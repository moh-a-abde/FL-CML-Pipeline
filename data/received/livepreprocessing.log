2025-02-26 20:08:27,727 - INFO - Starting livepreprocessing_socket.py
2025-02-26 20:08:27,727 - INFO - Sending test message to socket server
2025-02-26 20:08:27,727 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:08:27,727 - INFO - Data sent successfully!
2025-02-26 20:08:27,728 - INFO - Test message sent successfully
2025-02-26 20:08:27,728 - INFO - Socket communication test successful, proceeding with data processing
2025-02-26 20:08:27,728 - INFO - Starting data processing
2025-02-26 20:08:27,728 - INFO - This run will save data to: received/network_traffic_20250226_200827.csv
2025-02-26 20:08:27,728 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:08:27,730 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:08:27,730 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:08:27,731 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:08:27,833 - INFO - Broker version identified as 2.5.0
2025-02-26 20:08:27,833 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:08:27,833 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:08:27,833 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:08:27,833 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:08:27,834 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:08:27,834 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:08:27,835 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:08:27,835 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:08:27,993 - INFO - Received 100 messages so far
2025-02-26 20:08:27,994 - INFO - Received 200 messages so far
2025-02-26 20:08:27,994 - INFO - Received 300 messages so far
2025-02-26 20:08:27,994 - INFO - Received 400 messages so far
2025-02-26 20:08:27,994 - INFO - Received 500 messages so far
2025-02-26 20:08:27,995 - INFO - Received 600 messages so far
2025-02-26 20:08:27,995 - INFO - Received 700 messages so far
2025-02-26 20:08:27,995 - INFO - Received 800 messages so far
2025-02-26 20:08:27,995 - INFO - Received 900 messages so far
2025-02-26 20:08:27,996 - INFO - Received 1000 messages so far
2025-02-26 20:08:27,996 - INFO - Received 1100 messages so far
2025-02-26 20:08:27,996 - INFO - Received 1200 messages so far
2025-02-26 20:08:27,996 - INFO - Received 1300 messages so far
2025-02-26 20:08:27,996 - INFO - Received 1400 messages so far
2025-02-26 20:08:27,997 - INFO - Received 1500 messages so far
2025-02-26 20:08:27,997 - INFO - Received 1600 messages so far
2025-02-26 20:08:27,997 - INFO - Received 1700 messages so far
2025-02-26 20:08:27,997 - INFO - Received 1800 messages so far
2025-02-26 20:08:27,997 - INFO - Received 1900 messages so far
2025-02-26 20:08:27,998 - INFO - Received 2000 messages so far
2025-02-26 20:08:27,998 - INFO - Received 2100 messages so far
2025-02-26 20:08:27,998 - INFO - Received 2200 messages so far
2025-02-26 20:08:27,998 - INFO - Received 2300 messages so far
2025-02-26 20:08:27,998 - INFO - Received 2400 messages so far
2025-02-26 20:08:27,999 - INFO - Received 2500 messages so far
2025-02-26 20:08:27,999 - INFO - Received 2600 messages so far
2025-02-26 20:08:27,999 - INFO - Received 2700 messages so far
2025-02-26 20:08:27,999 - INFO - Received 2800 messages so far
2025-02-26 20:08:27,999 - INFO - Received 2900 messages so far
2025-02-26 20:08:28,000 - INFO - Received 3000 messages so far
2025-02-26 20:08:28,000 - INFO - Received 3100 messages so far
2025-02-26 20:08:28,000 - INFO - Received 3200 messages so far
2025-02-26 20:08:28,000 - INFO - Received 3300 messages so far
2025-02-26 20:08:28,000 - INFO - Received 3400 messages so far
2025-02-26 20:08:28,001 - INFO - Received 3500 messages so far
2025-02-26 20:08:28,001 - INFO - Received 3600 messages so far
2025-02-26 20:08:28,001 - INFO - Received 3700 messages so far
2025-02-26 20:08:28,001 - INFO - Received 3800 messages so far
2025-02-26 20:08:28,001 - INFO - Received 3900 messages so far
2025-02-26 20:08:28,002 - INFO - Received 4000 messages so far
2025-02-26 20:08:28,002 - INFO - Received 4100 messages so far
2025-02-26 20:08:28,063 - INFO - Received 4200 messages so far
2025-02-26 20:08:28,063 - INFO - Received 4300 messages so far
2025-02-26 20:08:28,063 - INFO - Received 4400 messages so far
2025-02-26 20:08:28,064 - INFO - Received 4500 messages so far
2025-02-26 20:08:28,064 - INFO - Received 4600 messages so far
2025-02-26 20:08:28,064 - INFO - Received 4700 messages so far
2025-02-26 20:08:28,065 - INFO - Received 4800 messages so far
2025-02-26 20:08:28,065 - INFO - Received 4900 messages so far
2025-02-26 20:08:28,065 - INFO - Received 5000 messages so far
2025-02-26 20:08:28,065 - INFO - Received 5100 messages so far
2025-02-26 20:08:28,065 - INFO - Received 5200 messages so far
2025-02-26 20:08:28,065 - INFO - Received 5300 messages so far
2025-02-26 20:08:28,066 - INFO - Received 5400 messages so far
2025-02-26 20:08:28,066 - INFO - Received 5500 messages so far
2025-02-26 20:08:28,066 - INFO - Received 5600 messages so far
2025-02-26 20:08:28,066 - INFO - Received 5700 messages so far
2025-02-26 20:08:28,067 - INFO - Received 5800 messages so far
2025-02-26 20:08:28,067 - INFO - Received 5900 messages so far
2025-02-26 20:08:28,067 - INFO - Received 6000 messages so far
2025-02-26 20:08:28,067 - INFO - Received 6100 messages so far
2025-02-26 20:08:28,067 - INFO - Received 6200 messages so far
2025-02-26 20:08:28,068 - INFO - Received 6300 messages so far
2025-02-26 20:08:28,068 - INFO - Received 6400 messages so far
2025-02-26 20:08:28,068 - INFO - Received 6500 messages so far
2025-02-26 20:08:28,068 - INFO - Received 6600 messages so far
2025-02-26 20:08:28,068 - INFO - Received 6700 messages so far
2025-02-26 20:08:28,069 - INFO - Received 6800 messages so far
2025-02-26 20:08:28,069 - INFO - Received 6900 messages so far
2025-02-26 20:08:28,069 - INFO - Received 7000 messages so far
2025-02-26 20:08:28,069 - INFO - Received 7100 messages so far
2025-02-26 20:08:28,069 - INFO - Received 7200 messages so far
2025-02-26 20:08:28,069 - INFO - Received 7300 messages so far
2025-02-26 20:08:28,070 - INFO - Received 7400 messages so far
2025-02-26 20:08:28,070 - INFO - Received 7500 messages so far
2025-02-26 20:08:28,070 - INFO - Received 7600 messages so far
2025-02-26 20:08:28,070 - INFO - Received 7700 messages so far
2025-02-26 20:08:28,070 - INFO - Received 7800 messages so far
2025-02-26 20:08:28,071 - INFO - Received 7900 messages so far
2025-02-26 20:08:28,071 - INFO - Received 8000 messages so far
2025-02-26 20:08:28,071 - INFO - Received 8100 messages so far
2025-02-26 20:08:28,071 - INFO - Received 8200 messages so far
2025-02-26 20:08:28,071 - INFO - Received 8300 messages so far
2025-02-26 20:08:28,072 - INFO - Received 8400 messages so far
2025-02-26 20:08:28,072 - INFO - Received 8500 messages so far
2025-02-26 20:08:28,072 - INFO - Received 8600 messages so far
2025-02-26 20:08:28,072 - INFO - Received 8700 messages so far
2025-02-26 20:08:28,173 - INFO - Received 8800 messages so far
2025-02-26 20:08:28,173 - INFO - Received 8900 messages so far
2025-02-26 20:08:28,173 - INFO - Received 9000 messages so far
2025-02-26 20:08:28,173 - INFO - Received 9100 messages so far
2025-02-26 20:08:28,174 - INFO - Received 9200 messages so far
2025-02-26 20:08:28,174 - INFO - Received 9300 messages so far
2025-02-26 20:08:28,174 - INFO - Received 9400 messages so far
2025-02-26 20:08:28,175 - INFO - Received 9500 messages so far
2025-02-26 20:08:28,175 - INFO - Received 9600 messages so far
2025-02-26 20:08:28,175 - INFO - Received 9700 messages so far
2025-02-26 20:08:28,175 - INFO - Received 9800 messages so far
2025-02-26 20:08:28,175 - INFO - Received 9900 messages so far
2025-02-26 20:08:28,176 - INFO - Received 10000 messages so far
2025-02-26 20:08:28,176 - INFO - Total messages consumed: 10000
2025-02-26 20:08:28,266 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:08:28,269 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:08:28,269 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:08:28,269 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:08:28,270 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:08:28,280 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:08:28,281 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:08:28,281 - INFO - Number of columns: 66
2025-02-26 20:08:28,293 - INFO - DataFrame head:
      id.resp_p    id.orig_h     id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7704        NaN          NaN           NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8603     9092.0  192.168.1.3   192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  C9PUwf280DtQzqzefa    43566.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0    0.0007     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3671        NaN          NaN           NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7828      443.0  192.168.1.3  13.107.42.16   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  C4RG5m2BqBFqcoZeGc    44581.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     IIr        NaN            NaN        NaN            NaN       NaN       NaN       1    376acab97e4aab30                     NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8219        NaN          NaN           NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:08:28,293 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:08:28,324 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:08:28,374 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    376acab97e4aab30              2336755850007c23  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:08:28,375 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.   443.    53.  5353.   133.   134.    80.   138.   136.
 21115.   123.   547.    22.  1900. 21116.     0.   135.    67.]
2025-02-26 20:08:28,376 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:08:28,381 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:08:28,383 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:08:28,383 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:08:28,385 - INFO - DataFrame shape after NA dropping: (858, 23)
2025-02-26 20:08:28,385 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:08:28,385 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:08:28,385 - INFO - X shape: (858, 21), y shape: (858,)
2025-02-26 20:08:28,386 - INFO - Label distribution in training data: {'DNS': 718, 'HTTPS': 126, 'HTTP': 13, 'SSH': 1}
2025-02-26 20:08:28,387 - INFO - Training model...
2025-02-26 20:08:28,503 - INFO - Predicting on test data...
2025-02-26 20:08:28,517 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 147.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 24.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 172.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 172.0
  }
}
2025-02-26 20:08:28,517 - INFO - Total processed data shape: (858, 23)
2025-02-26 20:08:28,524 - INFO - Saved all processed data to received/network_traffic_20250226_200827.csv
2025-02-26 20:08:28,526 - INFO - JSON data size: 420444 bytes
2025-02-26 20:08:28,527 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:08:28,527 - INFO - Data sent successfully!
2025-02-26 20:08:28,527 - INFO - Data processing and transmission completed successfully
2025-02-26 20:08:28,528 - INFO - Data processing completed successfully. Exiting.
