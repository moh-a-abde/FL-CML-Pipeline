2025-02-26 19:26:47,784 - INFO - Starting livepreprocessing_socket.py
2025-02-26 19:26:47,784 - INFO - Starting data processing
2025-02-26 19:26:47,784 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9000']
2025-02-26 19:26:47,786 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connecting> [IPv4 ('192.168.1.3', 9000)]>: connecting to 192.168.1.3:9000 [('192.168.1.3', 9000) IPv4]
2025-02-26 19:26:47,786 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:26:47,786 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connecting> [IPv4 ('192.168.1.3', 9000)]>: Connection complete.
2025-02-26 19:26:49,889 - WARNING - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connected> [IPv4 ('192.168.1.3', 9000)]> timed out after 1998.4943866729736 ms. Closing connection.
2025-02-26 19:26:49,889 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connected> [IPv4 ('192.168.1.3', 9000)]>: Closing connection. [Error 7] RequestTimedOutError: Request timed out after 1998.4943866729736 ms
2025-02-26 19:26:49,890 - INFO - Broker is not v(0, 10) -- it did not recognize ApiVersionRequest_v0
2025-02-26 19:26:49,890 - ERROR - An error occurred while reading from Kafka: NoBrokersAvailable
Traceback (most recent call last):
  File "/home/mohamed/Desktop/workstation/FL-CML-Pipeline/data/livepreprocessing_socket.py", line 35, in read_kafka_topic
    consumer = KafkaConsumer(
  File "/home/mohamed/.pyenv/versions/3.10.4/lib/python3.10/site-packages/kafka/consumer/group.py", line 356, in __init__
    self._client = KafkaClient(metrics=self._metrics, **self.config)
  File "/home/mohamed/.pyenv/versions/3.10.4/lib/python3.10/site-packages/kafka/client_async.py", line 244, in __init__
    self.config['api_version'] = self.check_version(timeout=check_timeout)
  File "/home/mohamed/.pyenv/versions/3.10.4/lib/python3.10/site-packages/kafka/client_async.py", line 927, in check_version
    raise Errors.NoBrokersAvailable()
kafka.errors.NoBrokersAvailable: NoBrokersAvailable
2025-02-26 19:26:49,891 - WARNING - No data received from Kafka, skipping processing
2025-02-26 19:26:49,891 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:27:19,922 - INFO - Starting data processing
2025-02-26 19:27:19,922 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9000']
2025-02-26 19:27:19,923 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connecting> [IPv4 ('192.168.1.3', 9000)]>: connecting to 192.168.1.3:9000 [('192.168.1.3', 9000) IPv4]
2025-02-26 19:27:19,923 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:27:19,923 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connecting> [IPv4 ('192.168.1.3', 9000)]>: Connection complete.
2025-02-26 19:27:22,026 - WARNING - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connected> [IPv4 ('192.168.1.3', 9000)]> timed out after 1999.4769096374512 ms. Closing connection.
2025-02-26 19:27:22,027 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connected> [IPv4 ('192.168.1.3', 9000)]>: Closing connection. [Error 7] RequestTimedOutError: Request timed out after 1999.4769096374512 ms
2025-02-26 19:27:22,027 - INFO - Broker is not v(0, 10) -- it did not recognize ApiVersionRequest_v0
2025-02-26 19:27:22,027 - ERROR - An error occurred while reading from Kafka: NoBrokersAvailable
Traceback (most recent call last):
  File "/home/mohamed/Desktop/workstation/FL-CML-Pipeline/data/livepreprocessing_socket.py", line 35, in read_kafka_topic
    consumer = KafkaConsumer(
  File "/home/mohamed/.pyenv/versions/3.10.4/lib/python3.10/site-packages/kafka/consumer/group.py", line 356, in __init__
    self._client = KafkaClient(metrics=self._metrics, **self.config)
  File "/home/mohamed/.pyenv/versions/3.10.4/lib/python3.10/site-packages/kafka/client_async.py", line 244, in __init__
    self.config['api_version'] = self.check_version(timeout=check_timeout)
  File "/home/mohamed/.pyenv/versions/3.10.4/lib/python3.10/site-packages/kafka/client_async.py", line 927, in check_version
    raise Errors.NoBrokersAvailable()
kafka.errors.NoBrokersAvailable: NoBrokersAvailable
2025-02-26 19:27:22,028 - WARNING - No data received from Kafka, skipping processing
2025-02-26 19:27:22,028 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:27:39,939 - INFO - Process interrupted by user.
2025-02-26 19:28:56,980 - INFO - Starting livepreprocessing_socket.py
2025-02-26 19:28:56,980 - INFO - Starting data processing
2025-02-26 19:28:56,980 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:28:56,982 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:28:56,982 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:28:56,982 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:28:57,087 - INFO - Broker version identified as 2.5.0
2025-02-26 19:28:57,087 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:28:57,088 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:28:57,088 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:28:57,088 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:28:57,089 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:28:57,090 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:28:57,090 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:28:57,090 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:28:57,250 - INFO - Received 100 messages so far
2025-02-26 19:28:57,251 - INFO - Received 200 messages so far
2025-02-26 19:28:57,251 - INFO - Received 300 messages so far
2025-02-26 19:28:57,251 - INFO - Received 400 messages so far
2025-02-26 19:28:57,251 - INFO - Received 500 messages so far
2025-02-26 19:28:57,252 - INFO - Received 600 messages so far
2025-02-26 19:28:57,252 - INFO - Received 700 messages so far
2025-02-26 19:28:57,252 - INFO - Received 800 messages so far
2025-02-26 19:28:57,252 - INFO - Received 900 messages so far
2025-02-26 19:28:57,253 - INFO - Received 1000 messages so far
2025-02-26 19:28:57,253 - INFO - Received 1100 messages so far
2025-02-26 19:28:57,253 - INFO - Received 1200 messages so far
2025-02-26 19:28:57,253 - INFO - Received 1300 messages so far
2025-02-26 19:28:57,253 - INFO - Received 1400 messages so far
2025-02-26 19:28:57,254 - INFO - Received 1500 messages so far
2025-02-26 19:28:57,254 - INFO - Received 1600 messages so far
2025-02-26 19:28:57,254 - INFO - Received 1700 messages so far
2025-02-26 19:28:57,254 - INFO - Received 1800 messages so far
2025-02-26 19:28:57,254 - INFO - Received 1900 messages so far
2025-02-26 19:28:57,255 - INFO - Received 2000 messages so far
2025-02-26 19:28:57,255 - INFO - Received 2100 messages so far
2025-02-26 19:28:57,255 - INFO - Received 2200 messages so far
2025-02-26 19:28:57,255 - INFO - Received 2300 messages so far
2025-02-26 19:28:57,255 - INFO - Received 2400 messages so far
2025-02-26 19:28:57,256 - INFO - Received 2500 messages so far
2025-02-26 19:28:57,256 - INFO - Received 2600 messages so far
2025-02-26 19:28:57,256 - INFO - Received 2700 messages so far
2025-02-26 19:28:57,256 - INFO - Received 2800 messages so far
2025-02-26 19:28:57,256 - INFO - Received 2900 messages so far
2025-02-26 19:28:57,257 - INFO - Received 3000 messages so far
2025-02-26 19:28:57,257 - INFO - Received 3100 messages so far
2025-02-26 19:28:57,257 - INFO - Received 3200 messages so far
2025-02-26 19:28:57,257 - INFO - Received 3300 messages so far
2025-02-26 19:28:57,257 - INFO - Received 3400 messages so far
2025-02-26 19:28:57,258 - INFO - Received 3500 messages so far
2025-02-26 19:28:57,258 - INFO - Received 3600 messages so far
2025-02-26 19:28:57,258 - INFO - Received 3700 messages so far
2025-02-26 19:28:57,258 - INFO - Received 3800 messages so far
2025-02-26 19:28:57,258 - INFO - Received 3900 messages so far
2025-02-26 19:28:57,258 - INFO - Received 4000 messages so far
2025-02-26 19:28:57,259 - INFO - Received 4100 messages so far
2025-02-26 19:28:57,318 - INFO - Received 4200 messages so far
2025-02-26 19:28:57,318 - INFO - Received 4300 messages so far
2025-02-26 19:28:57,318 - INFO - Received 4400 messages so far
2025-02-26 19:28:57,319 - INFO - Received 4500 messages so far
2025-02-26 19:28:57,319 - INFO - Received 4600 messages so far
2025-02-26 19:28:57,319 - INFO - Received 4700 messages so far
2025-02-26 19:28:57,319 - INFO - Received 4800 messages so far
2025-02-26 19:28:57,320 - INFO - Received 4900 messages so far
2025-02-26 19:28:57,320 - INFO - Received 5000 messages so far
2025-02-26 19:28:57,320 - INFO - Received 5100 messages so far
2025-02-26 19:28:57,320 - INFO - Received 5200 messages so far
2025-02-26 19:28:57,320 - INFO - Received 5300 messages so far
2025-02-26 19:28:57,321 - INFO - Received 5400 messages so far
2025-02-26 19:28:57,321 - INFO - Received 5500 messages so far
2025-02-26 19:28:57,321 - INFO - Received 5600 messages so far
2025-02-26 19:28:57,321 - INFO - Received 5700 messages so far
2025-02-26 19:28:57,321 - INFO - Received 5800 messages so far
2025-02-26 19:28:57,322 - INFO - Received 5900 messages so far
2025-02-26 19:28:57,322 - INFO - Received 6000 messages so far
2025-02-26 19:28:57,322 - INFO - Received 6100 messages so far
2025-02-26 19:28:57,322 - INFO - Received 6200 messages so far
2025-02-26 19:28:57,322 - INFO - Received 6300 messages so far
2025-02-26 19:28:57,322 - INFO - Received 6400 messages so far
2025-02-26 19:28:57,323 - INFO - Received 6500 messages so far
2025-02-26 19:28:57,323 - INFO - Received 6600 messages so far
2025-02-26 19:28:57,323 - INFO - Received 6700 messages so far
2025-02-26 19:28:57,323 - INFO - Received 6800 messages so far
2025-02-26 19:28:57,323 - INFO - Received 6900 messages so far
2025-02-26 19:28:57,324 - INFO - Received 7000 messages so far
2025-02-26 19:28:57,324 - INFO - Received 7100 messages so far
2025-02-26 19:28:57,324 - INFO - Received 7200 messages so far
2025-02-26 19:28:57,324 - INFO - Received 7300 messages so far
2025-02-26 19:28:57,324 - INFO - Received 7400 messages so far
2025-02-26 19:28:57,325 - INFO - Received 7500 messages so far
2025-02-26 19:28:57,325 - INFO - Received 7600 messages so far
2025-02-26 19:28:57,325 - INFO - Received 7700 messages so far
2025-02-26 19:28:57,325 - INFO - Received 7800 messages so far
2025-02-26 19:28:57,325 - INFO - Received 7900 messages so far
2025-02-26 19:28:57,326 - INFO - Received 8000 messages so far
2025-02-26 19:28:57,326 - INFO - Received 8100 messages so far
2025-02-26 19:28:57,326 - INFO - Received 8200 messages so far
2025-02-26 19:28:57,326 - INFO - Received 8300 messages so far
2025-02-26 19:28:57,326 - INFO - Received 8400 messages so far
2025-02-26 19:28:57,326 - INFO - Received 8500 messages so far
2025-02-26 19:28:57,327 - INFO - Received 8600 messages so far
2025-02-26 19:28:57,327 - INFO - Received 8700 messages so far
2025-02-26 19:28:57,425 - INFO - Received 8800 messages so far
2025-02-26 19:28:57,425 - INFO - Received 8900 messages so far
2025-02-26 19:28:57,425 - INFO - Received 9000 messages so far
2025-02-26 19:28:57,426 - INFO - Received 9100 messages so far
2025-02-26 19:28:57,426 - INFO - Received 9200 messages so far
2025-02-26 19:28:57,426 - INFO - Received 9300 messages so far
2025-02-26 19:28:57,427 - INFO - Received 9400 messages so far
2025-02-26 19:28:57,427 - INFO - Received 9500 messages so far
2025-02-26 19:28:57,427 - INFO - Received 9600 messages so far
2025-02-26 19:28:57,427 - INFO - Received 9700 messages so far
2025-02-26 19:28:57,427 - INFO - Received 9800 messages so far
2025-02-26 19:28:57,428 - INFO - Received 9900 messages so far
2025-02-26 19:28:57,428 - INFO - Received 10000 messages so far
2025-02-26 19:28:57,428 - INFO - Total messages consumed: 10000
2025-02-26 19:28:57,518 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:28:57,522 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:28:57,522 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:28:57,522 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:28:57,522 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:28:57,534 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:28:57,535 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:28:57,535 - INFO - Number of columns: 66
2025-02-26 19:28:57,548 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                               query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                               answers                   TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
2258        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                   NaN                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5914        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                   NaN                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9915        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                   NaN                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9707       53.0  192.168.1.3  192.168.1.1   udp        52.0       220.0  1.740120e+09      NaN  NaN     dns   C6FRWxHEz97jUiPZb    57668.0       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                   NaN                    NaN      NaN         SF       True       True           0.0      Dd        1.0           80.0        1.0          248.0      17.0  0.001386     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
307        53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740118e+09      NaN  NaN     NaN  CFmJND4WYa3ZYTfZL6    47879.0  0.001717  word-telemetry.officeapps.live.com     1.0  C_INTERNET    1.0          A    0.0    NOERROR  False  False  True  True  0.0  [word-telemetry.wac.trafficmanager.net, pgtus1-word-telemetry-vip.officeapps.live.com, 52.108.78.30]  [263.0, 263.0, 263.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:28:57,548 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:28:57,579 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:28:57,625 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version           client_initial_dcid client_scid                   server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                            19          19                            17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                            19           1                            17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13  53d430adb444f9c5ce75c07fa520              f3a21106ed00c9ab0a948d7162de  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                             1          19                             1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:28:57,626 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.   443.  9092.    80.  1900.  5353.     0.   123.   136.
   133. 21115.    22.   134.   138.   135. 21116.   547.    67.]
2025-02-26 19:28:57,631 - INFO - Label distribution: {}
2025-02-26 19:28:57,632 - WARNING - No data left after filtering for valid labels
2025-02-26 19:28:57,633 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:29:27,663 - INFO - Starting data processing
2025-02-26 19:29:27,663 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:29:27,664 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:29:27,665 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:29:27,665 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:29:27,767 - INFO - Broker version identified as 2.5.0
2025-02-26 19:29:27,768 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:29:27,768 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:29:27,768 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:29:27,768 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:29:27,769 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:29:27,769 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:29:27,770 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:29:27,770 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:29:27,941 - INFO - Received 100 messages so far
2025-02-26 19:29:27,941 - INFO - Received 200 messages so far
2025-02-26 19:29:27,941 - INFO - Received 300 messages so far
2025-02-26 19:29:27,941 - INFO - Received 400 messages so far
2025-02-26 19:29:27,941 - INFO - Received 500 messages so far
2025-02-26 19:29:27,942 - INFO - Received 600 messages so far
2025-02-26 19:29:27,942 - INFO - Received 700 messages so far
2025-02-26 19:29:27,942 - INFO - Received 800 messages so far
2025-02-26 19:29:27,942 - INFO - Received 900 messages so far
2025-02-26 19:29:27,943 - INFO - Received 1000 messages so far
2025-02-26 19:29:27,943 - INFO - Received 1100 messages so far
2025-02-26 19:29:27,944 - INFO - Received 1200 messages so far
2025-02-26 19:29:27,944 - INFO - Received 1300 messages so far
2025-02-26 19:29:27,944 - INFO - Received 1400 messages so far
2025-02-26 19:29:27,945 - INFO - Received 1500 messages so far
2025-02-26 19:29:27,945 - INFO - Received 1600 messages so far
2025-02-26 19:29:27,945 - INFO - Received 1700 messages so far
2025-02-26 19:29:27,945 - INFO - Received 1800 messages so far
2025-02-26 19:29:27,946 - INFO - Received 1900 messages so far
2025-02-26 19:29:27,946 - INFO - Received 2000 messages so far
2025-02-26 19:29:27,946 - INFO - Received 2100 messages so far
2025-02-26 19:29:27,946 - INFO - Received 2200 messages so far
2025-02-26 19:29:27,946 - INFO - Received 2300 messages so far
2025-02-26 19:29:27,947 - INFO - Received 2400 messages so far
2025-02-26 19:29:27,947 - INFO - Received 2500 messages so far
2025-02-26 19:29:27,947 - INFO - Received 2600 messages so far
2025-02-26 19:29:27,947 - INFO - Received 2700 messages so far
2025-02-26 19:29:27,947 - INFO - Received 2800 messages so far
2025-02-26 19:29:27,948 - INFO - Received 2900 messages so far
2025-02-26 19:29:27,948 - INFO - Received 3000 messages so far
2025-02-26 19:29:27,948 - INFO - Received 3100 messages so far
2025-02-26 19:29:27,948 - INFO - Received 3200 messages so far
2025-02-26 19:29:27,948 - INFO - Received 3300 messages so far
2025-02-26 19:29:27,949 - INFO - Received 3400 messages so far
2025-02-26 19:29:27,949 - INFO - Received 3500 messages so far
2025-02-26 19:29:27,949 - INFO - Received 3600 messages so far
2025-02-26 19:29:27,949 - INFO - Received 3700 messages so far
2025-02-26 19:29:27,949 - INFO - Received 3800 messages so far
2025-02-26 19:29:27,950 - INFO - Received 3900 messages so far
2025-02-26 19:29:27,950 - INFO - Received 4000 messages so far
2025-02-26 19:29:27,950 - INFO - Received 4100 messages so far
2025-02-26 19:29:28,008 - INFO - Received 4200 messages so far
2025-02-26 19:29:28,008 - INFO - Received 4300 messages so far
2025-02-26 19:29:28,009 - INFO - Received 4400 messages so far
2025-02-26 19:29:28,009 - INFO - Received 4500 messages so far
2025-02-26 19:29:28,009 - INFO - Received 4600 messages so far
2025-02-26 19:29:28,009 - INFO - Received 4700 messages so far
2025-02-26 19:29:28,009 - INFO - Received 4800 messages so far
2025-02-26 19:29:28,010 - INFO - Received 4900 messages so far
2025-02-26 19:29:28,010 - INFO - Received 5000 messages so far
2025-02-26 19:29:28,010 - INFO - Received 5100 messages so far
2025-02-26 19:29:28,010 - INFO - Received 5200 messages so far
2025-02-26 19:29:28,011 - INFO - Received 5300 messages so far
2025-02-26 19:29:28,011 - INFO - Received 5400 messages so far
2025-02-26 19:29:28,011 - INFO - Received 5500 messages so far
2025-02-26 19:29:28,011 - INFO - Received 5600 messages so far
2025-02-26 19:29:28,011 - INFO - Received 5700 messages so far
2025-02-26 19:29:28,012 - INFO - Received 5800 messages so far
2025-02-26 19:29:28,012 - INFO - Received 5900 messages so far
2025-02-26 19:29:28,012 - INFO - Received 6000 messages so far
2025-02-26 19:29:28,012 - INFO - Received 6100 messages so far
2025-02-26 19:29:28,012 - INFO - Received 6200 messages so far
2025-02-26 19:29:28,013 - INFO - Received 6300 messages so far
2025-02-26 19:29:28,013 - INFO - Received 6400 messages so far
2025-02-26 19:29:28,013 - INFO - Received 6500 messages so far
2025-02-26 19:29:28,013 - INFO - Received 6600 messages so far
2025-02-26 19:29:28,013 - INFO - Received 6700 messages so far
2025-02-26 19:29:28,014 - INFO - Received 6800 messages so far
2025-02-26 19:29:28,014 - INFO - Received 6900 messages so far
2025-02-26 19:29:28,014 - INFO - Received 7000 messages so far
2025-02-26 19:29:28,014 - INFO - Received 7100 messages so far
2025-02-26 19:29:28,014 - INFO - Received 7200 messages so far
2025-02-26 19:29:28,015 - INFO - Received 7300 messages so far
2025-02-26 19:29:28,015 - INFO - Received 7400 messages so far
2025-02-26 19:29:28,015 - INFO - Received 7500 messages so far
2025-02-26 19:29:28,015 - INFO - Received 7600 messages so far
2025-02-26 19:29:28,015 - INFO - Received 7700 messages so far
2025-02-26 19:29:28,016 - INFO - Received 7800 messages so far
2025-02-26 19:29:28,016 - INFO - Received 7900 messages so far
2025-02-26 19:29:28,016 - INFO - Received 8000 messages so far
2025-02-26 19:29:28,016 - INFO - Received 8100 messages so far
2025-02-26 19:29:28,016 - INFO - Received 8200 messages so far
2025-02-26 19:29:28,017 - INFO - Received 8300 messages so far
2025-02-26 19:29:28,017 - INFO - Received 8400 messages so far
2025-02-26 19:29:28,017 - INFO - Received 8500 messages so far
2025-02-26 19:29:28,017 - INFO - Received 8600 messages so far
2025-02-26 19:29:28,018 - INFO - Received 8700 messages so far
2025-02-26 19:29:28,079 - INFO - Received 8800 messages so far
2025-02-26 19:29:28,080 - INFO - Received 8900 messages so far
2025-02-26 19:29:28,080 - INFO - Received 9000 messages so far
2025-02-26 19:29:28,080 - INFO - Received 9100 messages so far
2025-02-26 19:29:28,080 - INFO - Received 9200 messages so far
2025-02-26 19:29:28,080 - INFO - Received 9300 messages so far
2025-02-26 19:29:28,081 - INFO - Received 9400 messages so far
2025-02-26 19:29:28,081 - INFO - Received 9500 messages so far
2025-02-26 19:29:28,081 - INFO - Received 9600 messages so far
2025-02-26 19:29:28,081 - INFO - Received 9700 messages so far
2025-02-26 19:29:28,082 - INFO - Received 9800 messages so far
2025-02-26 19:29:28,082 - INFO - Received 9900 messages so far
2025-02-26 19:29:28,082 - INFO - Received 10000 messages so far
2025-02-26 19:29:28,082 - INFO - Total messages consumed: 10000
2025-02-26 19:29:28,184 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:29:28,187 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:29:28,187 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:29:28,187 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:29:28,187 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:29:28,194 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:29:28,198 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:29:28,198 - INFO - Number of columns: 66
2025-02-26 19:29:28,208 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
2452        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.104254     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3466        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
162         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6230        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5231        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:29:28,208 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:29:28,239 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:29:28,285 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    6b77933b392d05f9              eb77933b392d05f9  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:29:28,286 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   443.  5353.  1900.   123.   136.   547. 21116.
     0.    80.   133.   134.   138.    67.    22. 21115.   135.]
2025-02-26 19:29:28,291 - INFO - Label distribution: {}
2025-02-26 19:29:28,292 - WARNING - No data left after filtering for valid labels
2025-02-26 19:29:28,293 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:29:36,933 - INFO - Process interrupted by user.
2025-02-26 19:31:16,239 - INFO - Starting livepreprocessing_socket.py
2025-02-26 19:31:16,239 - INFO - Sending test message to socket server
2025-02-26 19:31:16,239 - INFO - Attempting to send data to localhost:9000
2025-02-26 19:31:16,239 - ERROR - Connection refused to localhost:9000. Is the receiving server running?
2025-02-26 19:31:16,239 - ERROR - Failed to send test message
2025-02-26 19:31:16,239 - WARNING - Socket communication test failed, but proceeding anyway
2025-02-26 19:31:16,239 - INFO - Starting data processing
2025-02-26 19:31:16,239 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:31:16,241 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:31:16,241 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:31:16,241 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:31:16,344 - INFO - Broker version identified as 2.5.0
2025-02-26 19:31:16,344 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:31:16,344 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:31:16,344 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:31:16,344 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:31:16,345 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:31:16,346 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:31:16,346 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:31:16,346 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:31:16,503 - INFO - Received 100 messages so far
2025-02-26 19:31:16,504 - INFO - Received 200 messages so far
2025-02-26 19:31:16,504 - INFO - Received 300 messages so far
2025-02-26 19:31:16,504 - INFO - Received 400 messages so far
2025-02-26 19:31:16,504 - INFO - Received 500 messages so far
2025-02-26 19:31:16,505 - INFO - Received 600 messages so far
2025-02-26 19:31:16,505 - INFO - Received 700 messages so far
2025-02-26 19:31:16,505 - INFO - Received 800 messages so far
2025-02-26 19:31:16,505 - INFO - Received 900 messages so far
2025-02-26 19:31:16,506 - INFO - Received 1000 messages so far
2025-02-26 19:31:16,506 - INFO - Received 1100 messages so far
2025-02-26 19:31:16,506 - INFO - Received 1200 messages so far
2025-02-26 19:31:16,506 - INFO - Received 1300 messages so far
2025-02-26 19:31:16,506 - INFO - Received 1400 messages so far
2025-02-26 19:31:16,507 - INFO - Received 1500 messages so far
2025-02-26 19:31:16,507 - INFO - Received 1600 messages so far
2025-02-26 19:31:16,507 - INFO - Received 1700 messages so far
2025-02-26 19:31:16,507 - INFO - Received 1800 messages so far
2025-02-26 19:31:16,507 - INFO - Received 1900 messages so far
2025-02-26 19:31:16,508 - INFO - Received 2000 messages so far
2025-02-26 19:31:16,508 - INFO - Received 2100 messages so far
2025-02-26 19:31:16,508 - INFO - Received 2200 messages so far
2025-02-26 19:31:16,508 - INFO - Received 2300 messages so far
2025-02-26 19:31:16,508 - INFO - Received 2400 messages so far
2025-02-26 19:31:16,509 - INFO - Received 2500 messages so far
2025-02-26 19:31:16,509 - INFO - Received 2600 messages so far
2025-02-26 19:31:16,509 - INFO - Received 2700 messages so far
2025-02-26 19:31:16,509 - INFO - Received 2800 messages so far
2025-02-26 19:31:16,509 - INFO - Received 2900 messages so far
2025-02-26 19:31:16,510 - INFO - Received 3000 messages so far
2025-02-26 19:31:16,510 - INFO - Received 3100 messages so far
2025-02-26 19:31:16,510 - INFO - Received 3200 messages so far
2025-02-26 19:31:16,510 - INFO - Received 3300 messages so far
2025-02-26 19:31:16,510 - INFO - Received 3400 messages so far
2025-02-26 19:31:16,511 - INFO - Received 3500 messages so far
2025-02-26 19:31:16,511 - INFO - Received 3600 messages so far
2025-02-26 19:31:16,511 - INFO - Received 3700 messages so far
2025-02-26 19:31:16,511 - INFO - Received 3800 messages so far
2025-02-26 19:31:16,511 - INFO - Received 3900 messages so far
2025-02-26 19:31:16,512 - INFO - Received 4000 messages so far
2025-02-26 19:31:16,512 - INFO - Received 4100 messages so far
2025-02-26 19:31:16,571 - INFO - Received 4200 messages so far
2025-02-26 19:31:16,572 - INFO - Received 4300 messages so far
2025-02-26 19:31:16,572 - INFO - Received 4400 messages so far
2025-02-26 19:31:16,572 - INFO - Received 4500 messages so far
2025-02-26 19:31:16,572 - INFO - Received 4600 messages so far
2025-02-26 19:31:16,573 - INFO - Received 4700 messages so far
2025-02-26 19:31:16,573 - INFO - Received 4800 messages so far
2025-02-26 19:31:16,573 - INFO - Received 4900 messages so far
2025-02-26 19:31:16,573 - INFO - Received 5000 messages so far
2025-02-26 19:31:16,574 - INFO - Received 5100 messages so far
2025-02-26 19:31:16,574 - INFO - Received 5200 messages so far
2025-02-26 19:31:16,574 - INFO - Received 5300 messages so far
2025-02-26 19:31:16,574 - INFO - Received 5400 messages so far
2025-02-26 19:31:16,574 - INFO - Received 5500 messages so far
2025-02-26 19:31:16,575 - INFO - Received 5600 messages so far
2025-02-26 19:31:16,575 - INFO - Received 5700 messages so far
2025-02-26 19:31:16,575 - INFO - Received 5800 messages so far
2025-02-26 19:31:16,575 - INFO - Received 5900 messages so far
2025-02-26 19:31:16,575 - INFO - Received 6000 messages so far
2025-02-26 19:31:16,576 - INFO - Received 6100 messages so far
2025-02-26 19:31:16,576 - INFO - Received 6200 messages so far
2025-02-26 19:31:16,576 - INFO - Received 6300 messages so far
2025-02-26 19:31:16,576 - INFO - Received 6400 messages so far
2025-02-26 19:31:16,576 - INFO - Received 6500 messages so far
2025-02-26 19:31:16,576 - INFO - Received 6600 messages so far
2025-02-26 19:31:16,577 - INFO - Received 6700 messages so far
2025-02-26 19:31:16,577 - INFO - Received 6800 messages so far
2025-02-26 19:31:16,577 - INFO - Received 6900 messages so far
2025-02-26 19:31:16,577 - INFO - Received 7000 messages so far
2025-02-26 19:31:16,577 - INFO - Received 7100 messages so far
2025-02-26 19:31:16,578 - INFO - Received 7200 messages so far
2025-02-26 19:31:16,578 - INFO - Received 7300 messages so far
2025-02-26 19:31:16,578 - INFO - Received 7400 messages so far
2025-02-26 19:31:16,578 - INFO - Received 7500 messages so far
2025-02-26 19:31:16,578 - INFO - Received 7600 messages so far
2025-02-26 19:31:16,579 - INFO - Received 7700 messages so far
2025-02-26 19:31:16,579 - INFO - Received 7800 messages so far
2025-02-26 19:31:16,579 - INFO - Received 7900 messages so far
2025-02-26 19:31:16,579 - INFO - Received 8000 messages so far
2025-02-26 19:31:16,579 - INFO - Received 8100 messages so far
2025-02-26 19:31:16,580 - INFO - Received 8200 messages so far
2025-02-26 19:31:16,580 - INFO - Received 8300 messages so far
2025-02-26 19:31:16,580 - INFO - Received 8400 messages so far
2025-02-26 19:31:16,580 - INFO - Received 8500 messages so far
2025-02-26 19:31:16,580 - INFO - Received 8600 messages so far
2025-02-26 19:31:16,581 - INFO - Received 8700 messages so far
2025-02-26 19:31:16,682 - INFO - Received 8800 messages so far
2025-02-26 19:31:16,682 - INFO - Received 8900 messages so far
2025-02-26 19:31:16,682 - INFO - Received 9000 messages so far
2025-02-26 19:31:16,683 - INFO - Received 9100 messages so far
2025-02-26 19:31:16,683 - INFO - Received 9200 messages so far
2025-02-26 19:31:16,683 - INFO - Received 9300 messages so far
2025-02-26 19:31:16,684 - INFO - Received 9400 messages so far
2025-02-26 19:31:16,684 - INFO - Received 9500 messages so far
2025-02-26 19:31:16,684 - INFO - Received 9600 messages so far
2025-02-26 19:31:16,684 - INFO - Received 9700 messages so far
2025-02-26 19:31:16,684 - INFO - Received 9800 messages so far
2025-02-26 19:31:16,685 - INFO - Received 9900 messages so far
2025-02-26 19:31:16,685 - INFO - Received 10000 messages so far
2025-02-26 19:31:16,685 - INFO - Total messages consumed: 10000
2025-02-26 19:31:16,775 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:31:16,779 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:31:16,779 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:31:16,779 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:31:16,779 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:31:16,790 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:31:16,790 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:31:16,790 - INFO - Number of columns: 66
2025-02-26 19:31:16,801 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
4479        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005286     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6005        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2661        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6391        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.007185     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6155        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:31:16,801 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:31:16,833 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:31:16,878 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    2fe788e3cc713726              efe788e3cc713726  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:31:16,879 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.  1900.    53.   443.   134.  5353.   136.   138.   123.
    80.     0.   133.    67.    22. 21116.   135.   547. 21115.]
2025-02-26 19:31:16,884 - INFO - Label distribution: {}
2025-02-26 19:31:16,885 - WARNING - No data left after filtering for valid labels
2025-02-26 19:31:16,886 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:31:46,916 - INFO - Starting data processing
2025-02-26 19:31:46,916 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:31:46,917 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:31:46,918 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:31:46,918 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:31:47,020 - INFO - Broker version identified as 2.5.0
2025-02-26 19:31:47,020 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:31:47,020 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:31:47,020 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:31:47,021 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:31:47,022 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:31:47,022 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:31:47,022 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:31:47,022 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:31:47,191 - INFO - Received 100 messages so far
2025-02-26 19:31:47,191 - INFO - Received 200 messages so far
2025-02-26 19:31:47,191 - INFO - Received 300 messages so far
2025-02-26 19:31:47,192 - INFO - Received 400 messages so far
2025-02-26 19:31:47,192 - INFO - Received 500 messages so far
2025-02-26 19:31:47,192 - INFO - Received 600 messages so far
2025-02-26 19:31:47,192 - INFO - Received 700 messages so far
2025-02-26 19:31:47,192 - INFO - Received 800 messages so far
2025-02-26 19:31:47,193 - INFO - Received 900 messages so far
2025-02-26 19:31:47,193 - INFO - Received 1000 messages so far
2025-02-26 19:31:47,193 - INFO - Received 1100 messages so far
2025-02-26 19:31:47,193 - INFO - Received 1200 messages so far
2025-02-26 19:31:47,193 - INFO - Received 1300 messages so far
2025-02-26 19:31:47,194 - INFO - Received 1400 messages so far
2025-02-26 19:31:47,194 - INFO - Received 1500 messages so far
2025-02-26 19:31:47,194 - INFO - Received 1600 messages so far
2025-02-26 19:31:47,194 - INFO - Received 1700 messages so far
2025-02-26 19:31:47,194 - INFO - Received 1800 messages so far
2025-02-26 19:31:47,194 - INFO - Received 1900 messages so far
2025-02-26 19:31:47,195 - INFO - Received 2000 messages so far
2025-02-26 19:31:47,195 - INFO - Received 2100 messages so far
2025-02-26 19:31:47,195 - INFO - Received 2200 messages so far
2025-02-26 19:31:47,195 - INFO - Received 2300 messages so far
2025-02-26 19:31:47,195 - INFO - Received 2400 messages so far
2025-02-26 19:31:47,196 - INFO - Received 2500 messages so far
2025-02-26 19:31:47,196 - INFO - Received 2600 messages so far
2025-02-26 19:31:47,196 - INFO - Received 2700 messages so far
2025-02-26 19:31:47,196 - INFO - Received 2800 messages so far
2025-02-26 19:31:47,196 - INFO - Received 2900 messages so far
2025-02-26 19:31:47,197 - INFO - Received 3000 messages so far
2025-02-26 19:31:47,197 - INFO - Received 3100 messages so far
2025-02-26 19:31:47,197 - INFO - Received 3200 messages so far
2025-02-26 19:31:47,197 - INFO - Received 3300 messages so far
2025-02-26 19:31:47,197 - INFO - Received 3400 messages so far
2025-02-26 19:31:47,198 - INFO - Received 3500 messages so far
2025-02-26 19:31:47,198 - INFO - Received 3600 messages so far
2025-02-26 19:31:47,198 - INFO - Received 3700 messages so far
2025-02-26 19:31:47,198 - INFO - Received 3800 messages so far
2025-02-26 19:31:47,198 - INFO - Received 3900 messages so far
2025-02-26 19:31:47,199 - INFO - Received 4000 messages so far
2025-02-26 19:31:47,199 - INFO - Received 4100 messages so far
2025-02-26 19:31:47,254 - INFO - Received 4200 messages so far
2025-02-26 19:31:47,255 - INFO - Received 4300 messages so far
2025-02-26 19:31:47,255 - INFO - Received 4400 messages so far
2025-02-26 19:31:47,255 - INFO - Received 4500 messages so far
2025-02-26 19:31:47,255 - INFO - Received 4600 messages so far
2025-02-26 19:31:47,255 - INFO - Received 4700 messages so far
2025-02-26 19:31:47,256 - INFO - Received 4800 messages so far
2025-02-26 19:31:47,256 - INFO - Received 4900 messages so far
2025-02-26 19:31:47,256 - INFO - Received 5000 messages so far
2025-02-26 19:31:47,256 - INFO - Received 5100 messages so far
2025-02-26 19:31:47,256 - INFO - Received 5200 messages so far
2025-02-26 19:31:47,257 - INFO - Received 5300 messages so far
2025-02-26 19:31:47,257 - INFO - Received 5400 messages so far
2025-02-26 19:31:47,257 - INFO - Received 5500 messages so far
2025-02-26 19:31:47,257 - INFO - Received 5600 messages so far
2025-02-26 19:31:47,257 - INFO - Received 5700 messages so far
2025-02-26 19:31:47,258 - INFO - Received 5800 messages so far
2025-02-26 19:31:47,258 - INFO - Received 5900 messages so far
2025-02-26 19:31:47,258 - INFO - Received 6000 messages so far
2025-02-26 19:31:47,258 - INFO - Received 6100 messages so far
2025-02-26 19:31:47,258 - INFO - Received 6200 messages so far
2025-02-26 19:31:47,259 - INFO - Received 6300 messages so far
2025-02-26 19:31:47,259 - INFO - Received 6400 messages so far
2025-02-26 19:31:47,259 - INFO - Received 6500 messages so far
2025-02-26 19:31:47,259 - INFO - Received 6600 messages so far
2025-02-26 19:31:47,259 - INFO - Received 6700 messages so far
2025-02-26 19:31:47,260 - INFO - Received 6800 messages so far
2025-02-26 19:31:47,260 - INFO - Received 6900 messages so far
2025-02-26 19:31:47,260 - INFO - Received 7000 messages so far
2025-02-26 19:31:47,260 - INFO - Received 7100 messages so far
2025-02-26 19:31:47,260 - INFO - Received 7200 messages so far
2025-02-26 19:31:47,261 - INFO - Received 7300 messages so far
2025-02-26 19:31:47,261 - INFO - Received 7400 messages so far
2025-02-26 19:31:47,261 - INFO - Received 7500 messages so far
2025-02-26 19:31:47,261 - INFO - Received 7600 messages so far
2025-02-26 19:31:47,261 - INFO - Received 7700 messages so far
2025-02-26 19:31:47,262 - INFO - Received 7800 messages so far
2025-02-26 19:31:47,262 - INFO - Received 7900 messages so far
2025-02-26 19:31:47,262 - INFO - Received 8000 messages so far
2025-02-26 19:31:47,262 - INFO - Received 8100 messages so far
2025-02-26 19:31:47,262 - INFO - Received 8200 messages so far
2025-02-26 19:31:47,263 - INFO - Received 8300 messages so far
2025-02-26 19:31:47,263 - INFO - Received 8400 messages so far
2025-02-26 19:31:47,263 - INFO - Received 8500 messages so far
2025-02-26 19:31:47,263 - INFO - Received 8600 messages so far
2025-02-26 19:31:47,264 - INFO - Received 8700 messages so far
2025-02-26 19:31:47,323 - INFO - Received 8800 messages so far
2025-02-26 19:31:47,324 - INFO - Received 8900 messages so far
2025-02-26 19:31:47,324 - INFO - Received 9000 messages so far
2025-02-26 19:31:47,324 - INFO - Received 9100 messages so far
2025-02-26 19:31:47,324 - INFO - Received 9200 messages so far
2025-02-26 19:31:47,325 - INFO - Received 9300 messages so far
2025-02-26 19:31:47,325 - INFO - Received 9400 messages so far
2025-02-26 19:31:47,325 - INFO - Received 9500 messages so far
2025-02-26 19:31:47,325 - INFO - Received 9600 messages so far
2025-02-26 19:31:47,325 - INFO - Received 9700 messages so far
2025-02-26 19:31:47,326 - INFO - Received 9800 messages so far
2025-02-26 19:31:47,326 - INFO - Received 9900 messages so far
2025-02-26 19:31:47,326 - INFO - Received 10000 messages so far
2025-02-26 19:31:47,326 - INFO - Total messages consumed: 10000
2025-02-26 19:31:47,416 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:31:47,420 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:31:47,420 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:31:47,420 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:31:47,420 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:31:47,427 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:31:47,431 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:31:47,431 - INFO - Number of columns: 66
2025-02-26 19:31:47,442 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
8463     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  CwxOA24TO3SxEJoHTe    36324.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000571     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5755        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5237        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8643        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005622     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7746        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:31:47,442 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:31:47,473 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:31:47,519 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    5b67465ea3a9f950              20e4136c52007c23  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:31:47,520 - INFO - Unique values in 'id.resp_p' before labeling: [ 9092.    nan    53.  5353.  1900.   123.   443. 21115.   134.    80.
 21116.   133.   136.     0.   135.   138.   547.    67.    22.]
2025-02-26 19:31:47,529 - INFO - Label distribution: {}
2025-02-26 19:31:47,530 - WARNING - No data left after filtering for valid labels
2025-02-26 19:31:47,531 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:32:17,561 - INFO - Starting data processing
2025-02-26 19:32:17,562 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:32:17,562 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:32:17,563 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:32:17,563 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:32:17,665 - INFO - Broker version identified as 2.5.0
2025-02-26 19:32:17,665 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:32:17,665 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:32:17,666 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:32:17,666 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:32:17,667 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:32:17,667 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:32:17,667 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:32:17,667 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:32:17,833 - INFO - Received 100 messages so far
2025-02-26 19:32:17,834 - INFO - Received 200 messages so far
2025-02-26 19:32:17,834 - INFO - Received 300 messages so far
2025-02-26 19:32:17,834 - INFO - Received 400 messages so far
2025-02-26 19:32:17,834 - INFO - Received 500 messages so far
2025-02-26 19:32:17,835 - INFO - Received 600 messages so far
2025-02-26 19:32:17,835 - INFO - Received 700 messages so far
2025-02-26 19:32:17,835 - INFO - Received 800 messages so far
2025-02-26 19:32:17,835 - INFO - Received 900 messages so far
2025-02-26 19:32:17,835 - INFO - Received 1000 messages so far
2025-02-26 19:32:17,836 - INFO - Received 1100 messages so far
2025-02-26 19:32:17,836 - INFO - Received 1200 messages so far
2025-02-26 19:32:17,836 - INFO - Received 1300 messages so far
2025-02-26 19:32:17,836 - INFO - Received 1400 messages so far
2025-02-26 19:32:17,836 - INFO - Received 1500 messages so far
2025-02-26 19:32:17,837 - INFO - Received 1600 messages so far
2025-02-26 19:32:17,837 - INFO - Received 1700 messages so far
2025-02-26 19:32:17,837 - INFO - Received 1800 messages so far
2025-02-26 19:32:17,837 - INFO - Received 1900 messages so far
2025-02-26 19:32:17,837 - INFO - Received 2000 messages so far
2025-02-26 19:32:17,838 - INFO - Received 2100 messages so far
2025-02-26 19:32:17,838 - INFO - Received 2200 messages so far
2025-02-26 19:32:17,838 - INFO - Received 2300 messages so far
2025-02-26 19:32:17,838 - INFO - Received 2400 messages so far
2025-02-26 19:32:17,838 - INFO - Received 2500 messages so far
2025-02-26 19:32:17,838 - INFO - Received 2600 messages so far
2025-02-26 19:32:17,839 - INFO - Received 2700 messages so far
2025-02-26 19:32:17,839 - INFO - Received 2800 messages so far
2025-02-26 19:32:17,839 - INFO - Received 2900 messages so far
2025-02-26 19:32:17,839 - INFO - Received 3000 messages so far
2025-02-26 19:32:17,839 - INFO - Received 3100 messages so far
2025-02-26 19:32:17,840 - INFO - Received 3200 messages so far
2025-02-26 19:32:17,840 - INFO - Received 3300 messages so far
2025-02-26 19:32:17,840 - INFO - Received 3400 messages so far
2025-02-26 19:32:17,840 - INFO - Received 3500 messages so far
2025-02-26 19:32:17,840 - INFO - Received 3600 messages so far
2025-02-26 19:32:17,841 - INFO - Received 3700 messages so far
2025-02-26 19:32:17,841 - INFO - Received 3800 messages so far
2025-02-26 19:32:17,841 - INFO - Received 3900 messages so far
2025-02-26 19:32:17,841 - INFO - Received 4000 messages so far
2025-02-26 19:32:17,842 - INFO - Received 4100 messages so far
2025-02-26 19:32:17,952 - INFO - Received 4200 messages so far
2025-02-26 19:32:17,953 - INFO - Received 4300 messages so far
2025-02-26 19:32:17,953 - INFO - Received 4400 messages so far
2025-02-26 19:32:17,953 - INFO - Received 4500 messages so far
2025-02-26 19:32:17,953 - INFO - Received 4600 messages so far
2025-02-26 19:32:17,953 - INFO - Received 4700 messages so far
2025-02-26 19:32:17,953 - INFO - Received 4800 messages so far
2025-02-26 19:32:17,954 - INFO - Received 4900 messages so far
2025-02-26 19:32:17,954 - INFO - Received 5000 messages so far
2025-02-26 19:32:17,954 - INFO - Received 5100 messages so far
2025-02-26 19:32:17,954 - INFO - Received 5200 messages so far
2025-02-26 19:32:17,954 - INFO - Received 5300 messages so far
2025-02-26 19:32:17,955 - INFO - Received 5400 messages so far
2025-02-26 19:32:17,955 - INFO - Received 5500 messages so far
2025-02-26 19:32:17,955 - INFO - Received 5600 messages so far
2025-02-26 19:32:17,955 - INFO - Received 5700 messages so far
2025-02-26 19:32:17,955 - INFO - Received 5800 messages so far
2025-02-26 19:32:17,956 - INFO - Received 5900 messages so far
2025-02-26 19:32:17,956 - INFO - Received 6000 messages so far
2025-02-26 19:32:17,956 - INFO - Received 6100 messages so far
2025-02-26 19:32:17,956 - INFO - Received 6200 messages so far
2025-02-26 19:32:17,956 - INFO - Received 6300 messages so far
2025-02-26 19:32:17,957 - INFO - Received 6400 messages so far
2025-02-26 19:32:17,957 - INFO - Received 6500 messages so far
2025-02-26 19:32:17,957 - INFO - Received 6600 messages so far
2025-02-26 19:32:17,957 - INFO - Received 6700 messages so far
2025-02-26 19:32:17,957 - INFO - Received 6800 messages so far
2025-02-26 19:32:17,958 - INFO - Received 6900 messages so far
2025-02-26 19:32:17,958 - INFO - Received 7000 messages so far
2025-02-26 19:32:17,958 - INFO - Received 7100 messages so far
2025-02-26 19:32:17,958 - INFO - Received 7200 messages so far
2025-02-26 19:32:17,958 - INFO - Received 7300 messages so far
2025-02-26 19:32:17,958 - INFO - Received 7400 messages so far
2025-02-26 19:32:17,959 - INFO - Received 7500 messages so far
2025-02-26 19:32:17,959 - INFO - Received 7600 messages so far
2025-02-26 19:32:17,959 - INFO - Received 7700 messages so far
2025-02-26 19:32:17,959 - INFO - Received 7800 messages so far
2025-02-26 19:32:17,959 - INFO - Received 7900 messages so far
2025-02-26 19:32:17,960 - INFO - Received 8000 messages so far
2025-02-26 19:32:17,960 - INFO - Received 8100 messages so far
2025-02-26 19:32:17,960 - INFO - Received 8200 messages so far
2025-02-26 19:32:17,960 - INFO - Received 8300 messages so far
2025-02-26 19:32:17,960 - INFO - Received 8400 messages so far
2025-02-26 19:32:17,960 - INFO - Received 8500 messages so far
2025-02-26 19:32:17,961 - INFO - Received 8600 messages so far
2025-02-26 19:32:17,961 - INFO - Received 8700 messages so far
2025-02-26 19:32:18,018 - INFO - Received 8800 messages so far
2025-02-26 19:32:18,019 - INFO - Received 8900 messages so far
2025-02-26 19:32:18,019 - INFO - Received 9000 messages so far
2025-02-26 19:32:18,019 - INFO - Received 9100 messages so far
2025-02-26 19:32:18,019 - INFO - Received 9200 messages so far
2025-02-26 19:32:18,020 - INFO - Received 9300 messages so far
2025-02-26 19:32:18,020 - INFO - Received 9400 messages so far
2025-02-26 19:32:18,020 - INFO - Received 9500 messages so far
2025-02-26 19:32:18,020 - INFO - Received 9600 messages so far
2025-02-26 19:32:18,020 - INFO - Received 9700 messages so far
2025-02-26 19:32:18,021 - INFO - Received 9800 messages so far
2025-02-26 19:32:18,021 - INFO - Received 9900 messages so far
2025-02-26 19:32:18,021 - INFO - Received 10000 messages so far
2025-02-26 19:32:18,021 - INFO - Total messages consumed: 10000
2025-02-26 19:32:18,116 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:32:18,119 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:32:18,119 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:32:18,119 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:32:18,120 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:32:18,127 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:32:18,130 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:32:18,130 - INFO - Number of columns: 66
2025-02-26 19:32:18,141 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
4875        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7881        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.011322     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5458        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3637        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2184        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.007000     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:32:18,141 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:32:18,172 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:32:18,219 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    b90b0ae34b0b9725              f90b0ae34b0b9725  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:32:18,219 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   133.  1900.  5353.   443. 21116.   136.   123.
    80.   134.   138.   135.     0.   547.    22.    67. 21115.]
2025-02-26 19:32:18,225 - INFO - Label distribution: {}
2025-02-26 19:32:18,226 - WARNING - No data left after filtering for valid labels
2025-02-26 19:32:18,227 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:32:43,099 - INFO - Process interrupted by user.
2025-02-26 19:40:11,449 - INFO - Starting livepreprocessing_socket.py
2025-02-26 19:40:11,450 - INFO - Sending test message to socket server
2025-02-26 19:40:11,450 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:11,450 - ERROR - Connection refused to 192.168.1.3:9000. Is the receiving server running?
2025-02-26 19:40:11,450 - ERROR - Failed to send test message
2025-02-26 19:40:11,450 - WARNING - Socket communication test failed, but proceeding anyway
2025-02-26 19:40:11,450 - INFO - Starting data processing
2025-02-26 19:40:11,450 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:11,452 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:11,452 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:11,452 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:11,554 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:11,554 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:11,554 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:11,555 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:11,555 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:11,555 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:11,556 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:11,556 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:11,556 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:11,715 - INFO - Received 100 messages so far
2025-02-26 19:40:11,715 - INFO - Received 200 messages so far
2025-02-26 19:40:11,715 - INFO - Received 300 messages so far
2025-02-26 19:40:11,716 - INFO - Received 400 messages so far
2025-02-26 19:40:11,716 - INFO - Received 500 messages so far
2025-02-26 19:40:11,716 - INFO - Received 600 messages so far
2025-02-26 19:40:11,717 - INFO - Received 700 messages so far
2025-02-26 19:40:11,717 - INFO - Received 800 messages so far
2025-02-26 19:40:11,717 - INFO - Received 900 messages so far
2025-02-26 19:40:11,717 - INFO - Received 1000 messages so far
2025-02-26 19:40:11,718 - INFO - Received 1100 messages so far
2025-02-26 19:40:11,718 - INFO - Received 1200 messages so far
2025-02-26 19:40:11,718 - INFO - Received 1300 messages so far
2025-02-26 19:40:11,718 - INFO - Received 1400 messages so far
2025-02-26 19:40:11,718 - INFO - Received 1500 messages so far
2025-02-26 19:40:11,719 - INFO - Received 1600 messages so far
2025-02-26 19:40:11,719 - INFO - Received 1700 messages so far
2025-02-26 19:40:11,719 - INFO - Received 1800 messages so far
2025-02-26 19:40:11,719 - INFO - Received 1900 messages so far
2025-02-26 19:40:11,719 - INFO - Received 2000 messages so far
2025-02-26 19:40:11,720 - INFO - Received 2100 messages so far
2025-02-26 19:40:11,720 - INFO - Received 2200 messages so far
2025-02-26 19:40:11,720 - INFO - Received 2300 messages so far
2025-02-26 19:40:11,720 - INFO - Received 2400 messages so far
2025-02-26 19:40:11,720 - INFO - Received 2500 messages so far
2025-02-26 19:40:11,721 - INFO - Received 2600 messages so far
2025-02-26 19:40:11,721 - INFO - Received 2700 messages so far
2025-02-26 19:40:11,721 - INFO - Received 2800 messages so far
2025-02-26 19:40:11,721 - INFO - Received 2900 messages so far
2025-02-26 19:40:11,721 - INFO - Received 3000 messages so far
2025-02-26 19:40:11,722 - INFO - Received 3100 messages so far
2025-02-26 19:40:11,722 - INFO - Received 3200 messages so far
2025-02-26 19:40:11,722 - INFO - Received 3300 messages so far
2025-02-26 19:40:11,722 - INFO - Received 3400 messages so far
2025-02-26 19:40:11,722 - INFO - Received 3500 messages so far
2025-02-26 19:40:11,722 - INFO - Received 3600 messages so far
2025-02-26 19:40:11,723 - INFO - Received 3700 messages so far
2025-02-26 19:40:11,723 - INFO - Received 3800 messages so far
2025-02-26 19:40:11,723 - INFO - Received 3900 messages so far
2025-02-26 19:40:11,723 - INFO - Received 4000 messages so far
2025-02-26 19:40:11,724 - INFO - Received 4100 messages so far
2025-02-26 19:40:11,784 - INFO - Received 4200 messages so far
2025-02-26 19:40:11,784 - INFO - Received 4300 messages so far
2025-02-26 19:40:11,784 - INFO - Received 4400 messages so far
2025-02-26 19:40:11,784 - INFO - Received 4500 messages so far
2025-02-26 19:40:11,784 - INFO - Received 4600 messages so far
2025-02-26 19:40:11,785 - INFO - Received 4700 messages so far
2025-02-26 19:40:11,785 - INFO - Received 4800 messages so far
2025-02-26 19:40:11,785 - INFO - Received 4900 messages so far
2025-02-26 19:40:11,785 - INFO - Received 5000 messages so far
2025-02-26 19:40:11,786 - INFO - Received 5100 messages so far
2025-02-26 19:40:11,786 - INFO - Received 5200 messages so far
2025-02-26 19:40:11,786 - INFO - Received 5300 messages so far
2025-02-26 19:40:11,786 - INFO - Received 5400 messages so far
2025-02-26 19:40:11,786 - INFO - Received 5500 messages so far
2025-02-26 19:40:11,787 - INFO - Received 5600 messages so far
2025-02-26 19:40:11,787 - INFO - Received 5700 messages so far
2025-02-26 19:40:11,787 - INFO - Received 5800 messages so far
2025-02-26 19:40:11,787 - INFO - Received 5900 messages so far
2025-02-26 19:40:11,787 - INFO - Received 6000 messages so far
2025-02-26 19:40:11,788 - INFO - Received 6100 messages so far
2025-02-26 19:40:11,788 - INFO - Received 6200 messages so far
2025-02-26 19:40:11,788 - INFO - Received 6300 messages so far
2025-02-26 19:40:11,788 - INFO - Received 6400 messages so far
2025-02-26 19:40:11,788 - INFO - Received 6500 messages so far
2025-02-26 19:40:11,789 - INFO - Received 6600 messages so far
2025-02-26 19:40:11,789 - INFO - Received 6700 messages so far
2025-02-26 19:40:11,789 - INFO - Received 6800 messages so far
2025-02-26 19:40:11,789 - INFO - Received 6900 messages so far
2025-02-26 19:40:11,789 - INFO - Received 7000 messages so far
2025-02-26 19:40:11,790 - INFO - Received 7100 messages so far
2025-02-26 19:40:11,790 - INFO - Received 7200 messages so far
2025-02-26 19:40:11,790 - INFO - Received 7300 messages so far
2025-02-26 19:40:11,790 - INFO - Received 7400 messages so far
2025-02-26 19:40:11,790 - INFO - Received 7500 messages so far
2025-02-26 19:40:11,791 - INFO - Received 7600 messages so far
2025-02-26 19:40:11,791 - INFO - Received 7700 messages so far
2025-02-26 19:40:11,791 - INFO - Received 7800 messages so far
2025-02-26 19:40:11,791 - INFO - Received 7900 messages so far
2025-02-26 19:40:11,791 - INFO - Received 8000 messages so far
2025-02-26 19:40:11,792 - INFO - Received 8100 messages so far
2025-02-26 19:40:11,792 - INFO - Received 8200 messages so far
2025-02-26 19:40:11,792 - INFO - Received 8300 messages so far
2025-02-26 19:40:11,792 - INFO - Received 8400 messages so far
2025-02-26 19:40:11,792 - INFO - Received 8500 messages so far
2025-02-26 19:40:11,793 - INFO - Received 8600 messages so far
2025-02-26 19:40:11,793 - INFO - Received 8700 messages so far
2025-02-26 19:40:11,893 - INFO - Received 8800 messages so far
2025-02-26 19:40:11,893 - INFO - Received 8900 messages so far
2025-02-26 19:40:11,893 - INFO - Received 9000 messages so far
2025-02-26 19:40:11,893 - INFO - Received 9100 messages so far
2025-02-26 19:40:11,894 - INFO - Received 9200 messages so far
2025-02-26 19:40:11,894 - INFO - Received 9300 messages so far
2025-02-26 19:40:11,894 - INFO - Received 9400 messages so far
2025-02-26 19:40:11,895 - INFO - Received 9500 messages so far
2025-02-26 19:40:11,895 - INFO - Received 9600 messages so far
2025-02-26 19:40:11,895 - INFO - Received 9700 messages so far
2025-02-26 19:40:11,895 - INFO - Received 9800 messages so far
2025-02-26 19:40:11,895 - INFO - Received 9900 messages so far
2025-02-26 19:40:11,896 - INFO - Received 10000 messages so far
2025-02-26 19:40:11,896 - INFO - Total messages consumed: 10000
2025-02-26 19:40:11,988 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:11,992 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:11,992 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:11,992 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:11,992 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:12,003 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:12,003 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:12,003 - INFO - Number of columns: 66
2025-02-26 19:40:12,014 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3371        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005257     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6034        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1869        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1588        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2019        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:12,014 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:12,045 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:12,090 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    89520c813b739a8f              e9520c813b739a8f  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:12,090 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443. 21116.  5353.  1900.    80.   135.   123.
   134.   133.    67.   136.     0. 21115.   547.   138.    22.]
2025-02-26 19:40:12,091 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:12,097 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:12,098 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:12,098 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:12,101 - INFO - DataFrame shape after NA dropping: (868, 23)
2025-02-26 19:40:12,101 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:12,101 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:12,101 - INFO - X shape: (868, 21), y shape: (868,)
2025-02-26 19:40:12,101 - INFO - Label distribution in training data: {'DNS': 726, 'HTTPS': 127, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:12,102 - INFO - Training model...
2025-02-26 19:40:12,219 - INFO - Predicting on test data...
2025-02-26 19:40:12,235 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 145.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.8,
    "f1-score": 0.8888888888888888,
    "support": 5.0
  },
  "HTTPS": {
    "precision": 0.96,
    "recall": 1.0,
    "f1-score": 0.9795918367346939,
    "support": 24.0
  },
  "accuracy": 0.9942528735632183,
  "macro avg": {
    "precision": 0.9866666666666667,
    "recall": 0.9333333333333332,
    "f1-score": 0.9561602418745275,
    "support": 174.0
  },
  "weighted avg": {
    "precision": 0.9944827586206896,
    "recall": 0.9942528735632183,
    "f1-score": 0.9939922329084891,
    "support": 174.0
  }
}
2025-02-26 19:40:12,243 - INFO - Saved processed data locally to processed_data_20250226_194012.csv
2025-02-26 19:40:12,245 - INFO - JSON data size: 426682 bytes
2025-02-26 19:40:12,245 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:12,245 - ERROR - Connection refused to 192.168.1.3:9000. Is the receiving server running?
2025-02-26 19:40:12,246 - WARNING - Data processing completed but transmission failed
2025-02-26 19:40:12,248 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:40:42,278 - INFO - Starting data processing
2025-02-26 19:40:42,278 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:42,279 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:42,279 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:42,279 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:42,381 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:42,381 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:42,381 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:42,382 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:42,382 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:42,382 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:42,383 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:42,383 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:42,383 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:42,554 - INFO - Received 100 messages so far
2025-02-26 19:40:42,554 - INFO - Received 200 messages so far
2025-02-26 19:40:42,555 - INFO - Received 300 messages so far
2025-02-26 19:40:42,555 - INFO - Received 400 messages so far
2025-02-26 19:40:42,555 - INFO - Received 500 messages so far
2025-02-26 19:40:42,555 - INFO - Received 600 messages so far
2025-02-26 19:40:42,555 - INFO - Received 700 messages so far
2025-02-26 19:40:42,556 - INFO - Received 800 messages so far
2025-02-26 19:40:42,556 - INFO - Received 900 messages so far
2025-02-26 19:40:42,556 - INFO - Received 1000 messages so far
2025-02-26 19:40:42,556 - INFO - Received 1100 messages so far
2025-02-26 19:40:42,556 - INFO - Received 1200 messages so far
2025-02-26 19:40:42,557 - INFO - Received 1300 messages so far
2025-02-26 19:40:42,557 - INFO - Received 1400 messages so far
2025-02-26 19:40:42,557 - INFO - Received 1500 messages so far
2025-02-26 19:40:42,557 - INFO - Received 1600 messages so far
2025-02-26 19:40:42,557 - INFO - Received 1700 messages so far
2025-02-26 19:40:42,558 - INFO - Received 1800 messages so far
2025-02-26 19:40:42,558 - INFO - Received 1900 messages so far
2025-02-26 19:40:42,558 - INFO - Received 2000 messages so far
2025-02-26 19:40:42,558 - INFO - Received 2100 messages so far
2025-02-26 19:40:42,558 - INFO - Received 2200 messages so far
2025-02-26 19:40:42,559 - INFO - Received 2300 messages so far
2025-02-26 19:40:42,559 - INFO - Received 2400 messages so far
2025-02-26 19:40:42,559 - INFO - Received 2500 messages so far
2025-02-26 19:40:42,559 - INFO - Received 2600 messages so far
2025-02-26 19:40:42,559 - INFO - Received 2700 messages so far
2025-02-26 19:40:42,560 - INFO - Received 2800 messages so far
2025-02-26 19:40:42,560 - INFO - Received 2900 messages so far
2025-02-26 19:40:42,560 - INFO - Received 3000 messages so far
2025-02-26 19:40:42,560 - INFO - Received 3100 messages so far
2025-02-26 19:40:42,560 - INFO - Received 3200 messages so far
2025-02-26 19:40:42,560 - INFO - Received 3300 messages so far
2025-02-26 19:40:42,561 - INFO - Received 3400 messages so far
2025-02-26 19:40:42,561 - INFO - Received 3500 messages so far
2025-02-26 19:40:42,561 - INFO - Received 3600 messages so far
2025-02-26 19:40:42,561 - INFO - Received 3700 messages so far
2025-02-26 19:40:42,561 - INFO - Received 3800 messages so far
2025-02-26 19:40:42,562 - INFO - Received 3900 messages so far
2025-02-26 19:40:42,562 - INFO - Received 4000 messages so far
2025-02-26 19:40:42,562 - INFO - Received 4100 messages so far
2025-02-26 19:40:42,617 - INFO - Received 4200 messages so far
2025-02-26 19:40:42,618 - INFO - Received 4300 messages so far
2025-02-26 19:40:42,618 - INFO - Received 4400 messages so far
2025-02-26 19:40:42,618 - INFO - Received 4500 messages so far
2025-02-26 19:40:42,618 - INFO - Received 4600 messages so far
2025-02-26 19:40:42,618 - INFO - Received 4700 messages so far
2025-02-26 19:40:42,619 - INFO - Received 4800 messages so far
2025-02-26 19:40:42,619 - INFO - Received 4900 messages so far
2025-02-26 19:40:42,619 - INFO - Received 5000 messages so far
2025-02-26 19:40:42,619 - INFO - Received 5100 messages so far
2025-02-26 19:40:42,619 - INFO - Received 5200 messages so far
2025-02-26 19:40:42,620 - INFO - Received 5300 messages so far
2025-02-26 19:40:42,620 - INFO - Received 5400 messages so far
2025-02-26 19:40:42,620 - INFO - Received 5500 messages so far
2025-02-26 19:40:42,620 - INFO - Received 5600 messages so far
2025-02-26 19:40:42,620 - INFO - Received 5700 messages so far
2025-02-26 19:40:42,621 - INFO - Received 5800 messages so far
2025-02-26 19:40:42,621 - INFO - Received 5900 messages so far
2025-02-26 19:40:42,621 - INFO - Received 6000 messages so far
2025-02-26 19:40:42,621 - INFO - Received 6100 messages so far
2025-02-26 19:40:42,621 - INFO - Received 6200 messages so far
2025-02-26 19:40:42,622 - INFO - Received 6300 messages so far
2025-02-26 19:40:42,622 - INFO - Received 6400 messages so far
2025-02-26 19:40:42,622 - INFO - Received 6500 messages so far
2025-02-26 19:40:42,622 - INFO - Received 6600 messages so far
2025-02-26 19:40:42,622 - INFO - Received 6700 messages so far
2025-02-26 19:40:42,622 - INFO - Received 6800 messages so far
2025-02-26 19:40:42,623 - INFO - Received 6900 messages so far
2025-02-26 19:40:42,623 - INFO - Received 7000 messages so far
2025-02-26 19:40:42,623 - INFO - Received 7100 messages so far
2025-02-26 19:40:42,623 - INFO - Received 7200 messages so far
2025-02-26 19:40:42,623 - INFO - Received 7300 messages so far
2025-02-26 19:40:42,624 - INFO - Received 7400 messages so far
2025-02-26 19:40:42,624 - INFO - Received 7500 messages so far
2025-02-26 19:40:42,624 - INFO - Received 7600 messages so far
2025-02-26 19:40:42,624 - INFO - Received 7700 messages so far
2025-02-26 19:40:42,624 - INFO - Received 7800 messages so far
2025-02-26 19:40:42,625 - INFO - Received 7900 messages so far
2025-02-26 19:40:42,625 - INFO - Received 8000 messages so far
2025-02-26 19:40:42,625 - INFO - Received 8100 messages so far
2025-02-26 19:40:42,625 - INFO - Received 8200 messages so far
2025-02-26 19:40:42,625 - INFO - Received 8300 messages so far
2025-02-26 19:40:42,626 - INFO - Received 8400 messages so far
2025-02-26 19:40:42,626 - INFO - Received 8500 messages so far
2025-02-26 19:40:42,626 - INFO - Received 8600 messages so far
2025-02-26 19:40:42,626 - INFO - Received 8700 messages so far
2025-02-26 19:40:42,687 - INFO - Received 8800 messages so far
2025-02-26 19:40:42,687 - INFO - Received 8900 messages so far
2025-02-26 19:40:42,687 - INFO - Received 9000 messages so far
2025-02-26 19:40:42,687 - INFO - Received 9100 messages so far
2025-02-26 19:40:42,688 - INFO - Received 9200 messages so far
2025-02-26 19:40:42,688 - INFO - Received 9300 messages so far
2025-02-26 19:40:42,688 - INFO - Received 9400 messages so far
2025-02-26 19:40:42,688 - INFO - Received 9500 messages so far
2025-02-26 19:40:42,688 - INFO - Received 9600 messages so far
2025-02-26 19:40:42,689 - INFO - Received 9700 messages so far
2025-02-26 19:40:42,689 - INFO - Received 9800 messages so far
2025-02-26 19:40:42,689 - INFO - Received 9900 messages so far
2025-02-26 19:40:42,689 - INFO - Received 10000 messages so far
2025-02-26 19:40:42,689 - INFO - Total messages consumed: 10000
2025-02-26 19:40:42,776 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:42,779 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:42,779 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:42,779 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:42,779 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:42,786 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:42,790 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:42,790 - INFO - Number of columns: 66
2025-02-26 19:40:42,801 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7032        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
738         NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4137        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005296     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9283        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8583     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  CEPt7B4mA6zdT21A23    57794.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000711     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:42,801 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:42,833 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:42,879 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    c456d0cc73137d45              e456d0cc73137d45  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:42,879 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.    80.   443.  5353.     0.   138.   123.  1900.
   135.   133.   134. 21116.   547. 21115.   136.    22.    67.]
2025-02-26 19:40:42,881 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:42,886 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:42,887 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:42,887 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:42,889 - INFO - DataFrame shape after NA dropping: (717, 23)
2025-02-26 19:40:42,890 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:42,890 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:42,890 - INFO - X shape: (717, 21), y shape: (717,)
2025-02-26 19:40:42,890 - INFO - Label distribution in training data: {'DNS': 597, 'HTTPS': 108, 'HTTP': 11, 'SSH': 1}
2025-02-26 19:40:42,892 - INFO - Training model...
2025-02-26 19:40:43,008 - INFO - Predicting on test data...
2025-02-26 19:40:43,022 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 119.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 25.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 144.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 144.0
  }
}
2025-02-26 19:40:43,029 - INFO - Saved processed data locally to processed_data_20250226_194043.csv
2025-02-26 19:40:43,031 - INFO - JSON data size: 351700 bytes
2025-02-26 19:40:43,031 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:43,031 - INFO - Data sent successfully!
2025-02-26 19:40:43,032 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:43,034 - INFO - Starting data processing
2025-02-26 19:40:43,034 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:43,034 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:43,035 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:43,035 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:43,137 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:43,137 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:43,137 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:43,137 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:43,137 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:43,138 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:43,138 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:43,139 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:43,139 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:43,332 - INFO - Received 100 messages so far
2025-02-26 19:40:43,333 - INFO - Received 200 messages so far
2025-02-26 19:40:43,333 - INFO - Received 300 messages so far
2025-02-26 19:40:43,333 - INFO - Received 400 messages so far
2025-02-26 19:40:43,333 - INFO - Received 500 messages so far
2025-02-26 19:40:43,333 - INFO - Received 600 messages so far
2025-02-26 19:40:43,334 - INFO - Received 700 messages so far
2025-02-26 19:40:43,334 - INFO - Received 800 messages so far
2025-02-26 19:40:43,334 - INFO - Received 900 messages so far
2025-02-26 19:40:43,334 - INFO - Received 1000 messages so far
2025-02-26 19:40:43,334 - INFO - Received 1100 messages so far
2025-02-26 19:40:43,335 - INFO - Received 1200 messages so far
2025-02-26 19:40:43,335 - INFO - Received 1300 messages so far
2025-02-26 19:40:43,335 - INFO - Received 1400 messages so far
2025-02-26 19:40:43,335 - INFO - Received 1500 messages so far
2025-02-26 19:40:43,335 - INFO - Received 1600 messages so far
2025-02-26 19:40:43,336 - INFO - Received 1700 messages so far
2025-02-26 19:40:43,336 - INFO - Received 1800 messages so far
2025-02-26 19:40:43,336 - INFO - Received 1900 messages so far
2025-02-26 19:40:43,336 - INFO - Received 2000 messages so far
2025-02-26 19:40:43,336 - INFO - Received 2100 messages so far
2025-02-26 19:40:43,337 - INFO - Received 2200 messages so far
2025-02-26 19:40:43,337 - INFO - Received 2300 messages so far
2025-02-26 19:40:43,337 - INFO - Received 2400 messages so far
2025-02-26 19:40:43,337 - INFO - Received 2500 messages so far
2025-02-26 19:40:43,337 - INFO - Received 2600 messages so far
2025-02-26 19:40:43,338 - INFO - Received 2700 messages so far
2025-02-26 19:40:43,338 - INFO - Received 2800 messages so far
2025-02-26 19:40:43,338 - INFO - Received 2900 messages so far
2025-02-26 19:40:43,338 - INFO - Received 3000 messages so far
2025-02-26 19:40:43,338 - INFO - Received 3100 messages so far
2025-02-26 19:40:43,338 - INFO - Received 3200 messages so far
2025-02-26 19:40:43,339 - INFO - Received 3300 messages so far
2025-02-26 19:40:43,339 - INFO - Received 3400 messages so far
2025-02-26 19:40:43,339 - INFO - Received 3500 messages so far
2025-02-26 19:40:43,339 - INFO - Received 3600 messages so far
2025-02-26 19:40:43,339 - INFO - Received 3700 messages so far
2025-02-26 19:40:43,340 - INFO - Received 3800 messages so far
2025-02-26 19:40:43,340 - INFO - Received 3900 messages so far
2025-02-26 19:40:43,340 - INFO - Received 4000 messages so far
2025-02-26 19:40:43,340 - INFO - Received 4100 messages so far
2025-02-26 19:40:43,393 - INFO - Received 4200 messages so far
2025-02-26 19:40:43,393 - INFO - Received 4300 messages so far
2025-02-26 19:40:43,394 - INFO - Received 4400 messages so far
2025-02-26 19:40:43,394 - INFO - Received 4500 messages so far
2025-02-26 19:40:43,394 - INFO - Received 4600 messages so far
2025-02-26 19:40:43,394 - INFO - Received 4700 messages so far
2025-02-26 19:40:43,394 - INFO - Received 4800 messages so far
2025-02-26 19:40:43,395 - INFO - Received 4900 messages so far
2025-02-26 19:40:43,395 - INFO - Received 5000 messages so far
2025-02-26 19:40:43,395 - INFO - Received 5100 messages so far
2025-02-26 19:40:43,395 - INFO - Received 5200 messages so far
2025-02-26 19:40:43,395 - INFO - Received 5300 messages so far
2025-02-26 19:40:43,396 - INFO - Received 5400 messages so far
2025-02-26 19:40:43,396 - INFO - Received 5500 messages so far
2025-02-26 19:40:43,396 - INFO - Received 5600 messages so far
2025-02-26 19:40:43,396 - INFO - Received 5700 messages so far
2025-02-26 19:40:43,396 - INFO - Received 5800 messages so far
2025-02-26 19:40:43,397 - INFO - Received 5900 messages so far
2025-02-26 19:40:43,397 - INFO - Received 6000 messages so far
2025-02-26 19:40:43,397 - INFO - Received 6100 messages so far
2025-02-26 19:40:43,397 - INFO - Received 6200 messages so far
2025-02-26 19:40:43,397 - INFO - Received 6300 messages so far
2025-02-26 19:40:43,398 - INFO - Received 6400 messages so far
2025-02-26 19:40:43,398 - INFO - Received 6500 messages so far
2025-02-26 19:40:43,398 - INFO - Received 6600 messages so far
2025-02-26 19:40:43,398 - INFO - Received 6700 messages so far
2025-02-26 19:40:43,398 - INFO - Received 6800 messages so far
2025-02-26 19:40:43,398 - INFO - Received 6900 messages so far
2025-02-26 19:40:43,399 - INFO - Received 7000 messages so far
2025-02-26 19:40:43,399 - INFO - Received 7100 messages so far
2025-02-26 19:40:43,399 - INFO - Received 7200 messages so far
2025-02-26 19:40:43,399 - INFO - Received 7300 messages so far
2025-02-26 19:40:43,399 - INFO - Received 7400 messages so far
2025-02-26 19:40:43,400 - INFO - Received 7500 messages so far
2025-02-26 19:40:43,400 - INFO - Received 7600 messages so far
2025-02-26 19:40:43,400 - INFO - Received 7700 messages so far
2025-02-26 19:40:43,400 - INFO - Received 7800 messages so far
2025-02-26 19:40:43,400 - INFO - Received 7900 messages so far
2025-02-26 19:40:43,401 - INFO - Received 8000 messages so far
2025-02-26 19:40:43,401 - INFO - Received 8100 messages so far
2025-02-26 19:40:43,401 - INFO - Received 8200 messages so far
2025-02-26 19:40:43,401 - INFO - Received 8300 messages so far
2025-02-26 19:40:43,401 - INFO - Received 8400 messages so far
2025-02-26 19:40:43,402 - INFO - Received 8500 messages so far
2025-02-26 19:40:43,402 - INFO - Received 8600 messages so far
2025-02-26 19:40:43,402 - INFO - Received 8700 messages so far
2025-02-26 19:40:43,460 - INFO - Received 8800 messages so far
2025-02-26 19:40:43,461 - INFO - Received 8900 messages so far
2025-02-26 19:40:43,461 - INFO - Received 9000 messages so far
2025-02-26 19:40:43,461 - INFO - Received 9100 messages so far
2025-02-26 19:40:43,461 - INFO - Received 9200 messages so far
2025-02-26 19:40:43,461 - INFO - Received 9300 messages so far
2025-02-26 19:40:43,462 - INFO - Received 9400 messages so far
2025-02-26 19:40:43,462 - INFO - Received 9500 messages so far
2025-02-26 19:40:43,462 - INFO - Received 9600 messages so far
2025-02-26 19:40:43,462 - INFO - Received 9700 messages so far
2025-02-26 19:40:43,462 - INFO - Received 9800 messages so far
2025-02-26 19:40:43,463 - INFO - Received 9900 messages so far
2025-02-26 19:40:43,463 - INFO - Received 10000 messages so far
2025-02-26 19:40:43,463 - INFO - Total messages consumed: 10000
2025-02-26 19:40:43,552 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:43,555 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:43,556 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:43,556 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:43,556 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:43,568 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:43,568 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:43,569 - INFO - Number of columns: 66
2025-02-26 19:40:43,580 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7036        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4787        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4556        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5227        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5275       53.0  192.168.1.3  192.168.1.1   udp        55.0       490.0  1.740119e+09      NaN  NaN     dns  CqQhcB30jtmpUb4bJ4    41611.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           83.0        1.0          518.0      17.0  0.001777     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:43,580 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:43,611 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:43,656 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    56c8fcf4a1052fc6              f6c8fcf4a1052fc6  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:43,657 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.   443.  9092.  1900.    80.  5353.   123.   134.    67.
   133.   138. 21116. 21115.   136.   135.     0.    22.   547.]
2025-02-26 19:40:43,658 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:43,663 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:43,664 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:43,664 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:43,667 - INFO - DataFrame shape after NA dropping: (866, 23)
2025-02-26 19:40:43,667 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:43,667 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:43,667 - INFO - X shape: (866, 21), y shape: (866,)
2025-02-26 19:40:43,668 - INFO - Label distribution in training data: {'DNS': 723, 'HTTPS': 130, 'HTTP': 12, 'SSH': 1}
2025-02-26 19:40:43,669 - INFO - Training model...
2025-02-26 19:40:43,782 - INFO - Predicting on test data...
2025-02-26 19:40:43,795 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 134.0
  },
  "HTTP": {
    "precision": 0.75,
    "recall": 0.6,
    "f1-score": 0.6666666666666666,
    "support": 5.0
  },
  "HTTPS": {
    "precision": 0.9444444444444444,
    "recall": 0.9714285714285714,
    "f1-score": 0.9577464788732394,
    "support": 35.0
  },
  "accuracy": 0.9827586206896551,
  "macro avg": {
    "precision": 0.8981481481481483,
    "recall": 0.8571428571428572,
    "f1-score": 0.8748043818466353,
    "support": 174.0
  },
  "weighted avg": {
    "precision": 0.9816411238825031,
    "recall": 0.9827586206896551,
    "f1-score": 0.9819221844476822,
    "support": 174.0
  }
}
2025-02-26 19:40:43,802 - INFO - Saved processed data locally to processed_data_20250226_194043.csv
2025-02-26 19:40:43,805 - INFO - JSON data size: 424207 bytes
2025-02-26 19:40:43,805 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:43,805 - INFO - Data sent successfully!
2025-02-26 19:40:43,805 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:43,806 - INFO - Starting data processing
2025-02-26 19:40:43,806 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:43,807 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:43,807 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:43,807 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:43,910 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:43,910 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:43,911 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:43,911 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:43,911 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:43,912 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:43,912 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:43,912 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:43,912 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:44,066 - INFO - Received 100 messages so far
2025-02-26 19:40:44,067 - INFO - Received 200 messages so far
2025-02-26 19:40:44,067 - INFO - Received 300 messages so far
2025-02-26 19:40:44,067 - INFO - Received 400 messages so far
2025-02-26 19:40:44,067 - INFO - Received 500 messages so far
2025-02-26 19:40:44,067 - INFO - Received 600 messages so far
2025-02-26 19:40:44,068 - INFO - Received 700 messages so far
2025-02-26 19:40:44,068 - INFO - Received 800 messages so far
2025-02-26 19:40:44,068 - INFO - Received 900 messages so far
2025-02-26 19:40:44,068 - INFO - Received 1000 messages so far
2025-02-26 19:40:44,068 - INFO - Received 1100 messages so far
2025-02-26 19:40:44,069 - INFO - Received 1200 messages so far
2025-02-26 19:40:44,069 - INFO - Received 1300 messages so far
2025-02-26 19:40:44,069 - INFO - Received 1400 messages so far
2025-02-26 19:40:44,069 - INFO - Received 1500 messages so far
2025-02-26 19:40:44,069 - INFO - Received 1600 messages so far
2025-02-26 19:40:44,069 - INFO - Received 1700 messages so far
2025-02-26 19:40:44,070 - INFO - Received 1800 messages so far
2025-02-26 19:40:44,070 - INFO - Received 1900 messages so far
2025-02-26 19:40:44,070 - INFO - Received 2000 messages so far
2025-02-26 19:40:44,070 - INFO - Received 2100 messages so far
2025-02-26 19:40:44,070 - INFO - Received 2200 messages so far
2025-02-26 19:40:44,071 - INFO - Received 2300 messages so far
2025-02-26 19:40:44,071 - INFO - Received 2400 messages so far
2025-02-26 19:40:44,071 - INFO - Received 2500 messages so far
2025-02-26 19:40:44,071 - INFO - Received 2600 messages so far
2025-02-26 19:40:44,071 - INFO - Received 2700 messages so far
2025-02-26 19:40:44,072 - INFO - Received 2800 messages so far
2025-02-26 19:40:44,072 - INFO - Received 2900 messages so far
2025-02-26 19:40:44,072 - INFO - Received 3000 messages so far
2025-02-26 19:40:44,072 - INFO - Received 3100 messages so far
2025-02-26 19:40:44,072 - INFO - Received 3200 messages so far
2025-02-26 19:40:44,073 - INFO - Received 3300 messages so far
2025-02-26 19:40:44,073 - INFO - Received 3400 messages so far
2025-02-26 19:40:44,073 - INFO - Received 3500 messages so far
2025-02-26 19:40:44,073 - INFO - Received 3600 messages so far
2025-02-26 19:40:44,073 - INFO - Received 3700 messages so far
2025-02-26 19:40:44,073 - INFO - Received 3800 messages so far
2025-02-26 19:40:44,074 - INFO - Received 3900 messages so far
2025-02-26 19:40:44,074 - INFO - Received 4000 messages so far
2025-02-26 19:40:44,074 - INFO - Received 4100 messages so far
2025-02-26 19:40:44,128 - INFO - Received 4200 messages so far
2025-02-26 19:40:44,128 - INFO - Received 4300 messages so far
2025-02-26 19:40:44,128 - INFO - Received 4400 messages so far
2025-02-26 19:40:44,128 - INFO - Received 4500 messages so far
2025-02-26 19:40:44,129 - INFO - Received 4600 messages so far
2025-02-26 19:40:44,129 - INFO - Received 4700 messages so far
2025-02-26 19:40:44,129 - INFO - Received 4800 messages so far
2025-02-26 19:40:44,129 - INFO - Received 4900 messages so far
2025-02-26 19:40:44,129 - INFO - Received 5000 messages so far
2025-02-26 19:40:44,130 - INFO - Received 5100 messages so far
2025-02-26 19:40:44,130 - INFO - Received 5200 messages so far
2025-02-26 19:40:44,130 - INFO - Received 5300 messages so far
2025-02-26 19:40:44,130 - INFO - Received 5400 messages so far
2025-02-26 19:40:44,130 - INFO - Received 5500 messages so far
2025-02-26 19:40:44,131 - INFO - Received 5600 messages so far
2025-02-26 19:40:44,131 - INFO - Received 5700 messages so far
2025-02-26 19:40:44,131 - INFO - Received 5800 messages so far
2025-02-26 19:40:44,131 - INFO - Received 5900 messages so far
2025-02-26 19:40:44,131 - INFO - Received 6000 messages so far
2025-02-26 19:40:44,132 - INFO - Received 6100 messages so far
2025-02-26 19:40:44,132 - INFO - Received 6200 messages so far
2025-02-26 19:40:44,132 - INFO - Received 6300 messages so far
2025-02-26 19:40:44,132 - INFO - Received 6400 messages so far
2025-02-26 19:40:44,132 - INFO - Received 6500 messages so far
2025-02-26 19:40:44,133 - INFO - Received 6600 messages so far
2025-02-26 19:40:44,133 - INFO - Received 6700 messages so far
2025-02-26 19:40:44,133 - INFO - Received 6800 messages so far
2025-02-26 19:40:44,133 - INFO - Received 6900 messages so far
2025-02-26 19:40:44,133 - INFO - Received 7000 messages so far
2025-02-26 19:40:44,133 - INFO - Received 7100 messages so far
2025-02-26 19:40:44,134 - INFO - Received 7200 messages so far
2025-02-26 19:40:44,134 - INFO - Received 7300 messages so far
2025-02-26 19:40:44,134 - INFO - Received 7400 messages so far
2025-02-26 19:40:44,134 - INFO - Received 7500 messages so far
2025-02-26 19:40:44,134 - INFO - Received 7600 messages so far
2025-02-26 19:40:44,135 - INFO - Received 7700 messages so far
2025-02-26 19:40:44,135 - INFO - Received 7800 messages so far
2025-02-26 19:40:44,135 - INFO - Received 7900 messages so far
2025-02-26 19:40:44,135 - INFO - Received 8000 messages so far
2025-02-26 19:40:44,135 - INFO - Received 8100 messages so far
2025-02-26 19:40:44,136 - INFO - Received 8200 messages so far
2025-02-26 19:40:44,136 - INFO - Received 8300 messages so far
2025-02-26 19:40:44,136 - INFO - Received 8400 messages so far
2025-02-26 19:40:44,136 - INFO - Received 8500 messages so far
2025-02-26 19:40:44,136 - INFO - Received 8600 messages so far
2025-02-26 19:40:44,137 - INFO - Received 8700 messages so far
2025-02-26 19:40:44,232 - INFO - Received 8800 messages so far
2025-02-26 19:40:44,232 - INFO - Received 8900 messages so far
2025-02-26 19:40:44,233 - INFO - Received 9000 messages so far
2025-02-26 19:40:44,233 - INFO - Received 9100 messages so far
2025-02-26 19:40:44,233 - INFO - Received 9200 messages so far
2025-02-26 19:40:44,233 - INFO - Received 9300 messages so far
2025-02-26 19:40:44,233 - INFO - Received 9400 messages so far
2025-02-26 19:40:44,234 - INFO - Received 9500 messages so far
2025-02-26 19:40:44,234 - INFO - Received 9600 messages so far
2025-02-26 19:40:44,234 - INFO - Received 9700 messages so far
2025-02-26 19:40:44,234 - INFO - Received 9800 messages so far
2025-02-26 19:40:44,234 - INFO - Received 9900 messages so far
2025-02-26 19:40:44,235 - INFO - Received 10000 messages so far
2025-02-26 19:40:44,235 - INFO - Total messages consumed: 10000
2025-02-26 19:40:44,323 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:44,327 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:44,327 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:44,327 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:44,327 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:44,339 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:44,340 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:44,340 - INFO - Number of columns: 66
2025-02-26 19:40:44,351 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                 query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                     answers                                 TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
8937        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                   NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                         NaN                                  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3898        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                   NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                         NaN                                  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005569     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8328        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                   NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                         NaN                                  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
214        53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740118e+09      NaN  NaN     NaN  C0ZR0V2BnY1JaXynE3    47729.0  0.001807  analytics.google.com     1.0  C_INTERNET    1.0          A    0.0    NOERROR  False  False  True  True  0.0  [analytics-alv.google.com, 216.239.38.181, 216.239.32.181, 216.239.36.181, 216.239.34.181]  [204.0, 204.0, 204.0, 204.0, 204.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8707        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                   NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                         NaN                                  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.007383     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:44,351 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:44,381 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:44,426 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    b90b0ae34b0b9725              f90b0ae34b0b9725  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:44,426 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.   443.   123.   138.   136.   133.  1900.
    80.   547.   134. 21116.     0. 21115.   135.    22.    67.]
2025-02-26 19:40:44,428 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:44,433 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:44,434 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:44,434 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:44,436 - INFO - DataFrame shape after NA dropping: (852, 23)
2025-02-26 19:40:44,436 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:44,436 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:44,437 - INFO - X shape: (852, 21), y shape: (852,)
2025-02-26 19:40:44,437 - INFO - Label distribution in training data: {'DNS': 709, 'HTTPS': 128, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:44,438 - INFO - Training model...
2025-02-26 19:40:44,552 - INFO - Predicting on test data...
2025-02-26 19:40:44,566 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 143.0
  },
  "HTTP": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 0.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 0.9642857142857143,
    "f1-score": 0.9818181818181818,
    "support": 28.0
  },
  "accuracy": 0.9941520467836257,
  "macro avg": {
    "precision": 0.6666666666666666,
    "recall": 0.6547619047619048,
    "f1-score": 0.6606060606060606,
    "support": 171.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 0.9941520467836257,
    "f1-score": 0.9970228601807549,
    "support": 171.0
  }
}
2025-02-26 19:40:44,572 - INFO - Saved processed data locally to processed_data_20250226_194044.csv
2025-02-26 19:40:44,575 - INFO - JSON data size: 419992 bytes
2025-02-26 19:40:44,575 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:44,575 - INFO - Data sent successfully!
2025-02-26 19:40:44,575 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:44,576 - INFO - Starting data processing
2025-02-26 19:40:44,576 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:44,577 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:44,577 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:44,577 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:44,679 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:44,679 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:44,680 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:44,680 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:44,680 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:44,681 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:44,681 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:44,681 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:44,681 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:44,836 - INFO - Received 100 messages so far
2025-02-26 19:40:44,837 - INFO - Received 200 messages so far
2025-02-26 19:40:44,837 - INFO - Received 300 messages so far
2025-02-26 19:40:44,837 - INFO - Received 400 messages so far
2025-02-26 19:40:44,837 - INFO - Received 500 messages so far
2025-02-26 19:40:44,837 - INFO - Received 600 messages so far
2025-02-26 19:40:44,838 - INFO - Received 700 messages so far
2025-02-26 19:40:44,838 - INFO - Received 800 messages so far
2025-02-26 19:40:44,838 - INFO - Received 900 messages so far
2025-02-26 19:40:44,838 - INFO - Received 1000 messages so far
2025-02-26 19:40:44,838 - INFO - Received 1100 messages so far
2025-02-26 19:40:44,838 - INFO - Received 1200 messages so far
2025-02-26 19:40:44,839 - INFO - Received 1300 messages so far
2025-02-26 19:40:44,839 - INFO - Received 1400 messages so far
2025-02-26 19:40:44,839 - INFO - Received 1500 messages so far
2025-02-26 19:40:44,839 - INFO - Received 1600 messages so far
2025-02-26 19:40:44,839 - INFO - Received 1700 messages so far
2025-02-26 19:40:44,840 - INFO - Received 1800 messages so far
2025-02-26 19:40:44,840 - INFO - Received 1900 messages so far
2025-02-26 19:40:44,840 - INFO - Received 2000 messages so far
2025-02-26 19:40:44,840 - INFO - Received 2100 messages so far
2025-02-26 19:40:44,840 - INFO - Received 2200 messages so far
2025-02-26 19:40:44,841 - INFO - Received 2300 messages so far
2025-02-26 19:40:44,841 - INFO - Received 2400 messages so far
2025-02-26 19:40:44,841 - INFO - Received 2500 messages so far
2025-02-26 19:40:44,841 - INFO - Received 2600 messages so far
2025-02-26 19:40:44,841 - INFO - Received 2700 messages so far
2025-02-26 19:40:44,842 - INFO - Received 2800 messages so far
2025-02-26 19:40:44,842 - INFO - Received 2900 messages so far
2025-02-26 19:40:44,842 - INFO - Received 3000 messages so far
2025-02-26 19:40:44,842 - INFO - Received 3100 messages so far
2025-02-26 19:40:44,842 - INFO - Received 3200 messages so far
2025-02-26 19:40:44,843 - INFO - Received 3300 messages so far
2025-02-26 19:40:44,843 - INFO - Received 3400 messages so far
2025-02-26 19:40:44,843 - INFO - Received 3500 messages so far
2025-02-26 19:40:44,843 - INFO - Received 3600 messages so far
2025-02-26 19:40:44,843 - INFO - Received 3700 messages so far
2025-02-26 19:40:44,844 - INFO - Received 3800 messages so far
2025-02-26 19:40:44,844 - INFO - Received 3900 messages so far
2025-02-26 19:40:44,844 - INFO - Received 4000 messages so far
2025-02-26 19:40:44,844 - INFO - Received 4100 messages so far
2025-02-26 19:40:44,898 - INFO - Received 4200 messages so far
2025-02-26 19:40:44,898 - INFO - Received 4300 messages so far
2025-02-26 19:40:44,898 - INFO - Received 4400 messages so far
2025-02-26 19:40:44,898 - INFO - Received 4500 messages so far
2025-02-26 19:40:44,898 - INFO - Received 4600 messages so far
2025-02-26 19:40:44,899 - INFO - Received 4700 messages so far
2025-02-26 19:40:44,899 - INFO - Received 4800 messages so far
2025-02-26 19:40:44,899 - INFO - Received 4900 messages so far
2025-02-26 19:40:44,899 - INFO - Received 5000 messages so far
2025-02-26 19:40:44,899 - INFO - Received 5100 messages so far
2025-02-26 19:40:44,900 - INFO - Received 5200 messages so far
2025-02-26 19:40:44,900 - INFO - Received 5300 messages so far
2025-02-26 19:40:44,900 - INFO - Received 5400 messages so far
2025-02-26 19:40:44,900 - INFO - Received 5500 messages so far
2025-02-26 19:40:44,900 - INFO - Received 5600 messages so far
2025-02-26 19:40:44,901 - INFO - Received 5700 messages so far
2025-02-26 19:40:44,901 - INFO - Received 5800 messages so far
2025-02-26 19:40:44,901 - INFO - Received 5900 messages so far
2025-02-26 19:40:44,901 - INFO - Received 6000 messages so far
2025-02-26 19:40:44,901 - INFO - Received 6100 messages so far
2025-02-26 19:40:44,902 - INFO - Received 6200 messages so far
2025-02-26 19:40:44,902 - INFO - Received 6300 messages so far
2025-02-26 19:40:44,902 - INFO - Received 6400 messages so far
2025-02-26 19:40:44,902 - INFO - Received 6500 messages so far
2025-02-26 19:40:44,902 - INFO - Received 6600 messages so far
2025-02-26 19:40:44,902 - INFO - Received 6700 messages so far
2025-02-26 19:40:44,903 - INFO - Received 6800 messages so far
2025-02-26 19:40:44,903 - INFO - Received 6900 messages so far
2025-02-26 19:40:44,903 - INFO - Received 7000 messages so far
2025-02-26 19:40:44,903 - INFO - Received 7100 messages so far
2025-02-26 19:40:44,903 - INFO - Received 7200 messages so far
2025-02-26 19:40:44,904 - INFO - Received 7300 messages so far
2025-02-26 19:40:44,904 - INFO - Received 7400 messages so far
2025-02-26 19:40:44,904 - INFO - Received 7500 messages so far
2025-02-26 19:40:44,904 - INFO - Received 7600 messages so far
2025-02-26 19:40:44,904 - INFO - Received 7700 messages so far
2025-02-26 19:40:44,905 - INFO - Received 7800 messages so far
2025-02-26 19:40:44,905 - INFO - Received 7900 messages so far
2025-02-26 19:40:44,905 - INFO - Received 8000 messages so far
2025-02-26 19:40:44,905 - INFO - Received 8100 messages so far
2025-02-26 19:40:44,905 - INFO - Received 8200 messages so far
2025-02-26 19:40:44,906 - INFO - Received 8300 messages so far
2025-02-26 19:40:44,906 - INFO - Received 8400 messages so far
2025-02-26 19:40:44,906 - INFO - Received 8500 messages so far
2025-02-26 19:40:44,906 - INFO - Received 8600 messages so far
2025-02-26 19:40:44,907 - INFO - Received 8700 messages so far
2025-02-26 19:40:44,966 - INFO - Received 8800 messages so far
2025-02-26 19:40:44,966 - INFO - Received 8900 messages so far
2025-02-26 19:40:44,967 - INFO - Received 9000 messages so far
2025-02-26 19:40:44,967 - INFO - Received 9100 messages so far
2025-02-26 19:40:44,967 - INFO - Received 9200 messages so far
2025-02-26 19:40:44,967 - INFO - Received 9300 messages so far
2025-02-26 19:40:44,968 - INFO - Received 9400 messages so far
2025-02-26 19:40:44,968 - INFO - Received 9500 messages so far
2025-02-26 19:40:44,968 - INFO - Received 9600 messages so far
2025-02-26 19:40:44,968 - INFO - Received 9700 messages so far
2025-02-26 19:40:44,968 - INFO - Received 9800 messages so far
2025-02-26 19:40:44,968 - INFO - Received 9900 messages so far
2025-02-26 19:40:44,969 - INFO - Received 10000 messages so far
2025-02-26 19:40:44,969 - INFO - Total messages consumed: 10000
2025-02-26 19:40:45,058 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:45,062 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:45,062 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:45,062 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:45,062 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:45,069 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:45,072 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:45,072 - INFO - Number of columns: 66
2025-02-26 19:40:45,084 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9892        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8531     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  C1v3K13OcDArGIgL64    40596.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000483     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4541        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6618        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8616       53.0  192.168.1.3  192.168.1.1   udp        63.0       224.0  1.740120e+09      NaN  NaN     dns  C1vvIT3SGzXU0PPtIk    55421.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           91.0        1.0          252.0      17.0  0.019898     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:45,084 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:45,114 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:45,159 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    ca26477d8c98f7b3              ea26477d8c98f7b3  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:45,160 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.  5353.  1900.   443.   133.   123.    80.   138.
 21115.    67.   134.    22.   136. 21116.     0.   135.   547.]
2025-02-26 19:40:45,161 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:45,166 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:45,167 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:45,167 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:45,170 - INFO - DataFrame shape after NA dropping: (854, 23)
2025-02-26 19:40:45,170 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:45,170 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:45,170 - INFO - X shape: (854, 21), y shape: (854,)
2025-02-26 19:40:45,171 - INFO - Label distribution in training data: {'DNS': 710, 'HTTPS': 129, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:45,172 - INFO - Training model...
2025-02-26 19:40:45,285 - INFO - Predicting on test data...
2025-02-26 19:40:45,298 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 143.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.8,
    "f1-score": 0.8888888888888888,
    "support": 5.0
  },
  "HTTPS": {
    "precision": 0.9583333333333334,
    "recall": 1.0,
    "f1-score": 0.9787234042553191,
    "support": 23.0
  },
  "accuracy": 0.9941520467836257,
  "macro avg": {
    "precision": 0.9861111111111112,
    "recall": 0.9333333333333332,
    "f1-score": 0.9558707643814026,
    "support": 171.0
  },
  "weighted avg": {
    "precision": 0.9943957115009746,
    "recall": 0.9941520467836257,
    "f1-score": 0.9938893727620864,
    "support": 171.0
  }
}
2025-02-26 19:40:45,305 - INFO - Saved processed data locally to processed_data_20250226_194045.csv
2025-02-26 19:40:45,308 - INFO - JSON data size: 420186 bytes
2025-02-26 19:40:45,308 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:45,308 - INFO - Data sent successfully!
2025-02-26 19:40:45,308 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:45,309 - INFO - Starting data processing
2025-02-26 19:40:45,309 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:45,310 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:45,310 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:45,310 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:45,413 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:45,413 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:45,413 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:45,413 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:45,413 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:45,414 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:45,414 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:45,414 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:45,415 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:45,604 - INFO - Received 100 messages so far
2025-02-26 19:40:45,604 - INFO - Received 200 messages so far
2025-02-26 19:40:45,604 - INFO - Received 300 messages so far
2025-02-26 19:40:45,604 - INFO - Received 400 messages so far
2025-02-26 19:40:45,604 - INFO - Received 500 messages so far
2025-02-26 19:40:45,605 - INFO - Received 600 messages so far
2025-02-26 19:40:45,605 - INFO - Received 700 messages so far
2025-02-26 19:40:45,605 - INFO - Received 800 messages so far
2025-02-26 19:40:45,605 - INFO - Received 900 messages so far
2025-02-26 19:40:45,605 - INFO - Received 1000 messages so far
2025-02-26 19:40:45,606 - INFO - Received 1100 messages so far
2025-02-26 19:40:45,606 - INFO - Received 1200 messages so far
2025-02-26 19:40:45,606 - INFO - Received 1300 messages so far
2025-02-26 19:40:45,606 - INFO - Received 1400 messages so far
2025-02-26 19:40:45,606 - INFO - Received 1500 messages so far
2025-02-26 19:40:45,607 - INFO - Received 1600 messages so far
2025-02-26 19:40:45,607 - INFO - Received 1700 messages so far
2025-02-26 19:40:45,607 - INFO - Received 1800 messages so far
2025-02-26 19:40:45,607 - INFO - Received 1900 messages so far
2025-02-26 19:40:45,607 - INFO - Received 2000 messages so far
2025-02-26 19:40:45,608 - INFO - Received 2100 messages so far
2025-02-26 19:40:45,608 - INFO - Received 2200 messages so far
2025-02-26 19:40:45,608 - INFO - Received 2300 messages so far
2025-02-26 19:40:45,608 - INFO - Received 2400 messages so far
2025-02-26 19:40:45,608 - INFO - Received 2500 messages so far
2025-02-26 19:40:45,609 - INFO - Received 2600 messages so far
2025-02-26 19:40:45,609 - INFO - Received 2700 messages so far
2025-02-26 19:40:45,609 - INFO - Received 2800 messages so far
2025-02-26 19:40:45,609 - INFO - Received 2900 messages so far
2025-02-26 19:40:45,609 - INFO - Received 3000 messages so far
2025-02-26 19:40:45,610 - INFO - Received 3100 messages so far
2025-02-26 19:40:45,610 - INFO - Received 3200 messages so far
2025-02-26 19:40:45,610 - INFO - Received 3300 messages so far
2025-02-26 19:40:45,610 - INFO - Received 3400 messages so far
2025-02-26 19:40:45,610 - INFO - Received 3500 messages so far
2025-02-26 19:40:45,611 - INFO - Received 3600 messages so far
2025-02-26 19:40:45,611 - INFO - Received 3700 messages so far
2025-02-26 19:40:45,611 - INFO - Received 3800 messages so far
2025-02-26 19:40:45,611 - INFO - Received 3900 messages so far
2025-02-26 19:40:45,611 - INFO - Received 4000 messages so far
2025-02-26 19:40:45,612 - INFO - Received 4100 messages so far
2025-02-26 19:40:45,666 - INFO - Received 4200 messages so far
2025-02-26 19:40:45,666 - INFO - Received 4300 messages so far
2025-02-26 19:40:45,666 - INFO - Received 4400 messages so far
2025-02-26 19:40:45,666 - INFO - Received 4500 messages so far
2025-02-26 19:40:45,667 - INFO - Received 4600 messages so far
2025-02-26 19:40:45,667 - INFO - Received 4700 messages so far
2025-02-26 19:40:45,667 - INFO - Received 4800 messages so far
2025-02-26 19:40:45,667 - INFO - Received 4900 messages so far
2025-02-26 19:40:45,667 - INFO - Received 5000 messages so far
2025-02-26 19:40:45,668 - INFO - Received 5100 messages so far
2025-02-26 19:40:45,668 - INFO - Received 5200 messages so far
2025-02-26 19:40:45,668 - INFO - Received 5300 messages so far
2025-02-26 19:40:45,668 - INFO - Received 5400 messages so far
2025-02-26 19:40:45,668 - INFO - Received 5500 messages so far
2025-02-26 19:40:45,669 - INFO - Received 5600 messages so far
2025-02-26 19:40:45,669 - INFO - Received 5700 messages so far
2025-02-26 19:40:45,669 - INFO - Received 5800 messages so far
2025-02-26 19:40:45,669 - INFO - Received 5900 messages so far
2025-02-26 19:40:45,669 - INFO - Received 6000 messages so far
2025-02-26 19:40:45,670 - INFO - Received 6100 messages so far
2025-02-26 19:40:45,670 - INFO - Received 6200 messages so far
2025-02-26 19:40:45,670 - INFO - Received 6300 messages so far
2025-02-26 19:40:45,670 - INFO - Received 6400 messages so far
2025-02-26 19:40:45,670 - INFO - Received 6500 messages so far
2025-02-26 19:40:45,671 - INFO - Received 6600 messages so far
2025-02-26 19:40:45,671 - INFO - Received 6700 messages so far
2025-02-26 19:40:45,671 - INFO - Received 6800 messages so far
2025-02-26 19:40:45,671 - INFO - Received 6900 messages so far
2025-02-26 19:40:45,671 - INFO - Received 7000 messages so far
2025-02-26 19:40:45,672 - INFO - Received 7100 messages so far
2025-02-26 19:40:45,672 - INFO - Received 7200 messages so far
2025-02-26 19:40:45,672 - INFO - Received 7300 messages so far
2025-02-26 19:40:45,672 - INFO - Received 7400 messages so far
2025-02-26 19:40:45,672 - INFO - Received 7500 messages so far
2025-02-26 19:40:45,673 - INFO - Received 7600 messages so far
2025-02-26 19:40:45,673 - INFO - Received 7700 messages so far
2025-02-26 19:40:45,673 - INFO - Received 7800 messages so far
2025-02-26 19:40:45,673 - INFO - Received 7900 messages so far
2025-02-26 19:40:45,673 - INFO - Received 8000 messages so far
2025-02-26 19:40:45,674 - INFO - Received 8100 messages so far
2025-02-26 19:40:45,674 - INFO - Received 8200 messages so far
2025-02-26 19:40:45,674 - INFO - Received 8300 messages so far
2025-02-26 19:40:45,674 - INFO - Received 8400 messages so far
2025-02-26 19:40:45,674 - INFO - Received 8500 messages so far
2025-02-26 19:40:45,674 - INFO - Received 8600 messages so far
2025-02-26 19:40:45,675 - INFO - Received 8700 messages so far
2025-02-26 19:40:45,732 - INFO - Received 8800 messages so far
2025-02-26 19:40:45,732 - INFO - Received 8900 messages so far
2025-02-26 19:40:45,732 - INFO - Received 9000 messages so far
2025-02-26 19:40:45,732 - INFO - Received 9100 messages so far
2025-02-26 19:40:45,733 - INFO - Received 9200 messages so far
2025-02-26 19:40:45,733 - INFO - Received 9300 messages so far
2025-02-26 19:40:45,733 - INFO - Received 9400 messages so far
2025-02-26 19:40:45,733 - INFO - Received 9500 messages so far
2025-02-26 19:40:45,733 - INFO - Received 9600 messages so far
2025-02-26 19:40:45,734 - INFO - Received 9700 messages so far
2025-02-26 19:40:45,734 - INFO - Received 9800 messages so far
2025-02-26 19:40:45,734 - INFO - Received 9900 messages so far
2025-02-26 19:40:45,734 - INFO - Received 10000 messages so far
2025-02-26 19:40:45,734 - INFO - Total messages consumed: 10000
2025-02-26 19:40:45,821 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:45,824 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:45,825 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:45,825 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:45,825 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:45,832 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:45,835 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:45,835 - INFO - Number of columns: 66
2025-02-26 19:40:45,846 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
8071        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2679        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5242        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
742         NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7858       53.0  192.168.1.3  192.168.1.1   udp        62.0       396.0  1.740120e+09      NaN  NaN     dns  CMd1mj497ZDzzelmQ4    35393.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           90.0        1.0          424.0      17.0  0.002389     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:45,847 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:45,877 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:45,922 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    fb5090d671c8a979              fb5090d671c8a979  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:45,923 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443.    67.  5353.   138.    80.   136.  1900.
   135.   123.   547.   134.   133.     0.    22. 21116. 21115.]
2025-02-26 19:40:45,924 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:45,929 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:45,930 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:45,930 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:45,932 - INFO - DataFrame shape after NA dropping: (908, 23)
2025-02-26 19:40:45,933 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:45,933 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:45,933 - INFO - X shape: (908, 21), y shape: (908,)
2025-02-26 19:40:45,933 - INFO - Label distribution in training data: {'DNS': 759, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:45,934 - INFO - Training model...
2025-02-26 19:40:46,048 - INFO - Predicting on test data...
2025-02-26 19:40:46,062 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 156.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.3333333333333333,
    "f1-score": 0.5,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.92,
    "recall": 1.0,
    "f1-score": 0.9583333333333334,
    "support": 23.0
  },
  "accuracy": 0.989010989010989,
  "macro avg": {
    "precision": 0.9733333333333333,
    "recall": 0.7777777777777777,
    "f1-score": 0.8194444444444445,
    "support": 182.0
  },
  "weighted avg": {
    "precision": 0.9898901098901098,
    "recall": 0.989010989010989,
    "f1-score": 0.9864926739926739,
    "support": 182.0
  }
}
2025-02-26 19:40:46,070 - INFO - Saved processed data locally to processed_data_20250226_194046.csv
2025-02-26 19:40:46,072 - INFO - JSON data size: 448475 bytes
2025-02-26 19:40:46,072 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:46,073 - INFO - Data sent successfully!
2025-02-26 19:40:46,073 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:46,074 - INFO - Starting data processing
2025-02-26 19:40:46,074 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:46,074 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:46,075 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:46,075 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:46,177 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:46,177 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:46,178 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:46,178 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:46,178 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:46,179 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:46,179 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:46,179 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:46,179 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:46,333 - INFO - Received 100 messages so far
2025-02-26 19:40:46,333 - INFO - Received 200 messages so far
2025-02-26 19:40:46,333 - INFO - Received 300 messages so far
2025-02-26 19:40:46,333 - INFO - Received 400 messages so far
2025-02-26 19:40:46,333 - INFO - Received 500 messages so far
2025-02-26 19:40:46,334 - INFO - Received 600 messages so far
2025-02-26 19:40:46,334 - INFO - Received 700 messages so far
2025-02-26 19:40:46,334 - INFO - Received 800 messages so far
2025-02-26 19:40:46,334 - INFO - Received 900 messages so far
2025-02-26 19:40:46,334 - INFO - Received 1000 messages so far
2025-02-26 19:40:46,335 - INFO - Received 1100 messages so far
2025-02-26 19:40:46,335 - INFO - Received 1200 messages so far
2025-02-26 19:40:46,335 - INFO - Received 1300 messages so far
2025-02-26 19:40:46,335 - INFO - Received 1400 messages so far
2025-02-26 19:40:46,335 - INFO - Received 1500 messages so far
2025-02-26 19:40:46,336 - INFO - Received 1600 messages so far
2025-02-26 19:40:46,336 - INFO - Received 1700 messages so far
2025-02-26 19:40:46,336 - INFO - Received 1800 messages so far
2025-02-26 19:40:46,336 - INFO - Received 1900 messages so far
2025-02-26 19:40:46,336 - INFO - Received 2000 messages so far
2025-02-26 19:40:46,337 - INFO - Received 2100 messages so far
2025-02-26 19:40:46,337 - INFO - Received 2200 messages so far
2025-02-26 19:40:46,337 - INFO - Received 2300 messages so far
2025-02-26 19:40:46,337 - INFO - Received 2400 messages so far
2025-02-26 19:40:46,337 - INFO - Received 2500 messages so far
2025-02-26 19:40:46,338 - INFO - Received 2600 messages so far
2025-02-26 19:40:46,338 - INFO - Received 2700 messages so far
2025-02-26 19:40:46,338 - INFO - Received 2800 messages so far
2025-02-26 19:40:46,338 - INFO - Received 2900 messages so far
2025-02-26 19:40:46,338 - INFO - Received 3000 messages so far
2025-02-26 19:40:46,339 - INFO - Received 3100 messages so far
2025-02-26 19:40:46,339 - INFO - Received 3200 messages so far
2025-02-26 19:40:46,339 - INFO - Received 3300 messages so far
2025-02-26 19:40:46,339 - INFO - Received 3400 messages so far
2025-02-26 19:40:46,339 - INFO - Received 3500 messages so far
2025-02-26 19:40:46,340 - INFO - Received 3600 messages so far
2025-02-26 19:40:46,340 - INFO - Received 3700 messages so far
2025-02-26 19:40:46,340 - INFO - Received 3800 messages so far
2025-02-26 19:40:46,340 - INFO - Received 3900 messages so far
2025-02-26 19:40:46,340 - INFO - Received 4000 messages so far
2025-02-26 19:40:46,341 - INFO - Received 4100 messages so far
2025-02-26 19:40:46,435 - INFO - Received 4200 messages so far
2025-02-26 19:40:46,435 - INFO - Received 4300 messages so far
2025-02-26 19:40:46,435 - INFO - Received 4400 messages so far
2025-02-26 19:40:46,435 - INFO - Received 4500 messages so far
2025-02-26 19:40:46,435 - INFO - Received 4600 messages so far
2025-02-26 19:40:46,436 - INFO - Received 4700 messages so far
2025-02-26 19:40:46,436 - INFO - Received 4800 messages so far
2025-02-26 19:40:46,436 - INFO - Received 4900 messages so far
2025-02-26 19:40:46,436 - INFO - Received 5000 messages so far
2025-02-26 19:40:46,436 - INFO - Received 5100 messages so far
2025-02-26 19:40:46,437 - INFO - Received 5200 messages so far
2025-02-26 19:40:46,437 - INFO - Received 5300 messages so far
2025-02-26 19:40:46,437 - INFO - Received 5400 messages so far
2025-02-26 19:40:46,437 - INFO - Received 5500 messages so far
2025-02-26 19:40:46,437 - INFO - Received 5600 messages so far
2025-02-26 19:40:46,438 - INFO - Received 5700 messages so far
2025-02-26 19:40:46,438 - INFO - Received 5800 messages so far
2025-02-26 19:40:46,438 - INFO - Received 5900 messages so far
2025-02-26 19:40:46,438 - INFO - Received 6000 messages so far
2025-02-26 19:40:46,438 - INFO - Received 6100 messages so far
2025-02-26 19:40:46,439 - INFO - Received 6200 messages so far
2025-02-26 19:40:46,439 - INFO - Received 6300 messages so far
2025-02-26 19:40:46,439 - INFO - Received 6400 messages so far
2025-02-26 19:40:46,439 - INFO - Received 6500 messages so far
2025-02-26 19:40:46,439 - INFO - Received 6600 messages so far
2025-02-26 19:40:46,440 - INFO - Received 6700 messages so far
2025-02-26 19:40:46,440 - INFO - Received 6800 messages so far
2025-02-26 19:40:46,440 - INFO - Received 6900 messages so far
2025-02-26 19:40:46,440 - INFO - Received 7000 messages so far
2025-02-26 19:40:46,440 - INFO - Received 7100 messages so far
2025-02-26 19:40:46,441 - INFO - Received 7200 messages so far
2025-02-26 19:40:46,441 - INFO - Received 7300 messages so far
2025-02-26 19:40:46,441 - INFO - Received 7400 messages so far
2025-02-26 19:40:46,441 - INFO - Received 7500 messages so far
2025-02-26 19:40:46,441 - INFO - Received 7600 messages so far
2025-02-26 19:40:46,442 - INFO - Received 7700 messages so far
2025-02-26 19:40:46,442 - INFO - Received 7800 messages so far
2025-02-26 19:40:46,442 - INFO - Received 7900 messages so far
2025-02-26 19:40:46,442 - INFO - Received 8000 messages so far
2025-02-26 19:40:46,442 - INFO - Received 8100 messages so far
2025-02-26 19:40:46,443 - INFO - Received 8200 messages so far
2025-02-26 19:40:46,443 - INFO - Received 8300 messages so far
2025-02-26 19:40:46,443 - INFO - Received 8400 messages so far
2025-02-26 19:40:46,443 - INFO - Received 8500 messages so far
2025-02-26 19:40:46,443 - INFO - Received 8600 messages so far
2025-02-26 19:40:46,444 - INFO - Received 8700 messages so far
2025-02-26 19:40:46,500 - INFO - Received 8800 messages so far
2025-02-26 19:40:46,500 - INFO - Received 8900 messages so far
2025-02-26 19:40:46,500 - INFO - Received 9000 messages so far
2025-02-26 19:40:46,501 - INFO - Received 9100 messages so far
2025-02-26 19:40:46,501 - INFO - Received 9200 messages so far
2025-02-26 19:40:46,501 - INFO - Received 9300 messages so far
2025-02-26 19:40:46,501 - INFO - Received 9400 messages so far
2025-02-26 19:40:46,501 - INFO - Received 9500 messages so far
2025-02-26 19:40:46,502 - INFO - Received 9600 messages so far
2025-02-26 19:40:46,502 - INFO - Received 9700 messages so far
2025-02-26 19:40:46,502 - INFO - Received 9800 messages so far
2025-02-26 19:40:46,502 - INFO - Received 9900 messages so far
2025-02-26 19:40:46,502 - INFO - Received 10000 messages so far
2025-02-26 19:40:46,502 - INFO - Total messages consumed: 10000
2025-02-26 19:40:46,591 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:46,594 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:46,594 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:46,594 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:46,595 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:46,602 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:46,605 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:46,605 - INFO - Number of columns: 66
2025-02-26 19:40:46,617 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                   query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                                                                                                                                                                                                                                                                          answers                                                  TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
5028       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740119e+09      NaN  NaN     NaN  CVNaEV1ueHhTBKytPf    60578.0  0.001615  iup0-my.sharepoint.com     1.0  C_INTERNET    1.0          A    0.0    NOERROR  False  False  True  True  0.0  [iup0.sharepoint.com, 5711-ipv4v6e.clump.dprodmgd105.aa-rt.sharepoint.com, 193491-ipv4v6e.farm.dprodmgd105.aa-rt.sharepoint.com, 193491-ipv4v6e.farm.dprodmgd105.sharepointonline.com.akadns.net, 193491-ipv4v6.farm.dprodmgd105.aa-rt.sharepoint.com.dual-spo-0005.spo-msedge.net, dual-spo-0005.spo-msedge.net, 13.107.136.10, 13.107.138.10]  [116.0, 3052.0, 37.0, 52.0, 31.0, 144.0, 39.0, 39.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7323       53.0  192.168.1.3  192.168.1.1   udp        52.0       112.0  1.740119e+09      NaN  NaN     dns  C5hhbv4wtX5Lu8lMFd    40199.0       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                   NaN      NaN         SF       True       True           0.0      Dd        1.0           80.0        1.0          140.0      17.0  0.001239     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3801        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                   NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8664        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                   NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005082     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2516        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                   NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:46,617 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:46,648 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:46,693 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    6b77933b392d05f9              eb77933b392d05f9  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:46,693 - INFO - Unique values in 'id.resp_p' before labeling: [   53.    nan  9092.  5353.   443.   123.  1900.   134.   136.    80.
   138.   133.     0.    67. 21116.    22. 21115.   547.   135.]
2025-02-26 19:40:46,694 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:46,699 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:46,701 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:46,701 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:46,703 - INFO - DataFrame shape after NA dropping: (885, 23)
2025-02-26 19:40:46,703 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:46,703 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:46,704 - INFO - X shape: (885, 21), y shape: (885,)
2025-02-26 19:40:46,704 - INFO - Label distribution in training data: {'DNS': 739, 'HTTPS': 131, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:46,705 - INFO - Training model...
2025-02-26 19:40:46,819 - INFO - Predicting on test data...
2025-02-26 19:40:46,833 - INFO - Classification report:
{
  "DNS": {
    "precision": 0.9932432432432432,
    "recall": 1.0,
    "f1-score": 0.9966101694915255,
    "support": 147.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 25.0
  },
  "SSH": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "accuracy": 0.9943502824858758,
  "macro avg": {
    "precision": 0.7483108108108107,
    "recall": 0.75,
    "f1-score": 0.7491525423728813,
    "support": 177.0
  },
  "weighted avg": {
    "precision": 0.9887387387387386,
    "recall": 0.9943502824858758,
    "f1-score": 0.9915349995212104,
    "support": 177.0
  }
}
2025-02-26 19:40:46,840 - INFO - Saved processed data locally to processed_data_20250226_194046.csv
2025-02-26 19:40:46,842 - INFO - JSON data size: 433754 bytes
2025-02-26 19:40:46,843 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:46,843 - INFO - Data sent successfully!
2025-02-26 19:40:46,843 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:46,844 - INFO - Starting data processing
2025-02-26 19:40:46,844 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:46,844 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:46,845 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:46,846 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:46,947 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:46,948 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:46,948 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:46,948 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:46,948 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:46,949 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:46,949 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:46,949 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:46,950 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:47,103 - INFO - Received 100 messages so far
2025-02-26 19:40:47,103 - INFO - Received 200 messages so far
2025-02-26 19:40:47,103 - INFO - Received 300 messages so far
2025-02-26 19:40:47,103 - INFO - Received 400 messages so far
2025-02-26 19:40:47,104 - INFO - Received 500 messages so far
2025-02-26 19:40:47,104 - INFO - Received 600 messages so far
2025-02-26 19:40:47,104 - INFO - Received 700 messages so far
2025-02-26 19:40:47,104 - INFO - Received 800 messages so far
2025-02-26 19:40:47,104 - INFO - Received 900 messages so far
2025-02-26 19:40:47,105 - INFO - Received 1000 messages so far
2025-02-26 19:40:47,105 - INFO - Received 1100 messages so far
2025-02-26 19:40:47,105 - INFO - Received 1200 messages so far
2025-02-26 19:40:47,105 - INFO - Received 1300 messages so far
2025-02-26 19:40:47,105 - INFO - Received 1400 messages so far
2025-02-26 19:40:47,106 - INFO - Received 1500 messages so far
2025-02-26 19:40:47,106 - INFO - Received 1600 messages so far
2025-02-26 19:40:47,106 - INFO - Received 1700 messages so far
2025-02-26 19:40:47,106 - INFO - Received 1800 messages so far
2025-02-26 19:40:47,106 - INFO - Received 1900 messages so far
2025-02-26 19:40:47,107 - INFO - Received 2000 messages so far
2025-02-26 19:40:47,107 - INFO - Received 2100 messages so far
2025-02-26 19:40:47,107 - INFO - Received 2200 messages so far
2025-02-26 19:40:47,107 - INFO - Received 2300 messages so far
2025-02-26 19:40:47,107 - INFO - Received 2400 messages so far
2025-02-26 19:40:47,108 - INFO - Received 2500 messages so far
2025-02-26 19:40:47,108 - INFO - Received 2600 messages so far
2025-02-26 19:40:47,108 - INFO - Received 2700 messages so far
2025-02-26 19:40:47,108 - INFO - Received 2800 messages so far
2025-02-26 19:40:47,108 - INFO - Received 2900 messages so far
2025-02-26 19:40:47,108 - INFO - Received 3000 messages so far
2025-02-26 19:40:47,109 - INFO - Received 3100 messages so far
2025-02-26 19:40:47,109 - INFO - Received 3200 messages so far
2025-02-26 19:40:47,109 - INFO - Received 3300 messages so far
2025-02-26 19:40:47,109 - INFO - Received 3400 messages so far
2025-02-26 19:40:47,109 - INFO - Received 3500 messages so far
2025-02-26 19:40:47,110 - INFO - Received 3600 messages so far
2025-02-26 19:40:47,110 - INFO - Received 3700 messages so far
2025-02-26 19:40:47,110 - INFO - Received 3800 messages so far
2025-02-26 19:40:47,110 - INFO - Received 3900 messages so far
2025-02-26 19:40:47,110 - INFO - Received 4000 messages so far
2025-02-26 19:40:47,111 - INFO - Received 4100 messages so far
2025-02-26 19:40:47,166 - INFO - Received 4200 messages so far
2025-02-26 19:40:47,166 - INFO - Received 4300 messages so far
2025-02-26 19:40:47,166 - INFO - Received 4400 messages so far
2025-02-26 19:40:47,166 - INFO - Received 4500 messages so far
2025-02-26 19:40:47,166 - INFO - Received 4600 messages so far
2025-02-26 19:40:47,167 - INFO - Received 4700 messages so far
2025-02-26 19:40:47,167 - INFO - Received 4800 messages so far
2025-02-26 19:40:47,167 - INFO - Received 4900 messages so far
2025-02-26 19:40:47,167 - INFO - Received 5000 messages so far
2025-02-26 19:40:47,168 - INFO - Received 5100 messages so far
2025-02-26 19:40:47,168 - INFO - Received 5200 messages so far
2025-02-26 19:40:47,168 - INFO - Received 5300 messages so far
2025-02-26 19:40:47,168 - INFO - Received 5400 messages so far
2025-02-26 19:40:47,168 - INFO - Received 5500 messages so far
2025-02-26 19:40:47,169 - INFO - Received 5600 messages so far
2025-02-26 19:40:47,169 - INFO - Received 5700 messages so far
2025-02-26 19:40:47,169 - INFO - Received 5800 messages so far
2025-02-26 19:40:47,169 - INFO - Received 5900 messages so far
2025-02-26 19:40:47,169 - INFO - Received 6000 messages so far
2025-02-26 19:40:47,170 - INFO - Received 6100 messages so far
2025-02-26 19:40:47,170 - INFO - Received 6200 messages so far
2025-02-26 19:40:47,170 - INFO - Received 6300 messages so far
2025-02-26 19:40:47,170 - INFO - Received 6400 messages so far
2025-02-26 19:40:47,170 - INFO - Received 6500 messages so far
2025-02-26 19:40:47,171 - INFO - Received 6600 messages so far
2025-02-26 19:40:47,171 - INFO - Received 6700 messages so far
2025-02-26 19:40:47,171 - INFO - Received 6800 messages so far
2025-02-26 19:40:47,171 - INFO - Received 6900 messages so far
2025-02-26 19:40:47,171 - INFO - Received 7000 messages so far
2025-02-26 19:40:47,172 - INFO - Received 7100 messages so far
2025-02-26 19:40:47,172 - INFO - Received 7200 messages so far
2025-02-26 19:40:47,172 - INFO - Received 7300 messages so far
2025-02-26 19:40:47,172 - INFO - Received 7400 messages so far
2025-02-26 19:40:47,172 - INFO - Received 7500 messages so far
2025-02-26 19:40:47,173 - INFO - Received 7600 messages so far
2025-02-26 19:40:47,173 - INFO - Received 7700 messages so far
2025-02-26 19:40:47,173 - INFO - Received 7800 messages so far
2025-02-26 19:40:47,173 - INFO - Received 7900 messages so far
2025-02-26 19:40:47,173 - INFO - Received 8000 messages so far
2025-02-26 19:40:47,173 - INFO - Received 8100 messages so far
2025-02-26 19:40:47,174 - INFO - Received 8200 messages so far
2025-02-26 19:40:47,174 - INFO - Received 8300 messages so far
2025-02-26 19:40:47,174 - INFO - Received 8400 messages so far
2025-02-26 19:40:47,174 - INFO - Received 8500 messages so far
2025-02-26 19:40:47,174 - INFO - Received 8600 messages so far
2025-02-26 19:40:47,175 - INFO - Received 8700 messages so far
2025-02-26 19:40:47,284 - INFO - Received 8800 messages so far
2025-02-26 19:40:47,285 - INFO - Received 8900 messages so far
2025-02-26 19:40:47,285 - INFO - Received 9000 messages so far
2025-02-26 19:40:47,285 - INFO - Received 9100 messages so far
2025-02-26 19:40:47,285 - INFO - Received 9200 messages so far
2025-02-26 19:40:47,285 - INFO - Received 9300 messages so far
2025-02-26 19:40:47,286 - INFO - Received 9400 messages so far
2025-02-26 19:40:47,286 - INFO - Received 9500 messages so far
2025-02-26 19:40:47,286 - INFO - Received 9600 messages so far
2025-02-26 19:40:47,286 - INFO - Received 9700 messages so far
2025-02-26 19:40:47,286 - INFO - Received 9800 messages so far
2025-02-26 19:40:47,287 - INFO - Received 9900 messages so far
2025-02-26 19:40:47,287 - INFO - Received 10000 messages so far
2025-02-26 19:40:47,287 - INFO - Total messages consumed: 10000
2025-02-26 19:40:47,376 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:47,380 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:47,380 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:47,380 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:47,380 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:47,388 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:47,391 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:47,391 - INFO - Number of columns: 66
2025-02-26 19:40:47,402 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7698        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
873         NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3480        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
509         NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5274       53.0  192.168.1.3  192.168.1.1   udp        74.0       145.0  1.740119e+09      NaN  NaN     dns  Cq2eutQXtXCUPTGpe    52405.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0          102.0        1.0          173.0      17.0  0.001177     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:47,402 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:47,434 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:47,479 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    c456d0cc73137d45              e456d0cc73137d45  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:47,480 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.   443.  1900.   136.   133. 21116.   134.
   135.   123.    80.   138.    22. 21115.     0.   547.    67.]
2025-02-26 19:40:47,481 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:47,486 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:47,487 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:47,488 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:47,490 - INFO - DataFrame shape after NA dropping: (878, 23)
2025-02-26 19:40:47,490 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:47,490 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:47,490 - INFO - X shape: (878, 21), y shape: (878,)
2025-02-26 19:40:47,491 - INFO - Label distribution in training data: {'DNS': 733, 'HTTPS': 130, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:47,492 - INFO - Training model...
2025-02-26 19:40:47,607 - INFO - Predicting on test data...
2025-02-26 19:40:47,621 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 151.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 24.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 176.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 176.0
  }
}
2025-02-26 19:40:47,628 - INFO - Saved processed data locally to processed_data_20250226_194047.csv
2025-02-26 19:40:47,630 - INFO - JSON data size: 434080 bytes
2025-02-26 19:40:47,631 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:47,631 - INFO - Data sent successfully!
2025-02-26 19:40:47,631 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:47,632 - INFO - Starting data processing
2025-02-26 19:40:47,632 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:47,632 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:47,633 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:47,633 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:47,735 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:47,735 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:47,736 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:47,736 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:47,736 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:47,737 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:47,737 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:47,737 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:47,737 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:47,892 - INFO - Received 100 messages so far
2025-02-26 19:40:47,892 - INFO - Received 200 messages so far
2025-02-26 19:40:47,892 - INFO - Received 300 messages so far
2025-02-26 19:40:47,892 - INFO - Received 400 messages so far
2025-02-26 19:40:47,892 - INFO - Received 500 messages so far
2025-02-26 19:40:47,893 - INFO - Received 600 messages so far
2025-02-26 19:40:47,893 - INFO - Received 700 messages so far
2025-02-26 19:40:47,893 - INFO - Received 800 messages so far
2025-02-26 19:40:47,893 - INFO - Received 900 messages so far
2025-02-26 19:40:47,893 - INFO - Received 1000 messages so far
2025-02-26 19:40:47,894 - INFO - Received 1100 messages so far
2025-02-26 19:40:47,894 - INFO - Received 1200 messages so far
2025-02-26 19:40:47,894 - INFO - Received 1300 messages so far
2025-02-26 19:40:47,894 - INFO - Received 1400 messages so far
2025-02-26 19:40:47,894 - INFO - Received 1500 messages so far
2025-02-26 19:40:47,894 - INFO - Received 1600 messages so far
2025-02-26 19:40:47,895 - INFO - Received 1700 messages so far
2025-02-26 19:40:47,895 - INFO - Received 1800 messages so far
2025-02-26 19:40:47,895 - INFO - Received 1900 messages so far
2025-02-26 19:40:47,895 - INFO - Received 2000 messages so far
2025-02-26 19:40:47,895 - INFO - Received 2100 messages so far
2025-02-26 19:40:47,896 - INFO - Received 2200 messages so far
2025-02-26 19:40:47,896 - INFO - Received 2300 messages so far
2025-02-26 19:40:47,896 - INFO - Received 2400 messages so far
2025-02-26 19:40:47,896 - INFO - Received 2500 messages so far
2025-02-26 19:40:47,896 - INFO - Received 2600 messages so far
2025-02-26 19:40:47,897 - INFO - Received 2700 messages so far
2025-02-26 19:40:47,897 - INFO - Received 2800 messages so far
2025-02-26 19:40:47,897 - INFO - Received 2900 messages so far
2025-02-26 19:40:47,897 - INFO - Received 3000 messages so far
2025-02-26 19:40:47,897 - INFO - Received 3100 messages so far
2025-02-26 19:40:47,898 - INFO - Received 3200 messages so far
2025-02-26 19:40:47,898 - INFO - Received 3300 messages so far
2025-02-26 19:40:47,898 - INFO - Received 3400 messages so far
2025-02-26 19:40:47,898 - INFO - Received 3500 messages so far
2025-02-26 19:40:47,898 - INFO - Received 3600 messages so far
2025-02-26 19:40:47,899 - INFO - Received 3700 messages so far
2025-02-26 19:40:47,899 - INFO - Received 3800 messages so far
2025-02-26 19:40:47,899 - INFO - Received 3900 messages so far
2025-02-26 19:40:47,899 - INFO - Received 4000 messages so far
2025-02-26 19:40:47,899 - INFO - Received 4100 messages so far
2025-02-26 19:40:47,953 - INFO - Received 4200 messages so far
2025-02-26 19:40:47,954 - INFO - Received 4300 messages so far
2025-02-26 19:40:47,954 - INFO - Received 4400 messages so far
2025-02-26 19:40:47,954 - INFO - Received 4500 messages so far
2025-02-26 19:40:47,954 - INFO - Received 4600 messages so far
2025-02-26 19:40:47,954 - INFO - Received 4700 messages so far
2025-02-26 19:40:47,955 - INFO - Received 4800 messages so far
2025-02-26 19:40:47,955 - INFO - Received 4900 messages so far
2025-02-26 19:40:47,955 - INFO - Received 5000 messages so far
2025-02-26 19:40:47,955 - INFO - Received 5100 messages so far
2025-02-26 19:40:47,955 - INFO - Received 5200 messages so far
2025-02-26 19:40:47,956 - INFO - Received 5300 messages so far
2025-02-26 19:40:47,956 - INFO - Received 5400 messages so far
2025-02-26 19:40:47,956 - INFO - Received 5500 messages so far
2025-02-26 19:40:47,956 - INFO - Received 5600 messages so far
2025-02-26 19:40:47,956 - INFO - Received 5700 messages so far
2025-02-26 19:40:47,957 - INFO - Received 5800 messages so far
2025-02-26 19:40:47,957 - INFO - Received 5900 messages so far
2025-02-26 19:40:47,957 - INFO - Received 6000 messages so far
2025-02-26 19:40:47,957 - INFO - Received 6100 messages so far
2025-02-26 19:40:47,957 - INFO - Received 6200 messages so far
2025-02-26 19:40:47,958 - INFO - Received 6300 messages so far
2025-02-26 19:40:47,958 - INFO - Received 6400 messages so far
2025-02-26 19:40:47,958 - INFO - Received 6500 messages so far
2025-02-26 19:40:47,958 - INFO - Received 6600 messages so far
2025-02-26 19:40:47,958 - INFO - Received 6700 messages so far
2025-02-26 19:40:47,959 - INFO - Received 6800 messages so far
2025-02-26 19:40:47,959 - INFO - Received 6900 messages so far
2025-02-26 19:40:47,959 - INFO - Received 7000 messages so far
2025-02-26 19:40:47,959 - INFO - Received 7100 messages so far
2025-02-26 19:40:47,959 - INFO - Received 7200 messages so far
2025-02-26 19:40:47,960 - INFO - Received 7300 messages so far
2025-02-26 19:40:47,960 - INFO - Received 7400 messages so far
2025-02-26 19:40:47,960 - INFO - Received 7500 messages so far
2025-02-26 19:40:47,960 - INFO - Received 7600 messages so far
2025-02-26 19:40:47,960 - INFO - Received 7700 messages so far
2025-02-26 19:40:47,961 - INFO - Received 7800 messages so far
2025-02-26 19:40:47,961 - INFO - Received 7900 messages so far
2025-02-26 19:40:47,961 - INFO - Received 8000 messages so far
2025-02-26 19:40:47,961 - INFO - Received 8100 messages so far
2025-02-26 19:40:47,961 - INFO - Received 8200 messages so far
2025-02-26 19:40:47,962 - INFO - Received 8300 messages so far
2025-02-26 19:40:47,962 - INFO - Received 8400 messages so far
2025-02-26 19:40:47,962 - INFO - Received 8500 messages so far
2025-02-26 19:40:47,962 - INFO - Received 8600 messages so far
2025-02-26 19:40:47,963 - INFO - Received 8700 messages so far
2025-02-26 19:40:48,019 - INFO - Received 8800 messages so far
2025-02-26 19:40:48,020 - INFO - Received 8900 messages so far
2025-02-26 19:40:48,020 - INFO - Received 9000 messages so far
2025-02-26 19:40:48,020 - INFO - Received 9100 messages so far
2025-02-26 19:40:48,020 - INFO - Received 9200 messages so far
2025-02-26 19:40:48,020 - INFO - Received 9300 messages so far
2025-02-26 19:40:48,021 - INFO - Received 9400 messages so far
2025-02-26 19:40:48,021 - INFO - Received 9500 messages so far
2025-02-26 19:40:48,021 - INFO - Received 9600 messages so far
2025-02-26 19:40:48,021 - INFO - Received 9700 messages so far
2025-02-26 19:40:48,021 - INFO - Received 9800 messages so far
2025-02-26 19:40:48,022 - INFO - Received 9900 messages so far
2025-02-26 19:40:48,022 - INFO - Received 10000 messages so far
2025-02-26 19:40:48,022 - INFO - Total messages consumed: 10000
2025-02-26 19:40:48,111 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:48,115 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:48,115 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:48,115 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:48,115 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:48,122 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:48,126 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:48,126 - INFO - Number of columns: 66
2025-02-26 19:40:48,136 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9955        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.006159     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1498        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4797        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6808        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9479        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:48,136 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:48,167 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:48,213 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    1edec4bdcc72bfa6              2336755850007c23  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:48,213 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443.  1900.   123.    80.  5353.   547.   134.
   138.   133.   136.    67.   135.    22.     0. 21115. 21116.]
2025-02-26 19:40:48,214 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:48,219 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:48,221 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:48,221 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:48,223 - INFO - DataFrame shape after NA dropping: (844, 23)
2025-02-26 19:40:48,223 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:48,223 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:48,224 - INFO - X shape: (844, 21), y shape: (844,)
2025-02-26 19:40:48,224 - INFO - Label distribution in training data: {'DNS': 702, 'HTTPS': 129, 'HTTP': 12, 'SSH': 1}
2025-02-26 19:40:48,225 - INFO - Training model...
2025-02-26 19:40:48,336 - INFO - Predicting on test data...
2025-02-26 19:40:48,350 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 136.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.75,
    "f1-score": 0.8571428571428571,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 0.9666666666666667,
    "recall": 1.0,
    "f1-score": 0.9830508474576272,
    "support": 29.0
  },
  "accuracy": 0.9940828402366864,
  "macro avg": {
    "precision": 0.9888888888888889,
    "recall": 0.9166666666666666,
    "f1-score": 0.9467312348668281,
    "support": 169.0
  },
  "weighted avg": {
    "precision": 0.9942800788954635,
    "recall": 0.9940828402366864,
    "f1-score": 0.9937103313896013,
    "support": 169.0
  }
}
2025-02-26 19:40:48,356 - INFO - Saved processed data locally to processed_data_20250226_194048.csv
2025-02-26 19:40:48,359 - INFO - JSON data size: 415193 bytes
2025-02-26 19:40:48,359 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:48,359 - INFO - Data sent successfully!
2025-02-26 19:40:48,359 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:48,360 - INFO - Starting data processing
2025-02-26 19:40:48,360 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:48,360 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:48,361 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:48,361 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:48,463 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:48,463 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:48,464 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:48,464 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:48,464 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:48,465 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:48,465 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:48,465 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:48,465 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:48,659 - INFO - Received 100 messages so far
2025-02-26 19:40:48,659 - INFO - Received 200 messages so far
2025-02-26 19:40:48,659 - INFO - Received 300 messages so far
2025-02-26 19:40:48,659 - INFO - Received 400 messages so far
2025-02-26 19:40:48,660 - INFO - Received 500 messages so far
2025-02-26 19:40:48,660 - INFO - Received 600 messages so far
2025-02-26 19:40:48,660 - INFO - Received 700 messages so far
2025-02-26 19:40:48,660 - INFO - Received 800 messages so far
2025-02-26 19:40:48,660 - INFO - Received 900 messages so far
2025-02-26 19:40:48,661 - INFO - Received 1000 messages so far
2025-02-26 19:40:48,661 - INFO - Received 1100 messages so far
2025-02-26 19:40:48,661 - INFO - Received 1200 messages so far
2025-02-26 19:40:48,661 - INFO - Received 1300 messages so far
2025-02-26 19:40:48,661 - INFO - Received 1400 messages so far
2025-02-26 19:40:48,662 - INFO - Received 1500 messages so far
2025-02-26 19:40:48,662 - INFO - Received 1600 messages so far
2025-02-26 19:40:48,662 - INFO - Received 1700 messages so far
2025-02-26 19:40:48,662 - INFO - Received 1800 messages so far
2025-02-26 19:40:48,662 - INFO - Received 1900 messages so far
2025-02-26 19:40:48,663 - INFO - Received 2000 messages so far
2025-02-26 19:40:48,663 - INFO - Received 2100 messages so far
2025-02-26 19:40:48,663 - INFO - Received 2200 messages so far
2025-02-26 19:40:48,663 - INFO - Received 2300 messages so far
2025-02-26 19:40:48,663 - INFO - Received 2400 messages so far
2025-02-26 19:40:48,664 - INFO - Received 2500 messages so far
2025-02-26 19:40:48,664 - INFO - Received 2600 messages so far
2025-02-26 19:40:48,664 - INFO - Received 2700 messages so far
2025-02-26 19:40:48,664 - INFO - Received 2800 messages so far
2025-02-26 19:40:48,664 - INFO - Received 2900 messages so far
2025-02-26 19:40:48,665 - INFO - Received 3000 messages so far
2025-02-26 19:40:48,665 - INFO - Received 3100 messages so far
2025-02-26 19:40:48,665 - INFO - Received 3200 messages so far
2025-02-26 19:40:48,665 - INFO - Received 3300 messages so far
2025-02-26 19:40:48,665 - INFO - Received 3400 messages so far
2025-02-26 19:40:48,666 - INFO - Received 3500 messages so far
2025-02-26 19:40:48,666 - INFO - Received 3600 messages so far
2025-02-26 19:40:48,666 - INFO - Received 3700 messages so far
2025-02-26 19:40:48,666 - INFO - Received 3800 messages so far
2025-02-26 19:40:48,666 - INFO - Received 3900 messages so far
2025-02-26 19:40:48,666 - INFO - Received 4000 messages so far
2025-02-26 19:40:48,667 - INFO - Received 4100 messages so far
2025-02-26 19:40:48,722 - INFO - Received 4200 messages so far
2025-02-26 19:40:48,722 - INFO - Received 4300 messages so far
2025-02-26 19:40:48,722 - INFO - Received 4400 messages so far
2025-02-26 19:40:48,723 - INFO - Received 4500 messages so far
2025-02-26 19:40:48,723 - INFO - Received 4600 messages so far
2025-02-26 19:40:48,723 - INFO - Received 4700 messages so far
2025-02-26 19:40:48,723 - INFO - Received 4800 messages so far
2025-02-26 19:40:48,723 - INFO - Received 4900 messages so far
2025-02-26 19:40:48,724 - INFO - Received 5000 messages so far
2025-02-26 19:40:48,724 - INFO - Received 5100 messages so far
2025-02-26 19:40:48,724 - INFO - Received 5200 messages so far
2025-02-26 19:40:48,724 - INFO - Received 5300 messages so far
2025-02-26 19:40:48,724 - INFO - Received 5400 messages so far
2025-02-26 19:40:48,725 - INFO - Received 5500 messages so far
2025-02-26 19:40:48,725 - INFO - Received 5600 messages so far
2025-02-26 19:40:48,725 - INFO - Received 5700 messages so far
2025-02-26 19:40:48,725 - INFO - Received 5800 messages so far
2025-02-26 19:40:48,725 - INFO - Received 5900 messages so far
2025-02-26 19:40:48,726 - INFO - Received 6000 messages so far
2025-02-26 19:40:48,726 - INFO - Received 6100 messages so far
2025-02-26 19:40:48,726 - INFO - Received 6200 messages so far
2025-02-26 19:40:48,726 - INFO - Received 6300 messages so far
2025-02-26 19:40:48,726 - INFO - Received 6400 messages so far
2025-02-26 19:40:48,727 - INFO - Received 6500 messages so far
2025-02-26 19:40:48,727 - INFO - Received 6600 messages so far
2025-02-26 19:40:48,727 - INFO - Received 6700 messages so far
2025-02-26 19:40:48,727 - INFO - Received 6800 messages so far
2025-02-26 19:40:48,727 - INFO - Received 6900 messages so far
2025-02-26 19:40:48,727 - INFO - Received 7000 messages so far
2025-02-26 19:40:48,728 - INFO - Received 7100 messages so far
2025-02-26 19:40:48,728 - INFO - Received 7200 messages so far
2025-02-26 19:40:48,728 - INFO - Received 7300 messages so far
2025-02-26 19:40:48,728 - INFO - Received 7400 messages so far
2025-02-26 19:40:48,728 - INFO - Received 7500 messages so far
2025-02-26 19:40:48,729 - INFO - Received 7600 messages so far
2025-02-26 19:40:48,729 - INFO - Received 7700 messages so far
2025-02-26 19:40:48,729 - INFO - Received 7800 messages so far
2025-02-26 19:40:48,729 - INFO - Received 7900 messages so far
2025-02-26 19:40:48,729 - INFO - Received 8000 messages so far
2025-02-26 19:40:48,730 - INFO - Received 8100 messages so far
2025-02-26 19:40:48,730 - INFO - Received 8200 messages so far
2025-02-26 19:40:48,730 - INFO - Received 8300 messages so far
2025-02-26 19:40:48,731 - INFO - Received 8400 messages so far
2025-02-26 19:40:48,731 - INFO - Received 8500 messages so far
2025-02-26 19:40:48,731 - INFO - Received 8600 messages so far
2025-02-26 19:40:48,731 - INFO - Received 8700 messages so far
2025-02-26 19:40:48,787 - INFO - Received 8800 messages so far
2025-02-26 19:40:48,787 - INFO - Received 8900 messages so far
2025-02-26 19:40:48,788 - INFO - Received 9000 messages so far
2025-02-26 19:40:48,788 - INFO - Received 9100 messages so far
2025-02-26 19:40:48,788 - INFO - Received 9200 messages so far
2025-02-26 19:40:48,788 - INFO - Received 9300 messages so far
2025-02-26 19:40:48,788 - INFO - Received 9400 messages so far
2025-02-26 19:40:48,789 - INFO - Received 9500 messages so far
2025-02-26 19:40:48,789 - INFO - Received 9600 messages so far
2025-02-26 19:40:48,789 - INFO - Received 9700 messages so far
2025-02-26 19:40:48,789 - INFO - Received 9800 messages so far
2025-02-26 19:40:48,789 - INFO - Received 9900 messages so far
2025-02-26 19:40:48,789 - INFO - Received 10000 messages so far
2025-02-26 19:40:48,790 - INFO - Total messages consumed: 10000
2025-02-26 19:40:48,878 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:48,882 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:48,882 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:48,882 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:48,882 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:48,889 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:48,893 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:48,893 - INFO - Number of columns: 66
2025-02-26 19:40:48,904 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                               query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                 answers            TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
5057        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                     NaN             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9772        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                     NaN             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3901       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740119e+09      NaN  NaN     NaN  CKLcGu1NsjPDNAP2Di    36400.0  0.002237  word-telemetry.officeapps.live.com     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  True  0.0  [word-telemetry.wac.trafficmanager.net, pgtus3-word-telemetry-vip.officeapps.live.com]  [145.0, 145.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5962        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                     NaN             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3394        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                     NaN             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:48,904 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:48,935 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:48,980 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    5b67465ea3a9f950              20e4136c52007c23  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:48,981 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.   443.   123. 21116.   134.   138.  1900.
 21115.    80.   133.   547.   136.     0.    67.    22.   135.]
2025-02-26 19:40:48,982 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:48,987 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:48,989 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:48,989 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:48,991 - INFO - DataFrame shape after NA dropping: (890, 23)
2025-02-26 19:40:48,991 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:48,991 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:48,991 - INFO - X shape: (890, 21), y shape: (890,)
2025-02-26 19:40:48,992 - INFO - Label distribution in training data: {'DNS': 741, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:48,992 - INFO - Training model...
2025-02-26 19:40:49,108 - INFO - Predicting on test data...
2025-02-26 19:40:49,122 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 142.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.6,
    "f1-score": 0.75,
    "support": 5.0
  },
  "HTTPS": {
    "precision": 0.9393939393939394,
    "recall": 1.0,
    "f1-score": 0.96875,
    "support": 31.0
  },
  "accuracy": 0.9887640449438202,
  "macro avg": {
    "precision": 0.9797979797979798,
    "recall": 0.8666666666666667,
    "f1-score": 0.90625,
    "support": 178.0
  },
  "weighted avg": {
    "precision": 0.989445011916922,
    "recall": 0.9887640449438202,
    "f1-score": 0.9875351123595506,
    "support": 178.0
  }
}
2025-02-26 19:40:49,129 - INFO - Saved processed data locally to processed_data_20250226_194049.csv
2025-02-26 19:40:49,132 - INFO - JSON data size: 436050 bytes
2025-02-26 19:40:49,132 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:49,132 - INFO - Data sent successfully!
2025-02-26 19:40:49,132 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:49,133 - INFO - Starting data processing
2025-02-26 19:40:49,133 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:49,134 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:49,134 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:49,134 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:49,236 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:49,237 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:49,237 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:49,238 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:49,238 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:49,239 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:49,239 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:49,239 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:49,239 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:49,393 - INFO - Received 100 messages so far
2025-02-26 19:40:49,393 - INFO - Received 200 messages so far
2025-02-26 19:40:49,394 - INFO - Received 300 messages so far
2025-02-26 19:40:49,394 - INFO - Received 400 messages so far
2025-02-26 19:40:49,394 - INFO - Received 500 messages so far
2025-02-26 19:40:49,394 - INFO - Received 600 messages so far
2025-02-26 19:40:49,394 - INFO - Received 700 messages so far
2025-02-26 19:40:49,395 - INFO - Received 800 messages so far
2025-02-26 19:40:49,395 - INFO - Received 900 messages so far
2025-02-26 19:40:49,395 - INFO - Received 1000 messages so far
2025-02-26 19:40:49,395 - INFO - Received 1100 messages so far
2025-02-26 19:40:49,395 - INFO - Received 1200 messages so far
2025-02-26 19:40:49,395 - INFO - Received 1300 messages so far
2025-02-26 19:40:49,396 - INFO - Received 1400 messages so far
2025-02-26 19:40:49,396 - INFO - Received 1500 messages so far
2025-02-26 19:40:49,396 - INFO - Received 1600 messages so far
2025-02-26 19:40:49,396 - INFO - Received 1700 messages so far
2025-02-26 19:40:49,396 - INFO - Received 1800 messages so far
2025-02-26 19:40:49,397 - INFO - Received 1900 messages so far
2025-02-26 19:40:49,397 - INFO - Received 2000 messages so far
2025-02-26 19:40:49,397 - INFO - Received 2100 messages so far
2025-02-26 19:40:49,397 - INFO - Received 2200 messages so far
2025-02-26 19:40:49,397 - INFO - Received 2300 messages so far
2025-02-26 19:40:49,398 - INFO - Received 2400 messages so far
2025-02-26 19:40:49,398 - INFO - Received 2500 messages so far
2025-02-26 19:40:49,398 - INFO - Received 2600 messages so far
2025-02-26 19:40:49,398 - INFO - Received 2700 messages so far
2025-02-26 19:40:49,398 - INFO - Received 2800 messages so far
2025-02-26 19:40:49,399 - INFO - Received 2900 messages so far
2025-02-26 19:40:49,399 - INFO - Received 3000 messages so far
2025-02-26 19:40:49,399 - INFO - Received 3100 messages so far
2025-02-26 19:40:49,399 - INFO - Received 3200 messages so far
2025-02-26 19:40:49,399 - INFO - Received 3300 messages so far
2025-02-26 19:40:49,400 - INFO - Received 3400 messages so far
2025-02-26 19:40:49,400 - INFO - Received 3500 messages so far
2025-02-26 19:40:49,400 - INFO - Received 3600 messages so far
2025-02-26 19:40:49,400 - INFO - Received 3700 messages so far
2025-02-26 19:40:49,400 - INFO - Received 3800 messages so far
2025-02-26 19:40:49,400 - INFO - Received 3900 messages so far
2025-02-26 19:40:49,401 - INFO - Received 4000 messages so far
2025-02-26 19:40:49,401 - INFO - Received 4100 messages so far
2025-02-26 19:40:49,497 - INFO - Received 4200 messages so far
2025-02-26 19:40:49,498 - INFO - Received 4300 messages so far
2025-02-26 19:40:49,498 - INFO - Received 4400 messages so far
2025-02-26 19:40:49,498 - INFO - Received 4500 messages so far
2025-02-26 19:40:49,498 - INFO - Received 4600 messages so far
2025-02-26 19:40:49,499 - INFO - Received 4700 messages so far
2025-02-26 19:40:49,499 - INFO - Received 4800 messages so far
2025-02-26 19:40:49,499 - INFO - Received 4900 messages so far
2025-02-26 19:40:49,499 - INFO - Received 5000 messages so far
2025-02-26 19:40:49,499 - INFO - Received 5100 messages so far
2025-02-26 19:40:49,500 - INFO - Received 5200 messages so far
2025-02-26 19:40:49,500 - INFO - Received 5300 messages so far
2025-02-26 19:40:49,500 - INFO - Received 5400 messages so far
2025-02-26 19:40:49,500 - INFO - Received 5500 messages so far
2025-02-26 19:40:49,500 - INFO - Received 5600 messages so far
2025-02-26 19:40:49,501 - INFO - Received 5700 messages so far
2025-02-26 19:40:49,501 - INFO - Received 5800 messages so far
2025-02-26 19:40:49,501 - INFO - Received 5900 messages so far
2025-02-26 19:40:49,501 - INFO - Received 6000 messages so far
2025-02-26 19:40:49,501 - INFO - Received 6100 messages so far
2025-02-26 19:40:49,501 - INFO - Received 6200 messages so far
2025-02-26 19:40:49,502 - INFO - Received 6300 messages so far
2025-02-26 19:40:49,502 - INFO - Received 6400 messages so far
2025-02-26 19:40:49,502 - INFO - Received 6500 messages so far
2025-02-26 19:40:49,502 - INFO - Received 6600 messages so far
2025-02-26 19:40:49,502 - INFO - Received 6700 messages so far
2025-02-26 19:40:49,503 - INFO - Received 6800 messages so far
2025-02-26 19:40:49,503 - INFO - Received 6900 messages so far
2025-02-26 19:40:49,503 - INFO - Received 7000 messages so far
2025-02-26 19:40:49,503 - INFO - Received 7100 messages so far
2025-02-26 19:40:49,503 - INFO - Received 7200 messages so far
2025-02-26 19:40:49,504 - INFO - Received 7300 messages so far
2025-02-26 19:40:49,504 - INFO - Received 7400 messages so far
2025-02-26 19:40:49,504 - INFO - Received 7500 messages so far
2025-02-26 19:40:49,504 - INFO - Received 7600 messages so far
2025-02-26 19:40:49,504 - INFO - Received 7700 messages so far
2025-02-26 19:40:49,505 - INFO - Received 7800 messages so far
2025-02-26 19:40:49,505 - INFO - Received 7900 messages so far
2025-02-26 19:40:49,505 - INFO - Received 8000 messages so far
2025-02-26 19:40:49,505 - INFO - Received 8100 messages so far
2025-02-26 19:40:49,505 - INFO - Received 8200 messages so far
2025-02-26 19:40:49,506 - INFO - Received 8300 messages so far
2025-02-26 19:40:49,506 - INFO - Received 8400 messages so far
2025-02-26 19:40:49,506 - INFO - Received 8500 messages so far
2025-02-26 19:40:49,506 - INFO - Received 8600 messages so far
2025-02-26 19:40:49,507 - INFO - Received 8700 messages so far
2025-02-26 19:40:49,562 - INFO - Received 8800 messages so far
2025-02-26 19:40:49,563 - INFO - Received 8900 messages so far
2025-02-26 19:40:49,563 - INFO - Received 9000 messages so far
2025-02-26 19:40:49,563 - INFO - Received 9100 messages so far
2025-02-26 19:40:49,563 - INFO - Received 9200 messages so far
2025-02-26 19:40:49,563 - INFO - Received 9300 messages so far
2025-02-26 19:40:49,564 - INFO - Received 9400 messages so far
2025-02-26 19:40:49,564 - INFO - Received 9500 messages so far
2025-02-26 19:40:49,564 - INFO - Received 9600 messages so far
2025-02-26 19:40:49,564 - INFO - Received 9700 messages so far
2025-02-26 19:40:49,564 - INFO - Received 9800 messages so far
2025-02-26 19:40:49,565 - INFO - Received 9900 messages so far
2025-02-26 19:40:49,565 - INFO - Received 10000 messages so far
2025-02-26 19:40:49,565 - INFO - Total messages consumed: 10000
2025-02-26 19:40:49,653 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:49,657 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:49,657 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:49,657 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:49,657 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:49,665 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:49,668 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:49,668 - INFO - Number of columns: 66
2025-02-26 19:40:49,680 - INFO - DataFrame head:
      id.resp_p    id.orig_h        id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
6811        NaN          NaN              NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1115     1900.0  192.168.1.3  239.255.255.250   udp       688.0         0.0  1.740118e+09      NaN  NaN     NaN  CW74Ea3eQOahFkB99    33119.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         S0       True      False           0.0       D        4.0          800.0        0.0            0.0      17.0  3.003272     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9755        NaN          NaN              NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7734        NaN          NaN              NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7534        NaN          NaN              NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:49,680 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:49,710 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:49,756 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    7621c9ee35587231              f621c9ee35587231  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:49,757 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  1900.   443.    53.  9092.   138.   134.  5353.   123.   136.
 21115.    80. 21116.   133.     0.    22.   135.   547.    67.]
2025-02-26 19:40:49,758 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:49,763 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:49,764 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:49,764 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:49,766 - INFO - DataFrame shape after NA dropping: (803, 23)
2025-02-26 19:40:49,767 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:49,767 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:49,767 - INFO - X shape: (803, 21), y shape: (803,)
2025-02-26 19:40:49,767 - INFO - Label distribution in training data: {'DNS': 668, 'HTTPS': 120, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:49,768 - INFO - Training model...
2025-02-26 19:40:49,880 - INFO - Predicting on test data...
2025-02-26 19:40:49,893 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 133.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.8,
    "f1-score": 0.8888888888888888,
    "support": 5.0
  },
  "HTTPS": {
    "precision": 0.9583333333333334,
    "recall": 1.0,
    "f1-score": 0.9787234042553191,
    "support": 23.0
  },
  "accuracy": 0.9937888198757764,
  "macro avg": {
    "precision": 0.9861111111111112,
    "recall": 0.9333333333333332,
    "f1-score": 0.9558707643814026,
    "support": 161.0
  },
  "weighted avg": {
    "precision": 0.994047619047619,
    "recall": 0.9937888198757764,
    "f1-score": 0.9935098306976198,
    "support": 161.0
  }
}
2025-02-26 19:40:49,900 - INFO - Saved processed data locally to processed_data_20250226_194049.csv
2025-02-26 19:40:49,902 - INFO - JSON data size: 397786 bytes
2025-02-26 19:40:49,902 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:49,902 - INFO - Data sent successfully!
2025-02-26 19:40:49,902 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:49,903 - INFO - Starting data processing
2025-02-26 19:40:49,903 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:49,904 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:49,905 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:49,905 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:50,007 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:50,007 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:50,007 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:50,007 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:50,007 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:50,009 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:50,009 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:50,009 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:50,009 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:50,163 - INFO - Received 100 messages so far
2025-02-26 19:40:50,163 - INFO - Received 200 messages so far
2025-02-26 19:40:50,163 - INFO - Received 300 messages so far
2025-02-26 19:40:50,163 - INFO - Received 400 messages so far
2025-02-26 19:40:50,163 - INFO - Received 500 messages so far
2025-02-26 19:40:50,164 - INFO - Received 600 messages so far
2025-02-26 19:40:50,164 - INFO - Received 700 messages so far
2025-02-26 19:40:50,164 - INFO - Received 800 messages so far
2025-02-26 19:40:50,164 - INFO - Received 900 messages so far
2025-02-26 19:40:50,164 - INFO - Received 1000 messages so far
2025-02-26 19:40:50,165 - INFO - Received 1100 messages so far
2025-02-26 19:40:50,165 - INFO - Received 1200 messages so far
2025-02-26 19:40:50,165 - INFO - Received 1300 messages so far
2025-02-26 19:40:50,165 - INFO - Received 1400 messages so far
2025-02-26 19:40:50,165 - INFO - Received 1500 messages so far
2025-02-26 19:40:50,166 - INFO - Received 1600 messages so far
2025-02-26 19:40:50,166 - INFO - Received 1700 messages so far
2025-02-26 19:40:50,166 - INFO - Received 1800 messages so far
2025-02-26 19:40:50,166 - INFO - Received 1900 messages so far
2025-02-26 19:40:50,166 - INFO - Received 2000 messages so far
2025-02-26 19:40:50,167 - INFO - Received 2100 messages so far
2025-02-26 19:40:50,167 - INFO - Received 2200 messages so far
2025-02-26 19:40:50,167 - INFO - Received 2300 messages so far
2025-02-26 19:40:50,167 - INFO - Received 2400 messages so far
2025-02-26 19:40:50,167 - INFO - Received 2500 messages so far
2025-02-26 19:40:50,168 - INFO - Received 2600 messages so far
2025-02-26 19:40:50,168 - INFO - Received 2700 messages so far
2025-02-26 19:40:50,168 - INFO - Received 2800 messages so far
2025-02-26 19:40:50,168 - INFO - Received 2900 messages so far
2025-02-26 19:40:50,168 - INFO - Received 3000 messages so far
2025-02-26 19:40:50,168 - INFO - Received 3100 messages so far
2025-02-26 19:40:50,169 - INFO - Received 3200 messages so far
2025-02-26 19:40:50,169 - INFO - Received 3300 messages so far
2025-02-26 19:40:50,169 - INFO - Received 3400 messages so far
2025-02-26 19:40:50,169 - INFO - Received 3500 messages so far
2025-02-26 19:40:50,169 - INFO - Received 3600 messages so far
2025-02-26 19:40:50,170 - INFO - Received 3700 messages so far
2025-02-26 19:40:50,170 - INFO - Received 3800 messages so far
2025-02-26 19:40:50,170 - INFO - Received 3900 messages so far
2025-02-26 19:40:50,170 - INFO - Received 4000 messages so far
2025-02-26 19:40:50,171 - INFO - Received 4100 messages so far
2025-02-26 19:40:50,225 - INFO - Received 4200 messages so far
2025-02-26 19:40:50,225 - INFO - Received 4300 messages so far
2025-02-26 19:40:50,225 - INFO - Received 4400 messages so far
2025-02-26 19:40:50,226 - INFO - Received 4500 messages so far
2025-02-26 19:40:50,226 - INFO - Received 4600 messages so far
2025-02-26 19:40:50,226 - INFO - Received 4700 messages so far
2025-02-26 19:40:50,226 - INFO - Received 4800 messages so far
2025-02-26 19:40:50,226 - INFO - Received 4900 messages so far
2025-02-26 19:40:50,227 - INFO - Received 5000 messages so far
2025-02-26 19:40:50,227 - INFO - Received 5100 messages so far
2025-02-26 19:40:50,227 - INFO - Received 5200 messages so far
2025-02-26 19:40:50,227 - INFO - Received 5300 messages so far
2025-02-26 19:40:50,227 - INFO - Received 5400 messages so far
2025-02-26 19:40:50,228 - INFO - Received 5500 messages so far
2025-02-26 19:40:50,228 - INFO - Received 5600 messages so far
2025-02-26 19:40:50,228 - INFO - Received 5700 messages so far
2025-02-26 19:40:50,228 - INFO - Received 5800 messages so far
2025-02-26 19:40:50,228 - INFO - Received 5900 messages so far
2025-02-26 19:40:50,229 - INFO - Received 6000 messages so far
2025-02-26 19:40:50,229 - INFO - Received 6100 messages so far
2025-02-26 19:40:50,229 - INFO - Received 6200 messages so far
2025-02-26 19:40:50,229 - INFO - Received 6300 messages so far
2025-02-26 19:40:50,229 - INFO - Received 6400 messages so far
2025-02-26 19:40:50,230 - INFO - Received 6500 messages so far
2025-02-26 19:40:50,230 - INFO - Received 6600 messages so far
2025-02-26 19:40:50,230 - INFO - Received 6700 messages so far
2025-02-26 19:40:50,230 - INFO - Received 6800 messages so far
2025-02-26 19:40:50,230 - INFO - Received 6900 messages so far
2025-02-26 19:40:50,231 - INFO - Received 7000 messages so far
2025-02-26 19:40:50,231 - INFO - Received 7100 messages so far
2025-02-26 19:40:50,231 - INFO - Received 7200 messages so far
2025-02-26 19:40:50,231 - INFO - Received 7300 messages so far
2025-02-26 19:40:50,231 - INFO - Received 7400 messages so far
2025-02-26 19:40:50,231 - INFO - Received 7500 messages so far
2025-02-26 19:40:50,232 - INFO - Received 7600 messages so far
2025-02-26 19:40:50,232 - INFO - Received 7700 messages so far
2025-02-26 19:40:50,232 - INFO - Received 7800 messages so far
2025-02-26 19:40:50,232 - INFO - Received 7900 messages so far
2025-02-26 19:40:50,232 - INFO - Received 8000 messages so far
2025-02-26 19:40:50,233 - INFO - Received 8100 messages so far
2025-02-26 19:40:50,233 - INFO - Received 8200 messages so far
2025-02-26 19:40:50,233 - INFO - Received 8300 messages so far
2025-02-26 19:40:50,233 - INFO - Received 8400 messages so far
2025-02-26 19:40:50,233 - INFO - Received 8500 messages so far
2025-02-26 19:40:50,234 - INFO - Received 8600 messages so far
2025-02-26 19:40:50,234 - INFO - Received 8700 messages so far
2025-02-26 19:40:50,292 - INFO - Received 8800 messages so far
2025-02-26 19:40:50,292 - INFO - Received 8900 messages so far
2025-02-26 19:40:50,292 - INFO - Received 9000 messages so far
2025-02-26 19:40:50,293 - INFO - Received 9100 messages so far
2025-02-26 19:40:50,293 - INFO - Received 9200 messages so far
2025-02-26 19:40:50,293 - INFO - Received 9300 messages so far
2025-02-26 19:40:50,293 - INFO - Received 9400 messages so far
2025-02-26 19:40:50,293 - INFO - Received 9500 messages so far
2025-02-26 19:40:50,294 - INFO - Received 9600 messages so far
2025-02-26 19:40:50,294 - INFO - Received 9700 messages so far
2025-02-26 19:40:50,294 - INFO - Received 9800 messages so far
2025-02-26 19:40:50,294 - INFO - Received 9900 messages so far
2025-02-26 19:40:50,294 - INFO - Received 10000 messages so far
2025-02-26 19:40:50,294 - INFO - Total messages consumed: 10000
2025-02-26 19:40:50,384 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:50,388 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:50,388 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:50,388 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:50,388 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:50,396 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:50,399 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:50,399 - INFO - Number of columns: 66
2025-02-26 19:40:50,410 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes  history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto    duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3255        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN      NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2460      443.0  192.168.1.3  20.42.65.89   tcp    170297.0      7509.0  1.740118e+09      NaN  NaN     ssl  C5KGL22Czmq4i8dNb5    48260.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN       RSTR       True      False           0.0  ShADadr       74.0       174153.0      104.0        12913.0       6.0  157.898614     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2996        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN      NaN        NaN            NaN        NaN            NaN       NaN    0.009495     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1698     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740118e+09      NaN  NaN     NaN  CmKqmC3SFpHCF1JP03    54182.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0       Sr        1.0           60.0        1.0           40.0       6.0    0.000557     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2014        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN      NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:50,410 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:50,440 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:50,527 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    7621c9ee35587231              f621c9ee35587231  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:50,527 - INFO - Unique values in 'id.resp_p' before labeling: [   nan   443.  9092.   134.    53.  1900.   133.  5353.    80.   138.
   123.   136. 21116.    67.     0. 21115.    22.   547.   135.]
2025-02-26 19:40:50,529 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:50,534 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:50,535 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:50,535 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:50,537 - INFO - DataFrame shape after NA dropping: (857, 23)
2025-02-26 19:40:50,537 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:50,538 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:50,538 - INFO - X shape: (857, 21), y shape: (857,)
2025-02-26 19:40:50,538 - INFO - Label distribution in training data: {'DNS': 718, 'HTTPS': 124, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:50,539 - INFO - Training model...
2025-02-26 19:40:50,651 - INFO - Predicting on test data...
2025-02-26 19:40:50,665 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 146.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 6.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 20.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 172.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 172.0
  }
}
2025-02-26 19:40:50,672 - INFO - Saved processed data locally to processed_data_20250226_194050.csv
2025-02-26 19:40:50,674 - INFO - JSON data size: 422882 bytes
2025-02-26 19:40:50,674 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:50,674 - INFO - Data sent successfully!
2025-02-26 19:40:50,675 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:50,676 - INFO - Starting data processing
2025-02-26 19:40:50,676 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:50,676 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:50,677 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:50,677 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:50,779 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:50,779 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:50,779 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:50,779 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:50,780 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:50,780 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:50,781 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:50,781 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:50,781 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:50,933 - INFO - Received 100 messages so far
2025-02-26 19:40:50,933 - INFO - Received 200 messages so far
2025-02-26 19:40:50,933 - INFO - Received 300 messages so far
2025-02-26 19:40:50,934 - INFO - Received 400 messages so far
2025-02-26 19:40:50,934 - INFO - Received 500 messages so far
2025-02-26 19:40:50,934 - INFO - Received 600 messages so far
2025-02-26 19:40:50,934 - INFO - Received 700 messages so far
2025-02-26 19:40:50,934 - INFO - Received 800 messages so far
2025-02-26 19:40:50,935 - INFO - Received 900 messages so far
2025-02-26 19:40:50,935 - INFO - Received 1000 messages so far
2025-02-26 19:40:50,935 - INFO - Received 1100 messages so far
2025-02-26 19:40:50,935 - INFO - Received 1200 messages so far
2025-02-26 19:40:50,935 - INFO - Received 1300 messages so far
2025-02-26 19:40:50,936 - INFO - Received 1400 messages so far
2025-02-26 19:40:50,936 - INFO - Received 1500 messages so far
2025-02-26 19:40:50,936 - INFO - Received 1600 messages so far
2025-02-26 19:40:50,936 - INFO - Received 1700 messages so far
2025-02-26 19:40:50,936 - INFO - Received 1800 messages so far
2025-02-26 19:40:50,937 - INFO - Received 1900 messages so far
2025-02-26 19:40:50,937 - INFO - Received 2000 messages so far
2025-02-26 19:40:50,937 - INFO - Received 2100 messages so far
2025-02-26 19:40:50,937 - INFO - Received 2200 messages so far
2025-02-26 19:40:50,937 - INFO - Received 2300 messages so far
2025-02-26 19:40:50,938 - INFO - Received 2400 messages so far
2025-02-26 19:40:50,938 - INFO - Received 2500 messages so far
2025-02-26 19:40:50,938 - INFO - Received 2600 messages so far
2025-02-26 19:40:50,938 - INFO - Received 2700 messages so far
2025-02-26 19:40:50,938 - INFO - Received 2800 messages so far
2025-02-26 19:40:50,938 - INFO - Received 2900 messages so far
2025-02-26 19:40:50,939 - INFO - Received 3000 messages so far
2025-02-26 19:40:50,939 - INFO - Received 3100 messages so far
2025-02-26 19:40:50,939 - INFO - Received 3200 messages so far
2025-02-26 19:40:50,939 - INFO - Received 3300 messages so far
2025-02-26 19:40:50,939 - INFO - Received 3400 messages so far
2025-02-26 19:40:50,940 - INFO - Received 3500 messages so far
2025-02-26 19:40:50,940 - INFO - Received 3600 messages so far
2025-02-26 19:40:50,940 - INFO - Received 3700 messages so far
2025-02-26 19:40:50,940 - INFO - Received 3800 messages so far
2025-02-26 19:40:50,940 - INFO - Received 3900 messages so far
2025-02-26 19:40:50,941 - INFO - Received 4000 messages so far
2025-02-26 19:40:50,941 - INFO - Received 4100 messages so far
2025-02-26 19:40:50,994 - INFO - Received 4200 messages so far
2025-02-26 19:40:50,995 - INFO - Received 4300 messages so far
2025-02-26 19:40:50,995 - INFO - Received 4400 messages so far
2025-02-26 19:40:50,995 - INFO - Received 4500 messages so far
2025-02-26 19:40:50,995 - INFO - Received 4600 messages so far
2025-02-26 19:40:50,995 - INFO - Received 4700 messages so far
2025-02-26 19:40:50,996 - INFO - Received 4800 messages so far
2025-02-26 19:40:50,996 - INFO - Received 4900 messages so far
2025-02-26 19:40:50,996 - INFO - Received 5000 messages so far
2025-02-26 19:40:50,996 - INFO - Received 5100 messages so far
2025-02-26 19:40:50,996 - INFO - Received 5200 messages so far
2025-02-26 19:40:50,997 - INFO - Received 5300 messages so far
2025-02-26 19:40:50,997 - INFO - Received 5400 messages so far
2025-02-26 19:40:50,997 - INFO - Received 5500 messages so far
2025-02-26 19:40:50,997 - INFO - Received 5600 messages so far
2025-02-26 19:40:50,997 - INFO - Received 5700 messages so far
2025-02-26 19:40:50,998 - INFO - Received 5800 messages so far
2025-02-26 19:40:50,998 - INFO - Received 5900 messages so far
2025-02-26 19:40:50,998 - INFO - Received 6000 messages so far
2025-02-26 19:40:50,998 - INFO - Received 6100 messages so far
2025-02-26 19:40:50,998 - INFO - Received 6200 messages so far
2025-02-26 19:40:50,999 - INFO - Received 6300 messages so far
2025-02-26 19:40:50,999 - INFO - Received 6400 messages so far
2025-02-26 19:40:50,999 - INFO - Received 6500 messages so far
2025-02-26 19:40:50,999 - INFO - Received 6600 messages so far
2025-02-26 19:40:50,999 - INFO - Received 6700 messages so far
2025-02-26 19:40:51,000 - INFO - Received 6800 messages so far
2025-02-26 19:40:51,000 - INFO - Received 6900 messages so far
2025-02-26 19:40:51,000 - INFO - Received 7000 messages so far
2025-02-26 19:40:51,000 - INFO - Received 7100 messages so far
2025-02-26 19:40:51,000 - INFO - Received 7200 messages so far
2025-02-26 19:40:51,001 - INFO - Received 7300 messages so far
2025-02-26 19:40:51,001 - INFO - Received 7400 messages so far
2025-02-26 19:40:51,001 - INFO - Received 7500 messages so far
2025-02-26 19:40:51,001 - INFO - Received 7600 messages so far
2025-02-26 19:40:51,001 - INFO - Received 7700 messages so far
2025-02-26 19:40:51,002 - INFO - Received 7800 messages so far
2025-02-26 19:40:51,002 - INFO - Received 7900 messages so far
2025-02-26 19:40:51,002 - INFO - Received 8000 messages so far
2025-02-26 19:40:51,002 - INFO - Received 8100 messages so far
2025-02-26 19:40:51,002 - INFO - Received 8200 messages so far
2025-02-26 19:40:51,003 - INFO - Received 8300 messages so far
2025-02-26 19:40:51,003 - INFO - Received 8400 messages so far
2025-02-26 19:40:51,003 - INFO - Received 8500 messages so far
2025-02-26 19:40:51,003 - INFO - Received 8600 messages so far
2025-02-26 19:40:51,003 - INFO - Received 8700 messages so far
2025-02-26 19:40:51,060 - INFO - Received 8800 messages so far
2025-02-26 19:40:51,061 - INFO - Received 8900 messages so far
2025-02-26 19:40:51,061 - INFO - Received 9000 messages so far
2025-02-26 19:40:51,061 - INFO - Received 9100 messages so far
2025-02-26 19:40:51,061 - INFO - Received 9200 messages so far
2025-02-26 19:40:51,061 - INFO - Received 9300 messages so far
2025-02-26 19:40:51,062 - INFO - Received 9400 messages so far
2025-02-26 19:40:51,062 - INFO - Received 9500 messages so far
2025-02-26 19:40:51,062 - INFO - Received 9600 messages so far
2025-02-26 19:40:51,062 - INFO - Received 9700 messages so far
2025-02-26 19:40:51,062 - INFO - Received 9800 messages so far
2025-02-26 19:40:51,063 - INFO - Received 9900 messages so far
2025-02-26 19:40:51,063 - INFO - Received 10000 messages so far
2025-02-26 19:40:51,063 - INFO - Total messages consumed: 10000
2025-02-26 19:40:51,151 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:51,155 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:51,155 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:51,155 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:51,155 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:51,162 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:51,166 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:51,166 - INFO - Number of columns: 66
2025-02-26 19:40:51,176 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
6036        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6934        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.006661     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7789        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8349        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4031        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:51,176 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:51,206 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:51,251 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    3d390eb19a6c1898              fd390eb19a6c1898  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:51,251 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.   443.   134.  1900.    80.     0. 21116.
   547.   123.   133. 21115.   136.   138.    22.   135.    67.]
2025-02-26 19:40:51,252 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:51,258 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:51,259 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:51,259 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:51,261 - INFO - DataFrame shape after NA dropping: (899, 23)
2025-02-26 19:40:51,262 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:51,262 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:51,262 - INFO - X shape: (899, 21), y shape: (899,)
2025-02-26 19:40:51,262 - INFO - Label distribution in training data: {'DNS': 751, 'HTTPS': 133, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:51,264 - INFO - Training model...
2025-02-26 19:40:51,379 - INFO - Predicting on test data...
2025-02-26 19:40:51,393 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 147.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 0.9354838709677419,
    "recall": 1.0,
    "f1-score": 0.9666666666666667,
    "support": 29.0
  },
  "accuracy": 0.9888888888888889,
  "macro avg": {
    "precision": 0.978494623655914,
    "recall": 0.8333333333333334,
    "f1-score": 0.8777777777777778,
    "support": 180.0
  },
  "weighted avg": {
    "precision": 0.9896057347670251,
    "recall": 0.9888888888888889,
    "f1-score": 0.9872222222222221,
    "support": 180.0
  }
}
2025-02-26 19:40:51,400 - INFO - Saved processed data locally to processed_data_20250226_194051.csv
2025-02-26 19:40:51,403 - INFO - JSON data size: 441754 bytes
2025-02-26 19:40:51,403 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:51,403 - INFO - Data sent successfully!
2025-02-26 19:40:51,403 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:51,404 - INFO - Starting data processing
2025-02-26 19:40:51,404 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:51,405 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:51,406 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:51,406 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:51,508 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:51,508 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:51,508 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:51,508 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:51,508 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:51,509 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:51,510 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:51,510 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:51,510 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:51,663 - INFO - Received 100 messages so far
2025-02-26 19:40:51,664 - INFO - Received 200 messages so far
2025-02-26 19:40:51,664 - INFO - Received 300 messages so far
2025-02-26 19:40:51,664 - INFO - Received 400 messages so far
2025-02-26 19:40:51,664 - INFO - Received 500 messages so far
2025-02-26 19:40:51,664 - INFO - Received 600 messages so far
2025-02-26 19:40:51,665 - INFO - Received 700 messages so far
2025-02-26 19:40:51,665 - INFO - Received 800 messages so far
2025-02-26 19:40:51,665 - INFO - Received 900 messages so far
2025-02-26 19:40:51,665 - INFO - Received 1000 messages so far
2025-02-26 19:40:51,665 - INFO - Received 1100 messages so far
2025-02-26 19:40:51,666 - INFO - Received 1200 messages so far
2025-02-26 19:40:51,666 - INFO - Received 1300 messages so far
2025-02-26 19:40:51,666 - INFO - Received 1400 messages so far
2025-02-26 19:40:51,666 - INFO - Received 1500 messages so far
2025-02-26 19:40:51,666 - INFO - Received 1600 messages so far
2025-02-26 19:40:51,667 - INFO - Received 1700 messages so far
2025-02-26 19:40:51,667 - INFO - Received 1800 messages so far
2025-02-26 19:40:51,667 - INFO - Received 1900 messages so far
2025-02-26 19:40:51,667 - INFO - Received 2000 messages so far
2025-02-26 19:40:51,667 - INFO - Received 2100 messages so far
2025-02-26 19:40:51,668 - INFO - Received 2200 messages so far
2025-02-26 19:40:51,668 - INFO - Received 2300 messages so far
2025-02-26 19:40:51,668 - INFO - Received 2400 messages so far
2025-02-26 19:40:51,668 - INFO - Received 2500 messages so far
2025-02-26 19:40:51,668 - INFO - Received 2600 messages so far
2025-02-26 19:40:51,669 - INFO - Received 2700 messages so far
2025-02-26 19:40:51,669 - INFO - Received 2800 messages so far
2025-02-26 19:40:51,669 - INFO - Received 2900 messages so far
2025-02-26 19:40:51,669 - INFO - Received 3000 messages so far
2025-02-26 19:40:51,669 - INFO - Received 3100 messages so far
2025-02-26 19:40:51,669 - INFO - Received 3200 messages so far
2025-02-26 19:40:51,670 - INFO - Received 3300 messages so far
2025-02-26 19:40:51,670 - INFO - Received 3400 messages so far
2025-02-26 19:40:51,670 - INFO - Received 3500 messages so far
2025-02-26 19:40:51,670 - INFO - Received 3600 messages so far
2025-02-26 19:40:51,670 - INFO - Received 3700 messages so far
2025-02-26 19:40:51,671 - INFO - Received 3800 messages so far
2025-02-26 19:40:51,671 - INFO - Received 3900 messages so far
2025-02-26 19:40:51,671 - INFO - Received 4000 messages so far
2025-02-26 19:40:51,671 - INFO - Received 4100 messages so far
2025-02-26 19:40:51,775 - INFO - Received 4200 messages so far
2025-02-26 19:40:51,776 - INFO - Received 4300 messages so far
2025-02-26 19:40:51,776 - INFO - Received 4400 messages so far
2025-02-26 19:40:51,776 - INFO - Received 4500 messages so far
2025-02-26 19:40:51,776 - INFO - Received 4600 messages so far
2025-02-26 19:40:51,776 - INFO - Received 4700 messages so far
2025-02-26 19:40:51,777 - INFO - Received 4800 messages so far
2025-02-26 19:40:51,777 - INFO - Received 4900 messages so far
2025-02-26 19:40:51,777 - INFO - Received 5000 messages so far
2025-02-26 19:40:51,777 - INFO - Received 5100 messages so far
2025-02-26 19:40:51,778 - INFO - Received 5200 messages so far
2025-02-26 19:40:51,778 - INFO - Received 5300 messages so far
2025-02-26 19:40:51,778 - INFO - Received 5400 messages so far
2025-02-26 19:40:51,778 - INFO - Received 5500 messages so far
2025-02-26 19:40:51,778 - INFO - Received 5600 messages so far
2025-02-26 19:40:51,779 - INFO - Received 5700 messages so far
2025-02-26 19:40:51,779 - INFO - Received 5800 messages so far
2025-02-26 19:40:51,779 - INFO - Received 5900 messages so far
2025-02-26 19:40:51,779 - INFO - Received 6000 messages so far
2025-02-26 19:40:51,779 - INFO - Received 6100 messages so far
2025-02-26 19:40:51,780 - INFO - Received 6200 messages so far
2025-02-26 19:40:51,780 - INFO - Received 6300 messages so far
2025-02-26 19:40:51,780 - INFO - Received 6400 messages so far
2025-02-26 19:40:51,780 - INFO - Received 6500 messages so far
2025-02-26 19:40:51,780 - INFO - Received 6600 messages so far
2025-02-26 19:40:51,781 - INFO - Received 6700 messages so far
2025-02-26 19:40:51,781 - INFO - Received 6800 messages so far
2025-02-26 19:40:51,781 - INFO - Received 6900 messages so far
2025-02-26 19:40:51,781 - INFO - Received 7000 messages so far
2025-02-26 19:40:51,781 - INFO - Received 7100 messages so far
2025-02-26 19:40:51,781 - INFO - Received 7200 messages so far
2025-02-26 19:40:51,782 - INFO - Received 7300 messages so far
2025-02-26 19:40:51,782 - INFO - Received 7400 messages so far
2025-02-26 19:40:51,782 - INFO - Received 7500 messages so far
2025-02-26 19:40:51,782 - INFO - Received 7600 messages so far
2025-02-26 19:40:51,782 - INFO - Received 7700 messages so far
2025-02-26 19:40:51,783 - INFO - Received 7800 messages so far
2025-02-26 19:40:51,783 - INFO - Received 7900 messages so far
2025-02-26 19:40:51,783 - INFO - Received 8000 messages so far
2025-02-26 19:40:51,783 - INFO - Received 8100 messages so far
2025-02-26 19:40:51,783 - INFO - Received 8200 messages so far
2025-02-26 19:40:51,784 - INFO - Received 8300 messages so far
2025-02-26 19:40:51,784 - INFO - Received 8400 messages so far
2025-02-26 19:40:51,784 - INFO - Received 8500 messages so far
2025-02-26 19:40:51,784 - INFO - Received 8600 messages so far
2025-02-26 19:40:51,785 - INFO - Received 8700 messages so far
2025-02-26 19:40:51,842 - INFO - Received 8800 messages so far
2025-02-26 19:40:51,842 - INFO - Received 8900 messages so far
2025-02-26 19:40:51,842 - INFO - Received 9000 messages so far
2025-02-26 19:40:51,843 - INFO - Received 9100 messages so far
2025-02-26 19:40:51,843 - INFO - Received 9200 messages so far
2025-02-26 19:40:51,843 - INFO - Received 9300 messages so far
2025-02-26 19:40:51,843 - INFO - Received 9400 messages so far
2025-02-26 19:40:51,843 - INFO - Received 9500 messages so far
2025-02-26 19:40:51,843 - INFO - Received 9600 messages so far
2025-02-26 19:40:51,844 - INFO - Received 9700 messages so far
2025-02-26 19:40:51,844 - INFO - Received 9800 messages so far
2025-02-26 19:40:51,844 - INFO - Received 9900 messages so far
2025-02-26 19:40:51,844 - INFO - Received 10000 messages so far
2025-02-26 19:40:51,844 - INFO - Total messages consumed: 10000
2025-02-26 19:40:51,937 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:51,941 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:51,941 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:51,941 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:51,941 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:51,948 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:51,952 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:51,952 - INFO - Number of columns: 66
2025-02-26 19:40:51,964 - INFO - DataFrame head:
      id.resp_p    id.orig_h     id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt                    query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD     RA    Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto   duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7342        NaN          NaN           NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN        NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
248       443.0  192.168.1.3  35.174.210.7   tcp      2147.0       415.0  1.740118e+09      NaN  NaN     NaN  Cc4oOD11mtuMpCJaL3    57076.0  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN         SF       True      False           0.0  DdAFRf       12.0         2747.0        6.0          727.0       6.0  52.937148     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9981       53.0  192.168.1.3   192.168.1.1   udp         NaN         NaN  1.740120e+09      NaN  NaN     NaN  ClsXKy3FAx5DUOzip4    56559.0  NaN  ogads-pa.googleapis.com     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  False  0.0     NaN  NaN    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN        NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8252        NaN          NaN           NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN        NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3648        NaN          NaN           NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN        NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:51,964 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:51,994 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:52,040 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    376acab97e4aab30              e456d0cc73137d45  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:52,040 - INFO - Unique values in 'id.resp_p' before labeling: [   nan   443.    53.  9092.  1900.   123. 21116.   133.  5353.    80.
   134.   135.   547. 21115.     0.   138.   136.    22.    67.]
2025-02-26 19:40:52,041 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:52,047 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:52,048 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:52,048 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:52,050 - INFO - DataFrame shape after NA dropping: (815, 23)
2025-02-26 19:40:52,050 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:52,050 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:52,051 - INFO - X shape: (815, 21), y shape: (815,)
2025-02-26 19:40:52,051 - INFO - Label distribution in training data: {'DNS': 682, 'HTTPS': 119, 'HTTP': 13, 'SSH': 1}
2025-02-26 19:40:52,052 - INFO - Training model...
2025-02-26 19:40:52,163 - INFO - Predicting on test data...
2025-02-26 19:40:52,177 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 140.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 22.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 163.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 163.0
  }
}
2025-02-26 19:40:52,184 - INFO - Saved processed data locally to processed_data_20250226_194052.csv
2025-02-26 19:40:52,186 - INFO - JSON data size: 405526 bytes
2025-02-26 19:40:52,186 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:52,187 - INFO - Data sent successfully!
2025-02-26 19:40:52,187 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:52,188 - INFO - Starting data processing
2025-02-26 19:40:52,188 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:52,188 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:52,189 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:52,189 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:52,291 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:52,291 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:52,292 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:52,292 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:52,292 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:52,293 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:52,293 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:52,293 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:52,293 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:52,444 - INFO - Received 100 messages so far
2025-02-26 19:40:52,444 - INFO - Received 200 messages so far
2025-02-26 19:40:52,444 - INFO - Received 300 messages so far
2025-02-26 19:40:52,445 - INFO - Received 400 messages so far
2025-02-26 19:40:52,445 - INFO - Received 500 messages so far
2025-02-26 19:40:52,445 - INFO - Received 600 messages so far
2025-02-26 19:40:52,445 - INFO - Received 700 messages so far
2025-02-26 19:40:52,445 - INFO - Received 800 messages so far
2025-02-26 19:40:52,446 - INFO - Received 900 messages so far
2025-02-26 19:40:52,446 - INFO - Received 1000 messages so far
2025-02-26 19:40:52,446 - INFO - Received 1100 messages so far
2025-02-26 19:40:52,446 - INFO - Received 1200 messages so far
2025-02-26 19:40:52,446 - INFO - Received 1300 messages so far
2025-02-26 19:40:52,447 - INFO - Received 1400 messages so far
2025-02-26 19:40:52,447 - INFO - Received 1500 messages so far
2025-02-26 19:40:52,447 - INFO - Received 1600 messages so far
2025-02-26 19:40:52,447 - INFO - Received 1700 messages so far
2025-02-26 19:40:52,447 - INFO - Received 1800 messages so far
2025-02-26 19:40:52,448 - INFO - Received 1900 messages so far
2025-02-26 19:40:52,448 - INFO - Received 2000 messages so far
2025-02-26 19:40:52,448 - INFO - Received 2100 messages so far
2025-02-26 19:40:52,448 - INFO - Received 2200 messages so far
2025-02-26 19:40:52,448 - INFO - Received 2300 messages so far
2025-02-26 19:40:52,448 - INFO - Received 2400 messages so far
2025-02-26 19:40:52,449 - INFO - Received 2500 messages so far
2025-02-26 19:40:52,449 - INFO - Received 2600 messages so far
2025-02-26 19:40:52,449 - INFO - Received 2700 messages so far
2025-02-26 19:40:52,449 - INFO - Received 2800 messages so far
2025-02-26 19:40:52,449 - INFO - Received 2900 messages so far
2025-02-26 19:40:52,450 - INFO - Received 3000 messages so far
2025-02-26 19:40:52,450 - INFO - Received 3100 messages so far
2025-02-26 19:40:52,450 - INFO - Received 3200 messages so far
2025-02-26 19:40:52,450 - INFO - Received 3300 messages so far
2025-02-26 19:40:52,450 - INFO - Received 3400 messages so far
2025-02-26 19:40:52,451 - INFO - Received 3500 messages so far
2025-02-26 19:40:52,451 - INFO - Received 3600 messages so far
2025-02-26 19:40:52,451 - INFO - Received 3700 messages so far
2025-02-26 19:40:52,451 - INFO - Received 3800 messages so far
2025-02-26 19:40:52,451 - INFO - Received 3900 messages so far
2025-02-26 19:40:52,452 - INFO - Received 4000 messages so far
2025-02-26 19:40:52,452 - INFO - Received 4100 messages so far
2025-02-26 19:40:52,505 - INFO - Received 4200 messages so far
2025-02-26 19:40:52,505 - INFO - Received 4300 messages so far
2025-02-26 19:40:52,505 - INFO - Received 4400 messages so far
2025-02-26 19:40:52,505 - INFO - Received 4500 messages so far
2025-02-26 19:40:52,506 - INFO - Received 4600 messages so far
2025-02-26 19:40:52,506 - INFO - Received 4700 messages so far
2025-02-26 19:40:52,506 - INFO - Received 4800 messages so far
2025-02-26 19:40:52,507 - INFO - Received 4900 messages so far
2025-02-26 19:40:52,507 - INFO - Received 5000 messages so far
2025-02-26 19:40:52,507 - INFO - Received 5100 messages so far
2025-02-26 19:40:52,508 - INFO - Received 5200 messages so far
2025-02-26 19:40:52,508 - INFO - Received 5300 messages so far
2025-02-26 19:40:52,508 - INFO - Received 5400 messages so far
2025-02-26 19:40:52,509 - INFO - Received 5500 messages so far
2025-02-26 19:40:52,509 - INFO - Received 5600 messages so far
2025-02-26 19:40:52,509 - INFO - Received 5700 messages so far
2025-02-26 19:40:52,510 - INFO - Received 5800 messages so far
2025-02-26 19:40:52,510 - INFO - Received 5900 messages so far
2025-02-26 19:40:52,510 - INFO - Received 6000 messages so far
2025-02-26 19:40:52,510 - INFO - Received 6100 messages so far
2025-02-26 19:40:52,511 - INFO - Received 6200 messages so far
2025-02-26 19:40:52,511 - INFO - Received 6300 messages so far
2025-02-26 19:40:52,512 - INFO - Received 6400 messages so far
2025-02-26 19:40:52,512 - INFO - Received 6500 messages so far
2025-02-26 19:40:52,512 - INFO - Received 6600 messages so far
2025-02-26 19:40:52,513 - INFO - Received 6700 messages so far
2025-02-26 19:40:52,513 - INFO - Received 6800 messages so far
2025-02-26 19:40:52,513 - INFO - Received 6900 messages so far
2025-02-26 19:40:52,513 - INFO - Received 7000 messages so far
2025-02-26 19:40:52,513 - INFO - Received 7100 messages so far
2025-02-26 19:40:52,514 - INFO - Received 7200 messages so far
2025-02-26 19:40:52,514 - INFO - Received 7300 messages so far
2025-02-26 19:40:52,514 - INFO - Received 7400 messages so far
2025-02-26 19:40:52,514 - INFO - Received 7500 messages so far
2025-02-26 19:40:52,514 - INFO - Received 7600 messages so far
2025-02-26 19:40:52,515 - INFO - Received 7700 messages so far
2025-02-26 19:40:52,515 - INFO - Received 7800 messages so far
2025-02-26 19:40:52,515 - INFO - Received 7900 messages so far
2025-02-26 19:40:52,515 - INFO - Received 8000 messages so far
2025-02-26 19:40:52,515 - INFO - Received 8100 messages so far
2025-02-26 19:40:52,515 - INFO - Received 8200 messages so far
2025-02-26 19:40:52,516 - INFO - Received 8300 messages so far
2025-02-26 19:40:52,516 - INFO - Received 8400 messages so far
2025-02-26 19:40:52,516 - INFO - Received 8500 messages so far
2025-02-26 19:40:52,516 - INFO - Received 8600 messages so far
2025-02-26 19:40:52,517 - INFO - Received 8700 messages so far
2025-02-26 19:40:52,617 - INFO - Received 8800 messages so far
2025-02-26 19:40:52,617 - INFO - Received 8900 messages so far
2025-02-26 19:40:52,617 - INFO - Received 9000 messages so far
2025-02-26 19:40:52,617 - INFO - Received 9100 messages so far
2025-02-26 19:40:52,617 - INFO - Received 9200 messages so far
2025-02-26 19:40:52,618 - INFO - Received 9300 messages so far
2025-02-26 19:40:52,618 - INFO - Received 9400 messages so far
2025-02-26 19:40:52,618 - INFO - Received 9500 messages so far
2025-02-26 19:40:52,618 - INFO - Received 9600 messages so far
2025-02-26 19:40:52,618 - INFO - Received 9700 messages so far
2025-02-26 19:40:52,619 - INFO - Received 9800 messages so far
2025-02-26 19:40:52,619 - INFO - Received 9900 messages so far
2025-02-26 19:40:52,619 - INFO - Received 10000 messages so far
2025-02-26 19:40:52,619 - INFO - Total messages consumed: 10000
2025-02-26 19:40:52,708 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:52,712 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:52,712 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:52,712 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:52,712 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:52,719 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:52,723 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:52,723 - INFO - Number of columns: 66
2025-02-26 19:40:52,734 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                               query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD     RA    Z                                                                                               answers                   TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
1191        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN                                                                                                   NaN                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7618        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN                                                                                                   NaN                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7004        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN                                                                                                   NaN                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5030       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740119e+09      NaN  NaN     NaN  C94n7B32HYRMII14Xl    58418.0       NaN        dual-spo-0005.spo-msedge.net     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  False  0.0                                                                                                   NaN                    NaN    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5017       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740119e+09      NaN  NaN     NaN  CS4eJx2a6jKnsYHUQ3    54601.0  0.002651  word-telemetry.officeapps.live.com     1.0  C_INTERNET    1.0          A    0.0    NOERROR  False  False  True   True  0.0  [word-telemetry.wac.trafficmanager.net, pgtus1-word-telemetry-vip.officeapps.live.com, 52.108.78.30]  [205.0, 205.0, 205.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:52,734 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:52,764 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:52,810 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    b90b0ae34b0b9725              f90b0ae34b0b9725  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:52,810 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443.    80.  5353.  1900.   134.     0.   133.
   123.    67.   135.   138.   136. 21116.    22.   547. 21115.]
2025-02-26 19:40:52,812 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:52,817 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:52,818 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:52,818 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:52,820 - INFO - DataFrame shape after NA dropping: (861, 23)
2025-02-26 19:40:52,820 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:52,820 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:52,821 - INFO - X shape: (861, 21), y shape: (861,)
2025-02-26 19:40:52,821 - INFO - Label distribution in training data: {'DNS': 725, 'HTTPS': 123, 'HTTP': 12, 'SSH': 1}
2025-02-26 19:40:52,822 - INFO - Training model...
2025-02-26 19:40:52,936 - INFO - Predicting on test data...
2025-02-26 19:40:52,949 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 150.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 2.0
  },
  "HTTPS": {
    "precision": 0.9545454545454546,
    "recall": 1.0,
    "f1-score": 0.9767441860465116,
    "support": 21.0
  },
  "accuracy": 0.9942196531791907,
  "macro avg": {
    "precision": 0.9848484848484849,
    "recall": 0.8333333333333334,
    "f1-score": 0.8811369509043927,
    "support": 173.0
  },
  "weighted avg": {
    "precision": 0.9944823962165004,
    "recall": 0.9942196531791907,
    "f1-score": 0.993323475377515,
    "support": 173.0
  }
}
2025-02-26 19:40:52,956 - INFO - Saved processed data locally to processed_data_20250226_194052.csv
2025-02-26 19:40:52,959 - INFO - JSON data size: 424017 bytes
2025-02-26 19:40:52,959 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:52,959 - INFO - Data sent successfully!
2025-02-26 19:40:52,959 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:52,960 - INFO - Starting data processing
2025-02-26 19:40:52,960 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:52,961 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:52,961 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:52,962 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:53,063 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:53,063 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:53,064 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:53,064 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:53,064 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:53,065 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:53,065 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:53,065 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:53,065 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:53,219 - INFO - Received 100 messages so far
2025-02-26 19:40:53,219 - INFO - Received 200 messages so far
2025-02-26 19:40:53,220 - INFO - Received 300 messages so far
2025-02-26 19:40:53,220 - INFO - Received 400 messages so far
2025-02-26 19:40:53,220 - INFO - Received 500 messages so far
2025-02-26 19:40:53,220 - INFO - Received 600 messages so far
2025-02-26 19:40:53,220 - INFO - Received 700 messages so far
2025-02-26 19:40:53,221 - INFO - Received 800 messages so far
2025-02-26 19:40:53,221 - INFO - Received 900 messages so far
2025-02-26 19:40:53,221 - INFO - Received 1000 messages so far
2025-02-26 19:40:53,221 - INFO - Received 1100 messages so far
2025-02-26 19:40:53,221 - INFO - Received 1200 messages so far
2025-02-26 19:40:53,222 - INFO - Received 1300 messages so far
2025-02-26 19:40:53,222 - INFO - Received 1400 messages so far
2025-02-26 19:40:53,222 - INFO - Received 1500 messages so far
2025-02-26 19:40:53,222 - INFO - Received 1600 messages so far
2025-02-26 19:40:53,222 - INFO - Received 1700 messages so far
2025-02-26 19:40:53,223 - INFO - Received 1800 messages so far
2025-02-26 19:40:53,223 - INFO - Received 1900 messages so far
2025-02-26 19:40:53,223 - INFO - Received 2000 messages so far
2025-02-26 19:40:53,223 - INFO - Received 2100 messages so far
2025-02-26 19:40:53,223 - INFO - Received 2200 messages so far
2025-02-26 19:40:53,224 - INFO - Received 2300 messages so far
2025-02-26 19:40:53,224 - INFO - Received 2400 messages so far
2025-02-26 19:40:53,224 - INFO - Received 2500 messages so far
2025-02-26 19:40:53,224 - INFO - Received 2600 messages so far
2025-02-26 19:40:53,224 - INFO - Received 2700 messages so far
2025-02-26 19:40:53,224 - INFO - Received 2800 messages so far
2025-02-26 19:40:53,225 - INFO - Received 2900 messages so far
2025-02-26 19:40:53,225 - INFO - Received 3000 messages so far
2025-02-26 19:40:53,225 - INFO - Received 3100 messages so far
2025-02-26 19:40:53,225 - INFO - Received 3200 messages so far
2025-02-26 19:40:53,225 - INFO - Received 3300 messages so far
2025-02-26 19:40:53,226 - INFO - Received 3400 messages so far
2025-02-26 19:40:53,226 - INFO - Received 3500 messages so far
2025-02-26 19:40:53,226 - INFO - Received 3600 messages so far
2025-02-26 19:40:53,226 - INFO - Received 3700 messages so far
2025-02-26 19:40:53,226 - INFO - Received 3800 messages so far
2025-02-26 19:40:53,227 - INFO - Received 3900 messages so far
2025-02-26 19:40:53,227 - INFO - Received 4000 messages so far
2025-02-26 19:40:53,227 - INFO - Received 4100 messages so far
2025-02-26 19:40:53,281 - INFO - Received 4200 messages so far
2025-02-26 19:40:53,281 - INFO - Received 4300 messages so far
2025-02-26 19:40:53,282 - INFO - Received 4400 messages so far
2025-02-26 19:40:53,282 - INFO - Received 4500 messages so far
2025-02-26 19:40:53,282 - INFO - Received 4600 messages so far
2025-02-26 19:40:53,282 - INFO - Received 4700 messages so far
2025-02-26 19:40:53,282 - INFO - Received 4800 messages so far
2025-02-26 19:40:53,283 - INFO - Received 4900 messages so far
2025-02-26 19:40:53,283 - INFO - Received 5000 messages so far
2025-02-26 19:40:53,283 - INFO - Received 5100 messages so far
2025-02-26 19:40:53,283 - INFO - Received 5200 messages so far
2025-02-26 19:40:53,283 - INFO - Received 5300 messages so far
2025-02-26 19:40:53,284 - INFO - Received 5400 messages so far
2025-02-26 19:40:53,284 - INFO - Received 5500 messages so far
2025-02-26 19:40:53,284 - INFO - Received 5600 messages so far
2025-02-26 19:40:53,284 - INFO - Received 5700 messages so far
2025-02-26 19:40:53,284 - INFO - Received 5800 messages so far
2025-02-26 19:40:53,285 - INFO - Received 5900 messages so far
2025-02-26 19:40:53,285 - INFO - Received 6000 messages so far
2025-02-26 19:40:53,285 - INFO - Received 6100 messages so far
2025-02-26 19:40:53,285 - INFO - Received 6200 messages so far
2025-02-26 19:40:53,285 - INFO - Received 6300 messages so far
2025-02-26 19:40:53,286 - INFO - Received 6400 messages so far
2025-02-26 19:40:53,286 - INFO - Received 6500 messages so far
2025-02-26 19:40:53,286 - INFO - Received 6600 messages so far
2025-02-26 19:40:53,286 - INFO - Received 6700 messages so far
2025-02-26 19:40:53,286 - INFO - Received 6800 messages so far
2025-02-26 19:40:53,287 - INFO - Received 6900 messages so far
2025-02-26 19:40:53,287 - INFO - Received 7000 messages so far
2025-02-26 19:40:53,287 - INFO - Received 7100 messages so far
2025-02-26 19:40:53,287 - INFO - Received 7200 messages so far
2025-02-26 19:40:53,287 - INFO - Received 7300 messages so far
2025-02-26 19:40:53,288 - INFO - Received 7400 messages so far
2025-02-26 19:40:53,288 - INFO - Received 7500 messages so far
2025-02-26 19:40:53,288 - INFO - Received 7600 messages so far
2025-02-26 19:40:53,288 - INFO - Received 7700 messages so far
2025-02-26 19:40:53,288 - INFO - Received 7800 messages so far
2025-02-26 19:40:53,289 - INFO - Received 7900 messages so far
2025-02-26 19:40:53,289 - INFO - Received 8000 messages so far
2025-02-26 19:40:53,289 - INFO - Received 8100 messages so far
2025-02-26 19:40:53,289 - INFO - Received 8200 messages so far
2025-02-26 19:40:53,289 - INFO - Received 8300 messages so far
2025-02-26 19:40:53,290 - INFO - Received 8400 messages so far
2025-02-26 19:40:53,290 - INFO - Received 8500 messages so far
2025-02-26 19:40:53,290 - INFO - Received 8600 messages so far
2025-02-26 19:40:53,290 - INFO - Received 8700 messages so far
2025-02-26 19:40:53,348 - INFO - Received 8800 messages so far
2025-02-26 19:40:53,349 - INFO - Received 8900 messages so far
2025-02-26 19:40:53,349 - INFO - Received 9000 messages so far
2025-02-26 19:40:53,349 - INFO - Received 9100 messages so far
2025-02-26 19:40:53,349 - INFO - Received 9200 messages so far
2025-02-26 19:40:53,349 - INFO - Received 9300 messages so far
2025-02-26 19:40:53,350 - INFO - Received 9400 messages so far
2025-02-26 19:40:53,350 - INFO - Received 9500 messages so far
2025-02-26 19:40:53,350 - INFO - Received 9600 messages so far
2025-02-26 19:40:53,350 - INFO - Received 9700 messages so far
2025-02-26 19:40:53,350 - INFO - Received 9800 messages so far
2025-02-26 19:40:53,351 - INFO - Received 9900 messages so far
2025-02-26 19:40:53,351 - INFO - Received 10000 messages so far
2025-02-26 19:40:53,351 - INFO - Total messages consumed: 10000
2025-02-26 19:40:53,440 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:53,444 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:53,444 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:53,444 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:53,445 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:53,452 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:53,455 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:53,455 - INFO - Number of columns: 66
2025-02-26 19:40:53,467 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7628        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
880         NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4166        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.000000     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7215     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740119e+09      NaN  NaN     NaN  CcjwjE2F4B8SklPXPg    50664.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000503     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8052        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:53,467 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:53,497 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:53,543 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    7621c9ee35587231              f621c9ee35587231  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:53,543 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   443.  5353.   136.   123.   138.  1900.   134.
    80.     0. 21116.   547. 21115.   133.   135.    67.    22.]
2025-02-26 19:40:53,544 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:53,549 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:53,551 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:53,551 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:53,553 - INFO - DataFrame shape after NA dropping: (832, 23)
2025-02-26 19:40:53,553 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:53,553 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:53,554 - INFO - X shape: (832, 21), y shape: (832,)
2025-02-26 19:40:53,554 - INFO - Label distribution in training data: {'DNS': 699, 'HTTPS': 118, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:53,555 - INFO - Training model...
2025-02-26 19:40:53,669 - INFO - Predicting on test data...
2025-02-26 19:40:53,682 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 138.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 0.9259259259259259,
    "recall": 1.0,
    "f1-score": 0.9615384615384616,
    "support": 25.0
  },
  "accuracy": 0.9880239520958084,
  "macro avg": {
    "precision": 0.9753086419753086,
    "recall": 0.8333333333333334,
    "f1-score": 0.8760683760683761,
    "support": 167.0
  },
  "weighted avg": {
    "precision": 0.9889110667553782,
    "recall": 0.9880239520958084,
    "f1-score": 0.9862582527253186,
    "support": 167.0
  }
}
2025-02-26 19:40:53,689 - INFO - Saved processed data locally to processed_data_20250226_194053.csv
2025-02-26 19:40:53,692 - INFO - JSON data size: 409326 bytes
2025-02-26 19:40:53,692 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:53,692 - INFO - Data sent successfully!
2025-02-26 19:40:53,692 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:53,693 - INFO - Starting data processing
2025-02-26 19:40:53,693 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:53,694 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:53,695 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:53,695 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:53,797 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:53,797 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:53,797 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:53,797 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:53,797 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:53,798 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:53,798 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:53,798 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:53,799 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:53,991 - INFO - Received 100 messages so far
2025-02-26 19:40:53,992 - INFO - Received 200 messages so far
2025-02-26 19:40:53,992 - INFO - Received 300 messages so far
2025-02-26 19:40:53,992 - INFO - Received 400 messages so far
2025-02-26 19:40:53,992 - INFO - Received 500 messages so far
2025-02-26 19:40:53,993 - INFO - Received 600 messages so far
2025-02-26 19:40:53,993 - INFO - Received 700 messages so far
2025-02-26 19:40:53,993 - INFO - Received 800 messages so far
2025-02-26 19:40:53,993 - INFO - Received 900 messages so far
2025-02-26 19:40:53,993 - INFO - Received 1000 messages so far
2025-02-26 19:40:53,994 - INFO - Received 1100 messages so far
2025-02-26 19:40:53,994 - INFO - Received 1200 messages so far
2025-02-26 19:40:53,994 - INFO - Received 1300 messages so far
2025-02-26 19:40:53,994 - INFO - Received 1400 messages so far
2025-02-26 19:40:53,994 - INFO - Received 1500 messages so far
2025-02-26 19:40:53,995 - INFO - Received 1600 messages so far
2025-02-26 19:40:53,995 - INFO - Received 1700 messages so far
2025-02-26 19:40:53,995 - INFO - Received 1800 messages so far
2025-02-26 19:40:53,995 - INFO - Received 1900 messages so far
2025-02-26 19:40:53,995 - INFO - Received 2000 messages so far
2025-02-26 19:40:53,996 - INFO - Received 2100 messages so far
2025-02-26 19:40:53,996 - INFO - Received 2200 messages so far
2025-02-26 19:40:53,996 - INFO - Received 2300 messages so far
2025-02-26 19:40:53,996 - INFO - Received 2400 messages so far
2025-02-26 19:40:53,996 - INFO - Received 2500 messages so far
2025-02-26 19:40:53,996 - INFO - Received 2600 messages so far
2025-02-26 19:40:53,997 - INFO - Received 2700 messages so far
2025-02-26 19:40:53,997 - INFO - Received 2800 messages so far
2025-02-26 19:40:53,997 - INFO - Received 2900 messages so far
2025-02-26 19:40:53,997 - INFO - Received 3000 messages so far
2025-02-26 19:40:53,997 - INFO - Received 3100 messages so far
2025-02-26 19:40:53,998 - INFO - Received 3200 messages so far
2025-02-26 19:40:53,998 - INFO - Received 3300 messages so far
2025-02-26 19:40:53,998 - INFO - Received 3400 messages so far
2025-02-26 19:40:53,998 - INFO - Received 3500 messages so far
2025-02-26 19:40:53,998 - INFO - Received 3600 messages so far
2025-02-26 19:40:53,999 - INFO - Received 3700 messages so far
2025-02-26 19:40:53,999 - INFO - Received 3800 messages so far
2025-02-26 19:40:53,999 - INFO - Received 3900 messages so far
2025-02-26 19:40:53,999 - INFO - Received 4000 messages so far
2025-02-26 19:40:54,000 - INFO - Received 4100 messages so far
2025-02-26 19:40:54,055 - INFO - Received 4200 messages so far
2025-02-26 19:40:54,056 - INFO - Received 4300 messages so far
2025-02-26 19:40:54,056 - INFO - Received 4400 messages so far
2025-02-26 19:40:54,056 - INFO - Received 4500 messages so far
2025-02-26 19:40:54,056 - INFO - Received 4600 messages so far
2025-02-26 19:40:54,056 - INFO - Received 4700 messages so far
2025-02-26 19:40:54,057 - INFO - Received 4800 messages so far
2025-02-26 19:40:54,057 - INFO - Received 4900 messages so far
2025-02-26 19:40:54,057 - INFO - Received 5000 messages so far
2025-02-26 19:40:54,057 - INFO - Received 5100 messages so far
2025-02-26 19:40:54,057 - INFO - Received 5200 messages so far
2025-02-26 19:40:54,058 - INFO - Received 5300 messages so far
2025-02-26 19:40:54,058 - INFO - Received 5400 messages so far
2025-02-26 19:40:54,058 - INFO - Received 5500 messages so far
2025-02-26 19:40:54,058 - INFO - Received 5600 messages so far
2025-02-26 19:40:54,058 - INFO - Received 5700 messages so far
2025-02-26 19:40:54,059 - INFO - Received 5800 messages so far
2025-02-26 19:40:54,059 - INFO - Received 5900 messages so far
2025-02-26 19:40:54,059 - INFO - Received 6000 messages so far
2025-02-26 19:40:54,059 - INFO - Received 6100 messages so far
2025-02-26 19:40:54,059 - INFO - Received 6200 messages so far
2025-02-26 19:40:54,060 - INFO - Received 6300 messages so far
2025-02-26 19:40:54,060 - INFO - Received 6400 messages so far
2025-02-26 19:40:54,060 - INFO - Received 6500 messages so far
2025-02-26 19:40:54,060 - INFO - Received 6600 messages so far
2025-02-26 19:40:54,060 - INFO - Received 6700 messages so far
2025-02-26 19:40:54,061 - INFO - Received 6800 messages so far
2025-02-26 19:40:54,061 - INFO - Received 6900 messages so far
2025-02-26 19:40:54,061 - INFO - Received 7000 messages so far
2025-02-26 19:40:54,061 - INFO - Received 7100 messages so far
2025-02-26 19:40:54,061 - INFO - Received 7200 messages so far
2025-02-26 19:40:54,062 - INFO - Received 7300 messages so far
2025-02-26 19:40:54,062 - INFO - Received 7400 messages so far
2025-02-26 19:40:54,062 - INFO - Received 7500 messages so far
2025-02-26 19:40:54,062 - INFO - Received 7600 messages so far
2025-02-26 19:40:54,062 - INFO - Received 7700 messages so far
2025-02-26 19:40:54,063 - INFO - Received 7800 messages so far
2025-02-26 19:40:54,063 - INFO - Received 7900 messages so far
2025-02-26 19:40:54,063 - INFO - Received 8000 messages so far
2025-02-26 19:40:54,063 - INFO - Received 8100 messages so far
2025-02-26 19:40:54,063 - INFO - Received 8200 messages so far
2025-02-26 19:40:54,063 - INFO - Received 8300 messages so far
2025-02-26 19:40:54,064 - INFO - Received 8400 messages so far
2025-02-26 19:40:54,064 - INFO - Received 8500 messages so far
2025-02-26 19:40:54,064 - INFO - Received 8600 messages so far
2025-02-26 19:40:54,064 - INFO - Received 8700 messages so far
2025-02-26 19:40:54,120 - INFO - Received 8800 messages so far
2025-02-26 19:40:54,121 - INFO - Received 8900 messages so far
2025-02-26 19:40:54,121 - INFO - Received 9000 messages so far
2025-02-26 19:40:54,121 - INFO - Received 9100 messages so far
2025-02-26 19:40:54,121 - INFO - Received 9200 messages so far
2025-02-26 19:40:54,122 - INFO - Received 9300 messages so far
2025-02-26 19:40:54,122 - INFO - Received 9400 messages so far
2025-02-26 19:40:54,122 - INFO - Received 9500 messages so far
2025-02-26 19:40:54,122 - INFO - Received 9600 messages so far
2025-02-26 19:40:54,122 - INFO - Received 9700 messages so far
2025-02-26 19:40:54,122 - INFO - Received 9800 messages so far
2025-02-26 19:40:54,123 - INFO - Received 9900 messages so far
2025-02-26 19:40:54,123 - INFO - Received 10000 messages so far
2025-02-26 19:40:54,123 - INFO - Total messages consumed: 10000
2025-02-26 19:40:54,211 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:54,214 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:54,215 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:54,215 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:54,215 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:54,222 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:54,225 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:54,226 - INFO - Number of columns: 66
2025-02-26 19:40:54,237 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3750        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6250        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9707       53.0  192.168.1.3  192.168.1.1   udp        52.0       220.0  1.740120e+09      NaN  NaN     dns  C6FRWxHEz97jUiPZb    57668.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           80.0        1.0          248.0      17.0  0.001386     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
585         NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5719        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:54,237 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:54,267 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:54,312 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    c456d0cc73137d45              e456d0cc73137d45  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:54,313 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443.  1900.  5353.   123.   138.   134. 21116.
   136.    80.   133.    67.   135.     0.    22.   547. 21115.]
2025-02-26 19:40:54,314 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:54,319 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:54,320 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:54,320 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:54,323 - INFO - DataFrame shape after NA dropping: (827, 23)
2025-02-26 19:40:54,323 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:54,323 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:54,323 - INFO - X shape: (827, 21), y shape: (827,)
2025-02-26 19:40:54,324 - INFO - Label distribution in training data: {'DNS': 687, 'HTTPS': 125, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:54,325 - INFO - Training model...
2025-02-26 19:40:54,435 - INFO - Predicting on test data...
2025-02-26 19:40:54,449 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 143.0
  },
  "HTTP": {
    "precision": 0.5,
    "recall": 1.0,
    "f1-score": 0.6666666666666666,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 0.9545454545454546,
    "f1-score": 0.9767441860465116,
    "support": 22.0
  },
  "accuracy": 0.9939759036144579,
  "macro avg": {
    "precision": 0.8333333333333334,
    "recall": 0.9848484848484849,
    "f1-score": 0.8811369509043927,
    "support": 166.0
  },
  "weighted avg": {
    "precision": 0.9969879518072289,
    "recall": 0.9939759036144579,
    "f1-score": 0.9949098720463248,
    "support": 166.0
  }
}
2025-02-26 19:40:54,456 - INFO - Saved processed data locally to processed_data_20250226_194054.csv
2025-02-26 19:40:54,458 - INFO - JSON data size: 405723 bytes
2025-02-26 19:40:54,458 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:54,458 - INFO - Data sent successfully!
2025-02-26 19:40:54,458 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:54,459 - INFO - Starting data processing
2025-02-26 19:40:54,459 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:54,460 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:54,461 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:54,461 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:54,562 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:54,562 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:54,563 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:54,563 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:54,564 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:54,564 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:54,565 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:54,565 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:54,565 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:54,719 - INFO - Received 100 messages so far
2025-02-26 19:40:54,719 - INFO - Received 200 messages so far
2025-02-26 19:40:54,720 - INFO - Received 300 messages so far
2025-02-26 19:40:54,720 - INFO - Received 400 messages so far
2025-02-26 19:40:54,720 - INFO - Received 500 messages so far
2025-02-26 19:40:54,720 - INFO - Received 600 messages so far
2025-02-26 19:40:54,720 - INFO - Received 700 messages so far
2025-02-26 19:40:54,721 - INFO - Received 800 messages so far
2025-02-26 19:40:54,721 - INFO - Received 900 messages so far
2025-02-26 19:40:54,721 - INFO - Received 1000 messages so far
2025-02-26 19:40:54,721 - INFO - Received 1100 messages so far
2025-02-26 19:40:54,721 - INFO - Received 1200 messages so far
2025-02-26 19:40:54,722 - INFO - Received 1300 messages so far
2025-02-26 19:40:54,722 - INFO - Received 1400 messages so far
2025-02-26 19:40:54,722 - INFO - Received 1500 messages so far
2025-02-26 19:40:54,722 - INFO - Received 1600 messages so far
2025-02-26 19:40:54,722 - INFO - Received 1700 messages so far
2025-02-26 19:40:54,723 - INFO - Received 1800 messages so far
2025-02-26 19:40:54,723 - INFO - Received 1900 messages so far
2025-02-26 19:40:54,723 - INFO - Received 2000 messages so far
2025-02-26 19:40:54,723 - INFO - Received 2100 messages so far
2025-02-26 19:40:54,723 - INFO - Received 2200 messages so far
2025-02-26 19:40:54,724 - INFO - Received 2300 messages so far
2025-02-26 19:40:54,724 - INFO - Received 2400 messages so far
2025-02-26 19:40:54,724 - INFO - Received 2500 messages so far
2025-02-26 19:40:54,724 - INFO - Received 2600 messages so far
2025-02-26 19:40:54,724 - INFO - Received 2700 messages so far
2025-02-26 19:40:54,725 - INFO - Received 2800 messages so far
2025-02-26 19:40:54,725 - INFO - Received 2900 messages so far
2025-02-26 19:40:54,725 - INFO - Received 3000 messages so far
2025-02-26 19:40:54,725 - INFO - Received 3100 messages so far
2025-02-26 19:40:54,725 - INFO - Received 3200 messages so far
2025-02-26 19:40:54,725 - INFO - Received 3300 messages so far
2025-02-26 19:40:54,726 - INFO - Received 3400 messages so far
2025-02-26 19:40:54,726 - INFO - Received 3500 messages so far
2025-02-26 19:40:54,726 - INFO - Received 3600 messages so far
2025-02-26 19:40:54,726 - INFO - Received 3700 messages so far
2025-02-26 19:40:54,726 - INFO - Received 3800 messages so far
2025-02-26 19:40:54,727 - INFO - Received 3900 messages so far
2025-02-26 19:40:54,727 - INFO - Received 4000 messages so far
2025-02-26 19:40:54,727 - INFO - Received 4100 messages so far
2025-02-26 19:40:54,821 - INFO - Received 4200 messages so far
2025-02-26 19:40:54,821 - INFO - Received 4300 messages so far
2025-02-26 19:40:54,821 - INFO - Received 4400 messages so far
2025-02-26 19:40:54,821 - INFO - Received 4500 messages so far
2025-02-26 19:40:54,821 - INFO - Received 4600 messages so far
2025-02-26 19:40:54,822 - INFO - Received 4700 messages so far
2025-02-26 19:40:54,822 - INFO - Received 4800 messages so far
2025-02-26 19:40:54,822 - INFO - Received 4900 messages so far
2025-02-26 19:40:54,822 - INFO - Received 5000 messages so far
2025-02-26 19:40:54,822 - INFO - Received 5100 messages so far
2025-02-26 19:40:54,823 - INFO - Received 5200 messages so far
2025-02-26 19:40:54,823 - INFO - Received 5300 messages so far
2025-02-26 19:40:54,823 - INFO - Received 5400 messages so far
2025-02-26 19:40:54,823 - INFO - Received 5500 messages so far
2025-02-26 19:40:54,823 - INFO - Received 5600 messages so far
2025-02-26 19:40:54,824 - INFO - Received 5700 messages so far
2025-02-26 19:40:54,824 - INFO - Received 5800 messages so far
2025-02-26 19:40:54,824 - INFO - Received 5900 messages so far
2025-02-26 19:40:54,824 - INFO - Received 6000 messages so far
2025-02-26 19:40:54,824 - INFO - Received 6100 messages so far
2025-02-26 19:40:54,825 - INFO - Received 6200 messages so far
2025-02-26 19:40:54,825 - INFO - Received 6300 messages so far
2025-02-26 19:40:54,825 - INFO - Received 6400 messages so far
2025-02-26 19:40:54,825 - INFO - Received 6500 messages so far
2025-02-26 19:40:54,825 - INFO - Received 6600 messages so far
2025-02-26 19:40:54,826 - INFO - Received 6700 messages so far
2025-02-26 19:40:54,826 - INFO - Received 6800 messages so far
2025-02-26 19:40:54,826 - INFO - Received 6900 messages so far
2025-02-26 19:40:54,826 - INFO - Received 7000 messages so far
2025-02-26 19:40:54,826 - INFO - Received 7100 messages so far
2025-02-26 19:40:54,827 - INFO - Received 7200 messages so far
2025-02-26 19:40:54,827 - INFO - Received 7300 messages so far
2025-02-26 19:40:54,827 - INFO - Received 7400 messages so far
2025-02-26 19:40:54,827 - INFO - Received 7500 messages so far
2025-02-26 19:40:54,827 - INFO - Received 7600 messages so far
2025-02-26 19:40:54,828 - INFO - Received 7700 messages so far
2025-02-26 19:40:54,828 - INFO - Received 7800 messages so far
2025-02-26 19:40:54,828 - INFO - Received 7900 messages so far
2025-02-26 19:40:54,828 - INFO - Received 8000 messages so far
2025-02-26 19:40:54,828 - INFO - Received 8100 messages so far
2025-02-26 19:40:54,829 - INFO - Received 8200 messages so far
2025-02-26 19:40:54,829 - INFO - Received 8300 messages so far
2025-02-26 19:40:54,829 - INFO - Received 8400 messages so far
2025-02-26 19:40:54,829 - INFO - Received 8500 messages so far
2025-02-26 19:40:54,829 - INFO - Received 8600 messages so far
2025-02-26 19:40:54,830 - INFO - Received 8700 messages so far
2025-02-26 19:40:54,886 - INFO - Received 8800 messages so far
2025-02-26 19:40:54,886 - INFO - Received 8900 messages so far
2025-02-26 19:40:54,886 - INFO - Received 9000 messages so far
2025-02-26 19:40:54,886 - INFO - Received 9100 messages so far
2025-02-26 19:40:54,886 - INFO - Received 9200 messages so far
2025-02-26 19:40:54,887 - INFO - Received 9300 messages so far
2025-02-26 19:40:54,887 - INFO - Received 9400 messages so far
2025-02-26 19:40:54,887 - INFO - Received 9500 messages so far
2025-02-26 19:40:54,887 - INFO - Received 9600 messages so far
2025-02-26 19:40:54,887 - INFO - Received 9700 messages so far
2025-02-26 19:40:54,888 - INFO - Received 9800 messages so far
2025-02-26 19:40:54,888 - INFO - Received 9900 messages so far
2025-02-26 19:40:54,888 - INFO - Received 10000 messages so far
2025-02-26 19:40:54,888 - INFO - Total messages consumed: 10000
2025-02-26 19:40:54,977 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:54,981 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:54,981 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:54,981 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:54,981 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:54,989 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:54,992 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:54,992 - INFO - Number of columns: 66
2025-02-26 19:40:55,002 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7552        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005748     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2958        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4219        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9341        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6663        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.006053     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:55,002 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:55,033 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:55,078 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    6b77933b392d05f9              eb77933b392d05f9  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:55,079 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443.  5353.   133.   547.  1900.   134.    80.
    22.   135.    67.   123.     0.   138.   136. 21116. 21115.]
2025-02-26 19:40:55,080 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:55,085 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:55,086 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:55,086 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:55,088 - INFO - DataFrame shape after NA dropping: (905, 23)
2025-02-26 19:40:55,088 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:55,088 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:55,089 - INFO - X shape: (905, 21), y shape: (905,)
2025-02-26 19:40:55,089 - INFO - Label distribution in training data: {'DNS': 759, 'HTTPS': 131, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:55,090 - INFO - Training model...
2025-02-26 19:40:55,208 - INFO - Predicting on test data...
2025-02-26 19:40:55,222 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 153.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.3333333333333333,
    "f1-score": 0.5,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.9259259259259259,
    "recall": 1.0,
    "f1-score": 0.9615384615384616,
    "support": 25.0
  },
  "accuracy": 0.988950276243094,
  "macro avg": {
    "precision": 0.9753086419753086,
    "recall": 0.7777777777777777,
    "f1-score": 0.8205128205128206,
    "support": 181.0
  },
  "weighted avg": {
    "precision": 0.9897687742991611,
    "recall": 0.988950276243094,
    "f1-score": 0.9864003399915002,
    "support": 181.0
  }
}
2025-02-26 19:40:55,230 - INFO - Saved processed data locally to processed_data_20250226_194055.csv
2025-02-26 19:40:55,232 - INFO - JSON data size: 445177 bytes
2025-02-26 19:40:55,232 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:55,233 - INFO - Data sent successfully!
2025-02-26 19:40:55,233 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:55,234 - INFO - Starting data processing
2025-02-26 19:40:55,234 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:55,234 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:55,235 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:55,236 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:55,337 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:55,338 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:55,338 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:55,338 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:55,338 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:55,339 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:55,339 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:55,339 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:55,339 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:55,494 - INFO - Received 100 messages so far
2025-02-26 19:40:55,494 - INFO - Received 200 messages so far
2025-02-26 19:40:55,494 - INFO - Received 300 messages so far
2025-02-26 19:40:55,494 - INFO - Received 400 messages so far
2025-02-26 19:40:55,495 - INFO - Received 500 messages so far
2025-02-26 19:40:55,495 - INFO - Received 600 messages so far
2025-02-26 19:40:55,495 - INFO - Received 700 messages so far
2025-02-26 19:40:55,495 - INFO - Received 800 messages so far
2025-02-26 19:40:55,495 - INFO - Received 900 messages so far
2025-02-26 19:40:55,496 - INFO - Received 1000 messages so far
2025-02-26 19:40:55,496 - INFO - Received 1100 messages so far
2025-02-26 19:40:55,496 - INFO - Received 1200 messages so far
2025-02-26 19:40:55,496 - INFO - Received 1300 messages so far
2025-02-26 19:40:55,496 - INFO - Received 1400 messages so far
2025-02-26 19:40:55,496 - INFO - Received 1500 messages so far
2025-02-26 19:40:55,497 - INFO - Received 1600 messages so far
2025-02-26 19:40:55,497 - INFO - Received 1700 messages so far
2025-02-26 19:40:55,497 - INFO - Received 1800 messages so far
2025-02-26 19:40:55,497 - INFO - Received 1900 messages so far
2025-02-26 19:40:55,497 - INFO - Received 2000 messages so far
2025-02-26 19:40:55,498 - INFO - Received 2100 messages so far
2025-02-26 19:40:55,498 - INFO - Received 2200 messages so far
2025-02-26 19:40:55,498 - INFO - Received 2300 messages so far
2025-02-26 19:40:55,498 - INFO - Received 2400 messages so far
2025-02-26 19:40:55,498 - INFO - Received 2500 messages so far
2025-02-26 19:40:55,499 - INFO - Received 2600 messages so far
2025-02-26 19:40:55,499 - INFO - Received 2700 messages so far
2025-02-26 19:40:55,499 - INFO - Received 2800 messages so far
2025-02-26 19:40:55,499 - INFO - Received 2900 messages so far
2025-02-26 19:40:55,499 - INFO - Received 3000 messages so far
2025-02-26 19:40:55,500 - INFO - Received 3100 messages so far
2025-02-26 19:40:55,500 - INFO - Received 3200 messages so far
2025-02-26 19:40:55,500 - INFO - Received 3300 messages so far
2025-02-26 19:40:55,500 - INFO - Received 3400 messages so far
2025-02-26 19:40:55,500 - INFO - Received 3500 messages so far
2025-02-26 19:40:55,501 - INFO - Received 3600 messages so far
2025-02-26 19:40:55,501 - INFO - Received 3700 messages so far
2025-02-26 19:40:55,501 - INFO - Received 3800 messages so far
2025-02-26 19:40:55,501 - INFO - Received 3900 messages so far
2025-02-26 19:40:55,501 - INFO - Received 4000 messages so far
2025-02-26 19:40:55,502 - INFO - Received 4100 messages so far
2025-02-26 19:40:55,556 - INFO - Received 4200 messages so far
2025-02-26 19:40:55,557 - INFO - Received 4300 messages so far
2025-02-26 19:40:55,557 - INFO - Received 4400 messages so far
2025-02-26 19:40:55,557 - INFO - Received 4500 messages so far
2025-02-26 19:40:55,557 - INFO - Received 4600 messages so far
2025-02-26 19:40:55,558 - INFO - Received 4700 messages so far
2025-02-26 19:40:55,558 - INFO - Received 4800 messages so far
2025-02-26 19:40:55,558 - INFO - Received 4900 messages so far
2025-02-26 19:40:55,558 - INFO - Received 5000 messages so far
2025-02-26 19:40:55,558 - INFO - Received 5100 messages so far
2025-02-26 19:40:55,559 - INFO - Received 5200 messages so far
2025-02-26 19:40:55,559 - INFO - Received 5300 messages so far
2025-02-26 19:40:55,559 - INFO - Received 5400 messages so far
2025-02-26 19:40:55,559 - INFO - Received 5500 messages so far
2025-02-26 19:40:55,559 - INFO - Received 5600 messages so far
2025-02-26 19:40:55,560 - INFO - Received 5700 messages so far
2025-02-26 19:40:55,560 - INFO - Received 5800 messages so far
2025-02-26 19:40:55,560 - INFO - Received 5900 messages so far
2025-02-26 19:40:55,560 - INFO - Received 6000 messages so far
2025-02-26 19:40:55,560 - INFO - Received 6100 messages so far
2025-02-26 19:40:55,561 - INFO - Received 6200 messages so far
2025-02-26 19:40:55,561 - INFO - Received 6300 messages so far
2025-02-26 19:40:55,561 - INFO - Received 6400 messages so far
2025-02-26 19:40:55,561 - INFO - Received 6500 messages so far
2025-02-26 19:40:55,561 - INFO - Received 6600 messages so far
2025-02-26 19:40:55,561 - INFO - Received 6700 messages so far
2025-02-26 19:40:55,562 - INFO - Received 6800 messages so far
2025-02-26 19:40:55,562 - INFO - Received 6900 messages so far
2025-02-26 19:40:55,562 - INFO - Received 7000 messages so far
2025-02-26 19:40:55,562 - INFO - Received 7100 messages so far
2025-02-26 19:40:55,562 - INFO - Received 7200 messages so far
2025-02-26 19:40:55,563 - INFO - Received 7300 messages so far
2025-02-26 19:40:55,563 - INFO - Received 7400 messages so far
2025-02-26 19:40:55,563 - INFO - Received 7500 messages so far
2025-02-26 19:40:55,563 - INFO - Received 7600 messages so far
2025-02-26 19:40:55,563 - INFO - Received 7700 messages so far
2025-02-26 19:40:55,564 - INFO - Received 7800 messages so far
2025-02-26 19:40:55,564 - INFO - Received 7900 messages so far
2025-02-26 19:40:55,564 - INFO - Received 8000 messages so far
2025-02-26 19:40:55,564 - INFO - Received 8100 messages so far
2025-02-26 19:40:55,564 - INFO - Received 8200 messages so far
2025-02-26 19:40:55,565 - INFO - Received 8300 messages so far
2025-02-26 19:40:55,565 - INFO - Received 8400 messages so far
2025-02-26 19:40:55,565 - INFO - Received 8500 messages so far
2025-02-26 19:40:55,565 - INFO - Received 8600 messages so far
2025-02-26 19:40:55,566 - INFO - Received 8700 messages so far
2025-02-26 19:40:55,670 - INFO - Received 8800 messages so far
2025-02-26 19:40:55,670 - INFO - Received 8900 messages so far
2025-02-26 19:40:55,670 - INFO - Received 9000 messages so far
2025-02-26 19:40:55,670 - INFO - Received 9100 messages so far
2025-02-26 19:40:55,671 - INFO - Received 9200 messages so far
2025-02-26 19:40:55,671 - INFO - Received 9300 messages so far
2025-02-26 19:40:55,671 - INFO - Received 9400 messages so far
2025-02-26 19:40:55,671 - INFO - Received 9500 messages so far
2025-02-26 19:40:55,671 - INFO - Received 9600 messages so far
2025-02-26 19:40:55,672 - INFO - Received 9700 messages so far
2025-02-26 19:40:55,672 - INFO - Received 9800 messages so far
2025-02-26 19:40:55,672 - INFO - Received 9900 messages so far
2025-02-26 19:40:55,672 - INFO - Received 10000 messages so far
2025-02-26 19:40:55,672 - INFO - Total messages consumed: 10000
2025-02-26 19:40:55,762 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:55,766 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:55,766 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:55,766 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:55,767 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:55,774 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:55,777 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:55,778 - INFO - Number of columns: 66
2025-02-26 19:40:55,789 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                uid  id.orig_p       rtt                              query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                                                              answers           TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
1521        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                  NaN            NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7246     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740119e+09      NaN  NaN     NaN  CVDX41TcZHDhKyiT5    50960.0       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                  NaN            NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000184     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1279        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                  NaN            NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4150       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740119e+09      NaN  NaN     NaN  C8Mi83XdruMtMImhh    55725.0  0.002422  usc-word-edit.officeapps.live.com     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  True  0.0  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [141.0, 34.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5357        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                  NaN            NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:55,789 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:55,819 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:55,863 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version           client_initial_dcid client_scid                   server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                            19          19                            17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                            19           1                            17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13  e66e05fe576deac0adb1fa816be6              e545068f19ba9a27fe6c1bcaec57  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                             1          19                             1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:55,863 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   443.  5353.   136.   134.  1900.    22.   135.
    80.   123.   133.     0. 21115.    67.   138.   547. 21116.]
2025-02-26 19:40:55,865 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:55,870 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:55,871 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:55,871 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:55,873 - INFO - DataFrame shape after NA dropping: (887, 23)
2025-02-26 19:40:55,873 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:55,874 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:55,874 - INFO - X shape: (887, 21), y shape: (887,)
2025-02-26 19:40:55,874 - INFO - Label distribution in training data: {'DNS': 740, 'HTTPS': 132, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:55,875 - INFO - Training model...
2025-02-26 19:40:55,990 - INFO - Predicting on test data...
2025-02-26 19:40:56,004 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 159.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 18.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 178.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 178.0
  }
}
2025-02-26 19:40:56,011 - INFO - Saved processed data locally to processed_data_20250226_194056.csv
2025-02-26 19:40:56,013 - INFO - JSON data size: 436665 bytes
2025-02-26 19:40:56,013 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:56,014 - INFO - Data sent successfully!
2025-02-26 19:40:56,014 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:56,015 - INFO - Starting data processing
2025-02-26 19:40:56,015 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:56,015 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:56,016 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:56,016 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:56,118 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:56,118 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:56,118 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:56,119 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:56,119 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:56,119 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:56,120 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:56,120 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:56,120 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:56,275 - INFO - Received 100 messages so far
2025-02-26 19:40:56,275 - INFO - Received 200 messages so far
2025-02-26 19:40:56,275 - INFO - Received 300 messages so far
2025-02-26 19:40:56,275 - INFO - Received 400 messages so far
2025-02-26 19:40:56,275 - INFO - Received 500 messages so far
2025-02-26 19:40:56,276 - INFO - Received 600 messages so far
2025-02-26 19:40:56,276 - INFO - Received 700 messages so far
2025-02-26 19:40:56,276 - INFO - Received 800 messages so far
2025-02-26 19:40:56,276 - INFO - Received 900 messages so far
2025-02-26 19:40:56,276 - INFO - Received 1000 messages so far
2025-02-26 19:40:56,277 - INFO - Received 1100 messages so far
2025-02-26 19:40:56,277 - INFO - Received 1200 messages so far
2025-02-26 19:40:56,277 - INFO - Received 1300 messages so far
2025-02-26 19:40:56,277 - INFO - Received 1400 messages so far
2025-02-26 19:40:56,277 - INFO - Received 1500 messages so far
2025-02-26 19:40:56,278 - INFO - Received 1600 messages so far
2025-02-26 19:40:56,278 - INFO - Received 1700 messages so far
2025-02-26 19:40:56,278 - INFO - Received 1800 messages so far
2025-02-26 19:40:56,278 - INFO - Received 1900 messages so far
2025-02-26 19:40:56,278 - INFO - Received 2000 messages so far
2025-02-26 19:40:56,279 - INFO - Received 2100 messages so far
2025-02-26 19:40:56,279 - INFO - Received 2200 messages so far
2025-02-26 19:40:56,279 - INFO - Received 2300 messages so far
2025-02-26 19:40:56,279 - INFO - Received 2400 messages so far
2025-02-26 19:40:56,279 - INFO - Received 2500 messages so far
2025-02-26 19:40:56,280 - INFO - Received 2600 messages so far
2025-02-26 19:40:56,280 - INFO - Received 2700 messages so far
2025-02-26 19:40:56,280 - INFO - Received 2800 messages so far
2025-02-26 19:40:56,280 - INFO - Received 2900 messages so far
2025-02-26 19:40:56,280 - INFO - Received 3000 messages so far
2025-02-26 19:40:56,281 - INFO - Received 3100 messages so far
2025-02-26 19:40:56,281 - INFO - Received 3200 messages so far
2025-02-26 19:40:56,281 - INFO - Received 3300 messages so far
2025-02-26 19:40:56,281 - INFO - Received 3400 messages so far
2025-02-26 19:40:56,281 - INFO - Received 3500 messages so far
2025-02-26 19:40:56,281 - INFO - Received 3600 messages so far
2025-02-26 19:40:56,282 - INFO - Received 3700 messages so far
2025-02-26 19:40:56,282 - INFO - Received 3800 messages so far
2025-02-26 19:40:56,282 - INFO - Received 3900 messages so far
2025-02-26 19:40:56,282 - INFO - Received 4000 messages so far
2025-02-26 19:40:56,283 - INFO - Received 4100 messages so far
2025-02-26 19:40:56,336 - INFO - Received 4200 messages so far
2025-02-26 19:40:56,336 - INFO - Received 4300 messages so far
2025-02-26 19:40:56,336 - INFO - Received 4400 messages so far
2025-02-26 19:40:56,336 - INFO - Received 4500 messages so far
2025-02-26 19:40:56,337 - INFO - Received 4600 messages so far
2025-02-26 19:40:56,337 - INFO - Received 4700 messages so far
2025-02-26 19:40:56,337 - INFO - Received 4800 messages so far
2025-02-26 19:40:56,337 - INFO - Received 4900 messages so far
2025-02-26 19:40:56,337 - INFO - Received 5000 messages so far
2025-02-26 19:40:56,338 - INFO - Received 5100 messages so far
2025-02-26 19:40:56,338 - INFO - Received 5200 messages so far
2025-02-26 19:40:56,338 - INFO - Received 5300 messages so far
2025-02-26 19:40:56,338 - INFO - Received 5400 messages so far
2025-02-26 19:40:56,338 - INFO - Received 5500 messages so far
2025-02-26 19:40:56,339 - INFO - Received 5600 messages so far
2025-02-26 19:40:56,339 - INFO - Received 5700 messages so far
2025-02-26 19:40:56,339 - INFO - Received 5800 messages so far
2025-02-26 19:40:56,339 - INFO - Received 5900 messages so far
2025-02-26 19:40:56,339 - INFO - Received 6000 messages so far
2025-02-26 19:40:56,340 - INFO - Received 6100 messages so far
2025-02-26 19:40:56,340 - INFO - Received 6200 messages so far
2025-02-26 19:40:56,340 - INFO - Received 6300 messages so far
2025-02-26 19:40:56,340 - INFO - Received 6400 messages so far
2025-02-26 19:40:56,340 - INFO - Received 6500 messages so far
2025-02-26 19:40:56,341 - INFO - Received 6600 messages so far
2025-02-26 19:40:56,341 - INFO - Received 6700 messages so far
2025-02-26 19:40:56,341 - INFO - Received 6800 messages so far
2025-02-26 19:40:56,341 - INFO - Received 6900 messages so far
2025-02-26 19:40:56,341 - INFO - Received 7000 messages so far
2025-02-26 19:40:56,341 - INFO - Received 7100 messages so far
2025-02-26 19:40:56,342 - INFO - Received 7200 messages so far
2025-02-26 19:40:56,342 - INFO - Received 7300 messages so far
2025-02-26 19:40:56,342 - INFO - Received 7400 messages so far
2025-02-26 19:40:56,342 - INFO - Received 7500 messages so far
2025-02-26 19:40:56,342 - INFO - Received 7600 messages so far
2025-02-26 19:40:56,343 - INFO - Received 7700 messages so far
2025-02-26 19:40:56,343 - INFO - Received 7800 messages so far
2025-02-26 19:40:56,343 - INFO - Received 7900 messages so far
2025-02-26 19:40:56,343 - INFO - Received 8000 messages so far
2025-02-26 19:40:56,343 - INFO - Received 8100 messages so far
2025-02-26 19:40:56,344 - INFO - Received 8200 messages so far
2025-02-26 19:40:56,344 - INFO - Received 8300 messages so far
2025-02-26 19:40:56,344 - INFO - Received 8400 messages so far
2025-02-26 19:40:56,344 - INFO - Received 8500 messages so far
2025-02-26 19:40:56,344 - INFO - Received 8600 messages so far
2025-02-26 19:40:56,345 - INFO - Received 8700 messages so far
2025-02-26 19:40:56,400 - INFO - Received 8800 messages so far
2025-02-26 19:40:56,400 - INFO - Received 8900 messages so far
2025-02-26 19:40:56,400 - INFO - Received 9000 messages so far
2025-02-26 19:40:56,400 - INFO - Received 9100 messages so far
2025-02-26 19:40:56,401 - INFO - Received 9200 messages so far
2025-02-26 19:40:56,401 - INFO - Received 9300 messages so far
2025-02-26 19:40:56,401 - INFO - Received 9400 messages so far
2025-02-26 19:40:56,401 - INFO - Received 9500 messages so far
2025-02-26 19:40:56,401 - INFO - Received 9600 messages so far
2025-02-26 19:40:56,402 - INFO - Received 9700 messages so far
2025-02-26 19:40:56,402 - INFO - Received 9800 messages so far
2025-02-26 19:40:56,402 - INFO - Received 9900 messages so far
2025-02-26 19:40:56,402 - INFO - Received 10000 messages so far
2025-02-26 19:40:56,402 - INFO - Total messages consumed: 10000
2025-02-26 19:40:56,490 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:56,494 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:56,494 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:56,494 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:56,494 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:56,502 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:56,505 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:56,505 - INFO - Number of columns: 66
2025-02-26 19:40:56,515 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
352         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3189        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5513        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7349        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8894        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:56,515 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:56,543 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:56,585 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    1b03fbdb1202008c              fb03fbdb1202008c  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:56,585 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   443.  1900.  5353.    80. 21116.   136. 21115.
   133.   134.   547.   135.   123.     0.   138.    67.    22.]
2025-02-26 19:40:56,586 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:56,591 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:56,592 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:56,592 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:56,595 - INFO - DataFrame shape after NA dropping: (816, 23)
2025-02-26 19:40:56,595 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:56,595 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:56,595 - INFO - X shape: (816, 21), y shape: (816,)
2025-02-26 19:40:56,595 - INFO - Label distribution in training data: {'DNS': 680, 'HTTPS': 122, 'HTTP': 13, 'SSH': 1}
2025-02-26 19:40:56,596 - INFO - Training model...
2025-02-26 19:40:56,698 - INFO - Predicting on test data...
2025-02-26 19:40:56,711 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 139.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 25.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 164.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 164.0
  }
}
2025-02-26 19:40:56,718 - INFO - Saved processed data locally to processed_data_20250226_194056.csv
2025-02-26 19:40:56,720 - INFO - JSON data size: 400272 bytes
2025-02-26 19:40:56,720 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:56,721 - INFO - Data sent successfully!
2025-02-26 19:40:56,721 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:56,722 - INFO - Starting data processing
2025-02-26 19:40:56,722 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:56,722 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:56,723 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:56,723 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:56,825 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:56,825 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:56,825 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:56,825 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:56,825 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:56,826 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:56,826 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:56,827 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:56,827 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:57,026 - INFO - Received 100 messages so far
2025-02-26 19:40:57,027 - INFO - Received 200 messages so far
2025-02-26 19:40:57,027 - INFO - Received 300 messages so far
2025-02-26 19:40:57,027 - INFO - Received 400 messages so far
2025-02-26 19:40:57,027 - INFO - Received 500 messages so far
2025-02-26 19:40:57,028 - INFO - Received 600 messages so far
2025-02-26 19:40:57,028 - INFO - Received 700 messages so far
2025-02-26 19:40:57,028 - INFO - Received 800 messages so far
2025-02-26 19:40:57,028 - INFO - Received 900 messages so far
2025-02-26 19:40:57,028 - INFO - Received 1000 messages so far
2025-02-26 19:40:57,029 - INFO - Received 1100 messages so far
2025-02-26 19:40:57,029 - INFO - Received 1200 messages so far
2025-02-26 19:40:57,029 - INFO - Received 1300 messages so far
2025-02-26 19:40:57,029 - INFO - Received 1400 messages so far
2025-02-26 19:40:57,029 - INFO - Received 1500 messages so far
2025-02-26 19:40:57,030 - INFO - Received 1600 messages so far
2025-02-26 19:40:57,030 - INFO - Received 1700 messages so far
2025-02-26 19:40:57,030 - INFO - Received 1800 messages so far
2025-02-26 19:40:57,030 - INFO - Received 1900 messages so far
2025-02-26 19:40:57,030 - INFO - Received 2000 messages so far
2025-02-26 19:40:57,031 - INFO - Received 2100 messages so far
2025-02-26 19:40:57,031 - INFO - Received 2200 messages so far
2025-02-26 19:40:57,031 - INFO - Received 2300 messages so far
2025-02-26 19:40:57,031 - INFO - Received 2400 messages so far
2025-02-26 19:40:57,031 - INFO - Received 2500 messages so far
2025-02-26 19:40:57,032 - INFO - Received 2600 messages so far
2025-02-26 19:40:57,032 - INFO - Received 2700 messages so far
2025-02-26 19:40:57,032 - INFO - Received 2800 messages so far
2025-02-26 19:40:57,032 - INFO - Received 2900 messages so far
2025-02-26 19:40:57,032 - INFO - Received 3000 messages so far
2025-02-26 19:40:57,033 - INFO - Received 3100 messages so far
2025-02-26 19:40:57,033 - INFO - Received 3200 messages so far
2025-02-26 19:40:57,033 - INFO - Received 3300 messages so far
2025-02-26 19:40:57,033 - INFO - Received 3400 messages so far
2025-02-26 19:40:57,033 - INFO - Received 3500 messages so far
2025-02-26 19:40:57,033 - INFO - Received 3600 messages so far
2025-02-26 19:40:57,034 - INFO - Received 3700 messages so far
2025-02-26 19:40:57,034 - INFO - Received 3800 messages so far
2025-02-26 19:40:57,034 - INFO - Received 3900 messages so far
2025-02-26 19:40:57,034 - INFO - Received 4000 messages so far
2025-02-26 19:40:57,035 - INFO - Received 4100 messages so far
2025-02-26 19:40:57,088 - INFO - Received 4200 messages so far
2025-02-26 19:40:57,089 - INFO - Received 4300 messages so far
2025-02-26 19:40:57,089 - INFO - Received 4400 messages so far
2025-02-26 19:40:57,089 - INFO - Received 4500 messages so far
2025-02-26 19:40:57,089 - INFO - Received 4600 messages so far
2025-02-26 19:40:57,089 - INFO - Received 4700 messages so far
2025-02-26 19:40:57,090 - INFO - Received 4800 messages so far
2025-02-26 19:40:57,090 - INFO - Received 4900 messages so far
2025-02-26 19:40:57,090 - INFO - Received 5000 messages so far
2025-02-26 19:40:57,090 - INFO - Received 5100 messages so far
2025-02-26 19:40:57,090 - INFO - Received 5200 messages so far
2025-02-26 19:40:57,091 - INFO - Received 5300 messages so far
2025-02-26 19:40:57,091 - INFO - Received 5400 messages so far
2025-02-26 19:40:57,091 - INFO - Received 5500 messages so far
2025-02-26 19:40:57,091 - INFO - Received 5600 messages so far
2025-02-26 19:40:57,091 - INFO - Received 5700 messages so far
2025-02-26 19:40:57,091 - INFO - Received 5800 messages so far
2025-02-26 19:40:57,092 - INFO - Received 5900 messages so far
2025-02-26 19:40:57,092 - INFO - Received 6000 messages so far
2025-02-26 19:40:57,092 - INFO - Received 6100 messages so far
2025-02-26 19:40:57,092 - INFO - Received 6200 messages so far
2025-02-26 19:40:57,092 - INFO - Received 6300 messages so far
2025-02-26 19:40:57,093 - INFO - Received 6400 messages so far
2025-02-26 19:40:57,093 - INFO - Received 6500 messages so far
2025-02-26 19:40:57,093 - INFO - Received 6600 messages so far
2025-02-26 19:40:57,093 - INFO - Received 6700 messages so far
2025-02-26 19:40:57,093 - INFO - Received 6800 messages so far
2025-02-26 19:40:57,094 - INFO - Received 6900 messages so far
2025-02-26 19:40:57,094 - INFO - Received 7000 messages so far
2025-02-26 19:40:57,094 - INFO - Received 7100 messages so far
2025-02-26 19:40:57,094 - INFO - Received 7200 messages so far
2025-02-26 19:40:57,094 - INFO - Received 7300 messages so far
2025-02-26 19:40:57,095 - INFO - Received 7400 messages so far
2025-02-26 19:40:57,095 - INFO - Received 7500 messages so far
2025-02-26 19:40:57,095 - INFO - Received 7600 messages so far
2025-02-26 19:40:57,095 - INFO - Received 7700 messages so far
2025-02-26 19:40:57,095 - INFO - Received 7800 messages so far
2025-02-26 19:40:57,096 - INFO - Received 7900 messages so far
2025-02-26 19:40:57,096 - INFO - Received 8000 messages so far
2025-02-26 19:40:57,096 - INFO - Received 8100 messages so far
2025-02-26 19:40:57,096 - INFO - Received 8200 messages so far
2025-02-26 19:40:57,096 - INFO - Received 8300 messages so far
2025-02-26 19:40:57,096 - INFO - Received 8400 messages so far
2025-02-26 19:40:57,097 - INFO - Received 8500 messages so far
2025-02-26 19:40:57,097 - INFO - Received 8600 messages so far
2025-02-26 19:40:57,097 - INFO - Received 8700 messages so far
2025-02-26 19:40:57,152 - INFO - Received 8800 messages so far
2025-02-26 19:40:57,153 - INFO - Received 8900 messages so far
2025-02-26 19:40:57,153 - INFO - Received 9000 messages so far
2025-02-26 19:40:57,153 - INFO - Received 9100 messages so far
2025-02-26 19:40:57,153 - INFO - Received 9200 messages so far
2025-02-26 19:40:57,153 - INFO - Received 9300 messages so far
2025-02-26 19:40:57,154 - INFO - Received 9400 messages so far
2025-02-26 19:40:57,154 - INFO - Received 9500 messages so far
2025-02-26 19:40:57,154 - INFO - Received 9600 messages so far
2025-02-26 19:40:57,154 - INFO - Received 9700 messages so far
2025-02-26 19:40:57,154 - INFO - Received 9800 messages so far
2025-02-26 19:40:57,154 - INFO - Received 9900 messages so far
2025-02-26 19:40:57,155 - INFO - Received 10000 messages so far
2025-02-26 19:40:57,155 - INFO - Total messages consumed: 10000
2025-02-26 19:40:57,241 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:57,245 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:57,245 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:57,245 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:57,245 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:57,253 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:57,256 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:57,256 - INFO - Number of columns: 66
2025-02-26 19:40:57,267 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3678        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2176       53.0  192.168.1.3  192.168.1.1   udp        52.0       112.0  1.740118e+09      NaN  NaN     dns  CGmhcc3D5kdRRgKjRk    39356.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           80.0        1.0          140.0      17.0  0.001427     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3811        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9073        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7546        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:57,267 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:57,297 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:57,340 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    56c8fcf4a1052fc6              f6c8fcf4a1052fc6  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:57,341 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.   133.  9092.   443.  5353.  1900.   123.   136.    80.
   547.   138.     0.    22. 21116.   134. 21115.    67.   135.]
2025-02-26 19:40:57,342 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:57,347 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:57,348 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:57,348 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:57,350 - INFO - DataFrame shape after NA dropping: (905, 23)
2025-02-26 19:40:57,350 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:57,350 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:57,351 - INFO - X shape: (905, 21), y shape: (905,)
2025-02-26 19:40:57,351 - INFO - Label distribution in training data: {'DNS': 757, 'HTTPS': 133, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:57,352 - INFO - Training model...
2025-02-26 19:40:57,465 - INFO - Predicting on test data...
2025-02-26 19:40:57,479 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 147.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 30.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 181.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 181.0
  }
}
2025-02-26 19:40:57,486 - INFO - Saved processed data locally to processed_data_20250226_194057.csv
2025-02-26 19:40:57,489 - INFO - JSON data size: 443404 bytes
2025-02-26 19:40:57,489 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:57,489 - INFO - Data sent successfully!
2025-02-26 19:40:57,489 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:57,490 - INFO - Starting data processing
2025-02-26 19:40:57,490 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:57,491 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:57,491 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:57,491 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:57,593 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:57,593 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:57,593 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:57,593 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:57,594 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:57,594 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:57,595 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:57,595 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:57,595 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:57,748 - INFO - Received 100 messages so far
2025-02-26 19:40:57,748 - INFO - Received 200 messages so far
2025-02-26 19:40:57,749 - INFO - Received 300 messages so far
2025-02-26 19:40:57,749 - INFO - Received 400 messages so far
2025-02-26 19:40:57,749 - INFO - Received 500 messages so far
2025-02-26 19:40:57,749 - INFO - Received 600 messages so far
2025-02-26 19:40:57,749 - INFO - Received 700 messages so far
2025-02-26 19:40:57,750 - INFO - Received 800 messages so far
2025-02-26 19:40:57,750 - INFO - Received 900 messages so far
2025-02-26 19:40:57,750 - INFO - Received 1000 messages so far
2025-02-26 19:40:57,750 - INFO - Received 1100 messages so far
2025-02-26 19:40:57,750 - INFO - Received 1200 messages so far
2025-02-26 19:40:57,751 - INFO - Received 1300 messages so far
2025-02-26 19:40:57,751 - INFO - Received 1400 messages so far
2025-02-26 19:40:57,751 - INFO - Received 1500 messages so far
2025-02-26 19:40:57,751 - INFO - Received 1600 messages so far
2025-02-26 19:40:57,751 - INFO - Received 1700 messages so far
2025-02-26 19:40:57,752 - INFO - Received 1800 messages so far
2025-02-26 19:40:57,752 - INFO - Received 1900 messages so far
2025-02-26 19:40:57,752 - INFO - Received 2000 messages so far
2025-02-26 19:40:57,752 - INFO - Received 2100 messages so far
2025-02-26 19:40:57,752 - INFO - Received 2200 messages so far
2025-02-26 19:40:57,752 - INFO - Received 2300 messages so far
2025-02-26 19:40:57,753 - INFO - Received 2400 messages so far
2025-02-26 19:40:57,753 - INFO - Received 2500 messages so far
2025-02-26 19:40:57,753 - INFO - Received 2600 messages so far
2025-02-26 19:40:57,753 - INFO - Received 2700 messages so far
2025-02-26 19:40:57,753 - INFO - Received 2800 messages so far
2025-02-26 19:40:57,754 - INFO - Received 2900 messages so far
2025-02-26 19:40:57,754 - INFO - Received 3000 messages so far
2025-02-26 19:40:57,754 - INFO - Received 3100 messages so far
2025-02-26 19:40:57,754 - INFO - Received 3200 messages so far
2025-02-26 19:40:57,754 - INFO - Received 3300 messages so far
2025-02-26 19:40:57,755 - INFO - Received 3400 messages so far
2025-02-26 19:40:57,755 - INFO - Received 3500 messages so far
2025-02-26 19:40:57,755 - INFO - Received 3600 messages so far
2025-02-26 19:40:57,755 - INFO - Received 3700 messages so far
2025-02-26 19:40:57,755 - INFO - Received 3800 messages so far
2025-02-26 19:40:57,756 - INFO - Received 3900 messages so far
2025-02-26 19:40:57,756 - INFO - Received 4000 messages so far
2025-02-26 19:40:57,756 - INFO - Received 4100 messages so far
2025-02-26 19:40:57,808 - INFO - Received 4200 messages so far
2025-02-26 19:40:57,808 - INFO - Received 4300 messages so far
2025-02-26 19:40:57,808 - INFO - Received 4400 messages so far
2025-02-26 19:40:57,808 - INFO - Received 4500 messages so far
2025-02-26 19:40:57,809 - INFO - Received 4600 messages so far
2025-02-26 19:40:57,809 - INFO - Received 4700 messages so far
2025-02-26 19:40:57,809 - INFO - Received 4800 messages so far
2025-02-26 19:40:57,809 - INFO - Received 4900 messages so far
2025-02-26 19:40:57,809 - INFO - Received 5000 messages so far
2025-02-26 19:40:57,810 - INFO - Received 5100 messages so far
2025-02-26 19:40:57,810 - INFO - Received 5200 messages so far
2025-02-26 19:40:57,810 - INFO - Received 5300 messages so far
2025-02-26 19:40:57,810 - INFO - Received 5400 messages so far
2025-02-26 19:40:57,810 - INFO - Received 5500 messages so far
2025-02-26 19:40:57,811 - INFO - Received 5600 messages so far
2025-02-26 19:40:57,811 - INFO - Received 5700 messages so far
2025-02-26 19:40:57,811 - INFO - Received 5800 messages so far
2025-02-26 19:40:57,811 - INFO - Received 5900 messages so far
2025-02-26 19:40:57,811 - INFO - Received 6000 messages so far
2025-02-26 19:40:57,812 - INFO - Received 6100 messages so far
2025-02-26 19:40:57,812 - INFO - Received 6200 messages so far
2025-02-26 19:40:57,812 - INFO - Received 6300 messages so far
2025-02-26 19:40:57,812 - INFO - Received 6400 messages so far
2025-02-26 19:40:57,812 - INFO - Received 6500 messages so far
2025-02-26 19:40:57,813 - INFO - Received 6600 messages so far
2025-02-26 19:40:57,813 - INFO - Received 6700 messages so far
2025-02-26 19:40:57,813 - INFO - Received 6800 messages so far
2025-02-26 19:40:57,813 - INFO - Received 6900 messages so far
2025-02-26 19:40:57,813 - INFO - Received 7000 messages so far
2025-02-26 19:40:57,813 - INFO - Received 7100 messages so far
2025-02-26 19:40:57,814 - INFO - Received 7200 messages so far
2025-02-26 19:40:57,814 - INFO - Received 7300 messages so far
2025-02-26 19:40:57,814 - INFO - Received 7400 messages so far
2025-02-26 19:40:57,814 - INFO - Received 7500 messages so far
2025-02-26 19:40:57,814 - INFO - Received 7600 messages so far
2025-02-26 19:40:57,815 - INFO - Received 7700 messages so far
2025-02-26 19:40:57,815 - INFO - Received 7800 messages so far
2025-02-26 19:40:57,815 - INFO - Received 7900 messages so far
2025-02-26 19:40:57,815 - INFO - Received 8000 messages so far
2025-02-26 19:40:57,815 - INFO - Received 8100 messages so far
2025-02-26 19:40:57,816 - INFO - Received 8200 messages so far
2025-02-26 19:40:57,816 - INFO - Received 8300 messages so far
2025-02-26 19:40:57,816 - INFO - Received 8400 messages so far
2025-02-26 19:40:57,816 - INFO - Received 8500 messages so far
2025-02-26 19:40:57,816 - INFO - Received 8600 messages so far
2025-02-26 19:40:57,817 - INFO - Received 8700 messages so far
2025-02-26 19:40:57,907 - INFO - Received 8800 messages so far
2025-02-26 19:40:57,908 - INFO - Received 8900 messages so far
2025-02-26 19:40:57,908 - INFO - Received 9000 messages so far
2025-02-26 19:40:57,908 - INFO - Received 9100 messages so far
2025-02-26 19:40:57,908 - INFO - Received 9200 messages so far
2025-02-26 19:40:57,908 - INFO - Received 9300 messages so far
2025-02-26 19:40:57,909 - INFO - Received 9400 messages so far
2025-02-26 19:40:57,909 - INFO - Received 9500 messages so far
2025-02-26 19:40:57,909 - INFO - Received 9600 messages so far
2025-02-26 19:40:57,909 - INFO - Received 9700 messages so far
2025-02-26 19:40:57,909 - INFO - Received 9800 messages so far
2025-02-26 19:40:57,910 - INFO - Received 9900 messages so far
2025-02-26 19:40:57,910 - INFO - Received 10000 messages so far
2025-02-26 19:40:57,910 - INFO - Total messages consumed: 10000
2025-02-26 19:40:57,993 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:57,997 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:57,997 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:57,997 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:57,997 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:58,005 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:58,008 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:58,008 - INFO - Number of columns: 66
2025-02-26 19:40:58,019 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3327     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740119e+09      NaN  NaN     NaN  ClIgJb3WusvSgKJcDk    58246.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0   0.00014     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5972        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4345        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7445        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4362        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:58,019 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:58,049 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:58,093 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    8af1ef48d3289058              2336755850007c23  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:58,093 - INFO - Unique values in 'id.resp_p' before labeling: [ 9092.    nan    53.   443.   134.  5353.  1900.   123. 21116.   136.
   138.    22.   547.    67.   135.   133.    80.     0. 21115.]
2025-02-26 19:40:58,095 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:58,100 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:58,101 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:58,101 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:58,103 - INFO - DataFrame shape after NA dropping: (870, 23)
2025-02-26 19:40:58,103 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:58,103 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:58,104 - INFO - X shape: (870, 21), y shape: (870,)
2025-02-26 19:40:58,104 - INFO - Label distribution in training data: {'DNS': 726, 'HTTPS': 129, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:58,105 - INFO - Training model...
2025-02-26 19:40:58,219 - INFO - Predicting on test data...
2025-02-26 19:40:58,233 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 142.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 0.9333333333333333,
    "recall": 1.0,
    "f1-score": 0.9655172413793104,
    "support": 28.0
  },
  "accuracy": 0.9885057471264368,
  "macro avg": {
    "precision": 0.9777777777777779,
    "recall": 0.8333333333333334,
    "f1-score": 0.8773946360153256,
    "support": 174.0
  },
  "weighted avg": {
    "precision": 0.989272030651341,
    "recall": 0.9885057471264368,
    "f1-score": 0.9867882150878584,
    "support": 174.0
  }
}
2025-02-26 19:40:58,240 - INFO - Saved processed data locally to processed_data_20250226_194058.csv
2025-02-26 19:40:58,242 - INFO - JSON data size: 427918 bytes
2025-02-26 19:40:58,242 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:58,242 - INFO - Data sent successfully!
2025-02-26 19:40:58,242 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:58,243 - INFO - Starting data processing
2025-02-26 19:40:58,243 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:58,244 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:58,245 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:58,245 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:58,347 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:58,347 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:58,348 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:58,348 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:58,348 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:58,349 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:58,349 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:58,349 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:58,349 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:58,504 - INFO - Received 100 messages so far
2025-02-26 19:40:58,504 - INFO - Received 200 messages so far
2025-02-26 19:40:58,504 - INFO - Received 300 messages so far
2025-02-26 19:40:58,505 - INFO - Received 400 messages so far
2025-02-26 19:40:58,505 - INFO - Received 500 messages so far
2025-02-26 19:40:58,505 - INFO - Received 600 messages so far
2025-02-26 19:40:58,505 - INFO - Received 700 messages so far
2025-02-26 19:40:58,505 - INFO - Received 800 messages so far
2025-02-26 19:40:58,506 - INFO - Received 900 messages so far
2025-02-26 19:40:58,506 - INFO - Received 1000 messages so far
2025-02-26 19:40:58,506 - INFO - Received 1100 messages so far
2025-02-26 19:40:58,506 - INFO - Received 1200 messages so far
2025-02-26 19:40:58,506 - INFO - Received 1300 messages so far
2025-02-26 19:40:58,507 - INFO - Received 1400 messages so far
2025-02-26 19:40:58,507 - INFO - Received 1500 messages so far
2025-02-26 19:40:58,507 - INFO - Received 1600 messages so far
2025-02-26 19:40:58,507 - INFO - Received 1700 messages so far
2025-02-26 19:40:58,507 - INFO - Received 1800 messages so far
2025-02-26 19:40:58,507 - INFO - Received 1900 messages so far
2025-02-26 19:40:58,508 - INFO - Received 2000 messages so far
2025-02-26 19:40:58,508 - INFO - Received 2100 messages so far
2025-02-26 19:40:58,508 - INFO - Received 2200 messages so far
2025-02-26 19:40:58,508 - INFO - Received 2300 messages so far
2025-02-26 19:40:58,508 - INFO - Received 2400 messages so far
2025-02-26 19:40:58,509 - INFO - Received 2500 messages so far
2025-02-26 19:40:58,509 - INFO - Received 2600 messages so far
2025-02-26 19:40:58,509 - INFO - Received 2700 messages so far
2025-02-26 19:40:58,509 - INFO - Received 2800 messages so far
2025-02-26 19:40:58,509 - INFO - Received 2900 messages so far
2025-02-26 19:40:58,510 - INFO - Received 3000 messages so far
2025-02-26 19:40:58,510 - INFO - Received 3100 messages so far
2025-02-26 19:40:58,510 - INFO - Received 3200 messages so far
2025-02-26 19:40:58,510 - INFO - Received 3300 messages so far
2025-02-26 19:40:58,510 - INFO - Received 3400 messages so far
2025-02-26 19:40:58,511 - INFO - Received 3500 messages so far
2025-02-26 19:40:58,511 - INFO - Received 3600 messages so far
2025-02-26 19:40:58,511 - INFO - Received 3700 messages so far
2025-02-26 19:40:58,511 - INFO - Received 3800 messages so far
2025-02-26 19:40:58,511 - INFO - Received 3900 messages so far
2025-02-26 19:40:58,511 - INFO - Received 4000 messages so far
2025-02-26 19:40:58,512 - INFO - Received 4100 messages so far
2025-02-26 19:40:58,566 - INFO - Received 4200 messages so far
2025-02-26 19:40:58,567 - INFO - Received 4300 messages so far
2025-02-26 19:40:58,567 - INFO - Received 4400 messages so far
2025-02-26 19:40:58,567 - INFO - Received 4500 messages so far
2025-02-26 19:40:58,567 - INFO - Received 4600 messages so far
2025-02-26 19:40:58,567 - INFO - Received 4700 messages so far
2025-02-26 19:40:58,568 - INFO - Received 4800 messages so far
2025-02-26 19:40:58,568 - INFO - Received 4900 messages so far
2025-02-26 19:40:58,568 - INFO - Received 5000 messages so far
2025-02-26 19:40:58,568 - INFO - Received 5100 messages so far
2025-02-26 19:40:58,568 - INFO - Received 5200 messages so far
2025-02-26 19:40:58,569 - INFO - Received 5300 messages so far
2025-02-26 19:40:58,569 - INFO - Received 5400 messages so far
2025-02-26 19:40:58,569 - INFO - Received 5500 messages so far
2025-02-26 19:40:58,569 - INFO - Received 5600 messages so far
2025-02-26 19:40:58,569 - INFO - Received 5700 messages so far
2025-02-26 19:40:58,569 - INFO - Received 5800 messages so far
2025-02-26 19:40:58,570 - INFO - Received 5900 messages so far
2025-02-26 19:40:58,570 - INFO - Received 6000 messages so far
2025-02-26 19:40:58,570 - INFO - Received 6100 messages so far
2025-02-26 19:40:58,570 - INFO - Received 6200 messages so far
2025-02-26 19:40:58,570 - INFO - Received 6300 messages so far
2025-02-26 19:40:58,571 - INFO - Received 6400 messages so far
2025-02-26 19:40:58,571 - INFO - Received 6500 messages so far
2025-02-26 19:40:58,571 - INFO - Received 6600 messages so far
2025-02-26 19:40:58,571 - INFO - Received 6700 messages so far
2025-02-26 19:40:58,571 - INFO - Received 6800 messages so far
2025-02-26 19:40:58,572 - INFO - Received 6900 messages so far
2025-02-26 19:40:58,572 - INFO - Received 7000 messages so far
2025-02-26 19:40:58,572 - INFO - Received 7100 messages so far
2025-02-26 19:40:58,572 - INFO - Received 7200 messages so far
2025-02-26 19:40:58,572 - INFO - Received 7300 messages so far
2025-02-26 19:40:58,573 - INFO - Received 7400 messages so far
2025-02-26 19:40:58,573 - INFO - Received 7500 messages so far
2025-02-26 19:40:58,573 - INFO - Received 7600 messages so far
2025-02-26 19:40:58,573 - INFO - Received 7700 messages so far
2025-02-26 19:40:58,573 - INFO - Received 7800 messages so far
2025-02-26 19:40:58,573 - INFO - Received 7900 messages so far
2025-02-26 19:40:58,574 - INFO - Received 8000 messages so far
2025-02-26 19:40:58,574 - INFO - Received 8100 messages so far
2025-02-26 19:40:58,574 - INFO - Received 8200 messages so far
2025-02-26 19:40:58,574 - INFO - Received 8300 messages so far
2025-02-26 19:40:58,574 - INFO - Received 8400 messages so far
2025-02-26 19:40:58,575 - INFO - Received 8500 messages so far
2025-02-26 19:40:58,575 - INFO - Received 8600 messages so far
2025-02-26 19:40:58,575 - INFO - Received 8700 messages so far
2025-02-26 19:40:58,631 - INFO - Received 8800 messages so far
2025-02-26 19:40:58,632 - INFO - Received 8900 messages so far
2025-02-26 19:40:58,632 - INFO - Received 9000 messages so far
2025-02-26 19:40:58,632 - INFO - Received 9100 messages so far
2025-02-26 19:40:58,632 - INFO - Received 9200 messages so far
2025-02-26 19:40:58,632 - INFO - Received 9300 messages so far
2025-02-26 19:40:58,633 - INFO - Received 9400 messages so far
2025-02-26 19:40:58,633 - INFO - Received 9500 messages so far
2025-02-26 19:40:58,633 - INFO - Received 9600 messages so far
2025-02-26 19:40:58,633 - INFO - Received 9700 messages so far
2025-02-26 19:40:58,633 - INFO - Received 9800 messages so far
2025-02-26 19:40:58,634 - INFO - Received 9900 messages so far
2025-02-26 19:40:58,634 - INFO - Received 10000 messages so far
2025-02-26 19:40:58,634 - INFO - Total messages consumed: 10000
2025-02-26 19:40:58,722 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:58,726 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:58,726 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:58,726 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:58,726 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:58,734 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:58,737 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:58,737 - INFO - Number of columns: 66
2025-02-26 19:40:58,748 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                              query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                                                                                                                 answers                            TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7569       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740119e+09      NaN  NaN     NaN  CnJLRl3h0J0PhowKx9    51486.0  0.001457  usc-word-edit.officeapps.live.com     1.0  C_INTERNET    1.0          A    0.0    NOERROR  False  False  True  True  0.0  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net, wac-0003.wac-msedge.net, 52.108.8.12, 52.108.9.12]  [15.0, 27.0, 31.0, 19.0, 19.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3816        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                     NaN                             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8840        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                     NaN                             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2409        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                     NaN                             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6422        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                     NaN                             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.006795     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:58,748 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:58,778 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:58,822 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    376acab97e4aab30              f6c8fcf4a1052fc6  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:58,822 - INFO - Unique values in 'id.resp_p' before labeling: [   53.    nan  1900.  9092.   443.  5353.   134.    80. 21116.   135.
   138.   123.   547.     0. 21115.    67.   133.    22.   136.]
2025-02-26 19:40:58,824 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:58,828 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:58,830 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:58,830 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:58,832 - INFO - DataFrame shape after NA dropping: (743, 23)
2025-02-26 19:40:58,832 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:58,832 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:58,832 - INFO - X shape: (743, 21), y shape: (743,)
2025-02-26 19:40:58,833 - INFO - Label distribution in training data: {'DNS': 614, 'HTTPS': 116, 'HTTP': 12, 'SSH': 1}
2025-02-26 19:40:58,833 - INFO - Training model...
2025-02-26 19:40:58,943 - INFO - Predicting on test data...
2025-02-26 19:40:58,955 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 126.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 22.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 149.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 149.0
  }
}
2025-02-26 19:40:58,961 - INFO - Saved processed data locally to processed_data_20250226_194058.csv
2025-02-26 19:40:58,963 - INFO - JSON data size: 365478 bytes
2025-02-26 19:40:58,964 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:58,964 - INFO - Data sent successfully!
2025-02-26 19:40:58,964 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:58,965 - INFO - Starting data processing
2025-02-26 19:40:58,965 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:58,965 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:58,966 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:58,966 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:59,068 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:59,068 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:59,068 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:59,068 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:59,068 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:59,069 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:59,069 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:59,070 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:59,070 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:59,263 - INFO - Received 100 messages so far
2025-02-26 19:40:59,264 - INFO - Received 200 messages so far
2025-02-26 19:40:59,264 - INFO - Received 300 messages so far
2025-02-26 19:40:59,264 - INFO - Received 400 messages so far
2025-02-26 19:40:59,264 - INFO - Received 500 messages so far
2025-02-26 19:40:59,265 - INFO - Received 600 messages so far
2025-02-26 19:40:59,265 - INFO - Received 700 messages so far
2025-02-26 19:40:59,265 - INFO - Received 800 messages so far
2025-02-26 19:40:59,265 - INFO - Received 900 messages so far
2025-02-26 19:40:59,265 - INFO - Received 1000 messages so far
2025-02-26 19:40:59,265 - INFO - Received 1100 messages so far
2025-02-26 19:40:59,266 - INFO - Received 1200 messages so far
2025-02-26 19:40:59,266 - INFO - Received 1300 messages so far
2025-02-26 19:40:59,266 - INFO - Received 1400 messages so far
2025-02-26 19:40:59,266 - INFO - Received 1500 messages so far
2025-02-26 19:40:59,266 - INFO - Received 1600 messages so far
2025-02-26 19:40:59,267 - INFO - Received 1700 messages so far
2025-02-26 19:40:59,267 - INFO - Received 1800 messages so far
2025-02-26 19:40:59,267 - INFO - Received 1900 messages so far
2025-02-26 19:40:59,267 - INFO - Received 2000 messages so far
2025-02-26 19:40:59,267 - INFO - Received 2100 messages so far
2025-02-26 19:40:59,268 - INFO - Received 2200 messages so far
2025-02-26 19:40:59,268 - INFO - Received 2300 messages so far
2025-02-26 19:40:59,268 - INFO - Received 2400 messages so far
2025-02-26 19:40:59,268 - INFO - Received 2500 messages so far
2025-02-26 19:40:59,268 - INFO - Received 2600 messages so far
2025-02-26 19:40:59,269 - INFO - Received 2700 messages so far
2025-02-26 19:40:59,269 - INFO - Received 2800 messages so far
2025-02-26 19:40:59,269 - INFO - Received 2900 messages so far
2025-02-26 19:40:59,269 - INFO - Received 3000 messages so far
2025-02-26 19:40:59,269 - INFO - Received 3100 messages so far
2025-02-26 19:40:59,269 - INFO - Received 3200 messages so far
2025-02-26 19:40:59,270 - INFO - Received 3300 messages so far
2025-02-26 19:40:59,270 - INFO - Received 3400 messages so far
2025-02-26 19:40:59,270 - INFO - Received 3500 messages so far
2025-02-26 19:40:59,270 - INFO - Received 3600 messages so far
2025-02-26 19:40:59,270 - INFO - Received 3700 messages so far
2025-02-26 19:40:59,271 - INFO - Received 3800 messages so far
2025-02-26 19:40:59,271 - INFO - Received 3900 messages so far
2025-02-26 19:40:59,271 - INFO - Received 4000 messages so far
2025-02-26 19:40:59,271 - INFO - Received 4100 messages so far
2025-02-26 19:40:59,323 - INFO - Received 4200 messages so far
2025-02-26 19:40:59,324 - INFO - Received 4300 messages so far
2025-02-26 19:40:59,324 - INFO - Received 4400 messages so far
2025-02-26 19:40:59,324 - INFO - Received 4500 messages so far
2025-02-26 19:40:59,324 - INFO - Received 4600 messages so far
2025-02-26 19:40:59,324 - INFO - Received 4700 messages so far
2025-02-26 19:40:59,325 - INFO - Received 4800 messages so far
2025-02-26 19:40:59,325 - INFO - Received 4900 messages so far
2025-02-26 19:40:59,325 - INFO - Received 5000 messages so far
2025-02-26 19:40:59,325 - INFO - Received 5100 messages so far
2025-02-26 19:40:59,325 - INFO - Received 5200 messages so far
2025-02-26 19:40:59,326 - INFO - Received 5300 messages so far
2025-02-26 19:40:59,326 - INFO - Received 5400 messages so far
2025-02-26 19:40:59,326 - INFO - Received 5500 messages so far
2025-02-26 19:40:59,326 - INFO - Received 5600 messages so far
2025-02-26 19:40:59,326 - INFO - Received 5700 messages so far
2025-02-26 19:40:59,327 - INFO - Received 5800 messages so far
2025-02-26 19:40:59,327 - INFO - Received 5900 messages so far
2025-02-26 19:40:59,327 - INFO - Received 6000 messages so far
2025-02-26 19:40:59,327 - INFO - Received 6100 messages so far
2025-02-26 19:40:59,327 - INFO - Received 6200 messages so far
2025-02-26 19:40:59,328 - INFO - Received 6300 messages so far
2025-02-26 19:40:59,328 - INFO - Received 6400 messages so far
2025-02-26 19:40:59,328 - INFO - Received 6500 messages so far
2025-02-26 19:40:59,328 - INFO - Received 6600 messages so far
2025-02-26 19:40:59,328 - INFO - Received 6700 messages so far
2025-02-26 19:40:59,329 - INFO - Received 6800 messages so far
2025-02-26 19:40:59,329 - INFO - Received 6900 messages so far
2025-02-26 19:40:59,329 - INFO - Received 7000 messages so far
2025-02-26 19:40:59,329 - INFO - Received 7100 messages so far
2025-02-26 19:40:59,329 - INFO - Received 7200 messages so far
2025-02-26 19:40:59,329 - INFO - Received 7300 messages so far
2025-02-26 19:40:59,330 - INFO - Received 7400 messages so far
2025-02-26 19:40:59,330 - INFO - Received 7500 messages so far
2025-02-26 19:40:59,330 - INFO - Received 7600 messages so far
2025-02-26 19:40:59,330 - INFO - Received 7700 messages so far
2025-02-26 19:40:59,330 - INFO - Received 7800 messages so far
2025-02-26 19:40:59,331 - INFO - Received 7900 messages so far
2025-02-26 19:40:59,331 - INFO - Received 8000 messages so far
2025-02-26 19:40:59,331 - INFO - Received 8100 messages so far
2025-02-26 19:40:59,331 - INFO - Received 8200 messages so far
2025-02-26 19:40:59,331 - INFO - Received 8300 messages so far
2025-02-26 19:40:59,332 - INFO - Received 8400 messages so far
2025-02-26 19:40:59,332 - INFO - Received 8500 messages so far
2025-02-26 19:40:59,332 - INFO - Received 8600 messages so far
2025-02-26 19:40:59,332 - INFO - Received 8700 messages so far
2025-02-26 19:40:59,387 - INFO - Received 8800 messages so far
2025-02-26 19:40:59,388 - INFO - Received 8900 messages so far
2025-02-26 19:40:59,388 - INFO - Received 9000 messages so far
2025-02-26 19:40:59,388 - INFO - Received 9100 messages so far
2025-02-26 19:40:59,388 - INFO - Received 9200 messages so far
2025-02-26 19:40:59,388 - INFO - Received 9300 messages so far
2025-02-26 19:40:59,389 - INFO - Received 9400 messages so far
2025-02-26 19:40:59,389 - INFO - Received 9500 messages so far
2025-02-26 19:40:59,389 - INFO - Received 9600 messages so far
2025-02-26 19:40:59,389 - INFO - Received 9700 messages so far
2025-02-26 19:40:59,389 - INFO - Received 9800 messages so far
2025-02-26 19:40:59,390 - INFO - Received 9900 messages so far
2025-02-26 19:40:59,390 - INFO - Received 10000 messages so far
2025-02-26 19:40:59,390 - INFO - Total messages consumed: 10000
2025-02-26 19:40:59,476 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:59,480 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:59,480 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:59,480 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:59,481 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:59,488 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:59,491 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:59,491 - INFO - Number of columns: 66
2025-02-26 19:40:59,501 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
5016        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005897     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6085        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8834        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5922        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
872         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:59,501 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:59,531 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:59,573 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    89520c813b739a8f              e9520c813b739a8f  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:59,574 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.   443.    53.  1900.    80.    22.   134.  5353.   133.
   123. 21116.   136. 21115.   135.   547.   138.     0.    67.]
2025-02-26 19:40:59,575 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:59,580 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:59,581 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:59,581 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:59,583 - INFO - DataFrame shape after NA dropping: (908, 23)
2025-02-26 19:40:59,584 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:59,584 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:59,584 - INFO - X shape: (908, 21), y shape: (908,)
2025-02-26 19:40:59,584 - INFO - Label distribution in training data: {'DNS': 760, 'HTTPS': 133, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:59,585 - INFO - Training model...
2025-02-26 19:40:59,699 - INFO - Predicting on test data...
2025-02-26 19:40:59,713 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 151.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.3333333333333333,
    "f1-score": 0.5,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.9333333333333333,
    "recall": 1.0,
    "f1-score": 0.9655172413793104,
    "support": 28.0
  },
  "accuracy": 0.989010989010989,
  "macro avg": {
    "precision": 0.9777777777777779,
    "recall": 0.7777777777777777,
    "f1-score": 0.8218390804597702,
    "support": 182.0
  },
  "weighted avg": {
    "precision": 0.9897435897435897,
    "recall": 0.989010989010989,
    "f1-score": 0.9864532019704434,
    "support": 182.0
  }
}
2025-02-26 19:40:59,721 - INFO - Saved processed data locally to processed_data_20250226_194059.csv
2025-02-26 19:40:59,723 - INFO - JSON data size: 447284 bytes
2025-02-26 19:40:59,723 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:59,723 - INFO - Data sent successfully!
2025-02-26 19:40:59,723 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:59,725 - INFO - Starting data processing
2025-02-26 19:40:59,725 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:59,725 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:59,726 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:59,726 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:59,828 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:59,828 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:59,829 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:59,829 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:59,829 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:59,830 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:59,830 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:59,830 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:59,830 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:59,983 - INFO - Received 100 messages so far
2025-02-26 19:40:59,984 - INFO - Received 200 messages so far
2025-02-26 19:40:59,984 - INFO - Received 300 messages so far
2025-02-26 19:40:59,984 - INFO - Received 400 messages so far
2025-02-26 19:40:59,984 - INFO - Received 500 messages so far
2025-02-26 19:40:59,984 - INFO - Received 600 messages so far
2025-02-26 19:40:59,985 - INFO - Received 700 messages so far
2025-02-26 19:40:59,985 - INFO - Received 800 messages so far
2025-02-26 19:40:59,985 - INFO - Received 900 messages so far
2025-02-26 19:40:59,985 - INFO - Received 1000 messages so far
2025-02-26 19:40:59,985 - INFO - Received 1100 messages so far
2025-02-26 19:40:59,986 - INFO - Received 1200 messages so far
2025-02-26 19:40:59,986 - INFO - Received 1300 messages so far
2025-02-26 19:40:59,986 - INFO - Received 1400 messages so far
2025-02-26 19:40:59,986 - INFO - Received 1500 messages so far
2025-02-26 19:40:59,986 - INFO - Received 1600 messages so far
2025-02-26 19:40:59,987 - INFO - Received 1700 messages so far
2025-02-26 19:40:59,987 - INFO - Received 1800 messages so far
2025-02-26 19:40:59,987 - INFO - Received 1900 messages so far
2025-02-26 19:40:59,987 - INFO - Received 2000 messages so far
2025-02-26 19:40:59,987 - INFO - Received 2100 messages so far
2025-02-26 19:40:59,988 - INFO - Received 2200 messages so far
2025-02-26 19:40:59,988 - INFO - Received 2300 messages so far
2025-02-26 19:40:59,988 - INFO - Received 2400 messages so far
2025-02-26 19:40:59,988 - INFO - Received 2500 messages so far
2025-02-26 19:40:59,988 - INFO - Received 2600 messages so far
2025-02-26 19:40:59,989 - INFO - Received 2700 messages so far
2025-02-26 19:40:59,989 - INFO - Received 2800 messages so far
2025-02-26 19:40:59,989 - INFO - Received 2900 messages so far
2025-02-26 19:40:59,989 - INFO - Received 3000 messages so far
2025-02-26 19:40:59,989 - INFO - Received 3100 messages so far
2025-02-26 19:40:59,989 - INFO - Received 3200 messages so far
2025-02-26 19:40:59,990 - INFO - Received 3300 messages so far
2025-02-26 19:40:59,990 - INFO - Received 3400 messages so far
2025-02-26 19:40:59,990 - INFO - Received 3500 messages so far
2025-02-26 19:40:59,990 - INFO - Received 3600 messages so far
2025-02-26 19:40:59,990 - INFO - Received 3700 messages so far
2025-02-26 19:40:59,991 - INFO - Received 3800 messages so far
2025-02-26 19:40:59,991 - INFO - Received 3900 messages so far
2025-02-26 19:40:59,991 - INFO - Received 4000 messages so far
2025-02-26 19:40:59,991 - INFO - Received 4100 messages so far
2025-02-26 19:41:00,082 - INFO - Received 4200 messages so far
2025-02-26 19:41:00,082 - INFO - Received 4300 messages so far
2025-02-26 19:41:00,082 - INFO - Received 4400 messages so far
2025-02-26 19:41:00,082 - INFO - Received 4500 messages so far
2025-02-26 19:41:00,083 - INFO - Received 4600 messages so far
2025-02-26 19:41:00,083 - INFO - Received 4700 messages so far
2025-02-26 19:41:00,083 - INFO - Received 4800 messages so far
2025-02-26 19:41:00,083 - INFO - Received 4900 messages so far
2025-02-26 19:41:00,083 - INFO - Received 5000 messages so far
2025-02-26 19:41:00,084 - INFO - Received 5100 messages so far
2025-02-26 19:41:00,084 - INFO - Received 5200 messages so far
2025-02-26 19:41:00,084 - INFO - Received 5300 messages so far
2025-02-26 19:41:00,084 - INFO - Received 5400 messages so far
2025-02-26 19:41:00,084 - INFO - Received 5500 messages so far
2025-02-26 19:41:00,085 - INFO - Received 5600 messages so far
2025-02-26 19:41:00,085 - INFO - Received 5700 messages so far
2025-02-26 19:41:00,085 - INFO - Received 5800 messages so far
2025-02-26 19:41:00,085 - INFO - Received 5900 messages so far
2025-02-26 19:41:00,085 - INFO - Received 6000 messages so far
2025-02-26 19:41:00,086 - INFO - Received 6100 messages so far
2025-02-26 19:41:00,086 - INFO - Received 6200 messages so far
2025-02-26 19:41:00,086 - INFO - Received 6300 messages so far
2025-02-26 19:41:00,086 - INFO - Received 6400 messages so far
2025-02-26 19:41:00,086 - INFO - Received 6500 messages so far
2025-02-26 19:41:00,087 - INFO - Received 6600 messages so far
2025-02-26 19:41:00,087 - INFO - Received 6700 messages so far
2025-02-26 19:41:00,087 - INFO - Received 6800 messages so far
2025-02-26 19:41:00,087 - INFO - Received 6900 messages so far
2025-02-26 19:41:00,087 - INFO - Received 7000 messages so far
2025-02-26 19:41:00,087 - INFO - Received 7100 messages so far
2025-02-26 19:41:00,088 - INFO - Received 7200 messages so far
2025-02-26 19:41:00,088 - INFO - Received 7300 messages so far
2025-02-26 19:41:00,088 - INFO - Received 7400 messages so far
2025-02-26 19:41:00,088 - INFO - Received 7500 messages so far
2025-02-26 19:41:00,088 - INFO - Received 7600 messages so far
2025-02-26 19:41:00,089 - INFO - Received 7700 messages so far
2025-02-26 19:41:00,089 - INFO - Received 7800 messages so far
2025-02-26 19:41:00,089 - INFO - Received 7900 messages so far
2025-02-26 19:41:00,089 - INFO - Received 8000 messages so far
2025-02-26 19:41:00,089 - INFO - Received 8100 messages so far
2025-02-26 19:41:00,090 - INFO - Received 8200 messages so far
2025-02-26 19:41:00,090 - INFO - Received 8300 messages so far
2025-02-26 19:41:00,090 - INFO - Received 8400 messages so far
2025-02-26 19:41:00,090 - INFO - Received 8500 messages so far
2025-02-26 19:41:00,090 - INFO - Received 8600 messages so far
2025-02-26 19:41:00,091 - INFO - Received 8700 messages so far
2025-02-26 19:41:00,146 - INFO - Received 8800 messages so far
2025-02-26 19:41:00,147 - INFO - Received 8900 messages so far
2025-02-26 19:41:00,147 - INFO - Received 9000 messages so far
2025-02-26 19:41:00,147 - INFO - Received 9100 messages so far
2025-02-26 19:41:00,147 - INFO - Received 9200 messages so far
2025-02-26 19:41:00,147 - INFO - Received 9300 messages so far
2025-02-26 19:41:00,148 - INFO - Received 9400 messages so far
2025-02-26 19:41:00,148 - INFO - Received 9500 messages so far
2025-02-26 19:41:00,148 - INFO - Received 9600 messages so far
2025-02-26 19:41:00,148 - INFO - Received 9700 messages so far
2025-02-26 19:41:00,148 - INFO - Received 9800 messages so far
2025-02-26 19:41:00,149 - INFO - Received 9900 messages so far
2025-02-26 19:41:00,149 - INFO - Received 10000 messages so far
2025-02-26 19:41:00,149 - INFO - Total messages consumed: 10000
2025-02-26 19:41:00,234 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:41:00,238 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:00,238 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:41:00,238 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:00,238 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:41:00,246 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:41:00,249 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:41:00,249 - INFO - Number of columns: 66
2025-02-26 19:41:00,261 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt                                          query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD     RA    Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9737        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN                                            NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9662       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740120e+09      NaN  NaN     NaN  CsCSou1VGHqyAGVSNl    42031.0  NaN  pgtca1-word-telemetry-vip.officeapps.live.com     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  False  0.0     NaN  NaN    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4488        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN                                            NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.008315     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7356        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN                                            NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
546        53.0  192.168.1.3  192.168.1.1   udp        74.0       144.0  1.740118e+09      NaN  NaN     dns  CLXjJD33yYqavjQg91    40364.0  NaN                                            NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0          102.0        1.0          172.0      17.0  0.001231     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:41:00,261 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:41:00,292 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:41:00,335 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    ca26477d8c98f7b3              ea26477d8c98f7b3  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:41:00,336 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.   138.   133.   123.  1900.   443.    80.
   134.   547.    22.   136. 21116.   135.     0. 21115.    67.]
2025-02-26 19:41:00,337 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:41:00,342 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:00,343 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:41:00,343 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:41:00,345 - INFO - DataFrame shape after NA dropping: (826, 23)
2025-02-26 19:41:00,345 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:41:00,345 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:41:00,346 - INFO - X shape: (826, 21), y shape: (826,)
2025-02-26 19:41:00,346 - INFO - Label distribution in training data: {'DNS': 687, 'HTTPS': 126, 'HTTP': 12, 'SSH': 1}
2025-02-26 19:41:00,347 - INFO - Training model...
2025-02-26 19:41:00,457 - INFO - Predicting on test data...
2025-02-26 19:41:00,470 - INFO - Classification report:
{
  "DNS": {
    "precision": 0.9928571428571429,
    "recall": 1.0,
    "f1-score": 0.996415770609319,
    "support": 139.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 26.0
  },
  "SSH": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "accuracy": 0.9939759036144579,
  "macro avg": {
    "precision": 0.6642857142857143,
    "recall": 0.6666666666666666,
    "f1-score": 0.6654719235364396,
    "support": 166.0
  },
  "weighted avg": {
    "precision": 0.9879948364888125,
    "recall": 0.9939759036144579,
    "f1-score": 0.9909746512933455,
    "support": 166.0
  }
}
2025-02-26 19:41:00,477 - INFO - Saved processed data locally to processed_data_20250226_194100.csv
2025-02-26 19:41:00,479 - INFO - JSON data size: 406508 bytes
2025-02-26 19:41:00,479 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:41:00,479 - INFO - Data sent successfully!
2025-02-26 19:41:00,479 - INFO - Data processing and transmission completed successfully
2025-02-26 19:41:00,480 - INFO - Starting data processing
2025-02-26 19:41:00,481 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:41:00,481 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:41:00,482 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:41:00,482 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:41:00,584 - INFO - Broker version identified as 2.5.0
2025-02-26 19:41:00,584 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:41:00,584 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:41:00,584 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:41:00,584 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:41:00,585 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:41:00,585 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:41:00,586 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:41:00,586 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:41:00,738 - INFO - Received 100 messages so far
2025-02-26 19:41:00,739 - INFO - Received 200 messages so far
2025-02-26 19:41:00,739 - INFO - Received 300 messages so far
2025-02-26 19:41:00,739 - INFO - Received 400 messages so far
2025-02-26 19:41:00,739 - INFO - Received 500 messages so far
2025-02-26 19:41:00,739 - INFO - Received 600 messages so far
2025-02-26 19:41:00,740 - INFO - Received 700 messages so far
2025-02-26 19:41:00,740 - INFO - Received 800 messages so far
2025-02-26 19:41:00,740 - INFO - Received 900 messages so far
2025-02-26 19:41:00,740 - INFO - Received 1000 messages so far
2025-02-26 19:41:00,740 - INFO - Received 1100 messages so far
2025-02-26 19:41:00,740 - INFO - Received 1200 messages so far
2025-02-26 19:41:00,741 - INFO - Received 1300 messages so far
2025-02-26 19:41:00,741 - INFO - Received 1400 messages so far
2025-02-26 19:41:00,741 - INFO - Received 1500 messages so far
2025-02-26 19:41:00,741 - INFO - Received 1600 messages so far
2025-02-26 19:41:00,741 - INFO - Received 1700 messages so far
2025-02-26 19:41:00,742 - INFO - Received 1800 messages so far
2025-02-26 19:41:00,742 - INFO - Received 1900 messages so far
2025-02-26 19:41:00,742 - INFO - Received 2000 messages so far
2025-02-26 19:41:00,742 - INFO - Received 2100 messages so far
2025-02-26 19:41:00,742 - INFO - Received 2200 messages so far
2025-02-26 19:41:00,743 - INFO - Received 2300 messages so far
2025-02-26 19:41:00,743 - INFO - Received 2400 messages so far
2025-02-26 19:41:00,743 - INFO - Received 2500 messages so far
2025-02-26 19:41:00,743 - INFO - Received 2600 messages so far
2025-02-26 19:41:00,743 - INFO - Received 2700 messages so far
2025-02-26 19:41:00,744 - INFO - Received 2800 messages so far
2025-02-26 19:41:00,744 - INFO - Received 2900 messages so far
2025-02-26 19:41:00,744 - INFO - Received 3000 messages so far
2025-02-26 19:41:00,744 - INFO - Received 3100 messages so far
2025-02-26 19:41:00,744 - INFO - Received 3200 messages so far
2025-02-26 19:41:00,745 - INFO - Received 3300 messages so far
2025-02-26 19:41:00,745 - INFO - Received 3400 messages so far
2025-02-26 19:41:00,745 - INFO - Received 3500 messages so far
2025-02-26 19:41:00,745 - INFO - Received 3600 messages so far
2025-02-26 19:41:00,746 - INFO - Received 3700 messages so far
2025-02-26 19:41:00,746 - INFO - Received 3800 messages so far
2025-02-26 19:41:00,746 - INFO - Received 3900 messages so far
2025-02-26 19:41:00,746 - INFO - Received 4000 messages so far
2025-02-26 19:41:00,746 - INFO - Received 4100 messages so far
2025-02-26 19:41:00,802 - INFO - Received 4200 messages so far
2025-02-26 19:41:00,802 - INFO - Received 4300 messages so far
2025-02-26 19:41:00,802 - INFO - Received 4400 messages so far
2025-02-26 19:41:00,802 - INFO - Received 4500 messages so far
2025-02-26 19:41:00,802 - INFO - Received 4600 messages so far
2025-02-26 19:41:00,803 - INFO - Received 4700 messages so far
2025-02-26 19:41:00,803 - INFO - Received 4800 messages so far
2025-02-26 19:41:00,803 - INFO - Received 4900 messages so far
2025-02-26 19:41:00,803 - INFO - Received 5000 messages so far
2025-02-26 19:41:00,803 - INFO - Received 5100 messages so far
2025-02-26 19:41:00,804 - INFO - Received 5200 messages so far
2025-02-26 19:41:00,804 - INFO - Received 5300 messages so far
2025-02-26 19:41:00,804 - INFO - Received 5400 messages so far
2025-02-26 19:41:00,804 - INFO - Received 5500 messages so far
2025-02-26 19:41:00,804 - INFO - Received 5600 messages so far
2025-02-26 19:41:00,805 - INFO - Received 5700 messages so far
2025-02-26 19:41:00,805 - INFO - Received 5800 messages so far
2025-02-26 19:41:00,805 - INFO - Received 5900 messages so far
2025-02-26 19:41:00,805 - INFO - Received 6000 messages so far
2025-02-26 19:41:00,805 - INFO - Received 6100 messages so far
2025-02-26 19:41:00,806 - INFO - Received 6200 messages so far
2025-02-26 19:41:00,806 - INFO - Received 6300 messages so far
2025-02-26 19:41:00,806 - INFO - Received 6400 messages so far
2025-02-26 19:41:00,806 - INFO - Received 6500 messages so far
2025-02-26 19:41:00,806 - INFO - Received 6600 messages so far
2025-02-26 19:41:00,807 - INFO - Received 6700 messages so far
2025-02-26 19:41:00,807 - INFO - Received 6800 messages so far
2025-02-26 19:41:00,807 - INFO - Received 6900 messages so far
2025-02-26 19:41:00,807 - INFO - Received 7000 messages so far
2025-02-26 19:41:00,807 - INFO - Received 7100 messages so far
2025-02-26 19:41:00,808 - INFO - Received 7200 messages so far
2025-02-26 19:41:00,808 - INFO - Received 7300 messages so far
2025-02-26 19:41:00,808 - INFO - Received 7400 messages so far
2025-02-26 19:41:00,808 - INFO - Received 7500 messages so far
2025-02-26 19:41:00,808 - INFO - Received 7600 messages so far
2025-02-26 19:41:00,809 - INFO - Received 7700 messages so far
2025-02-26 19:41:00,809 - INFO - Received 7800 messages so far
2025-02-26 19:41:00,809 - INFO - Received 7900 messages so far
2025-02-26 19:41:00,809 - INFO - Received 8000 messages so far
2025-02-26 19:41:00,809 - INFO - Received 8100 messages so far
2025-02-26 19:41:00,810 - INFO - Received 8200 messages so far
2025-02-26 19:41:00,810 - INFO - Received 8300 messages so far
2025-02-26 19:41:00,810 - INFO - Received 8400 messages so far
2025-02-26 19:41:00,810 - INFO - Received 8500 messages so far
2025-02-26 19:41:00,811 - INFO - Received 8600 messages so far
2025-02-26 19:41:00,811 - INFO - Received 8700 messages so far
2025-02-26 19:41:00,909 - INFO - Received 8800 messages so far
2025-02-26 19:41:00,910 - INFO - Received 8900 messages so far
2025-02-26 19:41:00,910 - INFO - Received 9000 messages so far
2025-02-26 19:41:00,910 - INFO - Received 9100 messages so far
2025-02-26 19:41:00,910 - INFO - Received 9200 messages so far
2025-02-26 19:41:00,910 - INFO - Received 9300 messages so far
2025-02-26 19:41:00,911 - INFO - Received 9400 messages so far
2025-02-26 19:41:00,911 - INFO - Received 9500 messages so far
2025-02-26 19:41:00,911 - INFO - Received 9600 messages so far
2025-02-26 19:41:00,911 - INFO - Received 9700 messages so far
2025-02-26 19:41:00,911 - INFO - Received 9800 messages so far
2025-02-26 19:41:00,912 - INFO - Received 9900 messages so far
2025-02-26 19:41:00,912 - INFO - Received 10000 messages so far
2025-02-26 19:41:00,912 - INFO - Total messages consumed: 10000
2025-02-26 19:41:01,001 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:41:01,004 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:01,005 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:41:01,005 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:01,005 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:41:01,012 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:41:01,016 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:41:01,016 - INFO - Number of columns: 66
2025-02-26 19:41:01,027 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                   query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                                                                                                                                                                                                                                                                          answers                                                   TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
2026        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
843        53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740118e+09      NaN  NaN     NaN  CJFSeC2L0eLu4Zblfh    38634.0  0.001972  iup0-my.sharepoint.com     1.0  C_INTERNET    1.0          A    0.0    NOERROR  False  False  True  True  0.0  [iup0.sharepoint.com, 5711-ipv4v6e.clump.dprodmgd105.aa-rt.sharepoint.com, 193491-ipv4v6e.farm.dprodmgd105.aa-rt.sharepoint.com, 193491-ipv4v6e.farm.dprodmgd105.sharepointonline.com.akadns.net, 193491-ipv4v6.farm.dprodmgd105.aa-rt.sharepoint.com.dual-spo-0005.spo-msedge.net, dual-spo-0005.spo-msedge.net, 13.107.138.10, 13.107.136.10]  [2424.0, 2340.0, 50.0, 50.0, 252.0, 46.0, 46.0, 46.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8533     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  C2SHiC4ArTkfsgN0Wa    40612.0       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                    NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000530     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1485        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3888       53.0  192.168.1.3  192.168.1.1   udp        62.0       396.0  1.740119e+09      NaN  NaN     dns  CR6ErD23BumUeXUaD6    46684.0       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                    NaN      NaN         SF       True       True           0.0      Dd        1.0           90.0        1.0          424.0      17.0  0.001906     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:41:01,028 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:41:01,059 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:41:01,102 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    0ac96b6b462a8d5d              eac96b6b462a8d5d  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:41:01,103 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.    22.   443.  1900.   123.    80. 21116.
 21115.   134.   138.   136.     0.   133.   547.    67.   135.]
2025-02-26 19:41:01,104 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:41:01,109 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:01,110 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:41:01,111 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:41:01,113 - INFO - DataFrame shape after NA dropping: (832, 23)
2025-02-26 19:41:01,113 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:41:01,113 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:41:01,113 - INFO - X shape: (832, 21), y shape: (832,)
2025-02-26 19:41:01,114 - INFO - Label distribution in training data: {'DNS': 694, 'HTTPS': 126, 'HTTP': 12}
2025-02-26 19:41:01,115 - INFO - Training model...
2025-02-26 19:41:01,228 - INFO - Predicting on test data...
2025-02-26 19:41:01,240 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 147.0
  },
  "HTTP": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 0.95,
    "recall": 1.0,
    "f1-score": 0.9743589743589743,
    "support": 19.0
  },
  "accuracy": 0.9940119760479041,
  "macro avg": {
    "precision": 0.65,
    "recall": 0.6666666666666666,
    "f1-score": 0.6581196581196581,
    "support": 167.0
  },
  "weighted avg": {
    "precision": 0.9883233532934133,
    "recall": 0.9940119760479041,
    "f1-score": 0.9910947336097036,
    "support": 167.0
  }
}
2025-02-26 19:41:01,247 - INFO - Saved processed data locally to processed_data_20250226_194101.csv
2025-02-26 19:41:01,249 - INFO - JSON data size: 408131 bytes
2025-02-26 19:41:01,249 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:41:01,249 - INFO - Data sent successfully!
2025-02-26 19:41:01,249 - INFO - Data processing and transmission completed successfully
2025-02-26 19:41:01,250 - INFO - Starting data processing
2025-02-26 19:41:01,250 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:41:01,251 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:41:01,251 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:41:01,252 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:41:01,353 - INFO - Broker version identified as 2.5.0
2025-02-26 19:41:01,353 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:41:01,354 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:41:01,354 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:41:01,354 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:41:01,355 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:41:01,355 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:41:01,355 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:41:01,355 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:41:01,508 - INFO - Received 100 messages so far
2025-02-26 19:41:01,508 - INFO - Received 200 messages so far
2025-02-26 19:41:01,508 - INFO - Received 300 messages so far
2025-02-26 19:41:01,508 - INFO - Received 400 messages so far
2025-02-26 19:41:01,508 - INFO - Received 500 messages so far
2025-02-26 19:41:01,509 - INFO - Received 600 messages so far
2025-02-26 19:41:01,509 - INFO - Received 700 messages so far
2025-02-26 19:41:01,509 - INFO - Received 800 messages so far
2025-02-26 19:41:01,509 - INFO - Received 900 messages so far
2025-02-26 19:41:01,509 - INFO - Received 1000 messages so far
2025-02-26 19:41:01,510 - INFO - Received 1100 messages so far
2025-02-26 19:41:01,510 - INFO - Received 1200 messages so far
2025-02-26 19:41:01,510 - INFO - Received 1300 messages so far
2025-02-26 19:41:01,510 - INFO - Received 1400 messages so far
2025-02-26 19:41:01,510 - INFO - Received 1500 messages so far
2025-02-26 19:41:01,511 - INFO - Received 1600 messages so far
2025-02-26 19:41:01,511 - INFO - Received 1700 messages so far
2025-02-26 19:41:01,511 - INFO - Received 1800 messages so far
2025-02-26 19:41:01,511 - INFO - Received 1900 messages so far
2025-02-26 19:41:01,511 - INFO - Received 2000 messages so far
2025-02-26 19:41:01,512 - INFO - Received 2100 messages so far
2025-02-26 19:41:01,512 - INFO - Received 2200 messages so far
2025-02-26 19:41:01,512 - INFO - Received 2300 messages so far
2025-02-26 19:41:01,512 - INFO - Received 2400 messages so far
2025-02-26 19:41:01,512 - INFO - Received 2500 messages so far
2025-02-26 19:41:01,513 - INFO - Received 2600 messages so far
2025-02-26 19:41:01,513 - INFO - Received 2700 messages so far
2025-02-26 19:41:01,513 - INFO - Received 2800 messages so far
2025-02-26 19:41:01,513 - INFO - Received 2900 messages so far
2025-02-26 19:41:01,513 - INFO - Received 3000 messages so far
2025-02-26 19:41:01,514 - INFO - Received 3100 messages so far
2025-02-26 19:41:01,514 - INFO - Received 3200 messages so far
2025-02-26 19:41:01,514 - INFO - Received 3300 messages so far
2025-02-26 19:41:01,514 - INFO - Received 3400 messages so far
2025-02-26 19:41:01,514 - INFO - Received 3500 messages so far
2025-02-26 19:41:01,514 - INFO - Received 3600 messages so far
2025-02-26 19:41:01,515 - INFO - Received 3700 messages so far
2025-02-26 19:41:01,515 - INFO - Received 3800 messages so far
2025-02-26 19:41:01,515 - INFO - Received 3900 messages so far
2025-02-26 19:41:01,515 - INFO - Received 4000 messages so far
2025-02-26 19:41:01,516 - INFO - Received 4100 messages so far
2025-02-26 19:41:01,568 - INFO - Received 4200 messages so far
2025-02-26 19:41:01,569 - INFO - Received 4300 messages so far
2025-02-26 19:41:01,569 - INFO - Received 4400 messages so far
2025-02-26 19:41:01,569 - INFO - Received 4500 messages so far
2025-02-26 19:41:01,569 - INFO - Received 4600 messages so far
2025-02-26 19:41:01,569 - INFO - Received 4700 messages so far
2025-02-26 19:41:01,570 - INFO - Received 4800 messages so far
2025-02-26 19:41:01,570 - INFO - Received 4900 messages so far
2025-02-26 19:41:01,570 - INFO - Received 5000 messages so far
2025-02-26 19:41:01,570 - INFO - Received 5100 messages so far
2025-02-26 19:41:01,570 - INFO - Received 5200 messages so far
2025-02-26 19:41:01,571 - INFO - Received 5300 messages so far
2025-02-26 19:41:01,571 - INFO - Received 5400 messages so far
2025-02-26 19:41:01,571 - INFO - Received 5500 messages so far
2025-02-26 19:41:01,571 - INFO - Received 5600 messages so far
2025-02-26 19:41:01,571 - INFO - Received 5700 messages so far
2025-02-26 19:41:01,572 - INFO - Received 5800 messages so far
2025-02-26 19:41:01,572 - INFO - Received 5900 messages so far
2025-02-26 19:41:01,572 - INFO - Received 6000 messages so far
2025-02-26 19:41:01,572 - INFO - Received 6100 messages so far
2025-02-26 19:41:01,572 - INFO - Received 6200 messages so far
2025-02-26 19:41:01,573 - INFO - Received 6300 messages so far
2025-02-26 19:41:01,573 - INFO - Received 6400 messages so far
2025-02-26 19:41:01,573 - INFO - Received 6500 messages so far
2025-02-26 19:41:01,573 - INFO - Received 6600 messages so far
2025-02-26 19:41:01,573 - INFO - Received 6700 messages so far
2025-02-26 19:41:01,574 - INFO - Received 6800 messages so far
2025-02-26 19:41:01,574 - INFO - Received 6900 messages so far
2025-02-26 19:41:01,574 - INFO - Received 7000 messages so far
2025-02-26 19:41:01,574 - INFO - Received 7100 messages so far
2025-02-26 19:41:01,574 - INFO - Received 7200 messages so far
2025-02-26 19:41:01,575 - INFO - Received 7300 messages so far
2025-02-26 19:41:01,575 - INFO - Received 7400 messages so far
2025-02-26 19:41:01,575 - INFO - Received 7500 messages so far
2025-02-26 19:41:01,575 - INFO - Received 7600 messages so far
2025-02-26 19:41:01,575 - INFO - Received 7700 messages so far
2025-02-26 19:41:01,575 - INFO - Received 7800 messages so far
2025-02-26 19:41:01,576 - INFO - Received 7900 messages so far
2025-02-26 19:41:01,576 - INFO - Received 8000 messages so far
2025-02-26 19:41:01,576 - INFO - Received 8100 messages so far
2025-02-26 19:41:01,576 - INFO - Received 8200 messages so far
2025-02-26 19:41:01,576 - INFO - Received 8300 messages so far
2025-02-26 19:41:01,577 - INFO - Received 8400 messages so far
2025-02-26 19:41:01,577 - INFO - Received 8500 messages so far
2025-02-26 19:41:01,577 - INFO - Received 8600 messages so far
2025-02-26 19:41:01,577 - INFO - Received 8700 messages so far
2025-02-26 19:41:01,637 - INFO - Received 8800 messages so far
2025-02-26 19:41:01,638 - INFO - Received 8900 messages so far
2025-02-26 19:41:01,638 - INFO - Received 9000 messages so far
2025-02-26 19:41:01,638 - INFO - Received 9100 messages so far
2025-02-26 19:41:01,638 - INFO - Received 9200 messages so far
2025-02-26 19:41:01,639 - INFO - Received 9300 messages so far
2025-02-26 19:41:01,639 - INFO - Received 9400 messages so far
2025-02-26 19:41:01,639 - INFO - Received 9500 messages so far
2025-02-26 19:41:01,639 - INFO - Received 9600 messages so far
2025-02-26 19:41:01,639 - INFO - Received 9700 messages so far
2025-02-26 19:41:01,640 - INFO - Received 9800 messages so far
2025-02-26 19:41:01,640 - INFO - Received 9900 messages so far
2025-02-26 19:41:01,640 - INFO - Received 10000 messages so far
2025-02-26 19:41:01,640 - INFO - Total messages consumed: 10000
2025-02-26 19:41:01,730 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:41:01,734 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:01,735 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:41:01,735 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:01,735 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:41:01,742 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:41:01,746 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:41:01,746 - INFO - Number of columns: 66
2025-02-26 19:41:01,756 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9825        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1541        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3770        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1314        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1499        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:41:01,756 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:41:01,787 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:41:01,831 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    1edec4bdcc72bfa6              fd390eb19a6c1898  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:41:01,831 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.   443.   123.   138. 21116. 21115.    80.
     0.  1900.   133.   134.   136.    67.   135.   547.    22.]
2025-02-26 19:41:01,832 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:41:01,837 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:01,839 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:41:01,839 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:41:01,841 - INFO - DataFrame shape after NA dropping: (775, 23)
2025-02-26 19:41:01,841 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:41:01,841 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:41:01,842 - INFO - X shape: (775, 21), y shape: (775,)
2025-02-26 19:41:01,842 - INFO - Label distribution in training data: {'DNS': 644, 'HTTPS': 118, 'HTTP': 12, 'SSH': 1}
2025-02-26 19:41:01,843 - INFO - Training model...
2025-02-26 19:41:01,952 - INFO - Predicting on test data...
2025-02-26 19:41:01,965 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 133.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 0.85,
    "recall": 1.0,
    "f1-score": 0.918918918918919,
    "support": 17.0
  },
  "SSH": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "accuracy": 0.9806451612903225,
  "macro avg": {
    "precision": 0.7125,
    "recall": 0.625,
    "f1-score": 0.6463963963963963,
    "support": 155.0
  },
  "weighted avg": {
    "precision": 0.9770967741935483,
    "recall": 0.9806451612903225,
    "f1-score": 0.9760534728276663,
    "support": 155.0
  }
}
2025-02-26 19:41:01,971 - INFO - Saved processed data locally to processed_data_20250226_194101.csv
2025-02-26 19:41:01,974 - INFO - JSON data size: 380935 bytes
2025-02-26 19:41:01,974 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:41:01,974 - INFO - Data sent successfully!
2025-02-26 19:41:01,974 - INFO - Data processing and transmission completed successfully
2025-02-26 19:41:01,975 - INFO - Starting data processing
2025-02-26 19:41:01,975 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:41:01,975 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:41:01,976 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:41:01,976 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:41:02,078 - INFO - Broker version identified as 2.5.0
2025-02-26 19:41:02,078 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:41:02,079 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:41:02,079 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:41:02,079 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:41:02,080 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:41:02,080 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:41:02,080 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:41:02,080 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:41:02,278 - INFO - Received 100 messages so far
2025-02-26 19:41:02,278 - INFO - Received 200 messages so far
2025-02-26 19:41:02,278 - INFO - Received 300 messages so far
2025-02-26 19:41:02,278 - INFO - Received 400 messages so far
2025-02-26 19:41:02,279 - INFO - Received 500 messages so far
2025-02-26 19:41:02,279 - INFO - Received 600 messages so far
2025-02-26 19:41:02,279 - INFO - Received 700 messages so far
2025-02-26 19:41:02,279 - INFO - Received 800 messages so far
2025-02-26 19:41:02,279 - INFO - Received 900 messages so far
2025-02-26 19:41:02,280 - INFO - Received 1000 messages so far
2025-02-26 19:41:02,280 - INFO - Received 1100 messages so far
2025-02-26 19:41:02,280 - INFO - Received 1200 messages so far
2025-02-26 19:41:02,280 - INFO - Received 1300 messages so far
2025-02-26 19:41:02,280 - INFO - Received 1400 messages so far
2025-02-26 19:41:02,281 - INFO - Received 1500 messages so far
2025-02-26 19:41:02,281 - INFO - Received 1600 messages so far
2025-02-26 19:41:02,281 - INFO - Received 1700 messages so far
2025-02-26 19:41:02,281 - INFO - Received 1800 messages so far
2025-02-26 19:41:02,281 - INFO - Received 1900 messages so far
2025-02-26 19:41:02,282 - INFO - Received 2000 messages so far
2025-02-26 19:41:02,282 - INFO - Received 2100 messages so far
2025-02-26 19:41:02,282 - INFO - Received 2200 messages so far
2025-02-26 19:41:02,282 - INFO - Received 2300 messages so far
2025-02-26 19:41:02,282 - INFO - Received 2400 messages so far
2025-02-26 19:41:02,283 - INFO - Received 2500 messages so far
2025-02-26 19:41:02,283 - INFO - Received 2600 messages so far
2025-02-26 19:41:02,283 - INFO - Received 2700 messages so far
2025-02-26 19:41:02,283 - INFO - Received 2800 messages so far
2025-02-26 19:41:02,283 - INFO - Received 2900 messages so far
2025-02-26 19:41:02,284 - INFO - Received 3000 messages so far
2025-02-26 19:41:02,284 - INFO - Received 3100 messages so far
2025-02-26 19:41:02,284 - INFO - Received 3200 messages so far
2025-02-26 19:41:02,284 - INFO - Received 3300 messages so far
2025-02-26 19:41:02,284 - INFO - Received 3400 messages so far
2025-02-26 19:41:02,285 - INFO - Received 3500 messages so far
2025-02-26 19:41:02,285 - INFO - Received 3600 messages so far
2025-02-26 19:41:02,285 - INFO - Received 3700 messages so far
2025-02-26 19:41:02,285 - INFO - Received 3800 messages so far
2025-02-26 19:41:02,285 - INFO - Received 3900 messages so far
2025-02-26 19:41:02,286 - INFO - Received 4000 messages so far
2025-02-26 19:41:02,286 - INFO - Received 4100 messages so far
2025-02-26 19:41:02,341 - INFO - Received 4200 messages so far
2025-02-26 19:41:02,341 - INFO - Received 4300 messages so far
2025-02-26 19:41:02,341 - INFO - Received 4400 messages so far
2025-02-26 19:41:02,342 - INFO - Received 4500 messages so far
2025-02-26 19:41:02,342 - INFO - Received 4600 messages so far
2025-02-26 19:41:02,342 - INFO - Received 4700 messages so far
2025-02-26 19:41:02,342 - INFO - Received 4800 messages so far
2025-02-26 19:41:02,342 - INFO - Received 4900 messages so far
2025-02-26 19:41:02,343 - INFO - Received 5000 messages so far
2025-02-26 19:41:02,343 - INFO - Received 5100 messages so far
2025-02-26 19:41:02,343 - INFO - Received 5200 messages so far
2025-02-26 19:41:02,343 - INFO - Received 5300 messages so far
2025-02-26 19:41:02,343 - INFO - Received 5400 messages so far
2025-02-26 19:41:02,344 - INFO - Received 5500 messages so far
2025-02-26 19:41:02,344 - INFO - Received 5600 messages so far
2025-02-26 19:41:02,344 - INFO - Received 5700 messages so far
2025-02-26 19:41:02,344 - INFO - Received 5800 messages so far
2025-02-26 19:41:02,344 - INFO - Received 5900 messages so far
2025-02-26 19:41:02,345 - INFO - Received 6000 messages so far
2025-02-26 19:41:02,345 - INFO - Received 6100 messages so far
2025-02-26 19:41:02,345 - INFO - Received 6200 messages so far
2025-02-26 19:41:02,345 - INFO - Received 6300 messages so far
2025-02-26 19:41:02,345 - INFO - Received 6400 messages so far
2025-02-26 19:41:02,346 - INFO - Received 6500 messages so far
2025-02-26 19:41:02,346 - INFO - Received 6600 messages so far
2025-02-26 19:41:02,346 - INFO - Received 6700 messages so far
2025-02-26 19:41:02,346 - INFO - Received 6800 messages so far
2025-02-26 19:41:02,346 - INFO - Received 6900 messages so far
2025-02-26 19:41:02,347 - INFO - Received 7000 messages so far
2025-02-26 19:41:02,347 - INFO - Received 7100 messages so far
2025-02-26 19:41:02,347 - INFO - Received 7200 messages so far
2025-02-26 19:41:02,347 - INFO - Received 7300 messages so far
2025-02-26 19:41:02,347 - INFO - Received 7400 messages so far
2025-02-26 19:41:02,348 - INFO - Received 7500 messages so far
2025-02-26 19:41:02,348 - INFO - Received 7600 messages so far
2025-02-26 19:41:02,348 - INFO - Received 7700 messages so far
2025-02-26 19:41:02,348 - INFO - Received 7800 messages so far
2025-02-26 19:41:02,348 - INFO - Received 7900 messages so far
2025-02-26 19:41:02,348 - INFO - Received 8000 messages so far
2025-02-26 19:41:02,349 - INFO - Received 8100 messages so far
2025-02-26 19:41:02,349 - INFO - Received 8200 messages so far
2025-02-26 19:41:02,349 - INFO - Received 8300 messages so far
2025-02-26 19:41:02,349 - INFO - Received 8400 messages so far
2025-02-26 19:41:02,349 - INFO - Received 8500 messages so far
2025-02-26 19:41:02,350 - INFO - Received 8600 messages so far
2025-02-26 19:41:02,350 - INFO - Received 8700 messages so far
2025-02-26 19:41:02,405 - INFO - Received 8800 messages so far
2025-02-26 19:41:02,406 - INFO - Received 8900 messages so far
2025-02-26 19:41:02,406 - INFO - Received 9000 messages so far
2025-02-26 19:41:02,406 - INFO - Received 9100 messages so far
2025-02-26 19:41:02,406 - INFO - Received 9200 messages so far
2025-02-26 19:41:02,406 - INFO - Received 9300 messages so far
2025-02-26 19:41:02,407 - INFO - Received 9400 messages so far
2025-02-26 19:41:02,407 - INFO - Received 9500 messages so far
2025-02-26 19:41:02,407 - INFO - Received 9600 messages so far
2025-02-26 19:41:02,407 - INFO - Received 9700 messages so far
2025-02-26 19:41:02,407 - INFO - Received 9800 messages so far
2025-02-26 19:41:02,407 - INFO - Received 9900 messages so far
2025-02-26 19:41:02,408 - INFO - Received 10000 messages so far
2025-02-26 19:41:02,408 - INFO - Total messages consumed: 10000
2025-02-26 19:41:02,495 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:41:02,499 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:02,499 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:41:02,499 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:02,499 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:41:02,507 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:41:02,510 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:41:02,510 - INFO - Number of columns: 66
2025-02-26 19:41:02,522 - INFO - DataFrame head:
      id.resp_p    id.orig_h      id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                             query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                              answers          TTLs rejected conn_state local_orig local_resp  missed_bytes   history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto    duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3286     9092.0  192.168.1.3    192.168.1.4   tcp         0.0         0.0  1.740119e+09      NaN  NaN     NaN  CMBxrw2UMsxqyrWcJ5    57842.0       NaN                               NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                  NaN           NaN      NaN        REJ       True       True           0.0        Sr        1.0           60.0        1.0           40.0       6.0    0.000555     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1415      443.0  192.168.1.3  104.18.32.137   tcp     13530.0      4252.0  1.740118e+09      NaN  NaN     ssl   CGsm4yg3HP6MYnZec    52878.0       NaN                               NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                  NaN           NaN      NaN         SF       True      False           0.0  ShADadFf       24.0        14786.0       20.0         5300.0       6.0  283.614018     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8904        NaN          NaN            NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                               NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                  NaN           NaN      NaN        NaN        NaN        NaN           NaN       NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7382        NaN          NaN            NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                               NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                  NaN           NaN      NaN        NaN        NaN        NaN           NaN       NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1655       53.0  192.168.1.3    192.168.1.1   udp         NaN         NaN  1.740118e+09      NaN  NaN     NaN  CHW8X31pPxSRVsLSh1    35086.0  0.002415  mobile.events.data.microsoft.com     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  True  0.0  [mobile.events.data.trafficmanager.net, onedscolprdwus17.westus.cloudapp.azure.com]  [95.0, 19.0]    False        NaN        NaN        NaN           NaN       NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:41:02,522 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:41:02,552 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:41:02,597 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    fb5090d671c8a979              fb5090d671c8a979  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:41:02,597 - INFO - Unique values in 'id.resp_p' before labeling: [ 9092.   443.    nan    53.  5353.  1900.   133.   123.   135.   138.
    80. 21116.   136.    22.    67.   134.     0.   547. 21115.]
2025-02-26 19:41:02,598 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:41:02,603 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:02,605 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:41:02,605 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:41:02,607 - INFO - DataFrame shape after NA dropping: (900, 23)
2025-02-26 19:41:02,607 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:41:02,607 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:41:02,608 - INFO - X shape: (900, 21), y shape: (900,)
2025-02-26 19:41:02,608 - INFO - Label distribution in training data: {'DNS': 752, 'HTTPS': 133, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:02,609 - INFO - Training model...
2025-02-26 19:41:02,724 - INFO - Predicting on test data...
2025-02-26 19:41:02,738 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 153.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 2.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 25.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 180.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 180.0
  }
}
2025-02-26 19:41:02,745 - INFO - Saved processed data locally to processed_data_20250226_194102.csv
2025-02-26 19:41:02,748 - INFO - JSON data size: 440834 bytes
2025-02-26 19:41:02,748 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:41:02,748 - INFO - Data sent successfully!
2025-02-26 19:41:02,748 - INFO - Data processing and transmission completed successfully
2025-02-26 19:41:02,749 - INFO - Starting data processing
2025-02-26 19:41:02,749 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:41:02,750 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:41:02,751 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:41:02,751 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:41:02,853 - INFO - Broker version identified as 2.5.0
2025-02-26 19:41:02,853 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:41:02,853 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:41:02,853 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:41:02,853 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:41:02,854 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:41:02,854 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:41:02,855 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:41:02,855 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:41:03,008 - INFO - Received 100 messages so far
2025-02-26 19:41:03,008 - INFO - Received 200 messages so far
2025-02-26 19:41:03,008 - INFO - Received 300 messages so far
2025-02-26 19:41:03,009 - INFO - Received 400 messages so far
2025-02-26 19:41:03,009 - INFO - Received 500 messages so far
2025-02-26 19:41:03,009 - INFO - Received 600 messages so far
2025-02-26 19:41:03,009 - INFO - Received 700 messages so far
2025-02-26 19:41:03,009 - INFO - Received 800 messages so far
2025-02-26 19:41:03,010 - INFO - Received 900 messages so far
2025-02-26 19:41:03,010 - INFO - Received 1000 messages so far
2025-02-26 19:41:03,010 - INFO - Received 1100 messages so far
2025-02-26 19:41:03,010 - INFO - Received 1200 messages so far
2025-02-26 19:41:03,010 - INFO - Received 1300 messages so far
2025-02-26 19:41:03,011 - INFO - Received 1400 messages so far
2025-02-26 19:41:03,011 - INFO - Received 1500 messages so far
2025-02-26 19:41:03,011 - INFO - Received 1600 messages so far
2025-02-26 19:41:03,011 - INFO - Received 1700 messages so far
2025-02-26 19:41:03,011 - INFO - Received 1800 messages so far
2025-02-26 19:41:03,011 - INFO - Received 1900 messages so far
2025-02-26 19:41:03,012 - INFO - Received 2000 messages so far
2025-02-26 19:41:03,012 - INFO - Received 2100 messages so far
2025-02-26 19:41:03,012 - INFO - Received 2200 messages so far
2025-02-26 19:41:03,012 - INFO - Received 2300 messages so far
2025-02-26 19:41:03,012 - INFO - Received 2400 messages so far
2025-02-26 19:41:03,013 - INFO - Received 2500 messages so far
2025-02-26 19:41:03,013 - INFO - Received 2600 messages so far
2025-02-26 19:41:03,013 - INFO - Received 2700 messages so far
2025-02-26 19:41:03,013 - INFO - Received 2800 messages so far
2025-02-26 19:41:03,013 - INFO - Received 2900 messages so far
2025-02-26 19:41:03,014 - INFO - Received 3000 messages so far
2025-02-26 19:41:03,014 - INFO - Received 3100 messages so far
2025-02-26 19:41:03,014 - INFO - Received 3200 messages so far
2025-02-26 19:41:03,014 - INFO - Received 3300 messages so far
2025-02-26 19:41:03,014 - INFO - Received 3400 messages so far
2025-02-26 19:41:03,015 - INFO - Received 3500 messages so far
2025-02-26 19:41:03,015 - INFO - Received 3600 messages so far
2025-02-26 19:41:03,015 - INFO - Received 3700 messages so far
2025-02-26 19:41:03,015 - INFO - Received 3800 messages so far
2025-02-26 19:41:03,015 - INFO - Received 3900 messages so far
2025-02-26 19:41:03,016 - INFO - Received 4000 messages so far
2025-02-26 19:41:03,016 - INFO - Received 4100 messages so far
2025-02-26 19:41:03,119 - INFO - Received 4200 messages so far
2025-02-26 19:41:03,119 - INFO - Received 4300 messages so far
2025-02-26 19:41:03,119 - INFO - Received 4400 messages so far
2025-02-26 19:41:03,120 - INFO - Received 4500 messages so far
2025-02-26 19:41:03,120 - INFO - Received 4600 messages so far
2025-02-26 19:41:03,120 - INFO - Received 4700 messages so far
2025-02-26 19:41:03,120 - INFO - Received 4800 messages so far
2025-02-26 19:41:03,121 - INFO - Received 4900 messages so far
2025-02-26 19:41:03,121 - INFO - Received 5000 messages so far
2025-02-26 19:41:03,121 - INFO - Received 5100 messages so far
2025-02-26 19:41:03,121 - INFO - Received 5200 messages so far
2025-02-26 19:41:03,121 - INFO - Received 5300 messages so far
2025-02-26 19:41:03,122 - INFO - Received 5400 messages so far
2025-02-26 19:41:03,122 - INFO - Received 5500 messages so far
2025-02-26 19:41:03,122 - INFO - Received 5600 messages so far
2025-02-26 19:41:03,122 - INFO - Received 5700 messages so far
2025-02-26 19:41:03,123 - INFO - Received 5800 messages so far
2025-02-26 19:41:03,123 - INFO - Received 5900 messages so far
2025-02-26 19:41:03,123 - INFO - Received 6000 messages so far
2025-02-26 19:41:03,123 - INFO - Received 6100 messages so far
2025-02-26 19:41:03,123 - INFO - Received 6200 messages so far
2025-02-26 19:41:03,124 - INFO - Received 6300 messages so far
2025-02-26 19:41:03,124 - INFO - Received 6400 messages so far
2025-02-26 19:41:03,124 - INFO - Received 6500 messages so far
2025-02-26 19:41:03,124 - INFO - Received 6600 messages so far
2025-02-26 19:41:03,125 - INFO - Received 6700 messages so far
2025-02-26 19:41:03,125 - INFO - Received 6800 messages so far
2025-02-26 19:41:03,125 - INFO - Received 6900 messages so far
2025-02-26 19:41:03,125 - INFO - Received 7000 messages so far
2025-02-26 19:41:03,125 - INFO - Received 7100 messages so far
2025-02-26 19:41:03,126 - INFO - Received 7200 messages so far
2025-02-26 19:41:03,126 - INFO - Received 7300 messages so far
2025-02-26 19:41:03,126 - INFO - Received 7400 messages so far
2025-02-26 19:41:03,126 - INFO - Received 7500 messages so far
2025-02-26 19:41:03,127 - INFO - Received 7600 messages so far
2025-02-26 19:41:03,127 - INFO - Received 7700 messages so far
2025-02-26 19:41:03,127 - INFO - Received 7800 messages so far
2025-02-26 19:41:03,127 - INFO - Received 7900 messages so far
2025-02-26 19:41:03,127 - INFO - Received 8000 messages so far
2025-02-26 19:41:03,128 - INFO - Received 8100 messages so far
2025-02-26 19:41:03,128 - INFO - Received 8200 messages so far
2025-02-26 19:41:03,128 - INFO - Received 8300 messages so far
2025-02-26 19:41:03,128 - INFO - Received 8400 messages so far
2025-02-26 19:41:03,129 - INFO - Received 8500 messages so far
2025-02-26 19:41:03,129 - INFO - Received 8600 messages so far
2025-02-26 19:41:03,129 - INFO - Received 8700 messages so far
2025-02-26 19:41:03,187 - INFO - Received 8800 messages so far
2025-02-26 19:41:03,187 - INFO - Received 8900 messages so far
2025-02-26 19:41:03,187 - INFO - Received 9000 messages so far
2025-02-26 19:41:03,187 - INFO - Received 9100 messages so far
2025-02-26 19:41:03,188 - INFO - Received 9200 messages so far
2025-02-26 19:41:03,188 - INFO - Received 9300 messages so far
2025-02-26 19:41:03,188 - INFO - Received 9400 messages so far
2025-02-26 19:41:03,188 - INFO - Received 9500 messages so far
2025-02-26 19:41:03,188 - INFO - Received 9600 messages so far
2025-02-26 19:41:03,189 - INFO - Received 9700 messages so far
2025-02-26 19:41:03,189 - INFO - Received 9800 messages so far
2025-02-26 19:41:03,189 - INFO - Received 9900 messages so far
2025-02-26 19:41:03,189 - INFO - Received 10000 messages so far
2025-02-26 19:41:03,189 - INFO - Total messages consumed: 10000
2025-02-26 19:41:03,285 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:41:03,289 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:03,289 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:41:03,289 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:03,290 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:41:03,298 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:41:03,301 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:41:03,301 - INFO - Number of columns: 66
2025-02-26 19:41:03,312 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9023        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7866        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.008836     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6536        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7587        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.009721     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3904        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.007222     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:41:03,312 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:41:03,342 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:41:03,386 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    6b77933b392d05f9              eb77933b392d05f9  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:41:03,387 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443.  5353.   133.   123.  1900.    67.   138.
    80. 21115.   134.   547.    22.     0. 21116.   136.   135.]
2025-02-26 19:41:03,388 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:41:03,393 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:03,394 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:41:03,394 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:41:03,396 - INFO - DataFrame shape after NA dropping: (872, 23)
2025-02-26 19:41:03,396 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:41:03,396 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:41:03,397 - INFO - X shape: (872, 21), y shape: (872,)
2025-02-26 19:41:03,397 - INFO - Label distribution in training data: {'DNS': 727, 'HTTPS': 130, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:03,398 - INFO - Training model...
2025-02-26 19:41:03,506 - INFO - Predicting on test data...
2025-02-26 19:41:03,519 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 141.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.6666666666666666,
    "f1-score": 0.8,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.96875,
    "recall": 1.0,
    "f1-score": 0.9841269841269841,
    "support": 31.0
  },
  "accuracy": 0.9942857142857143,
  "macro avg": {
    "precision": 0.9895833333333334,
    "recall": 0.8888888888888888,
    "f1-score": 0.928042328042328,
    "support": 175.0
  },
  "weighted avg": {
    "precision": 0.9944642857142857,
    "recall": 0.9942857142857143,
    "f1-score": 0.9937596371882086,
    "support": 175.0
  }
}
2025-02-26 19:41:03,525 - INFO - Saved processed data locally to processed_data_20250226_194103.csv
2025-02-26 19:41:03,528 - INFO - JSON data size: 428295 bytes
2025-02-26 19:41:03,528 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:41:03,528 - INFO - Data sent successfully!
2025-02-26 19:41:03,528 - INFO - Data processing and transmission completed successfully
2025-02-26 19:41:03,529 - INFO - Starting data processing
2025-02-26 19:41:03,529 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:41:03,530 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:41:03,530 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:41:03,531 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:41:03,632 - INFO - Broker version identified as 2.5.0
2025-02-26 19:41:03,632 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:41:03,633 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:41:03,633 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:41:03,633 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:41:03,634 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:41:03,634 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:41:03,634 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:41:03,634 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:41:03,789 - INFO - Received 100 messages so far
2025-02-26 19:41:03,789 - INFO - Received 200 messages so far
2025-02-26 19:41:03,789 - INFO - Received 300 messages so far
2025-02-26 19:41:03,789 - INFO - Received 400 messages so far
2025-02-26 19:41:03,789 - INFO - Received 500 messages so far
2025-02-26 19:41:03,790 - INFO - Received 600 messages so far
2025-02-26 19:41:03,790 - INFO - Received 700 messages so far
2025-02-26 19:41:03,790 - INFO - Received 800 messages so far
2025-02-26 19:41:03,790 - INFO - Received 900 messages so far
2025-02-26 19:41:03,790 - INFO - Received 1000 messages so far
2025-02-26 19:41:03,791 - INFO - Received 1100 messages so far
2025-02-26 19:41:03,791 - INFO - Received 1200 messages so far
2025-02-26 19:41:03,791 - INFO - Received 1300 messages so far
2025-02-26 19:41:03,791 - INFO - Received 1400 messages so far
2025-02-26 19:41:03,791 - INFO - Received 1500 messages so far
2025-02-26 19:41:03,792 - INFO - Received 1600 messages so far
2025-02-26 19:41:03,792 - INFO - Received 1700 messages so far
2025-02-26 19:41:03,792 - INFO - Received 1800 messages so far
2025-02-26 19:41:03,792 - INFO - Received 1900 messages so far
2025-02-26 19:41:03,792 - INFO - Received 2000 messages so far
2025-02-26 19:41:03,793 - INFO - Received 2100 messages so far
2025-02-26 19:41:03,793 - INFO - Received 2200 messages so far
2025-02-26 19:41:03,793 - INFO - Received 2300 messages so far
2025-02-26 19:41:03,793 - INFO - Received 2400 messages so far
2025-02-26 19:41:03,793 - INFO - Received 2500 messages so far
2025-02-26 19:41:03,794 - INFO - Received 2600 messages so far
2025-02-26 19:41:03,794 - INFO - Received 2700 messages so far
2025-02-26 19:41:03,794 - INFO - Received 2800 messages so far
2025-02-26 19:41:03,794 - INFO - Received 2900 messages so far
2025-02-26 19:41:03,794 - INFO - Received 3000 messages so far
2025-02-26 19:41:03,795 - INFO - Received 3100 messages so far
2025-02-26 19:41:03,795 - INFO - Received 3200 messages so far
2025-02-26 19:41:03,795 - INFO - Received 3300 messages so far
2025-02-26 19:41:03,795 - INFO - Received 3400 messages so far
2025-02-26 19:41:03,795 - INFO - Received 3500 messages so far
2025-02-26 19:41:03,796 - INFO - Received 3600 messages so far
2025-02-26 19:41:03,796 - INFO - Received 3700 messages so far
2025-02-26 19:41:03,796 - INFO - Received 3800 messages so far
2025-02-26 19:41:03,796 - INFO - Received 3900 messages so far
2025-02-26 19:41:03,796 - INFO - Received 4000 messages so far
2025-02-26 19:41:03,797 - INFO - Received 4100 messages so far
2025-02-26 19:41:03,851 - INFO - Received 4200 messages so far
2025-02-26 19:41:03,852 - INFO - Received 4300 messages so far
2025-02-26 19:41:03,852 - INFO - Received 4400 messages so far
2025-02-26 19:41:03,852 - INFO - Received 4500 messages so far
2025-02-26 19:41:03,852 - INFO - Received 4600 messages so far
2025-02-26 19:41:03,853 - INFO - Received 4700 messages so far
2025-02-26 19:41:03,853 - INFO - Received 4800 messages so far
2025-02-26 19:41:03,853 - INFO - Received 4900 messages so far
2025-02-26 19:41:03,853 - INFO - Received 5000 messages so far
2025-02-26 19:41:03,853 - INFO - Received 5100 messages so far
2025-02-26 19:41:03,854 - INFO - Received 5200 messages so far
2025-02-26 19:41:03,854 - INFO - Received 5300 messages so far
2025-02-26 19:41:03,854 - INFO - Received 5400 messages so far
2025-02-26 19:41:03,854 - INFO - Received 5500 messages so far
2025-02-26 19:41:03,854 - INFO - Received 5600 messages so far
2025-02-26 19:41:03,855 - INFO - Received 5700 messages so far
2025-02-26 19:41:03,855 - INFO - Received 5800 messages so far
2025-02-26 19:41:03,855 - INFO - Received 5900 messages so far
2025-02-26 19:41:03,855 - INFO - Received 6000 messages so far
2025-02-26 19:41:03,855 - INFO - Received 6100 messages so far
2025-02-26 19:41:03,856 - INFO - Received 6200 messages so far
2025-02-26 19:41:03,856 - INFO - Received 6300 messages so far
2025-02-26 19:41:03,856 - INFO - Received 6400 messages so far
2025-02-26 19:41:03,856 - INFO - Received 6500 messages so far
2025-02-26 19:41:03,856 - INFO - Received 6600 messages so far
2025-02-26 19:41:03,856 - INFO - Received 6700 messages so far
2025-02-26 19:41:03,857 - INFO - Received 6800 messages so far
2025-02-26 19:41:03,857 - INFO - Received 6900 messages so far
2025-02-26 19:41:03,857 - INFO - Received 7000 messages so far
2025-02-26 19:41:03,857 - INFO - Received 7100 messages so far
2025-02-26 19:41:03,857 - INFO - Received 7200 messages so far
2025-02-26 19:41:03,858 - INFO - Received 7300 messages so far
2025-02-26 19:41:03,858 - INFO - Received 7400 messages so far
2025-02-26 19:41:03,858 - INFO - Received 7500 messages so far
2025-02-26 19:41:03,858 - INFO - Received 7600 messages so far
2025-02-26 19:41:03,858 - INFO - Received 7700 messages so far
2025-02-26 19:41:03,859 - INFO - Received 7800 messages so far
2025-02-26 19:41:03,859 - INFO - Received 7900 messages so far
2025-02-26 19:41:03,859 - INFO - Received 8000 messages so far
2025-02-26 19:41:03,859 - INFO - Received 8100 messages so far
2025-02-26 19:41:03,859 - INFO - Received 8200 messages so far
2025-02-26 19:41:03,860 - INFO - Received 8300 messages so far
2025-02-26 19:41:03,860 - INFO - Received 8400 messages so far
2025-02-26 19:41:03,860 - INFO - Received 8500 messages so far
2025-02-26 19:41:03,860 - INFO - Received 8600 messages so far
2025-02-26 19:41:03,861 - INFO - Received 8700 messages so far
2025-02-26 19:41:03,915 - INFO - Received 8800 messages so far
2025-02-26 19:41:03,915 - INFO - Received 8900 messages so far
2025-02-26 19:41:03,915 - INFO - Received 9000 messages so far
2025-02-26 19:41:03,916 - INFO - Received 9100 messages so far
2025-02-26 19:41:03,916 - INFO - Received 9200 messages so far
2025-02-26 19:41:03,916 - INFO - Received 9300 messages so far
2025-02-26 19:41:03,916 - INFO - Received 9400 messages so far
2025-02-26 19:41:03,916 - INFO - Received 9500 messages so far
2025-02-26 19:41:03,917 - INFO - Received 9600 messages so far
2025-02-26 19:41:03,917 - INFO - Received 9700 messages so far
2025-02-26 19:41:03,917 - INFO - Received 9800 messages so far
2025-02-26 19:41:03,917 - INFO - Received 9900 messages so far
2025-02-26 19:41:03,917 - INFO - Received 10000 messages so far
2025-02-26 19:41:03,918 - INFO - Total messages consumed: 10000
2025-02-26 19:41:04,002 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:41:04,006 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:04,006 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:41:04,006 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:04,007 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:41:04,014 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:41:04,018 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:41:04,018 - INFO - Number of columns: 66
2025-02-26 19:41:04,028 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
5080        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7426        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9539        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1836        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005324     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4707        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:41:04,028 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:41:04,059 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:41:04,144 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    b90b0ae34b0b9725              f90b0ae34b0b9725  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:41:04,145 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   443.   123.    80.  5353.   135.  1900.   138.
   134.   136.   133. 21116.    67.    22.     0.   547. 21115.]
2025-02-26 19:41:04,146 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:41:04,151 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:04,152 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:41:04,152 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:41:04,154 - INFO - DataFrame shape after NA dropping: (907, 23)
2025-02-26 19:41:04,154 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:41:04,154 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:41:04,155 - INFO - X shape: (907, 21), y shape: (907,)
2025-02-26 19:41:04,155 - INFO - Label distribution in training data: {'DNS': 758, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:04,156 - INFO - Training model...
2025-02-26 19:41:04,248 - INFO - Process interrupted by user.
