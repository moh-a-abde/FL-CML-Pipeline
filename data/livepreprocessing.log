2025-02-26 19:26:47,784 - INFO - Starting livepreprocessing_socket.py
2025-02-26 19:26:47,784 - INFO - Starting data processing
2025-02-26 19:26:47,784 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9000']
2025-02-26 19:26:47,786 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connecting> [IPv4 ('192.168.1.3', 9000)]>: connecting to 192.168.1.3:9000 [('192.168.1.3', 9000) IPv4]
2025-02-26 19:26:47,786 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:26:47,786 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connecting> [IPv4 ('192.168.1.3', 9000)]>: Connection complete.
2025-02-26 19:26:49,889 - WARNING - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connected> [IPv4 ('192.168.1.3', 9000)]> timed out after 1998.4943866729736 ms. Closing connection.
2025-02-26 19:26:49,889 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connected> [IPv4 ('192.168.1.3', 9000)]>: Closing connection. [Error 7] RequestTimedOutError: Request timed out after 1998.4943866729736 ms
2025-02-26 19:26:49,890 - INFO - Broker is not v(0, 10) -- it did not recognize ApiVersionRequest_v0
2025-02-26 19:26:49,890 - ERROR - An error occurred while reading from Kafka: NoBrokersAvailable
Traceback (most recent call last):
  File "/home/mohamed/Desktop/workstation/FL-CML-Pipeline/data/livepreprocessing_socket.py", line 35, in read_kafka_topic
    consumer = KafkaConsumer(
  File "/home/mohamed/.pyenv/versions/3.10.4/lib/python3.10/site-packages/kafka/consumer/group.py", line 356, in __init__
    self._client = KafkaClient(metrics=self._metrics, **self.config)
  File "/home/mohamed/.pyenv/versions/3.10.4/lib/python3.10/site-packages/kafka/client_async.py", line 244, in __init__
    self.config['api_version'] = self.check_version(timeout=check_timeout)
  File "/home/mohamed/.pyenv/versions/3.10.4/lib/python3.10/site-packages/kafka/client_async.py", line 927, in check_version
    raise Errors.NoBrokersAvailable()
kafka.errors.NoBrokersAvailable: NoBrokersAvailable
2025-02-26 19:26:49,891 - WARNING - No data received from Kafka, skipping processing
2025-02-26 19:26:49,891 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:27:19,922 - INFO - Starting data processing
2025-02-26 19:27:19,922 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9000']
2025-02-26 19:27:19,923 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connecting> [IPv4 ('192.168.1.3', 9000)]>: connecting to 192.168.1.3:9000 [('192.168.1.3', 9000) IPv4]
2025-02-26 19:27:19,923 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:27:19,923 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connecting> [IPv4 ('192.168.1.3', 9000)]>: Connection complete.
2025-02-26 19:27:22,026 - WARNING - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connected> [IPv4 ('192.168.1.3', 9000)]> timed out after 1999.4769096374512 ms. Closing connection.
2025-02-26 19:27:22,027 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9000 <connected> [IPv4 ('192.168.1.3', 9000)]>: Closing connection. [Error 7] RequestTimedOutError: Request timed out after 1999.4769096374512 ms
2025-02-26 19:27:22,027 - INFO - Broker is not v(0, 10) -- it did not recognize ApiVersionRequest_v0
2025-02-26 19:27:22,027 - ERROR - An error occurred while reading from Kafka: NoBrokersAvailable
Traceback (most recent call last):
  File "/home/mohamed/Desktop/workstation/FL-CML-Pipeline/data/livepreprocessing_socket.py", line 35, in read_kafka_topic
    consumer = KafkaConsumer(
  File "/home/mohamed/.pyenv/versions/3.10.4/lib/python3.10/site-packages/kafka/consumer/group.py", line 356, in __init__
    self._client = KafkaClient(metrics=self._metrics, **self.config)
  File "/home/mohamed/.pyenv/versions/3.10.4/lib/python3.10/site-packages/kafka/client_async.py", line 244, in __init__
    self.config['api_version'] = self.check_version(timeout=check_timeout)
  File "/home/mohamed/.pyenv/versions/3.10.4/lib/python3.10/site-packages/kafka/client_async.py", line 927, in check_version
    raise Errors.NoBrokersAvailable()
kafka.errors.NoBrokersAvailable: NoBrokersAvailable
2025-02-26 19:27:22,028 - WARNING - No data received from Kafka, skipping processing
2025-02-26 19:27:22,028 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:27:39,939 - INFO - Process interrupted by user.
2025-02-26 19:28:56,980 - INFO - Starting livepreprocessing_socket.py
2025-02-26 19:28:56,980 - INFO - Starting data processing
2025-02-26 19:28:56,980 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:28:56,982 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:28:56,982 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:28:56,982 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:28:57,087 - INFO - Broker version identified as 2.5.0
2025-02-26 19:28:57,087 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:28:57,088 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:28:57,088 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:28:57,088 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:28:57,089 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:28:57,090 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:28:57,090 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:28:57,090 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:28:57,250 - INFO - Received 100 messages so far
2025-02-26 19:28:57,251 - INFO - Received 200 messages so far
2025-02-26 19:28:57,251 - INFO - Received 300 messages so far
2025-02-26 19:28:57,251 - INFO - Received 400 messages so far
2025-02-26 19:28:57,251 - INFO - Received 500 messages so far
2025-02-26 19:28:57,252 - INFO - Received 600 messages so far
2025-02-26 19:28:57,252 - INFO - Received 700 messages so far
2025-02-26 19:28:57,252 - INFO - Received 800 messages so far
2025-02-26 19:28:57,252 - INFO - Received 900 messages so far
2025-02-26 19:28:57,253 - INFO - Received 1000 messages so far
2025-02-26 19:28:57,253 - INFO - Received 1100 messages so far
2025-02-26 19:28:57,253 - INFO - Received 1200 messages so far
2025-02-26 19:28:57,253 - INFO - Received 1300 messages so far
2025-02-26 19:28:57,253 - INFO - Received 1400 messages so far
2025-02-26 19:28:57,254 - INFO - Received 1500 messages so far
2025-02-26 19:28:57,254 - INFO - Received 1600 messages so far
2025-02-26 19:28:57,254 - INFO - Received 1700 messages so far
2025-02-26 19:28:57,254 - INFO - Received 1800 messages so far
2025-02-26 19:28:57,254 - INFO - Received 1900 messages so far
2025-02-26 19:28:57,255 - INFO - Received 2000 messages so far
2025-02-26 19:28:57,255 - INFO - Received 2100 messages so far
2025-02-26 19:28:57,255 - INFO - Received 2200 messages so far
2025-02-26 19:28:57,255 - INFO - Received 2300 messages so far
2025-02-26 19:28:57,255 - INFO - Received 2400 messages so far
2025-02-26 19:28:57,256 - INFO - Received 2500 messages so far
2025-02-26 19:28:57,256 - INFO - Received 2600 messages so far
2025-02-26 19:28:57,256 - INFO - Received 2700 messages so far
2025-02-26 19:28:57,256 - INFO - Received 2800 messages so far
2025-02-26 19:28:57,256 - INFO - Received 2900 messages so far
2025-02-26 19:28:57,257 - INFO - Received 3000 messages so far
2025-02-26 19:28:57,257 - INFO - Received 3100 messages so far
2025-02-26 19:28:57,257 - INFO - Received 3200 messages so far
2025-02-26 19:28:57,257 - INFO - Received 3300 messages so far
2025-02-26 19:28:57,257 - INFO - Received 3400 messages so far
2025-02-26 19:28:57,258 - INFO - Received 3500 messages so far
2025-02-26 19:28:57,258 - INFO - Received 3600 messages so far
2025-02-26 19:28:57,258 - INFO - Received 3700 messages so far
2025-02-26 19:28:57,258 - INFO - Received 3800 messages so far
2025-02-26 19:28:57,258 - INFO - Received 3900 messages so far
2025-02-26 19:28:57,258 - INFO - Received 4000 messages so far
2025-02-26 19:28:57,259 - INFO - Received 4100 messages so far
2025-02-26 19:28:57,318 - INFO - Received 4200 messages so far
2025-02-26 19:28:57,318 - INFO - Received 4300 messages so far
2025-02-26 19:28:57,318 - INFO - Received 4400 messages so far
2025-02-26 19:28:57,319 - INFO - Received 4500 messages so far
2025-02-26 19:28:57,319 - INFO - Received 4600 messages so far
2025-02-26 19:28:57,319 - INFO - Received 4700 messages so far
2025-02-26 19:28:57,319 - INFO - Received 4800 messages so far
2025-02-26 19:28:57,320 - INFO - Received 4900 messages so far
2025-02-26 19:28:57,320 - INFO - Received 5000 messages so far
2025-02-26 19:28:57,320 - INFO - Received 5100 messages so far
2025-02-26 19:28:57,320 - INFO - Received 5200 messages so far
2025-02-26 19:28:57,320 - INFO - Received 5300 messages so far
2025-02-26 19:28:57,321 - INFO - Received 5400 messages so far
2025-02-26 19:28:57,321 - INFO - Received 5500 messages so far
2025-02-26 19:28:57,321 - INFO - Received 5600 messages so far
2025-02-26 19:28:57,321 - INFO - Received 5700 messages so far
2025-02-26 19:28:57,321 - INFO - Received 5800 messages so far
2025-02-26 19:28:57,322 - INFO - Received 5900 messages so far
2025-02-26 19:28:57,322 - INFO - Received 6000 messages so far
2025-02-26 19:28:57,322 - INFO - Received 6100 messages so far
2025-02-26 19:28:57,322 - INFO - Received 6200 messages so far
2025-02-26 19:28:57,322 - INFO - Received 6300 messages so far
2025-02-26 19:28:57,322 - INFO - Received 6400 messages so far
2025-02-26 19:28:57,323 - INFO - Received 6500 messages so far
2025-02-26 19:28:57,323 - INFO - Received 6600 messages so far
2025-02-26 19:28:57,323 - INFO - Received 6700 messages so far
2025-02-26 19:28:57,323 - INFO - Received 6800 messages so far
2025-02-26 19:28:57,323 - INFO - Received 6900 messages so far
2025-02-26 19:28:57,324 - INFO - Received 7000 messages so far
2025-02-26 19:28:57,324 - INFO - Received 7100 messages so far
2025-02-26 19:28:57,324 - INFO - Received 7200 messages so far
2025-02-26 19:28:57,324 - INFO - Received 7300 messages so far
2025-02-26 19:28:57,324 - INFO - Received 7400 messages so far
2025-02-26 19:28:57,325 - INFO - Received 7500 messages so far
2025-02-26 19:28:57,325 - INFO - Received 7600 messages so far
2025-02-26 19:28:57,325 - INFO - Received 7700 messages so far
2025-02-26 19:28:57,325 - INFO - Received 7800 messages so far
2025-02-26 19:28:57,325 - INFO - Received 7900 messages so far
2025-02-26 19:28:57,326 - INFO - Received 8000 messages so far
2025-02-26 19:28:57,326 - INFO - Received 8100 messages so far
2025-02-26 19:28:57,326 - INFO - Received 8200 messages so far
2025-02-26 19:28:57,326 - INFO - Received 8300 messages so far
2025-02-26 19:28:57,326 - INFO - Received 8400 messages so far
2025-02-26 19:28:57,326 - INFO - Received 8500 messages so far
2025-02-26 19:28:57,327 - INFO - Received 8600 messages so far
2025-02-26 19:28:57,327 - INFO - Received 8700 messages so far
2025-02-26 19:28:57,425 - INFO - Received 8800 messages so far
2025-02-26 19:28:57,425 - INFO - Received 8900 messages so far
2025-02-26 19:28:57,425 - INFO - Received 9000 messages so far
2025-02-26 19:28:57,426 - INFO - Received 9100 messages so far
2025-02-26 19:28:57,426 - INFO - Received 9200 messages so far
2025-02-26 19:28:57,426 - INFO - Received 9300 messages so far
2025-02-26 19:28:57,427 - INFO - Received 9400 messages so far
2025-02-26 19:28:57,427 - INFO - Received 9500 messages so far
2025-02-26 19:28:57,427 - INFO - Received 9600 messages so far
2025-02-26 19:28:57,427 - INFO - Received 9700 messages so far
2025-02-26 19:28:57,427 - INFO - Received 9800 messages so far
2025-02-26 19:28:57,428 - INFO - Received 9900 messages so far
2025-02-26 19:28:57,428 - INFO - Received 10000 messages so far
2025-02-26 19:28:57,428 - INFO - Total messages consumed: 10000
2025-02-26 19:28:57,518 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:28:57,522 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:28:57,522 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:28:57,522 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:28:57,522 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:28:57,534 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:28:57,535 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:28:57,535 - INFO - Number of columns: 66
2025-02-26 19:28:57,548 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                               query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                               answers                   TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
2258        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                   NaN                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5914        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                   NaN                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9915        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                   NaN                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9707       53.0  192.168.1.3  192.168.1.1   udp        52.0       220.0  1.740120e+09      NaN  NaN     dns   C6FRWxHEz97jUiPZb    57668.0       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                   NaN                    NaN      NaN         SF       True       True           0.0      Dd        1.0           80.0        1.0          248.0      17.0  0.001386     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
307        53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740118e+09      NaN  NaN     NaN  CFmJND4WYa3ZYTfZL6    47879.0  0.001717  word-telemetry.officeapps.live.com     1.0  C_INTERNET    1.0          A    0.0    NOERROR  False  False  True  True  0.0  [word-telemetry.wac.trafficmanager.net, pgtus1-word-telemetry-vip.officeapps.live.com, 52.108.78.30]  [263.0, 263.0, 263.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:28:57,548 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:28:57,579 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:28:57,625 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version           client_initial_dcid client_scid                   server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                            19          19                            17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                            19           1                            17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13  53d430adb444f9c5ce75c07fa520              f3a21106ed00c9ab0a948d7162de  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                             1          19                             1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:28:57,626 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.   443.  9092.    80.  1900.  5353.     0.   123.   136.
   133. 21115.    22.   134.   138.   135. 21116.   547.    67.]
2025-02-26 19:28:57,631 - INFO - Label distribution: {}
2025-02-26 19:28:57,632 - WARNING - No data left after filtering for valid labels
2025-02-26 19:28:57,633 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:29:27,663 - INFO - Starting data processing
2025-02-26 19:29:27,663 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:29:27,664 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:29:27,665 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:29:27,665 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:29:27,767 - INFO - Broker version identified as 2.5.0
2025-02-26 19:29:27,768 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:29:27,768 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:29:27,768 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:29:27,768 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:29:27,769 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:29:27,769 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:29:27,770 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:29:27,770 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:29:27,941 - INFO - Received 100 messages so far
2025-02-26 19:29:27,941 - INFO - Received 200 messages so far
2025-02-26 19:29:27,941 - INFO - Received 300 messages so far
2025-02-26 19:29:27,941 - INFO - Received 400 messages so far
2025-02-26 19:29:27,941 - INFO - Received 500 messages so far
2025-02-26 19:29:27,942 - INFO - Received 600 messages so far
2025-02-26 19:29:27,942 - INFO - Received 700 messages so far
2025-02-26 19:29:27,942 - INFO - Received 800 messages so far
2025-02-26 19:29:27,942 - INFO - Received 900 messages so far
2025-02-26 19:29:27,943 - INFO - Received 1000 messages so far
2025-02-26 19:29:27,943 - INFO - Received 1100 messages so far
2025-02-26 19:29:27,944 - INFO - Received 1200 messages so far
2025-02-26 19:29:27,944 - INFO - Received 1300 messages so far
2025-02-26 19:29:27,944 - INFO - Received 1400 messages so far
2025-02-26 19:29:27,945 - INFO - Received 1500 messages so far
2025-02-26 19:29:27,945 - INFO - Received 1600 messages so far
2025-02-26 19:29:27,945 - INFO - Received 1700 messages so far
2025-02-26 19:29:27,945 - INFO - Received 1800 messages so far
2025-02-26 19:29:27,946 - INFO - Received 1900 messages so far
2025-02-26 19:29:27,946 - INFO - Received 2000 messages so far
2025-02-26 19:29:27,946 - INFO - Received 2100 messages so far
2025-02-26 19:29:27,946 - INFO - Received 2200 messages so far
2025-02-26 19:29:27,946 - INFO - Received 2300 messages so far
2025-02-26 19:29:27,947 - INFO - Received 2400 messages so far
2025-02-26 19:29:27,947 - INFO - Received 2500 messages so far
2025-02-26 19:29:27,947 - INFO - Received 2600 messages so far
2025-02-26 19:29:27,947 - INFO - Received 2700 messages so far
2025-02-26 19:29:27,947 - INFO - Received 2800 messages so far
2025-02-26 19:29:27,948 - INFO - Received 2900 messages so far
2025-02-26 19:29:27,948 - INFO - Received 3000 messages so far
2025-02-26 19:29:27,948 - INFO - Received 3100 messages so far
2025-02-26 19:29:27,948 - INFO - Received 3200 messages so far
2025-02-26 19:29:27,948 - INFO - Received 3300 messages so far
2025-02-26 19:29:27,949 - INFO - Received 3400 messages so far
2025-02-26 19:29:27,949 - INFO - Received 3500 messages so far
2025-02-26 19:29:27,949 - INFO - Received 3600 messages so far
2025-02-26 19:29:27,949 - INFO - Received 3700 messages so far
2025-02-26 19:29:27,949 - INFO - Received 3800 messages so far
2025-02-26 19:29:27,950 - INFO - Received 3900 messages so far
2025-02-26 19:29:27,950 - INFO - Received 4000 messages so far
2025-02-26 19:29:27,950 - INFO - Received 4100 messages so far
2025-02-26 19:29:28,008 - INFO - Received 4200 messages so far
2025-02-26 19:29:28,008 - INFO - Received 4300 messages so far
2025-02-26 19:29:28,009 - INFO - Received 4400 messages so far
2025-02-26 19:29:28,009 - INFO - Received 4500 messages so far
2025-02-26 19:29:28,009 - INFO - Received 4600 messages so far
2025-02-26 19:29:28,009 - INFO - Received 4700 messages so far
2025-02-26 19:29:28,009 - INFO - Received 4800 messages so far
2025-02-26 19:29:28,010 - INFO - Received 4900 messages so far
2025-02-26 19:29:28,010 - INFO - Received 5000 messages so far
2025-02-26 19:29:28,010 - INFO - Received 5100 messages so far
2025-02-26 19:29:28,010 - INFO - Received 5200 messages so far
2025-02-26 19:29:28,011 - INFO - Received 5300 messages so far
2025-02-26 19:29:28,011 - INFO - Received 5400 messages so far
2025-02-26 19:29:28,011 - INFO - Received 5500 messages so far
2025-02-26 19:29:28,011 - INFO - Received 5600 messages so far
2025-02-26 19:29:28,011 - INFO - Received 5700 messages so far
2025-02-26 19:29:28,012 - INFO - Received 5800 messages so far
2025-02-26 19:29:28,012 - INFO - Received 5900 messages so far
2025-02-26 19:29:28,012 - INFO - Received 6000 messages so far
2025-02-26 19:29:28,012 - INFO - Received 6100 messages so far
2025-02-26 19:29:28,012 - INFO - Received 6200 messages so far
2025-02-26 19:29:28,013 - INFO - Received 6300 messages so far
2025-02-26 19:29:28,013 - INFO - Received 6400 messages so far
2025-02-26 19:29:28,013 - INFO - Received 6500 messages so far
2025-02-26 19:29:28,013 - INFO - Received 6600 messages so far
2025-02-26 19:29:28,013 - INFO - Received 6700 messages so far
2025-02-26 19:29:28,014 - INFO - Received 6800 messages so far
2025-02-26 19:29:28,014 - INFO - Received 6900 messages so far
2025-02-26 19:29:28,014 - INFO - Received 7000 messages so far
2025-02-26 19:29:28,014 - INFO - Received 7100 messages so far
2025-02-26 19:29:28,014 - INFO - Received 7200 messages so far
2025-02-26 19:29:28,015 - INFO - Received 7300 messages so far
2025-02-26 19:29:28,015 - INFO - Received 7400 messages so far
2025-02-26 19:29:28,015 - INFO - Received 7500 messages so far
2025-02-26 19:29:28,015 - INFO - Received 7600 messages so far
2025-02-26 19:29:28,015 - INFO - Received 7700 messages so far
2025-02-26 19:29:28,016 - INFO - Received 7800 messages so far
2025-02-26 19:29:28,016 - INFO - Received 7900 messages so far
2025-02-26 19:29:28,016 - INFO - Received 8000 messages so far
2025-02-26 19:29:28,016 - INFO - Received 8100 messages so far
2025-02-26 19:29:28,016 - INFO - Received 8200 messages so far
2025-02-26 19:29:28,017 - INFO - Received 8300 messages so far
2025-02-26 19:29:28,017 - INFO - Received 8400 messages so far
2025-02-26 19:29:28,017 - INFO - Received 8500 messages so far
2025-02-26 19:29:28,017 - INFO - Received 8600 messages so far
2025-02-26 19:29:28,018 - INFO - Received 8700 messages so far
2025-02-26 19:29:28,079 - INFO - Received 8800 messages so far
2025-02-26 19:29:28,080 - INFO - Received 8900 messages so far
2025-02-26 19:29:28,080 - INFO - Received 9000 messages so far
2025-02-26 19:29:28,080 - INFO - Received 9100 messages so far
2025-02-26 19:29:28,080 - INFO - Received 9200 messages so far
2025-02-26 19:29:28,080 - INFO - Received 9300 messages so far
2025-02-26 19:29:28,081 - INFO - Received 9400 messages so far
2025-02-26 19:29:28,081 - INFO - Received 9500 messages so far
2025-02-26 19:29:28,081 - INFO - Received 9600 messages so far
2025-02-26 19:29:28,081 - INFO - Received 9700 messages so far
2025-02-26 19:29:28,082 - INFO - Received 9800 messages so far
2025-02-26 19:29:28,082 - INFO - Received 9900 messages so far
2025-02-26 19:29:28,082 - INFO - Received 10000 messages so far
2025-02-26 19:29:28,082 - INFO - Total messages consumed: 10000
2025-02-26 19:29:28,184 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:29:28,187 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:29:28,187 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:29:28,187 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:29:28,187 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:29:28,194 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:29:28,198 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:29:28,198 - INFO - Number of columns: 66
2025-02-26 19:29:28,208 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
2452        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.104254     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3466        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
162         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6230        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5231        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:29:28,208 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:29:28,239 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:29:28,285 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    6b77933b392d05f9              eb77933b392d05f9  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:29:28,286 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   443.  5353.  1900.   123.   136.   547. 21116.
     0.    80.   133.   134.   138.    67.    22. 21115.   135.]
2025-02-26 19:29:28,291 - INFO - Label distribution: {}
2025-02-26 19:29:28,292 - WARNING - No data left after filtering for valid labels
2025-02-26 19:29:28,293 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:29:36,933 - INFO - Process interrupted by user.
2025-02-26 19:31:16,239 - INFO - Starting livepreprocessing_socket.py
2025-02-26 19:31:16,239 - INFO - Sending test message to socket server
2025-02-26 19:31:16,239 - INFO - Attempting to send data to localhost:9000
2025-02-26 19:31:16,239 - ERROR - Connection refused to localhost:9000. Is the receiving server running?
2025-02-26 19:31:16,239 - ERROR - Failed to send test message
2025-02-26 19:31:16,239 - WARNING - Socket communication test failed, but proceeding anyway
2025-02-26 19:31:16,239 - INFO - Starting data processing
2025-02-26 19:31:16,239 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:31:16,241 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:31:16,241 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:31:16,241 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:31:16,344 - INFO - Broker version identified as 2.5.0
2025-02-26 19:31:16,344 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:31:16,344 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:31:16,344 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:31:16,344 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:31:16,345 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:31:16,346 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:31:16,346 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:31:16,346 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:31:16,503 - INFO - Received 100 messages so far
2025-02-26 19:31:16,504 - INFO - Received 200 messages so far
2025-02-26 19:31:16,504 - INFO - Received 300 messages so far
2025-02-26 19:31:16,504 - INFO - Received 400 messages so far
2025-02-26 19:31:16,504 - INFO - Received 500 messages so far
2025-02-26 19:31:16,505 - INFO - Received 600 messages so far
2025-02-26 19:31:16,505 - INFO - Received 700 messages so far
2025-02-26 19:31:16,505 - INFO - Received 800 messages so far
2025-02-26 19:31:16,505 - INFO - Received 900 messages so far
2025-02-26 19:31:16,506 - INFO - Received 1000 messages so far
2025-02-26 19:31:16,506 - INFO - Received 1100 messages so far
2025-02-26 19:31:16,506 - INFO - Received 1200 messages so far
2025-02-26 19:31:16,506 - INFO - Received 1300 messages so far
2025-02-26 19:31:16,506 - INFO - Received 1400 messages so far
2025-02-26 19:31:16,507 - INFO - Received 1500 messages so far
2025-02-26 19:31:16,507 - INFO - Received 1600 messages so far
2025-02-26 19:31:16,507 - INFO - Received 1700 messages so far
2025-02-26 19:31:16,507 - INFO - Received 1800 messages so far
2025-02-26 19:31:16,507 - INFO - Received 1900 messages so far
2025-02-26 19:31:16,508 - INFO - Received 2000 messages so far
2025-02-26 19:31:16,508 - INFO - Received 2100 messages so far
2025-02-26 19:31:16,508 - INFO - Received 2200 messages so far
2025-02-26 19:31:16,508 - INFO - Received 2300 messages so far
2025-02-26 19:31:16,508 - INFO - Received 2400 messages so far
2025-02-26 19:31:16,509 - INFO - Received 2500 messages so far
2025-02-26 19:31:16,509 - INFO - Received 2600 messages so far
2025-02-26 19:31:16,509 - INFO - Received 2700 messages so far
2025-02-26 19:31:16,509 - INFO - Received 2800 messages so far
2025-02-26 19:31:16,509 - INFO - Received 2900 messages so far
2025-02-26 19:31:16,510 - INFO - Received 3000 messages so far
2025-02-26 19:31:16,510 - INFO - Received 3100 messages so far
2025-02-26 19:31:16,510 - INFO - Received 3200 messages so far
2025-02-26 19:31:16,510 - INFO - Received 3300 messages so far
2025-02-26 19:31:16,510 - INFO - Received 3400 messages so far
2025-02-26 19:31:16,511 - INFO - Received 3500 messages so far
2025-02-26 19:31:16,511 - INFO - Received 3600 messages so far
2025-02-26 19:31:16,511 - INFO - Received 3700 messages so far
2025-02-26 19:31:16,511 - INFO - Received 3800 messages so far
2025-02-26 19:31:16,511 - INFO - Received 3900 messages so far
2025-02-26 19:31:16,512 - INFO - Received 4000 messages so far
2025-02-26 19:31:16,512 - INFO - Received 4100 messages so far
2025-02-26 19:31:16,571 - INFO - Received 4200 messages so far
2025-02-26 19:31:16,572 - INFO - Received 4300 messages so far
2025-02-26 19:31:16,572 - INFO - Received 4400 messages so far
2025-02-26 19:31:16,572 - INFO - Received 4500 messages so far
2025-02-26 19:31:16,572 - INFO - Received 4600 messages so far
2025-02-26 19:31:16,573 - INFO - Received 4700 messages so far
2025-02-26 19:31:16,573 - INFO - Received 4800 messages so far
2025-02-26 19:31:16,573 - INFO - Received 4900 messages so far
2025-02-26 19:31:16,573 - INFO - Received 5000 messages so far
2025-02-26 19:31:16,574 - INFO - Received 5100 messages so far
2025-02-26 19:31:16,574 - INFO - Received 5200 messages so far
2025-02-26 19:31:16,574 - INFO - Received 5300 messages so far
2025-02-26 19:31:16,574 - INFO - Received 5400 messages so far
2025-02-26 19:31:16,574 - INFO - Received 5500 messages so far
2025-02-26 19:31:16,575 - INFO - Received 5600 messages so far
2025-02-26 19:31:16,575 - INFO - Received 5700 messages so far
2025-02-26 19:31:16,575 - INFO - Received 5800 messages so far
2025-02-26 19:31:16,575 - INFO - Received 5900 messages so far
2025-02-26 19:31:16,575 - INFO - Received 6000 messages so far
2025-02-26 19:31:16,576 - INFO - Received 6100 messages so far
2025-02-26 19:31:16,576 - INFO - Received 6200 messages so far
2025-02-26 19:31:16,576 - INFO - Received 6300 messages so far
2025-02-26 19:31:16,576 - INFO - Received 6400 messages so far
2025-02-26 19:31:16,576 - INFO - Received 6500 messages so far
2025-02-26 19:31:16,576 - INFO - Received 6600 messages so far
2025-02-26 19:31:16,577 - INFO - Received 6700 messages so far
2025-02-26 19:31:16,577 - INFO - Received 6800 messages so far
2025-02-26 19:31:16,577 - INFO - Received 6900 messages so far
2025-02-26 19:31:16,577 - INFO - Received 7000 messages so far
2025-02-26 19:31:16,577 - INFO - Received 7100 messages so far
2025-02-26 19:31:16,578 - INFO - Received 7200 messages so far
2025-02-26 19:31:16,578 - INFO - Received 7300 messages so far
2025-02-26 19:31:16,578 - INFO - Received 7400 messages so far
2025-02-26 19:31:16,578 - INFO - Received 7500 messages so far
2025-02-26 19:31:16,578 - INFO - Received 7600 messages so far
2025-02-26 19:31:16,579 - INFO - Received 7700 messages so far
2025-02-26 19:31:16,579 - INFO - Received 7800 messages so far
2025-02-26 19:31:16,579 - INFO - Received 7900 messages so far
2025-02-26 19:31:16,579 - INFO - Received 8000 messages so far
2025-02-26 19:31:16,579 - INFO - Received 8100 messages so far
2025-02-26 19:31:16,580 - INFO - Received 8200 messages so far
2025-02-26 19:31:16,580 - INFO - Received 8300 messages so far
2025-02-26 19:31:16,580 - INFO - Received 8400 messages so far
2025-02-26 19:31:16,580 - INFO - Received 8500 messages so far
2025-02-26 19:31:16,580 - INFO - Received 8600 messages so far
2025-02-26 19:31:16,581 - INFO - Received 8700 messages so far
2025-02-26 19:31:16,682 - INFO - Received 8800 messages so far
2025-02-26 19:31:16,682 - INFO - Received 8900 messages so far
2025-02-26 19:31:16,682 - INFO - Received 9000 messages so far
2025-02-26 19:31:16,683 - INFO - Received 9100 messages so far
2025-02-26 19:31:16,683 - INFO - Received 9200 messages so far
2025-02-26 19:31:16,683 - INFO - Received 9300 messages so far
2025-02-26 19:31:16,684 - INFO - Received 9400 messages so far
2025-02-26 19:31:16,684 - INFO - Received 9500 messages so far
2025-02-26 19:31:16,684 - INFO - Received 9600 messages so far
2025-02-26 19:31:16,684 - INFO - Received 9700 messages so far
2025-02-26 19:31:16,684 - INFO - Received 9800 messages so far
2025-02-26 19:31:16,685 - INFO - Received 9900 messages so far
2025-02-26 19:31:16,685 - INFO - Received 10000 messages so far
2025-02-26 19:31:16,685 - INFO - Total messages consumed: 10000
2025-02-26 19:31:16,775 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:31:16,779 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:31:16,779 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:31:16,779 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:31:16,779 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:31:16,790 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:31:16,790 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:31:16,790 - INFO - Number of columns: 66
2025-02-26 19:31:16,801 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
4479        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005286     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6005        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2661        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6391        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.007185     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6155        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:31:16,801 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:31:16,833 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:31:16,878 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    2fe788e3cc713726              efe788e3cc713726  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:31:16,879 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.  1900.    53.   443.   134.  5353.   136.   138.   123.
    80.     0.   133.    67.    22. 21116.   135.   547. 21115.]
2025-02-26 19:31:16,884 - INFO - Label distribution: {}
2025-02-26 19:31:16,885 - WARNING - No data left after filtering for valid labels
2025-02-26 19:31:16,886 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:31:46,916 - INFO - Starting data processing
2025-02-26 19:31:46,916 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:31:46,917 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:31:46,918 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:31:46,918 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:31:47,020 - INFO - Broker version identified as 2.5.0
2025-02-26 19:31:47,020 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:31:47,020 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:31:47,020 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:31:47,021 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:31:47,022 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:31:47,022 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:31:47,022 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:31:47,022 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:31:47,191 - INFO - Received 100 messages so far
2025-02-26 19:31:47,191 - INFO - Received 200 messages so far
2025-02-26 19:31:47,191 - INFO - Received 300 messages so far
2025-02-26 19:31:47,192 - INFO - Received 400 messages so far
2025-02-26 19:31:47,192 - INFO - Received 500 messages so far
2025-02-26 19:31:47,192 - INFO - Received 600 messages so far
2025-02-26 19:31:47,192 - INFO - Received 700 messages so far
2025-02-26 19:31:47,192 - INFO - Received 800 messages so far
2025-02-26 19:31:47,193 - INFO - Received 900 messages so far
2025-02-26 19:31:47,193 - INFO - Received 1000 messages so far
2025-02-26 19:31:47,193 - INFO - Received 1100 messages so far
2025-02-26 19:31:47,193 - INFO - Received 1200 messages so far
2025-02-26 19:31:47,193 - INFO - Received 1300 messages so far
2025-02-26 19:31:47,194 - INFO - Received 1400 messages so far
2025-02-26 19:31:47,194 - INFO - Received 1500 messages so far
2025-02-26 19:31:47,194 - INFO - Received 1600 messages so far
2025-02-26 19:31:47,194 - INFO - Received 1700 messages so far
2025-02-26 19:31:47,194 - INFO - Received 1800 messages so far
2025-02-26 19:31:47,194 - INFO - Received 1900 messages so far
2025-02-26 19:31:47,195 - INFO - Received 2000 messages so far
2025-02-26 19:31:47,195 - INFO - Received 2100 messages so far
2025-02-26 19:31:47,195 - INFO - Received 2200 messages so far
2025-02-26 19:31:47,195 - INFO - Received 2300 messages so far
2025-02-26 19:31:47,195 - INFO - Received 2400 messages so far
2025-02-26 19:31:47,196 - INFO - Received 2500 messages so far
2025-02-26 19:31:47,196 - INFO - Received 2600 messages so far
2025-02-26 19:31:47,196 - INFO - Received 2700 messages so far
2025-02-26 19:31:47,196 - INFO - Received 2800 messages so far
2025-02-26 19:31:47,196 - INFO - Received 2900 messages so far
2025-02-26 19:31:47,197 - INFO - Received 3000 messages so far
2025-02-26 19:31:47,197 - INFO - Received 3100 messages so far
2025-02-26 19:31:47,197 - INFO - Received 3200 messages so far
2025-02-26 19:31:47,197 - INFO - Received 3300 messages so far
2025-02-26 19:31:47,197 - INFO - Received 3400 messages so far
2025-02-26 19:31:47,198 - INFO - Received 3500 messages so far
2025-02-26 19:31:47,198 - INFO - Received 3600 messages so far
2025-02-26 19:31:47,198 - INFO - Received 3700 messages so far
2025-02-26 19:31:47,198 - INFO - Received 3800 messages so far
2025-02-26 19:31:47,198 - INFO - Received 3900 messages so far
2025-02-26 19:31:47,199 - INFO - Received 4000 messages so far
2025-02-26 19:31:47,199 - INFO - Received 4100 messages so far
2025-02-26 19:31:47,254 - INFO - Received 4200 messages so far
2025-02-26 19:31:47,255 - INFO - Received 4300 messages so far
2025-02-26 19:31:47,255 - INFO - Received 4400 messages so far
2025-02-26 19:31:47,255 - INFO - Received 4500 messages so far
2025-02-26 19:31:47,255 - INFO - Received 4600 messages so far
2025-02-26 19:31:47,255 - INFO - Received 4700 messages so far
2025-02-26 19:31:47,256 - INFO - Received 4800 messages so far
2025-02-26 19:31:47,256 - INFO - Received 4900 messages so far
2025-02-26 19:31:47,256 - INFO - Received 5000 messages so far
2025-02-26 19:31:47,256 - INFO - Received 5100 messages so far
2025-02-26 19:31:47,256 - INFO - Received 5200 messages so far
2025-02-26 19:31:47,257 - INFO - Received 5300 messages so far
2025-02-26 19:31:47,257 - INFO - Received 5400 messages so far
2025-02-26 19:31:47,257 - INFO - Received 5500 messages so far
2025-02-26 19:31:47,257 - INFO - Received 5600 messages so far
2025-02-26 19:31:47,257 - INFO - Received 5700 messages so far
2025-02-26 19:31:47,258 - INFO - Received 5800 messages so far
2025-02-26 19:31:47,258 - INFO - Received 5900 messages so far
2025-02-26 19:31:47,258 - INFO - Received 6000 messages so far
2025-02-26 19:31:47,258 - INFO - Received 6100 messages so far
2025-02-26 19:31:47,258 - INFO - Received 6200 messages so far
2025-02-26 19:31:47,259 - INFO - Received 6300 messages so far
2025-02-26 19:31:47,259 - INFO - Received 6400 messages so far
2025-02-26 19:31:47,259 - INFO - Received 6500 messages so far
2025-02-26 19:31:47,259 - INFO - Received 6600 messages so far
2025-02-26 19:31:47,259 - INFO - Received 6700 messages so far
2025-02-26 19:31:47,260 - INFO - Received 6800 messages so far
2025-02-26 19:31:47,260 - INFO - Received 6900 messages so far
2025-02-26 19:31:47,260 - INFO - Received 7000 messages so far
2025-02-26 19:31:47,260 - INFO - Received 7100 messages so far
2025-02-26 19:31:47,260 - INFO - Received 7200 messages so far
2025-02-26 19:31:47,261 - INFO - Received 7300 messages so far
2025-02-26 19:31:47,261 - INFO - Received 7400 messages so far
2025-02-26 19:31:47,261 - INFO - Received 7500 messages so far
2025-02-26 19:31:47,261 - INFO - Received 7600 messages so far
2025-02-26 19:31:47,261 - INFO - Received 7700 messages so far
2025-02-26 19:31:47,262 - INFO - Received 7800 messages so far
2025-02-26 19:31:47,262 - INFO - Received 7900 messages so far
2025-02-26 19:31:47,262 - INFO - Received 8000 messages so far
2025-02-26 19:31:47,262 - INFO - Received 8100 messages so far
2025-02-26 19:31:47,262 - INFO - Received 8200 messages so far
2025-02-26 19:31:47,263 - INFO - Received 8300 messages so far
2025-02-26 19:31:47,263 - INFO - Received 8400 messages so far
2025-02-26 19:31:47,263 - INFO - Received 8500 messages so far
2025-02-26 19:31:47,263 - INFO - Received 8600 messages so far
2025-02-26 19:31:47,264 - INFO - Received 8700 messages so far
2025-02-26 19:31:47,323 - INFO - Received 8800 messages so far
2025-02-26 19:31:47,324 - INFO - Received 8900 messages so far
2025-02-26 19:31:47,324 - INFO - Received 9000 messages so far
2025-02-26 19:31:47,324 - INFO - Received 9100 messages so far
2025-02-26 19:31:47,324 - INFO - Received 9200 messages so far
2025-02-26 19:31:47,325 - INFO - Received 9300 messages so far
2025-02-26 19:31:47,325 - INFO - Received 9400 messages so far
2025-02-26 19:31:47,325 - INFO - Received 9500 messages so far
2025-02-26 19:31:47,325 - INFO - Received 9600 messages so far
2025-02-26 19:31:47,325 - INFO - Received 9700 messages so far
2025-02-26 19:31:47,326 - INFO - Received 9800 messages so far
2025-02-26 19:31:47,326 - INFO - Received 9900 messages so far
2025-02-26 19:31:47,326 - INFO - Received 10000 messages so far
2025-02-26 19:31:47,326 - INFO - Total messages consumed: 10000
2025-02-26 19:31:47,416 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:31:47,420 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:31:47,420 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:31:47,420 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:31:47,420 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:31:47,427 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:31:47,431 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:31:47,431 - INFO - Number of columns: 66
2025-02-26 19:31:47,442 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
8463     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  CwxOA24TO3SxEJoHTe    36324.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000571     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5755        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5237        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8643        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005622     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7746        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:31:47,442 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:31:47,473 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:31:47,519 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    5b67465ea3a9f950              20e4136c52007c23  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:31:47,520 - INFO - Unique values in 'id.resp_p' before labeling: [ 9092.    nan    53.  5353.  1900.   123.   443. 21115.   134.    80.
 21116.   133.   136.     0.   135.   138.   547.    67.    22.]
2025-02-26 19:31:47,529 - INFO - Label distribution: {}
2025-02-26 19:31:47,530 - WARNING - No data left after filtering for valid labels
2025-02-26 19:31:47,531 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:32:17,561 - INFO - Starting data processing
2025-02-26 19:32:17,562 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:32:17,562 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:32:17,563 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:32:17,563 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:32:17,665 - INFO - Broker version identified as 2.5.0
2025-02-26 19:32:17,665 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:32:17,665 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:32:17,666 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:32:17,666 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:32:17,667 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:32:17,667 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:32:17,667 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:32:17,667 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:32:17,833 - INFO - Received 100 messages so far
2025-02-26 19:32:17,834 - INFO - Received 200 messages so far
2025-02-26 19:32:17,834 - INFO - Received 300 messages so far
2025-02-26 19:32:17,834 - INFO - Received 400 messages so far
2025-02-26 19:32:17,834 - INFO - Received 500 messages so far
2025-02-26 19:32:17,835 - INFO - Received 600 messages so far
2025-02-26 19:32:17,835 - INFO - Received 700 messages so far
2025-02-26 19:32:17,835 - INFO - Received 800 messages so far
2025-02-26 19:32:17,835 - INFO - Received 900 messages so far
2025-02-26 19:32:17,835 - INFO - Received 1000 messages so far
2025-02-26 19:32:17,836 - INFO - Received 1100 messages so far
2025-02-26 19:32:17,836 - INFO - Received 1200 messages so far
2025-02-26 19:32:17,836 - INFO - Received 1300 messages so far
2025-02-26 19:32:17,836 - INFO - Received 1400 messages so far
2025-02-26 19:32:17,836 - INFO - Received 1500 messages so far
2025-02-26 19:32:17,837 - INFO - Received 1600 messages so far
2025-02-26 19:32:17,837 - INFO - Received 1700 messages so far
2025-02-26 19:32:17,837 - INFO - Received 1800 messages so far
2025-02-26 19:32:17,837 - INFO - Received 1900 messages so far
2025-02-26 19:32:17,837 - INFO - Received 2000 messages so far
2025-02-26 19:32:17,838 - INFO - Received 2100 messages so far
2025-02-26 19:32:17,838 - INFO - Received 2200 messages so far
2025-02-26 19:32:17,838 - INFO - Received 2300 messages so far
2025-02-26 19:32:17,838 - INFO - Received 2400 messages so far
2025-02-26 19:32:17,838 - INFO - Received 2500 messages so far
2025-02-26 19:32:17,838 - INFO - Received 2600 messages so far
2025-02-26 19:32:17,839 - INFO - Received 2700 messages so far
2025-02-26 19:32:17,839 - INFO - Received 2800 messages so far
2025-02-26 19:32:17,839 - INFO - Received 2900 messages so far
2025-02-26 19:32:17,839 - INFO - Received 3000 messages so far
2025-02-26 19:32:17,839 - INFO - Received 3100 messages so far
2025-02-26 19:32:17,840 - INFO - Received 3200 messages so far
2025-02-26 19:32:17,840 - INFO - Received 3300 messages so far
2025-02-26 19:32:17,840 - INFO - Received 3400 messages so far
2025-02-26 19:32:17,840 - INFO - Received 3500 messages so far
2025-02-26 19:32:17,840 - INFO - Received 3600 messages so far
2025-02-26 19:32:17,841 - INFO - Received 3700 messages so far
2025-02-26 19:32:17,841 - INFO - Received 3800 messages so far
2025-02-26 19:32:17,841 - INFO - Received 3900 messages so far
2025-02-26 19:32:17,841 - INFO - Received 4000 messages so far
2025-02-26 19:32:17,842 - INFO - Received 4100 messages so far
2025-02-26 19:32:17,952 - INFO - Received 4200 messages so far
2025-02-26 19:32:17,953 - INFO - Received 4300 messages so far
2025-02-26 19:32:17,953 - INFO - Received 4400 messages so far
2025-02-26 19:32:17,953 - INFO - Received 4500 messages so far
2025-02-26 19:32:17,953 - INFO - Received 4600 messages so far
2025-02-26 19:32:17,953 - INFO - Received 4700 messages so far
2025-02-26 19:32:17,953 - INFO - Received 4800 messages so far
2025-02-26 19:32:17,954 - INFO - Received 4900 messages so far
2025-02-26 19:32:17,954 - INFO - Received 5000 messages so far
2025-02-26 19:32:17,954 - INFO - Received 5100 messages so far
2025-02-26 19:32:17,954 - INFO - Received 5200 messages so far
2025-02-26 19:32:17,954 - INFO - Received 5300 messages so far
2025-02-26 19:32:17,955 - INFO - Received 5400 messages so far
2025-02-26 19:32:17,955 - INFO - Received 5500 messages so far
2025-02-26 19:32:17,955 - INFO - Received 5600 messages so far
2025-02-26 19:32:17,955 - INFO - Received 5700 messages so far
2025-02-26 19:32:17,955 - INFO - Received 5800 messages so far
2025-02-26 19:32:17,956 - INFO - Received 5900 messages so far
2025-02-26 19:32:17,956 - INFO - Received 6000 messages so far
2025-02-26 19:32:17,956 - INFO - Received 6100 messages so far
2025-02-26 19:32:17,956 - INFO - Received 6200 messages so far
2025-02-26 19:32:17,956 - INFO - Received 6300 messages so far
2025-02-26 19:32:17,957 - INFO - Received 6400 messages so far
2025-02-26 19:32:17,957 - INFO - Received 6500 messages so far
2025-02-26 19:32:17,957 - INFO - Received 6600 messages so far
2025-02-26 19:32:17,957 - INFO - Received 6700 messages so far
2025-02-26 19:32:17,957 - INFO - Received 6800 messages so far
2025-02-26 19:32:17,958 - INFO - Received 6900 messages so far
2025-02-26 19:32:17,958 - INFO - Received 7000 messages so far
2025-02-26 19:32:17,958 - INFO - Received 7100 messages so far
2025-02-26 19:32:17,958 - INFO - Received 7200 messages so far
2025-02-26 19:32:17,958 - INFO - Received 7300 messages so far
2025-02-26 19:32:17,958 - INFO - Received 7400 messages so far
2025-02-26 19:32:17,959 - INFO - Received 7500 messages so far
2025-02-26 19:32:17,959 - INFO - Received 7600 messages so far
2025-02-26 19:32:17,959 - INFO - Received 7700 messages so far
2025-02-26 19:32:17,959 - INFO - Received 7800 messages so far
2025-02-26 19:32:17,959 - INFO - Received 7900 messages so far
2025-02-26 19:32:17,960 - INFO - Received 8000 messages so far
2025-02-26 19:32:17,960 - INFO - Received 8100 messages so far
2025-02-26 19:32:17,960 - INFO - Received 8200 messages so far
2025-02-26 19:32:17,960 - INFO - Received 8300 messages so far
2025-02-26 19:32:17,960 - INFO - Received 8400 messages so far
2025-02-26 19:32:17,960 - INFO - Received 8500 messages so far
2025-02-26 19:32:17,961 - INFO - Received 8600 messages so far
2025-02-26 19:32:17,961 - INFO - Received 8700 messages so far
2025-02-26 19:32:18,018 - INFO - Received 8800 messages so far
2025-02-26 19:32:18,019 - INFO - Received 8900 messages so far
2025-02-26 19:32:18,019 - INFO - Received 9000 messages so far
2025-02-26 19:32:18,019 - INFO - Received 9100 messages so far
2025-02-26 19:32:18,019 - INFO - Received 9200 messages so far
2025-02-26 19:32:18,020 - INFO - Received 9300 messages so far
2025-02-26 19:32:18,020 - INFO - Received 9400 messages so far
2025-02-26 19:32:18,020 - INFO - Received 9500 messages so far
2025-02-26 19:32:18,020 - INFO - Received 9600 messages so far
2025-02-26 19:32:18,020 - INFO - Received 9700 messages so far
2025-02-26 19:32:18,021 - INFO - Received 9800 messages so far
2025-02-26 19:32:18,021 - INFO - Received 9900 messages so far
2025-02-26 19:32:18,021 - INFO - Received 10000 messages so far
2025-02-26 19:32:18,021 - INFO - Total messages consumed: 10000
2025-02-26 19:32:18,116 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:32:18,119 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:32:18,119 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:32:18,119 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:32:18,120 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:32:18,127 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:32:18,130 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:32:18,130 - INFO - Number of columns: 66
2025-02-26 19:32:18,141 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
4875        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7881        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.011322     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5458        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3637        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2184        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.007000     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:32:18,141 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:32:18,172 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:32:18,219 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    b90b0ae34b0b9725              f90b0ae34b0b9725  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:32:18,219 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   133.  1900.  5353.   443. 21116.   136.   123.
    80.   134.   138.   135.     0.   547.    22.    67. 21115.]
2025-02-26 19:32:18,225 - INFO - Label distribution: {}
2025-02-26 19:32:18,226 - WARNING - No data left after filtering for valid labels
2025-02-26 19:32:18,227 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:32:43,099 - INFO - Process interrupted by user.
2025-02-26 19:40:11,449 - INFO - Starting livepreprocessing_socket.py
2025-02-26 19:40:11,450 - INFO - Sending test message to socket server
2025-02-26 19:40:11,450 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:11,450 - ERROR - Connection refused to 192.168.1.3:9000. Is the receiving server running?
2025-02-26 19:40:11,450 - ERROR - Failed to send test message
2025-02-26 19:40:11,450 - WARNING - Socket communication test failed, but proceeding anyway
2025-02-26 19:40:11,450 - INFO - Starting data processing
2025-02-26 19:40:11,450 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:11,452 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:11,452 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:11,452 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:11,554 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:11,554 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:11,554 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:11,555 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:11,555 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:11,555 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:11,556 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:11,556 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:11,556 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:11,715 - INFO - Received 100 messages so far
2025-02-26 19:40:11,715 - INFO - Received 200 messages so far
2025-02-26 19:40:11,715 - INFO - Received 300 messages so far
2025-02-26 19:40:11,716 - INFO - Received 400 messages so far
2025-02-26 19:40:11,716 - INFO - Received 500 messages so far
2025-02-26 19:40:11,716 - INFO - Received 600 messages so far
2025-02-26 19:40:11,717 - INFO - Received 700 messages so far
2025-02-26 19:40:11,717 - INFO - Received 800 messages so far
2025-02-26 19:40:11,717 - INFO - Received 900 messages so far
2025-02-26 19:40:11,717 - INFO - Received 1000 messages so far
2025-02-26 19:40:11,718 - INFO - Received 1100 messages so far
2025-02-26 19:40:11,718 - INFO - Received 1200 messages so far
2025-02-26 19:40:11,718 - INFO - Received 1300 messages so far
2025-02-26 19:40:11,718 - INFO - Received 1400 messages so far
2025-02-26 19:40:11,718 - INFO - Received 1500 messages so far
2025-02-26 19:40:11,719 - INFO - Received 1600 messages so far
2025-02-26 19:40:11,719 - INFO - Received 1700 messages so far
2025-02-26 19:40:11,719 - INFO - Received 1800 messages so far
2025-02-26 19:40:11,719 - INFO - Received 1900 messages so far
2025-02-26 19:40:11,719 - INFO - Received 2000 messages so far
2025-02-26 19:40:11,720 - INFO - Received 2100 messages so far
2025-02-26 19:40:11,720 - INFO - Received 2200 messages so far
2025-02-26 19:40:11,720 - INFO - Received 2300 messages so far
2025-02-26 19:40:11,720 - INFO - Received 2400 messages so far
2025-02-26 19:40:11,720 - INFO - Received 2500 messages so far
2025-02-26 19:40:11,721 - INFO - Received 2600 messages so far
2025-02-26 19:40:11,721 - INFO - Received 2700 messages so far
2025-02-26 19:40:11,721 - INFO - Received 2800 messages so far
2025-02-26 19:40:11,721 - INFO - Received 2900 messages so far
2025-02-26 19:40:11,721 - INFO - Received 3000 messages so far
2025-02-26 19:40:11,722 - INFO - Received 3100 messages so far
2025-02-26 19:40:11,722 - INFO - Received 3200 messages so far
2025-02-26 19:40:11,722 - INFO - Received 3300 messages so far
2025-02-26 19:40:11,722 - INFO - Received 3400 messages so far
2025-02-26 19:40:11,722 - INFO - Received 3500 messages so far
2025-02-26 19:40:11,722 - INFO - Received 3600 messages so far
2025-02-26 19:40:11,723 - INFO - Received 3700 messages so far
2025-02-26 19:40:11,723 - INFO - Received 3800 messages so far
2025-02-26 19:40:11,723 - INFO - Received 3900 messages so far
2025-02-26 19:40:11,723 - INFO - Received 4000 messages so far
2025-02-26 19:40:11,724 - INFO - Received 4100 messages so far
2025-02-26 19:40:11,784 - INFO - Received 4200 messages so far
2025-02-26 19:40:11,784 - INFO - Received 4300 messages so far
2025-02-26 19:40:11,784 - INFO - Received 4400 messages so far
2025-02-26 19:40:11,784 - INFO - Received 4500 messages so far
2025-02-26 19:40:11,784 - INFO - Received 4600 messages so far
2025-02-26 19:40:11,785 - INFO - Received 4700 messages so far
2025-02-26 19:40:11,785 - INFO - Received 4800 messages so far
2025-02-26 19:40:11,785 - INFO - Received 4900 messages so far
2025-02-26 19:40:11,785 - INFO - Received 5000 messages so far
2025-02-26 19:40:11,786 - INFO - Received 5100 messages so far
2025-02-26 19:40:11,786 - INFO - Received 5200 messages so far
2025-02-26 19:40:11,786 - INFO - Received 5300 messages so far
2025-02-26 19:40:11,786 - INFO - Received 5400 messages so far
2025-02-26 19:40:11,786 - INFO - Received 5500 messages so far
2025-02-26 19:40:11,787 - INFO - Received 5600 messages so far
2025-02-26 19:40:11,787 - INFO - Received 5700 messages so far
2025-02-26 19:40:11,787 - INFO - Received 5800 messages so far
2025-02-26 19:40:11,787 - INFO - Received 5900 messages so far
2025-02-26 19:40:11,787 - INFO - Received 6000 messages so far
2025-02-26 19:40:11,788 - INFO - Received 6100 messages so far
2025-02-26 19:40:11,788 - INFO - Received 6200 messages so far
2025-02-26 19:40:11,788 - INFO - Received 6300 messages so far
2025-02-26 19:40:11,788 - INFO - Received 6400 messages so far
2025-02-26 19:40:11,788 - INFO - Received 6500 messages so far
2025-02-26 19:40:11,789 - INFO - Received 6600 messages so far
2025-02-26 19:40:11,789 - INFO - Received 6700 messages so far
2025-02-26 19:40:11,789 - INFO - Received 6800 messages so far
2025-02-26 19:40:11,789 - INFO - Received 6900 messages so far
2025-02-26 19:40:11,789 - INFO - Received 7000 messages so far
2025-02-26 19:40:11,790 - INFO - Received 7100 messages so far
2025-02-26 19:40:11,790 - INFO - Received 7200 messages so far
2025-02-26 19:40:11,790 - INFO - Received 7300 messages so far
2025-02-26 19:40:11,790 - INFO - Received 7400 messages so far
2025-02-26 19:40:11,790 - INFO - Received 7500 messages so far
2025-02-26 19:40:11,791 - INFO - Received 7600 messages so far
2025-02-26 19:40:11,791 - INFO - Received 7700 messages so far
2025-02-26 19:40:11,791 - INFO - Received 7800 messages so far
2025-02-26 19:40:11,791 - INFO - Received 7900 messages so far
2025-02-26 19:40:11,791 - INFO - Received 8000 messages so far
2025-02-26 19:40:11,792 - INFO - Received 8100 messages so far
2025-02-26 19:40:11,792 - INFO - Received 8200 messages so far
2025-02-26 19:40:11,792 - INFO - Received 8300 messages so far
2025-02-26 19:40:11,792 - INFO - Received 8400 messages so far
2025-02-26 19:40:11,792 - INFO - Received 8500 messages so far
2025-02-26 19:40:11,793 - INFO - Received 8600 messages so far
2025-02-26 19:40:11,793 - INFO - Received 8700 messages so far
2025-02-26 19:40:11,893 - INFO - Received 8800 messages so far
2025-02-26 19:40:11,893 - INFO - Received 8900 messages so far
2025-02-26 19:40:11,893 - INFO - Received 9000 messages so far
2025-02-26 19:40:11,893 - INFO - Received 9100 messages so far
2025-02-26 19:40:11,894 - INFO - Received 9200 messages so far
2025-02-26 19:40:11,894 - INFO - Received 9300 messages so far
2025-02-26 19:40:11,894 - INFO - Received 9400 messages so far
2025-02-26 19:40:11,895 - INFO - Received 9500 messages so far
2025-02-26 19:40:11,895 - INFO - Received 9600 messages so far
2025-02-26 19:40:11,895 - INFO - Received 9700 messages so far
2025-02-26 19:40:11,895 - INFO - Received 9800 messages so far
2025-02-26 19:40:11,895 - INFO - Received 9900 messages so far
2025-02-26 19:40:11,896 - INFO - Received 10000 messages so far
2025-02-26 19:40:11,896 - INFO - Total messages consumed: 10000
2025-02-26 19:40:11,988 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:11,992 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:11,992 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:11,992 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:11,992 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:12,003 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:12,003 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:12,003 - INFO - Number of columns: 66
2025-02-26 19:40:12,014 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3371        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005257     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6034        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1869        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1588        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2019        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:12,014 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:12,045 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:12,090 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    89520c813b739a8f              e9520c813b739a8f  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:12,090 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443. 21116.  5353.  1900.    80.   135.   123.
   134.   133.    67.   136.     0. 21115.   547.   138.    22.]
2025-02-26 19:40:12,091 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:12,097 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:12,098 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:12,098 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:12,101 - INFO - DataFrame shape after NA dropping: (868, 23)
2025-02-26 19:40:12,101 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:12,101 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:12,101 - INFO - X shape: (868, 21), y shape: (868,)
2025-02-26 19:40:12,101 - INFO - Label distribution in training data: {'DNS': 726, 'HTTPS': 127, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:12,102 - INFO - Training model...
2025-02-26 19:40:12,219 - INFO - Predicting on test data...
2025-02-26 19:40:12,235 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 145.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.8,
    "f1-score": 0.8888888888888888,
    "support": 5.0
  },
  "HTTPS": {
    "precision": 0.96,
    "recall": 1.0,
    "f1-score": 0.9795918367346939,
    "support": 24.0
  },
  "accuracy": 0.9942528735632183,
  "macro avg": {
    "precision": 0.9866666666666667,
    "recall": 0.9333333333333332,
    "f1-score": 0.9561602418745275,
    "support": 174.0
  },
  "weighted avg": {
    "precision": 0.9944827586206896,
    "recall": 0.9942528735632183,
    "f1-score": 0.9939922329084891,
    "support": 174.0
  }
}
2025-02-26 19:40:12,243 - INFO - Saved processed data locally to processed_data_20250226_194012.csv
2025-02-26 19:40:12,245 - INFO - JSON data size: 426682 bytes
2025-02-26 19:40:12,245 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:12,245 - ERROR - Connection refused to 192.168.1.3:9000. Is the receiving server running?
2025-02-26 19:40:12,246 - WARNING - Data processing completed but transmission failed
2025-02-26 19:40:12,248 - INFO - Waiting 30 seconds before retrying...
2025-02-26 19:40:42,278 - INFO - Starting data processing
2025-02-26 19:40:42,278 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:42,279 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:42,279 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:42,279 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:42,381 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:42,381 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:42,381 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:42,382 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:42,382 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:42,382 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:42,383 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:42,383 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:42,383 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:42,554 - INFO - Received 100 messages so far
2025-02-26 19:40:42,554 - INFO - Received 200 messages so far
2025-02-26 19:40:42,555 - INFO - Received 300 messages so far
2025-02-26 19:40:42,555 - INFO - Received 400 messages so far
2025-02-26 19:40:42,555 - INFO - Received 500 messages so far
2025-02-26 19:40:42,555 - INFO - Received 600 messages so far
2025-02-26 19:40:42,555 - INFO - Received 700 messages so far
2025-02-26 19:40:42,556 - INFO - Received 800 messages so far
2025-02-26 19:40:42,556 - INFO - Received 900 messages so far
2025-02-26 19:40:42,556 - INFO - Received 1000 messages so far
2025-02-26 19:40:42,556 - INFO - Received 1100 messages so far
2025-02-26 19:40:42,556 - INFO - Received 1200 messages so far
2025-02-26 19:40:42,557 - INFO - Received 1300 messages so far
2025-02-26 19:40:42,557 - INFO - Received 1400 messages so far
2025-02-26 19:40:42,557 - INFO - Received 1500 messages so far
2025-02-26 19:40:42,557 - INFO - Received 1600 messages so far
2025-02-26 19:40:42,557 - INFO - Received 1700 messages so far
2025-02-26 19:40:42,558 - INFO - Received 1800 messages so far
2025-02-26 19:40:42,558 - INFO - Received 1900 messages so far
2025-02-26 19:40:42,558 - INFO - Received 2000 messages so far
2025-02-26 19:40:42,558 - INFO - Received 2100 messages so far
2025-02-26 19:40:42,558 - INFO - Received 2200 messages so far
2025-02-26 19:40:42,559 - INFO - Received 2300 messages so far
2025-02-26 19:40:42,559 - INFO - Received 2400 messages so far
2025-02-26 19:40:42,559 - INFO - Received 2500 messages so far
2025-02-26 19:40:42,559 - INFO - Received 2600 messages so far
2025-02-26 19:40:42,559 - INFO - Received 2700 messages so far
2025-02-26 19:40:42,560 - INFO - Received 2800 messages so far
2025-02-26 19:40:42,560 - INFO - Received 2900 messages so far
2025-02-26 19:40:42,560 - INFO - Received 3000 messages so far
2025-02-26 19:40:42,560 - INFO - Received 3100 messages so far
2025-02-26 19:40:42,560 - INFO - Received 3200 messages so far
2025-02-26 19:40:42,560 - INFO - Received 3300 messages so far
2025-02-26 19:40:42,561 - INFO - Received 3400 messages so far
2025-02-26 19:40:42,561 - INFO - Received 3500 messages so far
2025-02-26 19:40:42,561 - INFO - Received 3600 messages so far
2025-02-26 19:40:42,561 - INFO - Received 3700 messages so far
2025-02-26 19:40:42,561 - INFO - Received 3800 messages so far
2025-02-26 19:40:42,562 - INFO - Received 3900 messages so far
2025-02-26 19:40:42,562 - INFO - Received 4000 messages so far
2025-02-26 19:40:42,562 - INFO - Received 4100 messages so far
2025-02-26 19:40:42,617 - INFO - Received 4200 messages so far
2025-02-26 19:40:42,618 - INFO - Received 4300 messages so far
2025-02-26 19:40:42,618 - INFO - Received 4400 messages so far
2025-02-26 19:40:42,618 - INFO - Received 4500 messages so far
2025-02-26 19:40:42,618 - INFO - Received 4600 messages so far
2025-02-26 19:40:42,618 - INFO - Received 4700 messages so far
2025-02-26 19:40:42,619 - INFO - Received 4800 messages so far
2025-02-26 19:40:42,619 - INFO - Received 4900 messages so far
2025-02-26 19:40:42,619 - INFO - Received 5000 messages so far
2025-02-26 19:40:42,619 - INFO - Received 5100 messages so far
2025-02-26 19:40:42,619 - INFO - Received 5200 messages so far
2025-02-26 19:40:42,620 - INFO - Received 5300 messages so far
2025-02-26 19:40:42,620 - INFO - Received 5400 messages so far
2025-02-26 19:40:42,620 - INFO - Received 5500 messages so far
2025-02-26 19:40:42,620 - INFO - Received 5600 messages so far
2025-02-26 19:40:42,620 - INFO - Received 5700 messages so far
2025-02-26 19:40:42,621 - INFO - Received 5800 messages so far
2025-02-26 19:40:42,621 - INFO - Received 5900 messages so far
2025-02-26 19:40:42,621 - INFO - Received 6000 messages so far
2025-02-26 19:40:42,621 - INFO - Received 6100 messages so far
2025-02-26 19:40:42,621 - INFO - Received 6200 messages so far
2025-02-26 19:40:42,622 - INFO - Received 6300 messages so far
2025-02-26 19:40:42,622 - INFO - Received 6400 messages so far
2025-02-26 19:40:42,622 - INFO - Received 6500 messages so far
2025-02-26 19:40:42,622 - INFO - Received 6600 messages so far
2025-02-26 19:40:42,622 - INFO - Received 6700 messages so far
2025-02-26 19:40:42,622 - INFO - Received 6800 messages so far
2025-02-26 19:40:42,623 - INFO - Received 6900 messages so far
2025-02-26 19:40:42,623 - INFO - Received 7000 messages so far
2025-02-26 19:40:42,623 - INFO - Received 7100 messages so far
2025-02-26 19:40:42,623 - INFO - Received 7200 messages so far
2025-02-26 19:40:42,623 - INFO - Received 7300 messages so far
2025-02-26 19:40:42,624 - INFO - Received 7400 messages so far
2025-02-26 19:40:42,624 - INFO - Received 7500 messages so far
2025-02-26 19:40:42,624 - INFO - Received 7600 messages so far
2025-02-26 19:40:42,624 - INFO - Received 7700 messages so far
2025-02-26 19:40:42,624 - INFO - Received 7800 messages so far
2025-02-26 19:40:42,625 - INFO - Received 7900 messages so far
2025-02-26 19:40:42,625 - INFO - Received 8000 messages so far
2025-02-26 19:40:42,625 - INFO - Received 8100 messages so far
2025-02-26 19:40:42,625 - INFO - Received 8200 messages so far
2025-02-26 19:40:42,625 - INFO - Received 8300 messages so far
2025-02-26 19:40:42,626 - INFO - Received 8400 messages so far
2025-02-26 19:40:42,626 - INFO - Received 8500 messages so far
2025-02-26 19:40:42,626 - INFO - Received 8600 messages so far
2025-02-26 19:40:42,626 - INFO - Received 8700 messages so far
2025-02-26 19:40:42,687 - INFO - Received 8800 messages so far
2025-02-26 19:40:42,687 - INFO - Received 8900 messages so far
2025-02-26 19:40:42,687 - INFO - Received 9000 messages so far
2025-02-26 19:40:42,687 - INFO - Received 9100 messages so far
2025-02-26 19:40:42,688 - INFO - Received 9200 messages so far
2025-02-26 19:40:42,688 - INFO - Received 9300 messages so far
2025-02-26 19:40:42,688 - INFO - Received 9400 messages so far
2025-02-26 19:40:42,688 - INFO - Received 9500 messages so far
2025-02-26 19:40:42,688 - INFO - Received 9600 messages so far
2025-02-26 19:40:42,689 - INFO - Received 9700 messages so far
2025-02-26 19:40:42,689 - INFO - Received 9800 messages so far
2025-02-26 19:40:42,689 - INFO - Received 9900 messages so far
2025-02-26 19:40:42,689 - INFO - Received 10000 messages so far
2025-02-26 19:40:42,689 - INFO - Total messages consumed: 10000
2025-02-26 19:40:42,776 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:42,779 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:42,779 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:42,779 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:42,779 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:42,786 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:42,790 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:42,790 - INFO - Number of columns: 66
2025-02-26 19:40:42,801 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7032        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
738         NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4137        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005296     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9283        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8583     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  CEPt7B4mA6zdT21A23    57794.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000711     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:42,801 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:42,833 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:42,879 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    c456d0cc73137d45              e456d0cc73137d45  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:42,879 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.    80.   443.  5353.     0.   138.   123.  1900.
   135.   133.   134. 21116.   547. 21115.   136.    22.    67.]
2025-02-26 19:40:42,881 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:42,886 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:42,887 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:42,887 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:42,889 - INFO - DataFrame shape after NA dropping: (717, 23)
2025-02-26 19:40:42,890 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:42,890 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:42,890 - INFO - X shape: (717, 21), y shape: (717,)
2025-02-26 19:40:42,890 - INFO - Label distribution in training data: {'DNS': 597, 'HTTPS': 108, 'HTTP': 11, 'SSH': 1}
2025-02-26 19:40:42,892 - INFO - Training model...
2025-02-26 19:40:43,008 - INFO - Predicting on test data...
2025-02-26 19:40:43,022 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 119.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 25.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 144.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 144.0
  }
}
2025-02-26 19:40:43,029 - INFO - Saved processed data locally to processed_data_20250226_194043.csv
2025-02-26 19:40:43,031 - INFO - JSON data size: 351700 bytes
2025-02-26 19:40:43,031 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:43,031 - INFO - Data sent successfully!
2025-02-26 19:40:43,032 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:43,034 - INFO - Starting data processing
2025-02-26 19:40:43,034 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:43,034 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:43,035 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:43,035 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:43,137 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:43,137 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:43,137 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:43,137 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:43,137 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:43,138 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:43,138 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:43,139 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:43,139 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:43,332 - INFO - Received 100 messages so far
2025-02-26 19:40:43,333 - INFO - Received 200 messages so far
2025-02-26 19:40:43,333 - INFO - Received 300 messages so far
2025-02-26 19:40:43,333 - INFO - Received 400 messages so far
2025-02-26 19:40:43,333 - INFO - Received 500 messages so far
2025-02-26 19:40:43,333 - INFO - Received 600 messages so far
2025-02-26 19:40:43,334 - INFO - Received 700 messages so far
2025-02-26 19:40:43,334 - INFO - Received 800 messages so far
2025-02-26 19:40:43,334 - INFO - Received 900 messages so far
2025-02-26 19:40:43,334 - INFO - Received 1000 messages so far
2025-02-26 19:40:43,334 - INFO - Received 1100 messages so far
2025-02-26 19:40:43,335 - INFO - Received 1200 messages so far
2025-02-26 19:40:43,335 - INFO - Received 1300 messages so far
2025-02-26 19:40:43,335 - INFO - Received 1400 messages so far
2025-02-26 19:40:43,335 - INFO - Received 1500 messages so far
2025-02-26 19:40:43,335 - INFO - Received 1600 messages so far
2025-02-26 19:40:43,336 - INFO - Received 1700 messages so far
2025-02-26 19:40:43,336 - INFO - Received 1800 messages so far
2025-02-26 19:40:43,336 - INFO - Received 1900 messages so far
2025-02-26 19:40:43,336 - INFO - Received 2000 messages so far
2025-02-26 19:40:43,336 - INFO - Received 2100 messages so far
2025-02-26 19:40:43,337 - INFO - Received 2200 messages so far
2025-02-26 19:40:43,337 - INFO - Received 2300 messages so far
2025-02-26 19:40:43,337 - INFO - Received 2400 messages so far
2025-02-26 19:40:43,337 - INFO - Received 2500 messages so far
2025-02-26 19:40:43,337 - INFO - Received 2600 messages so far
2025-02-26 19:40:43,338 - INFO - Received 2700 messages so far
2025-02-26 19:40:43,338 - INFO - Received 2800 messages so far
2025-02-26 19:40:43,338 - INFO - Received 2900 messages so far
2025-02-26 19:40:43,338 - INFO - Received 3000 messages so far
2025-02-26 19:40:43,338 - INFO - Received 3100 messages so far
2025-02-26 19:40:43,338 - INFO - Received 3200 messages so far
2025-02-26 19:40:43,339 - INFO - Received 3300 messages so far
2025-02-26 19:40:43,339 - INFO - Received 3400 messages so far
2025-02-26 19:40:43,339 - INFO - Received 3500 messages so far
2025-02-26 19:40:43,339 - INFO - Received 3600 messages so far
2025-02-26 19:40:43,339 - INFO - Received 3700 messages so far
2025-02-26 19:40:43,340 - INFO - Received 3800 messages so far
2025-02-26 19:40:43,340 - INFO - Received 3900 messages so far
2025-02-26 19:40:43,340 - INFO - Received 4000 messages so far
2025-02-26 19:40:43,340 - INFO - Received 4100 messages so far
2025-02-26 19:40:43,393 - INFO - Received 4200 messages so far
2025-02-26 19:40:43,393 - INFO - Received 4300 messages so far
2025-02-26 19:40:43,394 - INFO - Received 4400 messages so far
2025-02-26 19:40:43,394 - INFO - Received 4500 messages so far
2025-02-26 19:40:43,394 - INFO - Received 4600 messages so far
2025-02-26 19:40:43,394 - INFO - Received 4700 messages so far
2025-02-26 19:40:43,394 - INFO - Received 4800 messages so far
2025-02-26 19:40:43,395 - INFO - Received 4900 messages so far
2025-02-26 19:40:43,395 - INFO - Received 5000 messages so far
2025-02-26 19:40:43,395 - INFO - Received 5100 messages so far
2025-02-26 19:40:43,395 - INFO - Received 5200 messages so far
2025-02-26 19:40:43,395 - INFO - Received 5300 messages so far
2025-02-26 19:40:43,396 - INFO - Received 5400 messages so far
2025-02-26 19:40:43,396 - INFO - Received 5500 messages so far
2025-02-26 19:40:43,396 - INFO - Received 5600 messages so far
2025-02-26 19:40:43,396 - INFO - Received 5700 messages so far
2025-02-26 19:40:43,396 - INFO - Received 5800 messages so far
2025-02-26 19:40:43,397 - INFO - Received 5900 messages so far
2025-02-26 19:40:43,397 - INFO - Received 6000 messages so far
2025-02-26 19:40:43,397 - INFO - Received 6100 messages so far
2025-02-26 19:40:43,397 - INFO - Received 6200 messages so far
2025-02-26 19:40:43,397 - INFO - Received 6300 messages so far
2025-02-26 19:40:43,398 - INFO - Received 6400 messages so far
2025-02-26 19:40:43,398 - INFO - Received 6500 messages so far
2025-02-26 19:40:43,398 - INFO - Received 6600 messages so far
2025-02-26 19:40:43,398 - INFO - Received 6700 messages so far
2025-02-26 19:40:43,398 - INFO - Received 6800 messages so far
2025-02-26 19:40:43,398 - INFO - Received 6900 messages so far
2025-02-26 19:40:43,399 - INFO - Received 7000 messages so far
2025-02-26 19:40:43,399 - INFO - Received 7100 messages so far
2025-02-26 19:40:43,399 - INFO - Received 7200 messages so far
2025-02-26 19:40:43,399 - INFO - Received 7300 messages so far
2025-02-26 19:40:43,399 - INFO - Received 7400 messages so far
2025-02-26 19:40:43,400 - INFO - Received 7500 messages so far
2025-02-26 19:40:43,400 - INFO - Received 7600 messages so far
2025-02-26 19:40:43,400 - INFO - Received 7700 messages so far
2025-02-26 19:40:43,400 - INFO - Received 7800 messages so far
2025-02-26 19:40:43,400 - INFO - Received 7900 messages so far
2025-02-26 19:40:43,401 - INFO - Received 8000 messages so far
2025-02-26 19:40:43,401 - INFO - Received 8100 messages so far
2025-02-26 19:40:43,401 - INFO - Received 8200 messages so far
2025-02-26 19:40:43,401 - INFO - Received 8300 messages so far
2025-02-26 19:40:43,401 - INFO - Received 8400 messages so far
2025-02-26 19:40:43,402 - INFO - Received 8500 messages so far
2025-02-26 19:40:43,402 - INFO - Received 8600 messages so far
2025-02-26 19:40:43,402 - INFO - Received 8700 messages so far
2025-02-26 19:40:43,460 - INFO - Received 8800 messages so far
2025-02-26 19:40:43,461 - INFO - Received 8900 messages so far
2025-02-26 19:40:43,461 - INFO - Received 9000 messages so far
2025-02-26 19:40:43,461 - INFO - Received 9100 messages so far
2025-02-26 19:40:43,461 - INFO - Received 9200 messages so far
2025-02-26 19:40:43,461 - INFO - Received 9300 messages so far
2025-02-26 19:40:43,462 - INFO - Received 9400 messages so far
2025-02-26 19:40:43,462 - INFO - Received 9500 messages so far
2025-02-26 19:40:43,462 - INFO - Received 9600 messages so far
2025-02-26 19:40:43,462 - INFO - Received 9700 messages so far
2025-02-26 19:40:43,462 - INFO - Received 9800 messages so far
2025-02-26 19:40:43,463 - INFO - Received 9900 messages so far
2025-02-26 19:40:43,463 - INFO - Received 10000 messages so far
2025-02-26 19:40:43,463 - INFO - Total messages consumed: 10000
2025-02-26 19:40:43,552 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:43,555 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:43,556 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:43,556 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:43,556 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:43,568 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:43,568 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:43,569 - INFO - Number of columns: 66
2025-02-26 19:40:43,580 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7036        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4787        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4556        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5227        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5275       53.0  192.168.1.3  192.168.1.1   udp        55.0       490.0  1.740119e+09      NaN  NaN     dns  CqQhcB30jtmpUb4bJ4    41611.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           83.0        1.0          518.0      17.0  0.001777     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:43,580 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:43,611 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:43,656 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    56c8fcf4a1052fc6              f6c8fcf4a1052fc6  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:43,657 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.   443.  9092.  1900.    80.  5353.   123.   134.    67.
   133.   138. 21116. 21115.   136.   135.     0.    22.   547.]
2025-02-26 19:40:43,658 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:43,663 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:43,664 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:43,664 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:43,667 - INFO - DataFrame shape after NA dropping: (866, 23)
2025-02-26 19:40:43,667 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:43,667 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:43,667 - INFO - X shape: (866, 21), y shape: (866,)
2025-02-26 19:40:43,668 - INFO - Label distribution in training data: {'DNS': 723, 'HTTPS': 130, 'HTTP': 12, 'SSH': 1}
2025-02-26 19:40:43,669 - INFO - Training model...
2025-02-26 19:40:43,782 - INFO - Predicting on test data...
2025-02-26 19:40:43,795 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 134.0
  },
  "HTTP": {
    "precision": 0.75,
    "recall": 0.6,
    "f1-score": 0.6666666666666666,
    "support": 5.0
  },
  "HTTPS": {
    "precision": 0.9444444444444444,
    "recall": 0.9714285714285714,
    "f1-score": 0.9577464788732394,
    "support": 35.0
  },
  "accuracy": 0.9827586206896551,
  "macro avg": {
    "precision": 0.8981481481481483,
    "recall": 0.8571428571428572,
    "f1-score": 0.8748043818466353,
    "support": 174.0
  },
  "weighted avg": {
    "precision": 0.9816411238825031,
    "recall": 0.9827586206896551,
    "f1-score": 0.9819221844476822,
    "support": 174.0
  }
}
2025-02-26 19:40:43,802 - INFO - Saved processed data locally to processed_data_20250226_194043.csv
2025-02-26 19:40:43,805 - INFO - JSON data size: 424207 bytes
2025-02-26 19:40:43,805 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:43,805 - INFO - Data sent successfully!
2025-02-26 19:40:43,805 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:43,806 - INFO - Starting data processing
2025-02-26 19:40:43,806 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:43,807 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:43,807 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:43,807 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:43,910 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:43,910 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:43,911 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:43,911 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:43,911 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:43,912 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:43,912 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:43,912 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:43,912 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:44,066 - INFO - Received 100 messages so far
2025-02-26 19:40:44,067 - INFO - Received 200 messages so far
2025-02-26 19:40:44,067 - INFO - Received 300 messages so far
2025-02-26 19:40:44,067 - INFO - Received 400 messages so far
2025-02-26 19:40:44,067 - INFO - Received 500 messages so far
2025-02-26 19:40:44,067 - INFO - Received 600 messages so far
2025-02-26 19:40:44,068 - INFO - Received 700 messages so far
2025-02-26 19:40:44,068 - INFO - Received 800 messages so far
2025-02-26 19:40:44,068 - INFO - Received 900 messages so far
2025-02-26 19:40:44,068 - INFO - Received 1000 messages so far
2025-02-26 19:40:44,068 - INFO - Received 1100 messages so far
2025-02-26 19:40:44,069 - INFO - Received 1200 messages so far
2025-02-26 19:40:44,069 - INFO - Received 1300 messages so far
2025-02-26 19:40:44,069 - INFO - Received 1400 messages so far
2025-02-26 19:40:44,069 - INFO - Received 1500 messages so far
2025-02-26 19:40:44,069 - INFO - Received 1600 messages so far
2025-02-26 19:40:44,069 - INFO - Received 1700 messages so far
2025-02-26 19:40:44,070 - INFO - Received 1800 messages so far
2025-02-26 19:40:44,070 - INFO - Received 1900 messages so far
2025-02-26 19:40:44,070 - INFO - Received 2000 messages so far
2025-02-26 19:40:44,070 - INFO - Received 2100 messages so far
2025-02-26 19:40:44,070 - INFO - Received 2200 messages so far
2025-02-26 19:40:44,071 - INFO - Received 2300 messages so far
2025-02-26 19:40:44,071 - INFO - Received 2400 messages so far
2025-02-26 19:40:44,071 - INFO - Received 2500 messages so far
2025-02-26 19:40:44,071 - INFO - Received 2600 messages so far
2025-02-26 19:40:44,071 - INFO - Received 2700 messages so far
2025-02-26 19:40:44,072 - INFO - Received 2800 messages so far
2025-02-26 19:40:44,072 - INFO - Received 2900 messages so far
2025-02-26 19:40:44,072 - INFO - Received 3000 messages so far
2025-02-26 19:40:44,072 - INFO - Received 3100 messages so far
2025-02-26 19:40:44,072 - INFO - Received 3200 messages so far
2025-02-26 19:40:44,073 - INFO - Received 3300 messages so far
2025-02-26 19:40:44,073 - INFO - Received 3400 messages so far
2025-02-26 19:40:44,073 - INFO - Received 3500 messages so far
2025-02-26 19:40:44,073 - INFO - Received 3600 messages so far
2025-02-26 19:40:44,073 - INFO - Received 3700 messages so far
2025-02-26 19:40:44,073 - INFO - Received 3800 messages so far
2025-02-26 19:40:44,074 - INFO - Received 3900 messages so far
2025-02-26 19:40:44,074 - INFO - Received 4000 messages so far
2025-02-26 19:40:44,074 - INFO - Received 4100 messages so far
2025-02-26 19:40:44,128 - INFO - Received 4200 messages so far
2025-02-26 19:40:44,128 - INFO - Received 4300 messages so far
2025-02-26 19:40:44,128 - INFO - Received 4400 messages so far
2025-02-26 19:40:44,128 - INFO - Received 4500 messages so far
2025-02-26 19:40:44,129 - INFO - Received 4600 messages so far
2025-02-26 19:40:44,129 - INFO - Received 4700 messages so far
2025-02-26 19:40:44,129 - INFO - Received 4800 messages so far
2025-02-26 19:40:44,129 - INFO - Received 4900 messages so far
2025-02-26 19:40:44,129 - INFO - Received 5000 messages so far
2025-02-26 19:40:44,130 - INFO - Received 5100 messages so far
2025-02-26 19:40:44,130 - INFO - Received 5200 messages so far
2025-02-26 19:40:44,130 - INFO - Received 5300 messages so far
2025-02-26 19:40:44,130 - INFO - Received 5400 messages so far
2025-02-26 19:40:44,130 - INFO - Received 5500 messages so far
2025-02-26 19:40:44,131 - INFO - Received 5600 messages so far
2025-02-26 19:40:44,131 - INFO - Received 5700 messages so far
2025-02-26 19:40:44,131 - INFO - Received 5800 messages so far
2025-02-26 19:40:44,131 - INFO - Received 5900 messages so far
2025-02-26 19:40:44,131 - INFO - Received 6000 messages so far
2025-02-26 19:40:44,132 - INFO - Received 6100 messages so far
2025-02-26 19:40:44,132 - INFO - Received 6200 messages so far
2025-02-26 19:40:44,132 - INFO - Received 6300 messages so far
2025-02-26 19:40:44,132 - INFO - Received 6400 messages so far
2025-02-26 19:40:44,132 - INFO - Received 6500 messages so far
2025-02-26 19:40:44,133 - INFO - Received 6600 messages so far
2025-02-26 19:40:44,133 - INFO - Received 6700 messages so far
2025-02-26 19:40:44,133 - INFO - Received 6800 messages so far
2025-02-26 19:40:44,133 - INFO - Received 6900 messages so far
2025-02-26 19:40:44,133 - INFO - Received 7000 messages so far
2025-02-26 19:40:44,133 - INFO - Received 7100 messages so far
2025-02-26 19:40:44,134 - INFO - Received 7200 messages so far
2025-02-26 19:40:44,134 - INFO - Received 7300 messages so far
2025-02-26 19:40:44,134 - INFO - Received 7400 messages so far
2025-02-26 19:40:44,134 - INFO - Received 7500 messages so far
2025-02-26 19:40:44,134 - INFO - Received 7600 messages so far
2025-02-26 19:40:44,135 - INFO - Received 7700 messages so far
2025-02-26 19:40:44,135 - INFO - Received 7800 messages so far
2025-02-26 19:40:44,135 - INFO - Received 7900 messages so far
2025-02-26 19:40:44,135 - INFO - Received 8000 messages so far
2025-02-26 19:40:44,135 - INFO - Received 8100 messages so far
2025-02-26 19:40:44,136 - INFO - Received 8200 messages so far
2025-02-26 19:40:44,136 - INFO - Received 8300 messages so far
2025-02-26 19:40:44,136 - INFO - Received 8400 messages so far
2025-02-26 19:40:44,136 - INFO - Received 8500 messages so far
2025-02-26 19:40:44,136 - INFO - Received 8600 messages so far
2025-02-26 19:40:44,137 - INFO - Received 8700 messages so far
2025-02-26 19:40:44,232 - INFO - Received 8800 messages so far
2025-02-26 19:40:44,232 - INFO - Received 8900 messages so far
2025-02-26 19:40:44,233 - INFO - Received 9000 messages so far
2025-02-26 19:40:44,233 - INFO - Received 9100 messages so far
2025-02-26 19:40:44,233 - INFO - Received 9200 messages so far
2025-02-26 19:40:44,233 - INFO - Received 9300 messages so far
2025-02-26 19:40:44,233 - INFO - Received 9400 messages so far
2025-02-26 19:40:44,234 - INFO - Received 9500 messages so far
2025-02-26 19:40:44,234 - INFO - Received 9600 messages so far
2025-02-26 19:40:44,234 - INFO - Received 9700 messages so far
2025-02-26 19:40:44,234 - INFO - Received 9800 messages so far
2025-02-26 19:40:44,234 - INFO - Received 9900 messages so far
2025-02-26 19:40:44,235 - INFO - Received 10000 messages so far
2025-02-26 19:40:44,235 - INFO - Total messages consumed: 10000
2025-02-26 19:40:44,323 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:44,327 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:44,327 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:44,327 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:44,327 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:44,339 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:44,340 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:44,340 - INFO - Number of columns: 66
2025-02-26 19:40:44,351 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                 query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                     answers                                 TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
8937        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                   NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                         NaN                                  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3898        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                   NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                         NaN                                  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005569     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8328        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                   NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                         NaN                                  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
214        53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740118e+09      NaN  NaN     NaN  C0ZR0V2BnY1JaXynE3    47729.0  0.001807  analytics.google.com     1.0  C_INTERNET    1.0          A    0.0    NOERROR  False  False  True  True  0.0  [analytics-alv.google.com, 216.239.38.181, 216.239.32.181, 216.239.36.181, 216.239.34.181]  [204.0, 204.0, 204.0, 204.0, 204.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8707        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                   NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                         NaN                                  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.007383     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:44,351 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:44,381 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:44,426 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    b90b0ae34b0b9725              f90b0ae34b0b9725  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:44,426 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.   443.   123.   138.   136.   133.  1900.
    80.   547.   134. 21116.     0. 21115.   135.    22.    67.]
2025-02-26 19:40:44,428 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:44,433 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:44,434 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:44,434 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:44,436 - INFO - DataFrame shape after NA dropping: (852, 23)
2025-02-26 19:40:44,436 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:44,436 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:44,437 - INFO - X shape: (852, 21), y shape: (852,)
2025-02-26 19:40:44,437 - INFO - Label distribution in training data: {'DNS': 709, 'HTTPS': 128, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:44,438 - INFO - Training model...
2025-02-26 19:40:44,552 - INFO - Predicting on test data...
2025-02-26 19:40:44,566 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 143.0
  },
  "HTTP": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 0.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 0.9642857142857143,
    "f1-score": 0.9818181818181818,
    "support": 28.0
  },
  "accuracy": 0.9941520467836257,
  "macro avg": {
    "precision": 0.6666666666666666,
    "recall": 0.6547619047619048,
    "f1-score": 0.6606060606060606,
    "support": 171.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 0.9941520467836257,
    "f1-score": 0.9970228601807549,
    "support": 171.0
  }
}
2025-02-26 19:40:44,572 - INFO - Saved processed data locally to processed_data_20250226_194044.csv
2025-02-26 19:40:44,575 - INFO - JSON data size: 419992 bytes
2025-02-26 19:40:44,575 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:44,575 - INFO - Data sent successfully!
2025-02-26 19:40:44,575 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:44,576 - INFO - Starting data processing
2025-02-26 19:40:44,576 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:44,577 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:44,577 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:44,577 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:44,679 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:44,679 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:44,680 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:44,680 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:44,680 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:44,681 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:44,681 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:44,681 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:44,681 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:44,836 - INFO - Received 100 messages so far
2025-02-26 19:40:44,837 - INFO - Received 200 messages so far
2025-02-26 19:40:44,837 - INFO - Received 300 messages so far
2025-02-26 19:40:44,837 - INFO - Received 400 messages so far
2025-02-26 19:40:44,837 - INFO - Received 500 messages so far
2025-02-26 19:40:44,837 - INFO - Received 600 messages so far
2025-02-26 19:40:44,838 - INFO - Received 700 messages so far
2025-02-26 19:40:44,838 - INFO - Received 800 messages so far
2025-02-26 19:40:44,838 - INFO - Received 900 messages so far
2025-02-26 19:40:44,838 - INFO - Received 1000 messages so far
2025-02-26 19:40:44,838 - INFO - Received 1100 messages so far
2025-02-26 19:40:44,838 - INFO - Received 1200 messages so far
2025-02-26 19:40:44,839 - INFO - Received 1300 messages so far
2025-02-26 19:40:44,839 - INFO - Received 1400 messages so far
2025-02-26 19:40:44,839 - INFO - Received 1500 messages so far
2025-02-26 19:40:44,839 - INFO - Received 1600 messages so far
2025-02-26 19:40:44,839 - INFO - Received 1700 messages so far
2025-02-26 19:40:44,840 - INFO - Received 1800 messages so far
2025-02-26 19:40:44,840 - INFO - Received 1900 messages so far
2025-02-26 19:40:44,840 - INFO - Received 2000 messages so far
2025-02-26 19:40:44,840 - INFO - Received 2100 messages so far
2025-02-26 19:40:44,840 - INFO - Received 2200 messages so far
2025-02-26 19:40:44,841 - INFO - Received 2300 messages so far
2025-02-26 19:40:44,841 - INFO - Received 2400 messages so far
2025-02-26 19:40:44,841 - INFO - Received 2500 messages so far
2025-02-26 19:40:44,841 - INFO - Received 2600 messages so far
2025-02-26 19:40:44,841 - INFO - Received 2700 messages so far
2025-02-26 19:40:44,842 - INFO - Received 2800 messages so far
2025-02-26 19:40:44,842 - INFO - Received 2900 messages so far
2025-02-26 19:40:44,842 - INFO - Received 3000 messages so far
2025-02-26 19:40:44,842 - INFO - Received 3100 messages so far
2025-02-26 19:40:44,842 - INFO - Received 3200 messages so far
2025-02-26 19:40:44,843 - INFO - Received 3300 messages so far
2025-02-26 19:40:44,843 - INFO - Received 3400 messages so far
2025-02-26 19:40:44,843 - INFO - Received 3500 messages so far
2025-02-26 19:40:44,843 - INFO - Received 3600 messages so far
2025-02-26 19:40:44,843 - INFO - Received 3700 messages so far
2025-02-26 19:40:44,844 - INFO - Received 3800 messages so far
2025-02-26 19:40:44,844 - INFO - Received 3900 messages so far
2025-02-26 19:40:44,844 - INFO - Received 4000 messages so far
2025-02-26 19:40:44,844 - INFO - Received 4100 messages so far
2025-02-26 19:40:44,898 - INFO - Received 4200 messages so far
2025-02-26 19:40:44,898 - INFO - Received 4300 messages so far
2025-02-26 19:40:44,898 - INFO - Received 4400 messages so far
2025-02-26 19:40:44,898 - INFO - Received 4500 messages so far
2025-02-26 19:40:44,898 - INFO - Received 4600 messages so far
2025-02-26 19:40:44,899 - INFO - Received 4700 messages so far
2025-02-26 19:40:44,899 - INFO - Received 4800 messages so far
2025-02-26 19:40:44,899 - INFO - Received 4900 messages so far
2025-02-26 19:40:44,899 - INFO - Received 5000 messages so far
2025-02-26 19:40:44,899 - INFO - Received 5100 messages so far
2025-02-26 19:40:44,900 - INFO - Received 5200 messages so far
2025-02-26 19:40:44,900 - INFO - Received 5300 messages so far
2025-02-26 19:40:44,900 - INFO - Received 5400 messages so far
2025-02-26 19:40:44,900 - INFO - Received 5500 messages so far
2025-02-26 19:40:44,900 - INFO - Received 5600 messages so far
2025-02-26 19:40:44,901 - INFO - Received 5700 messages so far
2025-02-26 19:40:44,901 - INFO - Received 5800 messages so far
2025-02-26 19:40:44,901 - INFO - Received 5900 messages so far
2025-02-26 19:40:44,901 - INFO - Received 6000 messages so far
2025-02-26 19:40:44,901 - INFO - Received 6100 messages so far
2025-02-26 19:40:44,902 - INFO - Received 6200 messages so far
2025-02-26 19:40:44,902 - INFO - Received 6300 messages so far
2025-02-26 19:40:44,902 - INFO - Received 6400 messages so far
2025-02-26 19:40:44,902 - INFO - Received 6500 messages so far
2025-02-26 19:40:44,902 - INFO - Received 6600 messages so far
2025-02-26 19:40:44,902 - INFO - Received 6700 messages so far
2025-02-26 19:40:44,903 - INFO - Received 6800 messages so far
2025-02-26 19:40:44,903 - INFO - Received 6900 messages so far
2025-02-26 19:40:44,903 - INFO - Received 7000 messages so far
2025-02-26 19:40:44,903 - INFO - Received 7100 messages so far
2025-02-26 19:40:44,903 - INFO - Received 7200 messages so far
2025-02-26 19:40:44,904 - INFO - Received 7300 messages so far
2025-02-26 19:40:44,904 - INFO - Received 7400 messages so far
2025-02-26 19:40:44,904 - INFO - Received 7500 messages so far
2025-02-26 19:40:44,904 - INFO - Received 7600 messages so far
2025-02-26 19:40:44,904 - INFO - Received 7700 messages so far
2025-02-26 19:40:44,905 - INFO - Received 7800 messages so far
2025-02-26 19:40:44,905 - INFO - Received 7900 messages so far
2025-02-26 19:40:44,905 - INFO - Received 8000 messages so far
2025-02-26 19:40:44,905 - INFO - Received 8100 messages so far
2025-02-26 19:40:44,905 - INFO - Received 8200 messages so far
2025-02-26 19:40:44,906 - INFO - Received 8300 messages so far
2025-02-26 19:40:44,906 - INFO - Received 8400 messages so far
2025-02-26 19:40:44,906 - INFO - Received 8500 messages so far
2025-02-26 19:40:44,906 - INFO - Received 8600 messages so far
2025-02-26 19:40:44,907 - INFO - Received 8700 messages so far
2025-02-26 19:40:44,966 - INFO - Received 8800 messages so far
2025-02-26 19:40:44,966 - INFO - Received 8900 messages so far
2025-02-26 19:40:44,967 - INFO - Received 9000 messages so far
2025-02-26 19:40:44,967 - INFO - Received 9100 messages so far
2025-02-26 19:40:44,967 - INFO - Received 9200 messages so far
2025-02-26 19:40:44,967 - INFO - Received 9300 messages so far
2025-02-26 19:40:44,968 - INFO - Received 9400 messages so far
2025-02-26 19:40:44,968 - INFO - Received 9500 messages so far
2025-02-26 19:40:44,968 - INFO - Received 9600 messages so far
2025-02-26 19:40:44,968 - INFO - Received 9700 messages so far
2025-02-26 19:40:44,968 - INFO - Received 9800 messages so far
2025-02-26 19:40:44,968 - INFO - Received 9900 messages so far
2025-02-26 19:40:44,969 - INFO - Received 10000 messages so far
2025-02-26 19:40:44,969 - INFO - Total messages consumed: 10000
2025-02-26 19:40:45,058 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:45,062 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:45,062 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:45,062 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:45,062 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:45,069 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:45,072 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:45,072 - INFO - Number of columns: 66
2025-02-26 19:40:45,084 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9892        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8531     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  C1v3K13OcDArGIgL64    40596.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000483     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4541        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6618        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8616       53.0  192.168.1.3  192.168.1.1   udp        63.0       224.0  1.740120e+09      NaN  NaN     dns  C1vvIT3SGzXU0PPtIk    55421.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           91.0        1.0          252.0      17.0  0.019898     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:45,084 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:45,114 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:45,159 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    ca26477d8c98f7b3              ea26477d8c98f7b3  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:45,160 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.  5353.  1900.   443.   133.   123.    80.   138.
 21115.    67.   134.    22.   136. 21116.     0.   135.   547.]
2025-02-26 19:40:45,161 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:45,166 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:45,167 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:45,167 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:45,170 - INFO - DataFrame shape after NA dropping: (854, 23)
2025-02-26 19:40:45,170 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:45,170 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:45,170 - INFO - X shape: (854, 21), y shape: (854,)
2025-02-26 19:40:45,171 - INFO - Label distribution in training data: {'DNS': 710, 'HTTPS': 129, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:45,172 - INFO - Training model...
2025-02-26 19:40:45,285 - INFO - Predicting on test data...
2025-02-26 19:40:45,298 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 143.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.8,
    "f1-score": 0.8888888888888888,
    "support": 5.0
  },
  "HTTPS": {
    "precision": 0.9583333333333334,
    "recall": 1.0,
    "f1-score": 0.9787234042553191,
    "support": 23.0
  },
  "accuracy": 0.9941520467836257,
  "macro avg": {
    "precision": 0.9861111111111112,
    "recall": 0.9333333333333332,
    "f1-score": 0.9558707643814026,
    "support": 171.0
  },
  "weighted avg": {
    "precision": 0.9943957115009746,
    "recall": 0.9941520467836257,
    "f1-score": 0.9938893727620864,
    "support": 171.0
  }
}
2025-02-26 19:40:45,305 - INFO - Saved processed data locally to processed_data_20250226_194045.csv
2025-02-26 19:40:45,308 - INFO - JSON data size: 420186 bytes
2025-02-26 19:40:45,308 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:45,308 - INFO - Data sent successfully!
2025-02-26 19:40:45,308 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:45,309 - INFO - Starting data processing
2025-02-26 19:40:45,309 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:45,310 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:45,310 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:45,310 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:45,413 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:45,413 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:45,413 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:45,413 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:45,413 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:45,414 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:45,414 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:45,414 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:45,415 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:45,604 - INFO - Received 100 messages so far
2025-02-26 19:40:45,604 - INFO - Received 200 messages so far
2025-02-26 19:40:45,604 - INFO - Received 300 messages so far
2025-02-26 19:40:45,604 - INFO - Received 400 messages so far
2025-02-26 19:40:45,604 - INFO - Received 500 messages so far
2025-02-26 19:40:45,605 - INFO - Received 600 messages so far
2025-02-26 19:40:45,605 - INFO - Received 700 messages so far
2025-02-26 19:40:45,605 - INFO - Received 800 messages so far
2025-02-26 19:40:45,605 - INFO - Received 900 messages so far
2025-02-26 19:40:45,605 - INFO - Received 1000 messages so far
2025-02-26 19:40:45,606 - INFO - Received 1100 messages so far
2025-02-26 19:40:45,606 - INFO - Received 1200 messages so far
2025-02-26 19:40:45,606 - INFO - Received 1300 messages so far
2025-02-26 19:40:45,606 - INFO - Received 1400 messages so far
2025-02-26 19:40:45,606 - INFO - Received 1500 messages so far
2025-02-26 19:40:45,607 - INFO - Received 1600 messages so far
2025-02-26 19:40:45,607 - INFO - Received 1700 messages so far
2025-02-26 19:40:45,607 - INFO - Received 1800 messages so far
2025-02-26 19:40:45,607 - INFO - Received 1900 messages so far
2025-02-26 19:40:45,607 - INFO - Received 2000 messages so far
2025-02-26 19:40:45,608 - INFO - Received 2100 messages so far
2025-02-26 19:40:45,608 - INFO - Received 2200 messages so far
2025-02-26 19:40:45,608 - INFO - Received 2300 messages so far
2025-02-26 19:40:45,608 - INFO - Received 2400 messages so far
2025-02-26 19:40:45,608 - INFO - Received 2500 messages so far
2025-02-26 19:40:45,609 - INFO - Received 2600 messages so far
2025-02-26 19:40:45,609 - INFO - Received 2700 messages so far
2025-02-26 19:40:45,609 - INFO - Received 2800 messages so far
2025-02-26 19:40:45,609 - INFO - Received 2900 messages so far
2025-02-26 19:40:45,609 - INFO - Received 3000 messages so far
2025-02-26 19:40:45,610 - INFO - Received 3100 messages so far
2025-02-26 19:40:45,610 - INFO - Received 3200 messages so far
2025-02-26 19:40:45,610 - INFO - Received 3300 messages so far
2025-02-26 19:40:45,610 - INFO - Received 3400 messages so far
2025-02-26 19:40:45,610 - INFO - Received 3500 messages so far
2025-02-26 19:40:45,611 - INFO - Received 3600 messages so far
2025-02-26 19:40:45,611 - INFO - Received 3700 messages so far
2025-02-26 19:40:45,611 - INFO - Received 3800 messages so far
2025-02-26 19:40:45,611 - INFO - Received 3900 messages so far
2025-02-26 19:40:45,611 - INFO - Received 4000 messages so far
2025-02-26 19:40:45,612 - INFO - Received 4100 messages so far
2025-02-26 19:40:45,666 - INFO - Received 4200 messages so far
2025-02-26 19:40:45,666 - INFO - Received 4300 messages so far
2025-02-26 19:40:45,666 - INFO - Received 4400 messages so far
2025-02-26 19:40:45,666 - INFO - Received 4500 messages so far
2025-02-26 19:40:45,667 - INFO - Received 4600 messages so far
2025-02-26 19:40:45,667 - INFO - Received 4700 messages so far
2025-02-26 19:40:45,667 - INFO - Received 4800 messages so far
2025-02-26 19:40:45,667 - INFO - Received 4900 messages so far
2025-02-26 19:40:45,667 - INFO - Received 5000 messages so far
2025-02-26 19:40:45,668 - INFO - Received 5100 messages so far
2025-02-26 19:40:45,668 - INFO - Received 5200 messages so far
2025-02-26 19:40:45,668 - INFO - Received 5300 messages so far
2025-02-26 19:40:45,668 - INFO - Received 5400 messages so far
2025-02-26 19:40:45,668 - INFO - Received 5500 messages so far
2025-02-26 19:40:45,669 - INFO - Received 5600 messages so far
2025-02-26 19:40:45,669 - INFO - Received 5700 messages so far
2025-02-26 19:40:45,669 - INFO - Received 5800 messages so far
2025-02-26 19:40:45,669 - INFO - Received 5900 messages so far
2025-02-26 19:40:45,669 - INFO - Received 6000 messages so far
2025-02-26 19:40:45,670 - INFO - Received 6100 messages so far
2025-02-26 19:40:45,670 - INFO - Received 6200 messages so far
2025-02-26 19:40:45,670 - INFO - Received 6300 messages so far
2025-02-26 19:40:45,670 - INFO - Received 6400 messages so far
2025-02-26 19:40:45,670 - INFO - Received 6500 messages so far
2025-02-26 19:40:45,671 - INFO - Received 6600 messages so far
2025-02-26 19:40:45,671 - INFO - Received 6700 messages so far
2025-02-26 19:40:45,671 - INFO - Received 6800 messages so far
2025-02-26 19:40:45,671 - INFO - Received 6900 messages so far
2025-02-26 19:40:45,671 - INFO - Received 7000 messages so far
2025-02-26 19:40:45,672 - INFO - Received 7100 messages so far
2025-02-26 19:40:45,672 - INFO - Received 7200 messages so far
2025-02-26 19:40:45,672 - INFO - Received 7300 messages so far
2025-02-26 19:40:45,672 - INFO - Received 7400 messages so far
2025-02-26 19:40:45,672 - INFO - Received 7500 messages so far
2025-02-26 19:40:45,673 - INFO - Received 7600 messages so far
2025-02-26 19:40:45,673 - INFO - Received 7700 messages so far
2025-02-26 19:40:45,673 - INFO - Received 7800 messages so far
2025-02-26 19:40:45,673 - INFO - Received 7900 messages so far
2025-02-26 19:40:45,673 - INFO - Received 8000 messages so far
2025-02-26 19:40:45,674 - INFO - Received 8100 messages so far
2025-02-26 19:40:45,674 - INFO - Received 8200 messages so far
2025-02-26 19:40:45,674 - INFO - Received 8300 messages so far
2025-02-26 19:40:45,674 - INFO - Received 8400 messages so far
2025-02-26 19:40:45,674 - INFO - Received 8500 messages so far
2025-02-26 19:40:45,674 - INFO - Received 8600 messages so far
2025-02-26 19:40:45,675 - INFO - Received 8700 messages so far
2025-02-26 19:40:45,732 - INFO - Received 8800 messages so far
2025-02-26 19:40:45,732 - INFO - Received 8900 messages so far
2025-02-26 19:40:45,732 - INFO - Received 9000 messages so far
2025-02-26 19:40:45,732 - INFO - Received 9100 messages so far
2025-02-26 19:40:45,733 - INFO - Received 9200 messages so far
2025-02-26 19:40:45,733 - INFO - Received 9300 messages so far
2025-02-26 19:40:45,733 - INFO - Received 9400 messages so far
2025-02-26 19:40:45,733 - INFO - Received 9500 messages so far
2025-02-26 19:40:45,733 - INFO - Received 9600 messages so far
2025-02-26 19:40:45,734 - INFO - Received 9700 messages so far
2025-02-26 19:40:45,734 - INFO - Received 9800 messages so far
2025-02-26 19:40:45,734 - INFO - Received 9900 messages so far
2025-02-26 19:40:45,734 - INFO - Received 10000 messages so far
2025-02-26 19:40:45,734 - INFO - Total messages consumed: 10000
2025-02-26 19:40:45,821 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:45,824 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:45,825 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:45,825 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:45,825 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:45,832 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:45,835 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:45,835 - INFO - Number of columns: 66
2025-02-26 19:40:45,846 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
8071        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2679        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5242        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
742         NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7858       53.0  192.168.1.3  192.168.1.1   udp        62.0       396.0  1.740120e+09      NaN  NaN     dns  CMd1mj497ZDzzelmQ4    35393.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           90.0        1.0          424.0      17.0  0.002389     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:45,847 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:45,877 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:45,922 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    fb5090d671c8a979              fb5090d671c8a979  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:45,923 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443.    67.  5353.   138.    80.   136.  1900.
   135.   123.   547.   134.   133.     0.    22. 21116. 21115.]
2025-02-26 19:40:45,924 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:45,929 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:45,930 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:45,930 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:45,932 - INFO - DataFrame shape after NA dropping: (908, 23)
2025-02-26 19:40:45,933 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:45,933 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:45,933 - INFO - X shape: (908, 21), y shape: (908,)
2025-02-26 19:40:45,933 - INFO - Label distribution in training data: {'DNS': 759, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:45,934 - INFO - Training model...
2025-02-26 19:40:46,048 - INFO - Predicting on test data...
2025-02-26 19:40:46,062 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 156.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.3333333333333333,
    "f1-score": 0.5,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.92,
    "recall": 1.0,
    "f1-score": 0.9583333333333334,
    "support": 23.0
  },
  "accuracy": 0.989010989010989,
  "macro avg": {
    "precision": 0.9733333333333333,
    "recall": 0.7777777777777777,
    "f1-score": 0.8194444444444445,
    "support": 182.0
  },
  "weighted avg": {
    "precision": 0.9898901098901098,
    "recall": 0.989010989010989,
    "f1-score": 0.9864926739926739,
    "support": 182.0
  }
}
2025-02-26 19:40:46,070 - INFO - Saved processed data locally to processed_data_20250226_194046.csv
2025-02-26 19:40:46,072 - INFO - JSON data size: 448475 bytes
2025-02-26 19:40:46,072 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:46,073 - INFO - Data sent successfully!
2025-02-26 19:40:46,073 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:46,074 - INFO - Starting data processing
2025-02-26 19:40:46,074 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:46,074 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:46,075 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:46,075 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:46,177 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:46,177 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:46,178 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:46,178 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:46,178 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:46,179 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:46,179 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:46,179 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:46,179 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:46,333 - INFO - Received 100 messages so far
2025-02-26 19:40:46,333 - INFO - Received 200 messages so far
2025-02-26 19:40:46,333 - INFO - Received 300 messages so far
2025-02-26 19:40:46,333 - INFO - Received 400 messages so far
2025-02-26 19:40:46,333 - INFO - Received 500 messages so far
2025-02-26 19:40:46,334 - INFO - Received 600 messages so far
2025-02-26 19:40:46,334 - INFO - Received 700 messages so far
2025-02-26 19:40:46,334 - INFO - Received 800 messages so far
2025-02-26 19:40:46,334 - INFO - Received 900 messages so far
2025-02-26 19:40:46,334 - INFO - Received 1000 messages so far
2025-02-26 19:40:46,335 - INFO - Received 1100 messages so far
2025-02-26 19:40:46,335 - INFO - Received 1200 messages so far
2025-02-26 19:40:46,335 - INFO - Received 1300 messages so far
2025-02-26 19:40:46,335 - INFO - Received 1400 messages so far
2025-02-26 19:40:46,335 - INFO - Received 1500 messages so far
2025-02-26 19:40:46,336 - INFO - Received 1600 messages so far
2025-02-26 19:40:46,336 - INFO - Received 1700 messages so far
2025-02-26 19:40:46,336 - INFO - Received 1800 messages so far
2025-02-26 19:40:46,336 - INFO - Received 1900 messages so far
2025-02-26 19:40:46,336 - INFO - Received 2000 messages so far
2025-02-26 19:40:46,337 - INFO - Received 2100 messages so far
2025-02-26 19:40:46,337 - INFO - Received 2200 messages so far
2025-02-26 19:40:46,337 - INFO - Received 2300 messages so far
2025-02-26 19:40:46,337 - INFO - Received 2400 messages so far
2025-02-26 19:40:46,337 - INFO - Received 2500 messages so far
2025-02-26 19:40:46,338 - INFO - Received 2600 messages so far
2025-02-26 19:40:46,338 - INFO - Received 2700 messages so far
2025-02-26 19:40:46,338 - INFO - Received 2800 messages so far
2025-02-26 19:40:46,338 - INFO - Received 2900 messages so far
2025-02-26 19:40:46,338 - INFO - Received 3000 messages so far
2025-02-26 19:40:46,339 - INFO - Received 3100 messages so far
2025-02-26 19:40:46,339 - INFO - Received 3200 messages so far
2025-02-26 19:40:46,339 - INFO - Received 3300 messages so far
2025-02-26 19:40:46,339 - INFO - Received 3400 messages so far
2025-02-26 19:40:46,339 - INFO - Received 3500 messages so far
2025-02-26 19:40:46,340 - INFO - Received 3600 messages so far
2025-02-26 19:40:46,340 - INFO - Received 3700 messages so far
2025-02-26 19:40:46,340 - INFO - Received 3800 messages so far
2025-02-26 19:40:46,340 - INFO - Received 3900 messages so far
2025-02-26 19:40:46,340 - INFO - Received 4000 messages so far
2025-02-26 19:40:46,341 - INFO - Received 4100 messages so far
2025-02-26 19:40:46,435 - INFO - Received 4200 messages so far
2025-02-26 19:40:46,435 - INFO - Received 4300 messages so far
2025-02-26 19:40:46,435 - INFO - Received 4400 messages so far
2025-02-26 19:40:46,435 - INFO - Received 4500 messages so far
2025-02-26 19:40:46,435 - INFO - Received 4600 messages so far
2025-02-26 19:40:46,436 - INFO - Received 4700 messages so far
2025-02-26 19:40:46,436 - INFO - Received 4800 messages so far
2025-02-26 19:40:46,436 - INFO - Received 4900 messages so far
2025-02-26 19:40:46,436 - INFO - Received 5000 messages so far
2025-02-26 19:40:46,436 - INFO - Received 5100 messages so far
2025-02-26 19:40:46,437 - INFO - Received 5200 messages so far
2025-02-26 19:40:46,437 - INFO - Received 5300 messages so far
2025-02-26 19:40:46,437 - INFO - Received 5400 messages so far
2025-02-26 19:40:46,437 - INFO - Received 5500 messages so far
2025-02-26 19:40:46,437 - INFO - Received 5600 messages so far
2025-02-26 19:40:46,438 - INFO - Received 5700 messages so far
2025-02-26 19:40:46,438 - INFO - Received 5800 messages so far
2025-02-26 19:40:46,438 - INFO - Received 5900 messages so far
2025-02-26 19:40:46,438 - INFO - Received 6000 messages so far
2025-02-26 19:40:46,438 - INFO - Received 6100 messages so far
2025-02-26 19:40:46,439 - INFO - Received 6200 messages so far
2025-02-26 19:40:46,439 - INFO - Received 6300 messages so far
2025-02-26 19:40:46,439 - INFO - Received 6400 messages so far
2025-02-26 19:40:46,439 - INFO - Received 6500 messages so far
2025-02-26 19:40:46,439 - INFO - Received 6600 messages so far
2025-02-26 19:40:46,440 - INFO - Received 6700 messages so far
2025-02-26 19:40:46,440 - INFO - Received 6800 messages so far
2025-02-26 19:40:46,440 - INFO - Received 6900 messages so far
2025-02-26 19:40:46,440 - INFO - Received 7000 messages so far
2025-02-26 19:40:46,440 - INFO - Received 7100 messages so far
2025-02-26 19:40:46,441 - INFO - Received 7200 messages so far
2025-02-26 19:40:46,441 - INFO - Received 7300 messages so far
2025-02-26 19:40:46,441 - INFO - Received 7400 messages so far
2025-02-26 19:40:46,441 - INFO - Received 7500 messages so far
2025-02-26 19:40:46,441 - INFO - Received 7600 messages so far
2025-02-26 19:40:46,442 - INFO - Received 7700 messages so far
2025-02-26 19:40:46,442 - INFO - Received 7800 messages so far
2025-02-26 19:40:46,442 - INFO - Received 7900 messages so far
2025-02-26 19:40:46,442 - INFO - Received 8000 messages so far
2025-02-26 19:40:46,442 - INFO - Received 8100 messages so far
2025-02-26 19:40:46,443 - INFO - Received 8200 messages so far
2025-02-26 19:40:46,443 - INFO - Received 8300 messages so far
2025-02-26 19:40:46,443 - INFO - Received 8400 messages so far
2025-02-26 19:40:46,443 - INFO - Received 8500 messages so far
2025-02-26 19:40:46,443 - INFO - Received 8600 messages so far
2025-02-26 19:40:46,444 - INFO - Received 8700 messages so far
2025-02-26 19:40:46,500 - INFO - Received 8800 messages so far
2025-02-26 19:40:46,500 - INFO - Received 8900 messages so far
2025-02-26 19:40:46,500 - INFO - Received 9000 messages so far
2025-02-26 19:40:46,501 - INFO - Received 9100 messages so far
2025-02-26 19:40:46,501 - INFO - Received 9200 messages so far
2025-02-26 19:40:46,501 - INFO - Received 9300 messages so far
2025-02-26 19:40:46,501 - INFO - Received 9400 messages so far
2025-02-26 19:40:46,501 - INFO - Received 9500 messages so far
2025-02-26 19:40:46,502 - INFO - Received 9600 messages so far
2025-02-26 19:40:46,502 - INFO - Received 9700 messages so far
2025-02-26 19:40:46,502 - INFO - Received 9800 messages so far
2025-02-26 19:40:46,502 - INFO - Received 9900 messages so far
2025-02-26 19:40:46,502 - INFO - Received 10000 messages so far
2025-02-26 19:40:46,502 - INFO - Total messages consumed: 10000
2025-02-26 19:40:46,591 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:46,594 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:46,594 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:46,594 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:46,595 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:46,602 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:46,605 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:46,605 - INFO - Number of columns: 66
2025-02-26 19:40:46,617 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                   query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                                                                                                                                                                                                                                                                          answers                                                  TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
5028       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740119e+09      NaN  NaN     NaN  CVNaEV1ueHhTBKytPf    60578.0  0.001615  iup0-my.sharepoint.com     1.0  C_INTERNET    1.0          A    0.0    NOERROR  False  False  True  True  0.0  [iup0.sharepoint.com, 5711-ipv4v6e.clump.dprodmgd105.aa-rt.sharepoint.com, 193491-ipv4v6e.farm.dprodmgd105.aa-rt.sharepoint.com, 193491-ipv4v6e.farm.dprodmgd105.sharepointonline.com.akadns.net, 193491-ipv4v6.farm.dprodmgd105.aa-rt.sharepoint.com.dual-spo-0005.spo-msedge.net, dual-spo-0005.spo-msedge.net, 13.107.136.10, 13.107.138.10]  [116.0, 3052.0, 37.0, 52.0, 31.0, 144.0, 39.0, 39.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7323       53.0  192.168.1.3  192.168.1.1   udp        52.0       112.0  1.740119e+09      NaN  NaN     dns  C5hhbv4wtX5Lu8lMFd    40199.0       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                   NaN      NaN         SF       True       True           0.0      Dd        1.0           80.0        1.0          140.0      17.0  0.001239     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3801        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                   NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8664        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                   NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005082     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2516        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                   NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:46,617 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:46,648 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:46,693 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    6b77933b392d05f9              eb77933b392d05f9  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:46,693 - INFO - Unique values in 'id.resp_p' before labeling: [   53.    nan  9092.  5353.   443.   123.  1900.   134.   136.    80.
   138.   133.     0.    67. 21116.    22. 21115.   547.   135.]
2025-02-26 19:40:46,694 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:46,699 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:46,701 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:46,701 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:46,703 - INFO - DataFrame shape after NA dropping: (885, 23)
2025-02-26 19:40:46,703 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:46,703 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:46,704 - INFO - X shape: (885, 21), y shape: (885,)
2025-02-26 19:40:46,704 - INFO - Label distribution in training data: {'DNS': 739, 'HTTPS': 131, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:46,705 - INFO - Training model...
2025-02-26 19:40:46,819 - INFO - Predicting on test data...
2025-02-26 19:40:46,833 - INFO - Classification report:
{
  "DNS": {
    "precision": 0.9932432432432432,
    "recall": 1.0,
    "f1-score": 0.9966101694915255,
    "support": 147.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 25.0
  },
  "SSH": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "accuracy": 0.9943502824858758,
  "macro avg": {
    "precision": 0.7483108108108107,
    "recall": 0.75,
    "f1-score": 0.7491525423728813,
    "support": 177.0
  },
  "weighted avg": {
    "precision": 0.9887387387387386,
    "recall": 0.9943502824858758,
    "f1-score": 0.9915349995212104,
    "support": 177.0
  }
}
2025-02-26 19:40:46,840 - INFO - Saved processed data locally to processed_data_20250226_194046.csv
2025-02-26 19:40:46,842 - INFO - JSON data size: 433754 bytes
2025-02-26 19:40:46,843 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:46,843 - INFO - Data sent successfully!
2025-02-26 19:40:46,843 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:46,844 - INFO - Starting data processing
2025-02-26 19:40:46,844 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:46,844 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:46,845 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:46,846 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:46,947 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:46,948 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:46,948 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:46,948 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:46,948 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:46,949 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:46,949 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:46,949 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:46,950 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:47,103 - INFO - Received 100 messages so far
2025-02-26 19:40:47,103 - INFO - Received 200 messages so far
2025-02-26 19:40:47,103 - INFO - Received 300 messages so far
2025-02-26 19:40:47,103 - INFO - Received 400 messages so far
2025-02-26 19:40:47,104 - INFO - Received 500 messages so far
2025-02-26 19:40:47,104 - INFO - Received 600 messages so far
2025-02-26 19:40:47,104 - INFO - Received 700 messages so far
2025-02-26 19:40:47,104 - INFO - Received 800 messages so far
2025-02-26 19:40:47,104 - INFO - Received 900 messages so far
2025-02-26 19:40:47,105 - INFO - Received 1000 messages so far
2025-02-26 19:40:47,105 - INFO - Received 1100 messages so far
2025-02-26 19:40:47,105 - INFO - Received 1200 messages so far
2025-02-26 19:40:47,105 - INFO - Received 1300 messages so far
2025-02-26 19:40:47,105 - INFO - Received 1400 messages so far
2025-02-26 19:40:47,106 - INFO - Received 1500 messages so far
2025-02-26 19:40:47,106 - INFO - Received 1600 messages so far
2025-02-26 19:40:47,106 - INFO - Received 1700 messages so far
2025-02-26 19:40:47,106 - INFO - Received 1800 messages so far
2025-02-26 19:40:47,106 - INFO - Received 1900 messages so far
2025-02-26 19:40:47,107 - INFO - Received 2000 messages so far
2025-02-26 19:40:47,107 - INFO - Received 2100 messages so far
2025-02-26 19:40:47,107 - INFO - Received 2200 messages so far
2025-02-26 19:40:47,107 - INFO - Received 2300 messages so far
2025-02-26 19:40:47,107 - INFO - Received 2400 messages so far
2025-02-26 19:40:47,108 - INFO - Received 2500 messages so far
2025-02-26 19:40:47,108 - INFO - Received 2600 messages so far
2025-02-26 19:40:47,108 - INFO - Received 2700 messages so far
2025-02-26 19:40:47,108 - INFO - Received 2800 messages so far
2025-02-26 19:40:47,108 - INFO - Received 2900 messages so far
2025-02-26 19:40:47,108 - INFO - Received 3000 messages so far
2025-02-26 19:40:47,109 - INFO - Received 3100 messages so far
2025-02-26 19:40:47,109 - INFO - Received 3200 messages so far
2025-02-26 19:40:47,109 - INFO - Received 3300 messages so far
2025-02-26 19:40:47,109 - INFO - Received 3400 messages so far
2025-02-26 19:40:47,109 - INFO - Received 3500 messages so far
2025-02-26 19:40:47,110 - INFO - Received 3600 messages so far
2025-02-26 19:40:47,110 - INFO - Received 3700 messages so far
2025-02-26 19:40:47,110 - INFO - Received 3800 messages so far
2025-02-26 19:40:47,110 - INFO - Received 3900 messages so far
2025-02-26 19:40:47,110 - INFO - Received 4000 messages so far
2025-02-26 19:40:47,111 - INFO - Received 4100 messages so far
2025-02-26 19:40:47,166 - INFO - Received 4200 messages so far
2025-02-26 19:40:47,166 - INFO - Received 4300 messages so far
2025-02-26 19:40:47,166 - INFO - Received 4400 messages so far
2025-02-26 19:40:47,166 - INFO - Received 4500 messages so far
2025-02-26 19:40:47,166 - INFO - Received 4600 messages so far
2025-02-26 19:40:47,167 - INFO - Received 4700 messages so far
2025-02-26 19:40:47,167 - INFO - Received 4800 messages so far
2025-02-26 19:40:47,167 - INFO - Received 4900 messages so far
2025-02-26 19:40:47,167 - INFO - Received 5000 messages so far
2025-02-26 19:40:47,168 - INFO - Received 5100 messages so far
2025-02-26 19:40:47,168 - INFO - Received 5200 messages so far
2025-02-26 19:40:47,168 - INFO - Received 5300 messages so far
2025-02-26 19:40:47,168 - INFO - Received 5400 messages so far
2025-02-26 19:40:47,168 - INFO - Received 5500 messages so far
2025-02-26 19:40:47,169 - INFO - Received 5600 messages so far
2025-02-26 19:40:47,169 - INFO - Received 5700 messages so far
2025-02-26 19:40:47,169 - INFO - Received 5800 messages so far
2025-02-26 19:40:47,169 - INFO - Received 5900 messages so far
2025-02-26 19:40:47,169 - INFO - Received 6000 messages so far
2025-02-26 19:40:47,170 - INFO - Received 6100 messages so far
2025-02-26 19:40:47,170 - INFO - Received 6200 messages so far
2025-02-26 19:40:47,170 - INFO - Received 6300 messages so far
2025-02-26 19:40:47,170 - INFO - Received 6400 messages so far
2025-02-26 19:40:47,170 - INFO - Received 6500 messages so far
2025-02-26 19:40:47,171 - INFO - Received 6600 messages so far
2025-02-26 19:40:47,171 - INFO - Received 6700 messages so far
2025-02-26 19:40:47,171 - INFO - Received 6800 messages so far
2025-02-26 19:40:47,171 - INFO - Received 6900 messages so far
2025-02-26 19:40:47,171 - INFO - Received 7000 messages so far
2025-02-26 19:40:47,172 - INFO - Received 7100 messages so far
2025-02-26 19:40:47,172 - INFO - Received 7200 messages so far
2025-02-26 19:40:47,172 - INFO - Received 7300 messages so far
2025-02-26 19:40:47,172 - INFO - Received 7400 messages so far
2025-02-26 19:40:47,172 - INFO - Received 7500 messages so far
2025-02-26 19:40:47,173 - INFO - Received 7600 messages so far
2025-02-26 19:40:47,173 - INFO - Received 7700 messages so far
2025-02-26 19:40:47,173 - INFO - Received 7800 messages so far
2025-02-26 19:40:47,173 - INFO - Received 7900 messages so far
2025-02-26 19:40:47,173 - INFO - Received 8000 messages so far
2025-02-26 19:40:47,173 - INFO - Received 8100 messages so far
2025-02-26 19:40:47,174 - INFO - Received 8200 messages so far
2025-02-26 19:40:47,174 - INFO - Received 8300 messages so far
2025-02-26 19:40:47,174 - INFO - Received 8400 messages so far
2025-02-26 19:40:47,174 - INFO - Received 8500 messages so far
2025-02-26 19:40:47,174 - INFO - Received 8600 messages so far
2025-02-26 19:40:47,175 - INFO - Received 8700 messages so far
2025-02-26 19:40:47,284 - INFO - Received 8800 messages so far
2025-02-26 19:40:47,285 - INFO - Received 8900 messages so far
2025-02-26 19:40:47,285 - INFO - Received 9000 messages so far
2025-02-26 19:40:47,285 - INFO - Received 9100 messages so far
2025-02-26 19:40:47,285 - INFO - Received 9200 messages so far
2025-02-26 19:40:47,285 - INFO - Received 9300 messages so far
2025-02-26 19:40:47,286 - INFO - Received 9400 messages so far
2025-02-26 19:40:47,286 - INFO - Received 9500 messages so far
2025-02-26 19:40:47,286 - INFO - Received 9600 messages so far
2025-02-26 19:40:47,286 - INFO - Received 9700 messages so far
2025-02-26 19:40:47,286 - INFO - Received 9800 messages so far
2025-02-26 19:40:47,287 - INFO - Received 9900 messages so far
2025-02-26 19:40:47,287 - INFO - Received 10000 messages so far
2025-02-26 19:40:47,287 - INFO - Total messages consumed: 10000
2025-02-26 19:40:47,376 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:47,380 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:47,380 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:47,380 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:47,380 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:47,388 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:47,391 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:47,391 - INFO - Number of columns: 66
2025-02-26 19:40:47,402 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7698        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
873         NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3480        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
509         NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5274       53.0  192.168.1.3  192.168.1.1   udp        74.0       145.0  1.740119e+09      NaN  NaN     dns  Cq2eutQXtXCUPTGpe    52405.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0          102.0        1.0          173.0      17.0  0.001177     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:47,402 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:47,434 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:47,479 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    c456d0cc73137d45              e456d0cc73137d45  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:47,480 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.   443.  1900.   136.   133. 21116.   134.
   135.   123.    80.   138.    22. 21115.     0.   547.    67.]
2025-02-26 19:40:47,481 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:47,486 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:47,487 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:47,488 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:47,490 - INFO - DataFrame shape after NA dropping: (878, 23)
2025-02-26 19:40:47,490 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:47,490 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:47,490 - INFO - X shape: (878, 21), y shape: (878,)
2025-02-26 19:40:47,491 - INFO - Label distribution in training data: {'DNS': 733, 'HTTPS': 130, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:47,492 - INFO - Training model...
2025-02-26 19:40:47,607 - INFO - Predicting on test data...
2025-02-26 19:40:47,621 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 151.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 24.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 176.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 176.0
  }
}
2025-02-26 19:40:47,628 - INFO - Saved processed data locally to processed_data_20250226_194047.csv
2025-02-26 19:40:47,630 - INFO - JSON data size: 434080 bytes
2025-02-26 19:40:47,631 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:47,631 - INFO - Data sent successfully!
2025-02-26 19:40:47,631 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:47,632 - INFO - Starting data processing
2025-02-26 19:40:47,632 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:47,632 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:47,633 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:47,633 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:47,735 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:47,735 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:47,736 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:47,736 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:47,736 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:47,737 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:47,737 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:47,737 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:47,737 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:47,892 - INFO - Received 100 messages so far
2025-02-26 19:40:47,892 - INFO - Received 200 messages so far
2025-02-26 19:40:47,892 - INFO - Received 300 messages so far
2025-02-26 19:40:47,892 - INFO - Received 400 messages so far
2025-02-26 19:40:47,892 - INFO - Received 500 messages so far
2025-02-26 19:40:47,893 - INFO - Received 600 messages so far
2025-02-26 19:40:47,893 - INFO - Received 700 messages so far
2025-02-26 19:40:47,893 - INFO - Received 800 messages so far
2025-02-26 19:40:47,893 - INFO - Received 900 messages so far
2025-02-26 19:40:47,893 - INFO - Received 1000 messages so far
2025-02-26 19:40:47,894 - INFO - Received 1100 messages so far
2025-02-26 19:40:47,894 - INFO - Received 1200 messages so far
2025-02-26 19:40:47,894 - INFO - Received 1300 messages so far
2025-02-26 19:40:47,894 - INFO - Received 1400 messages so far
2025-02-26 19:40:47,894 - INFO - Received 1500 messages so far
2025-02-26 19:40:47,894 - INFO - Received 1600 messages so far
2025-02-26 19:40:47,895 - INFO - Received 1700 messages so far
2025-02-26 19:40:47,895 - INFO - Received 1800 messages so far
2025-02-26 19:40:47,895 - INFO - Received 1900 messages so far
2025-02-26 19:40:47,895 - INFO - Received 2000 messages so far
2025-02-26 19:40:47,895 - INFO - Received 2100 messages so far
2025-02-26 19:40:47,896 - INFO - Received 2200 messages so far
2025-02-26 19:40:47,896 - INFO - Received 2300 messages so far
2025-02-26 19:40:47,896 - INFO - Received 2400 messages so far
2025-02-26 19:40:47,896 - INFO - Received 2500 messages so far
2025-02-26 19:40:47,896 - INFO - Received 2600 messages so far
2025-02-26 19:40:47,897 - INFO - Received 2700 messages so far
2025-02-26 19:40:47,897 - INFO - Received 2800 messages so far
2025-02-26 19:40:47,897 - INFO - Received 2900 messages so far
2025-02-26 19:40:47,897 - INFO - Received 3000 messages so far
2025-02-26 19:40:47,897 - INFO - Received 3100 messages so far
2025-02-26 19:40:47,898 - INFO - Received 3200 messages so far
2025-02-26 19:40:47,898 - INFO - Received 3300 messages so far
2025-02-26 19:40:47,898 - INFO - Received 3400 messages so far
2025-02-26 19:40:47,898 - INFO - Received 3500 messages so far
2025-02-26 19:40:47,898 - INFO - Received 3600 messages so far
2025-02-26 19:40:47,899 - INFO - Received 3700 messages so far
2025-02-26 19:40:47,899 - INFO - Received 3800 messages so far
2025-02-26 19:40:47,899 - INFO - Received 3900 messages so far
2025-02-26 19:40:47,899 - INFO - Received 4000 messages so far
2025-02-26 19:40:47,899 - INFO - Received 4100 messages so far
2025-02-26 19:40:47,953 - INFO - Received 4200 messages so far
2025-02-26 19:40:47,954 - INFO - Received 4300 messages so far
2025-02-26 19:40:47,954 - INFO - Received 4400 messages so far
2025-02-26 19:40:47,954 - INFO - Received 4500 messages so far
2025-02-26 19:40:47,954 - INFO - Received 4600 messages so far
2025-02-26 19:40:47,954 - INFO - Received 4700 messages so far
2025-02-26 19:40:47,955 - INFO - Received 4800 messages so far
2025-02-26 19:40:47,955 - INFO - Received 4900 messages so far
2025-02-26 19:40:47,955 - INFO - Received 5000 messages so far
2025-02-26 19:40:47,955 - INFO - Received 5100 messages so far
2025-02-26 19:40:47,955 - INFO - Received 5200 messages so far
2025-02-26 19:40:47,956 - INFO - Received 5300 messages so far
2025-02-26 19:40:47,956 - INFO - Received 5400 messages so far
2025-02-26 19:40:47,956 - INFO - Received 5500 messages so far
2025-02-26 19:40:47,956 - INFO - Received 5600 messages so far
2025-02-26 19:40:47,956 - INFO - Received 5700 messages so far
2025-02-26 19:40:47,957 - INFO - Received 5800 messages so far
2025-02-26 19:40:47,957 - INFO - Received 5900 messages so far
2025-02-26 19:40:47,957 - INFO - Received 6000 messages so far
2025-02-26 19:40:47,957 - INFO - Received 6100 messages so far
2025-02-26 19:40:47,957 - INFO - Received 6200 messages so far
2025-02-26 19:40:47,958 - INFO - Received 6300 messages so far
2025-02-26 19:40:47,958 - INFO - Received 6400 messages so far
2025-02-26 19:40:47,958 - INFO - Received 6500 messages so far
2025-02-26 19:40:47,958 - INFO - Received 6600 messages so far
2025-02-26 19:40:47,958 - INFO - Received 6700 messages so far
2025-02-26 19:40:47,959 - INFO - Received 6800 messages so far
2025-02-26 19:40:47,959 - INFO - Received 6900 messages so far
2025-02-26 19:40:47,959 - INFO - Received 7000 messages so far
2025-02-26 19:40:47,959 - INFO - Received 7100 messages so far
2025-02-26 19:40:47,959 - INFO - Received 7200 messages so far
2025-02-26 19:40:47,960 - INFO - Received 7300 messages so far
2025-02-26 19:40:47,960 - INFO - Received 7400 messages so far
2025-02-26 19:40:47,960 - INFO - Received 7500 messages so far
2025-02-26 19:40:47,960 - INFO - Received 7600 messages so far
2025-02-26 19:40:47,960 - INFO - Received 7700 messages so far
2025-02-26 19:40:47,961 - INFO - Received 7800 messages so far
2025-02-26 19:40:47,961 - INFO - Received 7900 messages so far
2025-02-26 19:40:47,961 - INFO - Received 8000 messages so far
2025-02-26 19:40:47,961 - INFO - Received 8100 messages so far
2025-02-26 19:40:47,961 - INFO - Received 8200 messages so far
2025-02-26 19:40:47,962 - INFO - Received 8300 messages so far
2025-02-26 19:40:47,962 - INFO - Received 8400 messages so far
2025-02-26 19:40:47,962 - INFO - Received 8500 messages so far
2025-02-26 19:40:47,962 - INFO - Received 8600 messages so far
2025-02-26 19:40:47,963 - INFO - Received 8700 messages so far
2025-02-26 19:40:48,019 - INFO - Received 8800 messages so far
2025-02-26 19:40:48,020 - INFO - Received 8900 messages so far
2025-02-26 19:40:48,020 - INFO - Received 9000 messages so far
2025-02-26 19:40:48,020 - INFO - Received 9100 messages so far
2025-02-26 19:40:48,020 - INFO - Received 9200 messages so far
2025-02-26 19:40:48,020 - INFO - Received 9300 messages so far
2025-02-26 19:40:48,021 - INFO - Received 9400 messages so far
2025-02-26 19:40:48,021 - INFO - Received 9500 messages so far
2025-02-26 19:40:48,021 - INFO - Received 9600 messages so far
2025-02-26 19:40:48,021 - INFO - Received 9700 messages so far
2025-02-26 19:40:48,021 - INFO - Received 9800 messages so far
2025-02-26 19:40:48,022 - INFO - Received 9900 messages so far
2025-02-26 19:40:48,022 - INFO - Received 10000 messages so far
2025-02-26 19:40:48,022 - INFO - Total messages consumed: 10000
2025-02-26 19:40:48,111 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:48,115 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:48,115 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:48,115 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:48,115 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:48,122 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:48,126 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:48,126 - INFO - Number of columns: 66
2025-02-26 19:40:48,136 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9955        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.006159     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1498        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4797        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6808        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9479        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:48,136 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:48,167 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:48,213 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    1edec4bdcc72bfa6              2336755850007c23  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:48,213 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443.  1900.   123.    80.  5353.   547.   134.
   138.   133.   136.    67.   135.    22.     0. 21115. 21116.]
2025-02-26 19:40:48,214 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:48,219 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:48,221 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:48,221 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:48,223 - INFO - DataFrame shape after NA dropping: (844, 23)
2025-02-26 19:40:48,223 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:48,223 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:48,224 - INFO - X shape: (844, 21), y shape: (844,)
2025-02-26 19:40:48,224 - INFO - Label distribution in training data: {'DNS': 702, 'HTTPS': 129, 'HTTP': 12, 'SSH': 1}
2025-02-26 19:40:48,225 - INFO - Training model...
2025-02-26 19:40:48,336 - INFO - Predicting on test data...
2025-02-26 19:40:48,350 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 136.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.75,
    "f1-score": 0.8571428571428571,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 0.9666666666666667,
    "recall": 1.0,
    "f1-score": 0.9830508474576272,
    "support": 29.0
  },
  "accuracy": 0.9940828402366864,
  "macro avg": {
    "precision": 0.9888888888888889,
    "recall": 0.9166666666666666,
    "f1-score": 0.9467312348668281,
    "support": 169.0
  },
  "weighted avg": {
    "precision": 0.9942800788954635,
    "recall": 0.9940828402366864,
    "f1-score": 0.9937103313896013,
    "support": 169.0
  }
}
2025-02-26 19:40:48,356 - INFO - Saved processed data locally to processed_data_20250226_194048.csv
2025-02-26 19:40:48,359 - INFO - JSON data size: 415193 bytes
2025-02-26 19:40:48,359 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:48,359 - INFO - Data sent successfully!
2025-02-26 19:40:48,359 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:48,360 - INFO - Starting data processing
2025-02-26 19:40:48,360 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:48,360 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:48,361 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:48,361 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:48,463 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:48,463 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:48,464 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:48,464 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:48,464 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:48,465 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:48,465 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:48,465 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:48,465 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:48,659 - INFO - Received 100 messages so far
2025-02-26 19:40:48,659 - INFO - Received 200 messages so far
2025-02-26 19:40:48,659 - INFO - Received 300 messages so far
2025-02-26 19:40:48,659 - INFO - Received 400 messages so far
2025-02-26 19:40:48,660 - INFO - Received 500 messages so far
2025-02-26 19:40:48,660 - INFO - Received 600 messages so far
2025-02-26 19:40:48,660 - INFO - Received 700 messages so far
2025-02-26 19:40:48,660 - INFO - Received 800 messages so far
2025-02-26 19:40:48,660 - INFO - Received 900 messages so far
2025-02-26 19:40:48,661 - INFO - Received 1000 messages so far
2025-02-26 19:40:48,661 - INFO - Received 1100 messages so far
2025-02-26 19:40:48,661 - INFO - Received 1200 messages so far
2025-02-26 19:40:48,661 - INFO - Received 1300 messages so far
2025-02-26 19:40:48,661 - INFO - Received 1400 messages so far
2025-02-26 19:40:48,662 - INFO - Received 1500 messages so far
2025-02-26 19:40:48,662 - INFO - Received 1600 messages so far
2025-02-26 19:40:48,662 - INFO - Received 1700 messages so far
2025-02-26 19:40:48,662 - INFO - Received 1800 messages so far
2025-02-26 19:40:48,662 - INFO - Received 1900 messages so far
2025-02-26 19:40:48,663 - INFO - Received 2000 messages so far
2025-02-26 19:40:48,663 - INFO - Received 2100 messages so far
2025-02-26 19:40:48,663 - INFO - Received 2200 messages so far
2025-02-26 19:40:48,663 - INFO - Received 2300 messages so far
2025-02-26 19:40:48,663 - INFO - Received 2400 messages so far
2025-02-26 19:40:48,664 - INFO - Received 2500 messages so far
2025-02-26 19:40:48,664 - INFO - Received 2600 messages so far
2025-02-26 19:40:48,664 - INFO - Received 2700 messages so far
2025-02-26 19:40:48,664 - INFO - Received 2800 messages so far
2025-02-26 19:40:48,664 - INFO - Received 2900 messages so far
2025-02-26 19:40:48,665 - INFO - Received 3000 messages so far
2025-02-26 19:40:48,665 - INFO - Received 3100 messages so far
2025-02-26 19:40:48,665 - INFO - Received 3200 messages so far
2025-02-26 19:40:48,665 - INFO - Received 3300 messages so far
2025-02-26 19:40:48,665 - INFO - Received 3400 messages so far
2025-02-26 19:40:48,666 - INFO - Received 3500 messages so far
2025-02-26 19:40:48,666 - INFO - Received 3600 messages so far
2025-02-26 19:40:48,666 - INFO - Received 3700 messages so far
2025-02-26 19:40:48,666 - INFO - Received 3800 messages so far
2025-02-26 19:40:48,666 - INFO - Received 3900 messages so far
2025-02-26 19:40:48,666 - INFO - Received 4000 messages so far
2025-02-26 19:40:48,667 - INFO - Received 4100 messages so far
2025-02-26 19:40:48,722 - INFO - Received 4200 messages so far
2025-02-26 19:40:48,722 - INFO - Received 4300 messages so far
2025-02-26 19:40:48,722 - INFO - Received 4400 messages so far
2025-02-26 19:40:48,723 - INFO - Received 4500 messages so far
2025-02-26 19:40:48,723 - INFO - Received 4600 messages so far
2025-02-26 19:40:48,723 - INFO - Received 4700 messages so far
2025-02-26 19:40:48,723 - INFO - Received 4800 messages so far
2025-02-26 19:40:48,723 - INFO - Received 4900 messages so far
2025-02-26 19:40:48,724 - INFO - Received 5000 messages so far
2025-02-26 19:40:48,724 - INFO - Received 5100 messages so far
2025-02-26 19:40:48,724 - INFO - Received 5200 messages so far
2025-02-26 19:40:48,724 - INFO - Received 5300 messages so far
2025-02-26 19:40:48,724 - INFO - Received 5400 messages so far
2025-02-26 19:40:48,725 - INFO - Received 5500 messages so far
2025-02-26 19:40:48,725 - INFO - Received 5600 messages so far
2025-02-26 19:40:48,725 - INFO - Received 5700 messages so far
2025-02-26 19:40:48,725 - INFO - Received 5800 messages so far
2025-02-26 19:40:48,725 - INFO - Received 5900 messages so far
2025-02-26 19:40:48,726 - INFO - Received 6000 messages so far
2025-02-26 19:40:48,726 - INFO - Received 6100 messages so far
2025-02-26 19:40:48,726 - INFO - Received 6200 messages so far
2025-02-26 19:40:48,726 - INFO - Received 6300 messages so far
2025-02-26 19:40:48,726 - INFO - Received 6400 messages so far
2025-02-26 19:40:48,727 - INFO - Received 6500 messages so far
2025-02-26 19:40:48,727 - INFO - Received 6600 messages so far
2025-02-26 19:40:48,727 - INFO - Received 6700 messages so far
2025-02-26 19:40:48,727 - INFO - Received 6800 messages so far
2025-02-26 19:40:48,727 - INFO - Received 6900 messages so far
2025-02-26 19:40:48,727 - INFO - Received 7000 messages so far
2025-02-26 19:40:48,728 - INFO - Received 7100 messages so far
2025-02-26 19:40:48,728 - INFO - Received 7200 messages so far
2025-02-26 19:40:48,728 - INFO - Received 7300 messages so far
2025-02-26 19:40:48,728 - INFO - Received 7400 messages so far
2025-02-26 19:40:48,728 - INFO - Received 7500 messages so far
2025-02-26 19:40:48,729 - INFO - Received 7600 messages so far
2025-02-26 19:40:48,729 - INFO - Received 7700 messages so far
2025-02-26 19:40:48,729 - INFO - Received 7800 messages so far
2025-02-26 19:40:48,729 - INFO - Received 7900 messages so far
2025-02-26 19:40:48,729 - INFO - Received 8000 messages so far
2025-02-26 19:40:48,730 - INFO - Received 8100 messages so far
2025-02-26 19:40:48,730 - INFO - Received 8200 messages so far
2025-02-26 19:40:48,730 - INFO - Received 8300 messages so far
2025-02-26 19:40:48,731 - INFO - Received 8400 messages so far
2025-02-26 19:40:48,731 - INFO - Received 8500 messages so far
2025-02-26 19:40:48,731 - INFO - Received 8600 messages so far
2025-02-26 19:40:48,731 - INFO - Received 8700 messages so far
2025-02-26 19:40:48,787 - INFO - Received 8800 messages so far
2025-02-26 19:40:48,787 - INFO - Received 8900 messages so far
2025-02-26 19:40:48,788 - INFO - Received 9000 messages so far
2025-02-26 19:40:48,788 - INFO - Received 9100 messages so far
2025-02-26 19:40:48,788 - INFO - Received 9200 messages so far
2025-02-26 19:40:48,788 - INFO - Received 9300 messages so far
2025-02-26 19:40:48,788 - INFO - Received 9400 messages so far
2025-02-26 19:40:48,789 - INFO - Received 9500 messages so far
2025-02-26 19:40:48,789 - INFO - Received 9600 messages so far
2025-02-26 19:40:48,789 - INFO - Received 9700 messages so far
2025-02-26 19:40:48,789 - INFO - Received 9800 messages so far
2025-02-26 19:40:48,789 - INFO - Received 9900 messages so far
2025-02-26 19:40:48,789 - INFO - Received 10000 messages so far
2025-02-26 19:40:48,790 - INFO - Total messages consumed: 10000
2025-02-26 19:40:48,878 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:48,882 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:48,882 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:48,882 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:48,882 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:48,889 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:48,893 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:48,893 - INFO - Number of columns: 66
2025-02-26 19:40:48,904 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                               query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                 answers            TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
5057        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                     NaN             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9772        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                     NaN             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3901       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740119e+09      NaN  NaN     NaN  CKLcGu1NsjPDNAP2Di    36400.0  0.002237  word-telemetry.officeapps.live.com     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  True  0.0  [word-telemetry.wac.trafficmanager.net, pgtus3-word-telemetry-vip.officeapps.live.com]  [145.0, 145.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5962        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                     NaN             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3394        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                     NaN             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:48,904 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:48,935 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:48,980 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    5b67465ea3a9f950              20e4136c52007c23  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:48,981 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.   443.   123. 21116.   134.   138.  1900.
 21115.    80.   133.   547.   136.     0.    67.    22.   135.]
2025-02-26 19:40:48,982 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:48,987 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:48,989 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:48,989 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:48,991 - INFO - DataFrame shape after NA dropping: (890, 23)
2025-02-26 19:40:48,991 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:48,991 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:48,991 - INFO - X shape: (890, 21), y shape: (890,)
2025-02-26 19:40:48,992 - INFO - Label distribution in training data: {'DNS': 741, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:48,992 - INFO - Training model...
2025-02-26 19:40:49,108 - INFO - Predicting on test data...
2025-02-26 19:40:49,122 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 142.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.6,
    "f1-score": 0.75,
    "support": 5.0
  },
  "HTTPS": {
    "precision": 0.9393939393939394,
    "recall": 1.0,
    "f1-score": 0.96875,
    "support": 31.0
  },
  "accuracy": 0.9887640449438202,
  "macro avg": {
    "precision": 0.9797979797979798,
    "recall": 0.8666666666666667,
    "f1-score": 0.90625,
    "support": 178.0
  },
  "weighted avg": {
    "precision": 0.989445011916922,
    "recall": 0.9887640449438202,
    "f1-score": 0.9875351123595506,
    "support": 178.0
  }
}
2025-02-26 19:40:49,129 - INFO - Saved processed data locally to processed_data_20250226_194049.csv
2025-02-26 19:40:49,132 - INFO - JSON data size: 436050 bytes
2025-02-26 19:40:49,132 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:49,132 - INFO - Data sent successfully!
2025-02-26 19:40:49,132 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:49,133 - INFO - Starting data processing
2025-02-26 19:40:49,133 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:49,134 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:49,134 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:49,134 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:49,236 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:49,237 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:49,237 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:49,238 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:49,238 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:49,239 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:49,239 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:49,239 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:49,239 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:49,393 - INFO - Received 100 messages so far
2025-02-26 19:40:49,393 - INFO - Received 200 messages so far
2025-02-26 19:40:49,394 - INFO - Received 300 messages so far
2025-02-26 19:40:49,394 - INFO - Received 400 messages so far
2025-02-26 19:40:49,394 - INFO - Received 500 messages so far
2025-02-26 19:40:49,394 - INFO - Received 600 messages so far
2025-02-26 19:40:49,394 - INFO - Received 700 messages so far
2025-02-26 19:40:49,395 - INFO - Received 800 messages so far
2025-02-26 19:40:49,395 - INFO - Received 900 messages so far
2025-02-26 19:40:49,395 - INFO - Received 1000 messages so far
2025-02-26 19:40:49,395 - INFO - Received 1100 messages so far
2025-02-26 19:40:49,395 - INFO - Received 1200 messages so far
2025-02-26 19:40:49,395 - INFO - Received 1300 messages so far
2025-02-26 19:40:49,396 - INFO - Received 1400 messages so far
2025-02-26 19:40:49,396 - INFO - Received 1500 messages so far
2025-02-26 19:40:49,396 - INFO - Received 1600 messages so far
2025-02-26 19:40:49,396 - INFO - Received 1700 messages so far
2025-02-26 19:40:49,396 - INFO - Received 1800 messages so far
2025-02-26 19:40:49,397 - INFO - Received 1900 messages so far
2025-02-26 19:40:49,397 - INFO - Received 2000 messages so far
2025-02-26 19:40:49,397 - INFO - Received 2100 messages so far
2025-02-26 19:40:49,397 - INFO - Received 2200 messages so far
2025-02-26 19:40:49,397 - INFO - Received 2300 messages so far
2025-02-26 19:40:49,398 - INFO - Received 2400 messages so far
2025-02-26 19:40:49,398 - INFO - Received 2500 messages so far
2025-02-26 19:40:49,398 - INFO - Received 2600 messages so far
2025-02-26 19:40:49,398 - INFO - Received 2700 messages so far
2025-02-26 19:40:49,398 - INFO - Received 2800 messages so far
2025-02-26 19:40:49,399 - INFO - Received 2900 messages so far
2025-02-26 19:40:49,399 - INFO - Received 3000 messages so far
2025-02-26 19:40:49,399 - INFO - Received 3100 messages so far
2025-02-26 19:40:49,399 - INFO - Received 3200 messages so far
2025-02-26 19:40:49,399 - INFO - Received 3300 messages so far
2025-02-26 19:40:49,400 - INFO - Received 3400 messages so far
2025-02-26 19:40:49,400 - INFO - Received 3500 messages so far
2025-02-26 19:40:49,400 - INFO - Received 3600 messages so far
2025-02-26 19:40:49,400 - INFO - Received 3700 messages so far
2025-02-26 19:40:49,400 - INFO - Received 3800 messages so far
2025-02-26 19:40:49,400 - INFO - Received 3900 messages so far
2025-02-26 19:40:49,401 - INFO - Received 4000 messages so far
2025-02-26 19:40:49,401 - INFO - Received 4100 messages so far
2025-02-26 19:40:49,497 - INFO - Received 4200 messages so far
2025-02-26 19:40:49,498 - INFO - Received 4300 messages so far
2025-02-26 19:40:49,498 - INFO - Received 4400 messages so far
2025-02-26 19:40:49,498 - INFO - Received 4500 messages so far
2025-02-26 19:40:49,498 - INFO - Received 4600 messages so far
2025-02-26 19:40:49,499 - INFO - Received 4700 messages so far
2025-02-26 19:40:49,499 - INFO - Received 4800 messages so far
2025-02-26 19:40:49,499 - INFO - Received 4900 messages so far
2025-02-26 19:40:49,499 - INFO - Received 5000 messages so far
2025-02-26 19:40:49,499 - INFO - Received 5100 messages so far
2025-02-26 19:40:49,500 - INFO - Received 5200 messages so far
2025-02-26 19:40:49,500 - INFO - Received 5300 messages so far
2025-02-26 19:40:49,500 - INFO - Received 5400 messages so far
2025-02-26 19:40:49,500 - INFO - Received 5500 messages so far
2025-02-26 19:40:49,500 - INFO - Received 5600 messages so far
2025-02-26 19:40:49,501 - INFO - Received 5700 messages so far
2025-02-26 19:40:49,501 - INFO - Received 5800 messages so far
2025-02-26 19:40:49,501 - INFO - Received 5900 messages so far
2025-02-26 19:40:49,501 - INFO - Received 6000 messages so far
2025-02-26 19:40:49,501 - INFO - Received 6100 messages so far
2025-02-26 19:40:49,501 - INFO - Received 6200 messages so far
2025-02-26 19:40:49,502 - INFO - Received 6300 messages so far
2025-02-26 19:40:49,502 - INFO - Received 6400 messages so far
2025-02-26 19:40:49,502 - INFO - Received 6500 messages so far
2025-02-26 19:40:49,502 - INFO - Received 6600 messages so far
2025-02-26 19:40:49,502 - INFO - Received 6700 messages so far
2025-02-26 19:40:49,503 - INFO - Received 6800 messages so far
2025-02-26 19:40:49,503 - INFO - Received 6900 messages so far
2025-02-26 19:40:49,503 - INFO - Received 7000 messages so far
2025-02-26 19:40:49,503 - INFO - Received 7100 messages so far
2025-02-26 19:40:49,503 - INFO - Received 7200 messages so far
2025-02-26 19:40:49,504 - INFO - Received 7300 messages so far
2025-02-26 19:40:49,504 - INFO - Received 7400 messages so far
2025-02-26 19:40:49,504 - INFO - Received 7500 messages so far
2025-02-26 19:40:49,504 - INFO - Received 7600 messages so far
2025-02-26 19:40:49,504 - INFO - Received 7700 messages so far
2025-02-26 19:40:49,505 - INFO - Received 7800 messages so far
2025-02-26 19:40:49,505 - INFO - Received 7900 messages so far
2025-02-26 19:40:49,505 - INFO - Received 8000 messages so far
2025-02-26 19:40:49,505 - INFO - Received 8100 messages so far
2025-02-26 19:40:49,505 - INFO - Received 8200 messages so far
2025-02-26 19:40:49,506 - INFO - Received 8300 messages so far
2025-02-26 19:40:49,506 - INFO - Received 8400 messages so far
2025-02-26 19:40:49,506 - INFO - Received 8500 messages so far
2025-02-26 19:40:49,506 - INFO - Received 8600 messages so far
2025-02-26 19:40:49,507 - INFO - Received 8700 messages so far
2025-02-26 19:40:49,562 - INFO - Received 8800 messages so far
2025-02-26 19:40:49,563 - INFO - Received 8900 messages so far
2025-02-26 19:40:49,563 - INFO - Received 9000 messages so far
2025-02-26 19:40:49,563 - INFO - Received 9100 messages so far
2025-02-26 19:40:49,563 - INFO - Received 9200 messages so far
2025-02-26 19:40:49,563 - INFO - Received 9300 messages so far
2025-02-26 19:40:49,564 - INFO - Received 9400 messages so far
2025-02-26 19:40:49,564 - INFO - Received 9500 messages so far
2025-02-26 19:40:49,564 - INFO - Received 9600 messages so far
2025-02-26 19:40:49,564 - INFO - Received 9700 messages so far
2025-02-26 19:40:49,564 - INFO - Received 9800 messages so far
2025-02-26 19:40:49,565 - INFO - Received 9900 messages so far
2025-02-26 19:40:49,565 - INFO - Received 10000 messages so far
2025-02-26 19:40:49,565 - INFO - Total messages consumed: 10000
2025-02-26 19:40:49,653 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:49,657 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:49,657 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:49,657 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:49,657 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:49,665 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:49,668 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:49,668 - INFO - Number of columns: 66
2025-02-26 19:40:49,680 - INFO - DataFrame head:
      id.resp_p    id.orig_h        id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
6811        NaN          NaN              NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1115     1900.0  192.168.1.3  239.255.255.250   udp       688.0         0.0  1.740118e+09      NaN  NaN     NaN  CW74Ea3eQOahFkB99    33119.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         S0       True      False           0.0       D        4.0          800.0        0.0            0.0      17.0  3.003272     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9755        NaN          NaN              NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7734        NaN          NaN              NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7534        NaN          NaN              NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:49,680 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:49,710 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:49,756 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    7621c9ee35587231              f621c9ee35587231  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:49,757 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  1900.   443.    53.  9092.   138.   134.  5353.   123.   136.
 21115.    80. 21116.   133.     0.    22.   135.   547.    67.]
2025-02-26 19:40:49,758 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:49,763 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:49,764 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:49,764 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:49,766 - INFO - DataFrame shape after NA dropping: (803, 23)
2025-02-26 19:40:49,767 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:49,767 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:49,767 - INFO - X shape: (803, 21), y shape: (803,)
2025-02-26 19:40:49,767 - INFO - Label distribution in training data: {'DNS': 668, 'HTTPS': 120, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:49,768 - INFO - Training model...
2025-02-26 19:40:49,880 - INFO - Predicting on test data...
2025-02-26 19:40:49,893 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 133.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.8,
    "f1-score": 0.8888888888888888,
    "support": 5.0
  },
  "HTTPS": {
    "precision": 0.9583333333333334,
    "recall": 1.0,
    "f1-score": 0.9787234042553191,
    "support": 23.0
  },
  "accuracy": 0.9937888198757764,
  "macro avg": {
    "precision": 0.9861111111111112,
    "recall": 0.9333333333333332,
    "f1-score": 0.9558707643814026,
    "support": 161.0
  },
  "weighted avg": {
    "precision": 0.994047619047619,
    "recall": 0.9937888198757764,
    "f1-score": 0.9935098306976198,
    "support": 161.0
  }
}
2025-02-26 19:40:49,900 - INFO - Saved processed data locally to processed_data_20250226_194049.csv
2025-02-26 19:40:49,902 - INFO - JSON data size: 397786 bytes
2025-02-26 19:40:49,902 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:49,902 - INFO - Data sent successfully!
2025-02-26 19:40:49,902 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:49,903 - INFO - Starting data processing
2025-02-26 19:40:49,903 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:49,904 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:49,905 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:49,905 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:50,007 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:50,007 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:50,007 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:50,007 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:50,007 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:50,009 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:50,009 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:50,009 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:50,009 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:50,163 - INFO - Received 100 messages so far
2025-02-26 19:40:50,163 - INFO - Received 200 messages so far
2025-02-26 19:40:50,163 - INFO - Received 300 messages so far
2025-02-26 19:40:50,163 - INFO - Received 400 messages so far
2025-02-26 19:40:50,163 - INFO - Received 500 messages so far
2025-02-26 19:40:50,164 - INFO - Received 600 messages so far
2025-02-26 19:40:50,164 - INFO - Received 700 messages so far
2025-02-26 19:40:50,164 - INFO - Received 800 messages so far
2025-02-26 19:40:50,164 - INFO - Received 900 messages so far
2025-02-26 19:40:50,164 - INFO - Received 1000 messages so far
2025-02-26 19:40:50,165 - INFO - Received 1100 messages so far
2025-02-26 19:40:50,165 - INFO - Received 1200 messages so far
2025-02-26 19:40:50,165 - INFO - Received 1300 messages so far
2025-02-26 19:40:50,165 - INFO - Received 1400 messages so far
2025-02-26 19:40:50,165 - INFO - Received 1500 messages so far
2025-02-26 19:40:50,166 - INFO - Received 1600 messages so far
2025-02-26 19:40:50,166 - INFO - Received 1700 messages so far
2025-02-26 19:40:50,166 - INFO - Received 1800 messages so far
2025-02-26 19:40:50,166 - INFO - Received 1900 messages so far
2025-02-26 19:40:50,166 - INFO - Received 2000 messages so far
2025-02-26 19:40:50,167 - INFO - Received 2100 messages so far
2025-02-26 19:40:50,167 - INFO - Received 2200 messages so far
2025-02-26 19:40:50,167 - INFO - Received 2300 messages so far
2025-02-26 19:40:50,167 - INFO - Received 2400 messages so far
2025-02-26 19:40:50,167 - INFO - Received 2500 messages so far
2025-02-26 19:40:50,168 - INFO - Received 2600 messages so far
2025-02-26 19:40:50,168 - INFO - Received 2700 messages so far
2025-02-26 19:40:50,168 - INFO - Received 2800 messages so far
2025-02-26 19:40:50,168 - INFO - Received 2900 messages so far
2025-02-26 19:40:50,168 - INFO - Received 3000 messages so far
2025-02-26 19:40:50,168 - INFO - Received 3100 messages so far
2025-02-26 19:40:50,169 - INFO - Received 3200 messages so far
2025-02-26 19:40:50,169 - INFO - Received 3300 messages so far
2025-02-26 19:40:50,169 - INFO - Received 3400 messages so far
2025-02-26 19:40:50,169 - INFO - Received 3500 messages so far
2025-02-26 19:40:50,169 - INFO - Received 3600 messages so far
2025-02-26 19:40:50,170 - INFO - Received 3700 messages so far
2025-02-26 19:40:50,170 - INFO - Received 3800 messages so far
2025-02-26 19:40:50,170 - INFO - Received 3900 messages so far
2025-02-26 19:40:50,170 - INFO - Received 4000 messages so far
2025-02-26 19:40:50,171 - INFO - Received 4100 messages so far
2025-02-26 19:40:50,225 - INFO - Received 4200 messages so far
2025-02-26 19:40:50,225 - INFO - Received 4300 messages so far
2025-02-26 19:40:50,225 - INFO - Received 4400 messages so far
2025-02-26 19:40:50,226 - INFO - Received 4500 messages so far
2025-02-26 19:40:50,226 - INFO - Received 4600 messages so far
2025-02-26 19:40:50,226 - INFO - Received 4700 messages so far
2025-02-26 19:40:50,226 - INFO - Received 4800 messages so far
2025-02-26 19:40:50,226 - INFO - Received 4900 messages so far
2025-02-26 19:40:50,227 - INFO - Received 5000 messages so far
2025-02-26 19:40:50,227 - INFO - Received 5100 messages so far
2025-02-26 19:40:50,227 - INFO - Received 5200 messages so far
2025-02-26 19:40:50,227 - INFO - Received 5300 messages so far
2025-02-26 19:40:50,227 - INFO - Received 5400 messages so far
2025-02-26 19:40:50,228 - INFO - Received 5500 messages so far
2025-02-26 19:40:50,228 - INFO - Received 5600 messages so far
2025-02-26 19:40:50,228 - INFO - Received 5700 messages so far
2025-02-26 19:40:50,228 - INFO - Received 5800 messages so far
2025-02-26 19:40:50,228 - INFO - Received 5900 messages so far
2025-02-26 19:40:50,229 - INFO - Received 6000 messages so far
2025-02-26 19:40:50,229 - INFO - Received 6100 messages so far
2025-02-26 19:40:50,229 - INFO - Received 6200 messages so far
2025-02-26 19:40:50,229 - INFO - Received 6300 messages so far
2025-02-26 19:40:50,229 - INFO - Received 6400 messages so far
2025-02-26 19:40:50,230 - INFO - Received 6500 messages so far
2025-02-26 19:40:50,230 - INFO - Received 6600 messages so far
2025-02-26 19:40:50,230 - INFO - Received 6700 messages so far
2025-02-26 19:40:50,230 - INFO - Received 6800 messages so far
2025-02-26 19:40:50,230 - INFO - Received 6900 messages so far
2025-02-26 19:40:50,231 - INFO - Received 7000 messages so far
2025-02-26 19:40:50,231 - INFO - Received 7100 messages so far
2025-02-26 19:40:50,231 - INFO - Received 7200 messages so far
2025-02-26 19:40:50,231 - INFO - Received 7300 messages so far
2025-02-26 19:40:50,231 - INFO - Received 7400 messages so far
2025-02-26 19:40:50,231 - INFO - Received 7500 messages so far
2025-02-26 19:40:50,232 - INFO - Received 7600 messages so far
2025-02-26 19:40:50,232 - INFO - Received 7700 messages so far
2025-02-26 19:40:50,232 - INFO - Received 7800 messages so far
2025-02-26 19:40:50,232 - INFO - Received 7900 messages so far
2025-02-26 19:40:50,232 - INFO - Received 8000 messages so far
2025-02-26 19:40:50,233 - INFO - Received 8100 messages so far
2025-02-26 19:40:50,233 - INFO - Received 8200 messages so far
2025-02-26 19:40:50,233 - INFO - Received 8300 messages so far
2025-02-26 19:40:50,233 - INFO - Received 8400 messages so far
2025-02-26 19:40:50,233 - INFO - Received 8500 messages so far
2025-02-26 19:40:50,234 - INFO - Received 8600 messages so far
2025-02-26 19:40:50,234 - INFO - Received 8700 messages so far
2025-02-26 19:40:50,292 - INFO - Received 8800 messages so far
2025-02-26 19:40:50,292 - INFO - Received 8900 messages so far
2025-02-26 19:40:50,292 - INFO - Received 9000 messages so far
2025-02-26 19:40:50,293 - INFO - Received 9100 messages so far
2025-02-26 19:40:50,293 - INFO - Received 9200 messages so far
2025-02-26 19:40:50,293 - INFO - Received 9300 messages so far
2025-02-26 19:40:50,293 - INFO - Received 9400 messages so far
2025-02-26 19:40:50,293 - INFO - Received 9500 messages so far
2025-02-26 19:40:50,294 - INFO - Received 9600 messages so far
2025-02-26 19:40:50,294 - INFO - Received 9700 messages so far
2025-02-26 19:40:50,294 - INFO - Received 9800 messages so far
2025-02-26 19:40:50,294 - INFO - Received 9900 messages so far
2025-02-26 19:40:50,294 - INFO - Received 10000 messages so far
2025-02-26 19:40:50,294 - INFO - Total messages consumed: 10000
2025-02-26 19:40:50,384 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:50,388 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:50,388 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:50,388 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:50,388 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:50,396 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:50,399 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:50,399 - INFO - Number of columns: 66
2025-02-26 19:40:50,410 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes  history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto    duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3255        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN      NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2460      443.0  192.168.1.3  20.42.65.89   tcp    170297.0      7509.0  1.740118e+09      NaN  NaN     ssl  C5KGL22Czmq4i8dNb5    48260.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN       RSTR       True      False           0.0  ShADadr       74.0       174153.0      104.0        12913.0       6.0  157.898614     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2996        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN      NaN        NaN            NaN        NaN            NaN       NaN    0.009495     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1698     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740118e+09      NaN  NaN     NaN  CmKqmC3SFpHCF1JP03    54182.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0       Sr        1.0           60.0        1.0           40.0       6.0    0.000557     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2014        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN      NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:50,410 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:50,440 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:50,527 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    7621c9ee35587231              f621c9ee35587231  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:50,527 - INFO - Unique values in 'id.resp_p' before labeling: [   nan   443.  9092.   134.    53.  1900.   133.  5353.    80.   138.
   123.   136. 21116.    67.     0. 21115.    22.   547.   135.]
2025-02-26 19:40:50,529 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:50,534 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:50,535 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:50,535 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:50,537 - INFO - DataFrame shape after NA dropping: (857, 23)
2025-02-26 19:40:50,537 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:50,538 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:50,538 - INFO - X shape: (857, 21), y shape: (857,)
2025-02-26 19:40:50,538 - INFO - Label distribution in training data: {'DNS': 718, 'HTTPS': 124, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:50,539 - INFO - Training model...
2025-02-26 19:40:50,651 - INFO - Predicting on test data...
2025-02-26 19:40:50,665 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 146.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 6.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 20.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 172.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 172.0
  }
}
2025-02-26 19:40:50,672 - INFO - Saved processed data locally to processed_data_20250226_194050.csv
2025-02-26 19:40:50,674 - INFO - JSON data size: 422882 bytes
2025-02-26 19:40:50,674 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:50,674 - INFO - Data sent successfully!
2025-02-26 19:40:50,675 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:50,676 - INFO - Starting data processing
2025-02-26 19:40:50,676 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:50,676 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:50,677 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:50,677 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:50,779 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:50,779 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:50,779 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:50,779 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:50,780 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:50,780 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:50,781 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:50,781 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:50,781 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:50,933 - INFO - Received 100 messages so far
2025-02-26 19:40:50,933 - INFO - Received 200 messages so far
2025-02-26 19:40:50,933 - INFO - Received 300 messages so far
2025-02-26 19:40:50,934 - INFO - Received 400 messages so far
2025-02-26 19:40:50,934 - INFO - Received 500 messages so far
2025-02-26 19:40:50,934 - INFO - Received 600 messages so far
2025-02-26 19:40:50,934 - INFO - Received 700 messages so far
2025-02-26 19:40:50,934 - INFO - Received 800 messages so far
2025-02-26 19:40:50,935 - INFO - Received 900 messages so far
2025-02-26 19:40:50,935 - INFO - Received 1000 messages so far
2025-02-26 19:40:50,935 - INFO - Received 1100 messages so far
2025-02-26 19:40:50,935 - INFO - Received 1200 messages so far
2025-02-26 19:40:50,935 - INFO - Received 1300 messages so far
2025-02-26 19:40:50,936 - INFO - Received 1400 messages so far
2025-02-26 19:40:50,936 - INFO - Received 1500 messages so far
2025-02-26 19:40:50,936 - INFO - Received 1600 messages so far
2025-02-26 19:40:50,936 - INFO - Received 1700 messages so far
2025-02-26 19:40:50,936 - INFO - Received 1800 messages so far
2025-02-26 19:40:50,937 - INFO - Received 1900 messages so far
2025-02-26 19:40:50,937 - INFO - Received 2000 messages so far
2025-02-26 19:40:50,937 - INFO - Received 2100 messages so far
2025-02-26 19:40:50,937 - INFO - Received 2200 messages so far
2025-02-26 19:40:50,937 - INFO - Received 2300 messages so far
2025-02-26 19:40:50,938 - INFO - Received 2400 messages so far
2025-02-26 19:40:50,938 - INFO - Received 2500 messages so far
2025-02-26 19:40:50,938 - INFO - Received 2600 messages so far
2025-02-26 19:40:50,938 - INFO - Received 2700 messages so far
2025-02-26 19:40:50,938 - INFO - Received 2800 messages so far
2025-02-26 19:40:50,938 - INFO - Received 2900 messages so far
2025-02-26 19:40:50,939 - INFO - Received 3000 messages so far
2025-02-26 19:40:50,939 - INFO - Received 3100 messages so far
2025-02-26 19:40:50,939 - INFO - Received 3200 messages so far
2025-02-26 19:40:50,939 - INFO - Received 3300 messages so far
2025-02-26 19:40:50,939 - INFO - Received 3400 messages so far
2025-02-26 19:40:50,940 - INFO - Received 3500 messages so far
2025-02-26 19:40:50,940 - INFO - Received 3600 messages so far
2025-02-26 19:40:50,940 - INFO - Received 3700 messages so far
2025-02-26 19:40:50,940 - INFO - Received 3800 messages so far
2025-02-26 19:40:50,940 - INFO - Received 3900 messages so far
2025-02-26 19:40:50,941 - INFO - Received 4000 messages so far
2025-02-26 19:40:50,941 - INFO - Received 4100 messages so far
2025-02-26 19:40:50,994 - INFO - Received 4200 messages so far
2025-02-26 19:40:50,995 - INFO - Received 4300 messages so far
2025-02-26 19:40:50,995 - INFO - Received 4400 messages so far
2025-02-26 19:40:50,995 - INFO - Received 4500 messages so far
2025-02-26 19:40:50,995 - INFO - Received 4600 messages so far
2025-02-26 19:40:50,995 - INFO - Received 4700 messages so far
2025-02-26 19:40:50,996 - INFO - Received 4800 messages so far
2025-02-26 19:40:50,996 - INFO - Received 4900 messages so far
2025-02-26 19:40:50,996 - INFO - Received 5000 messages so far
2025-02-26 19:40:50,996 - INFO - Received 5100 messages so far
2025-02-26 19:40:50,996 - INFO - Received 5200 messages so far
2025-02-26 19:40:50,997 - INFO - Received 5300 messages so far
2025-02-26 19:40:50,997 - INFO - Received 5400 messages so far
2025-02-26 19:40:50,997 - INFO - Received 5500 messages so far
2025-02-26 19:40:50,997 - INFO - Received 5600 messages so far
2025-02-26 19:40:50,997 - INFO - Received 5700 messages so far
2025-02-26 19:40:50,998 - INFO - Received 5800 messages so far
2025-02-26 19:40:50,998 - INFO - Received 5900 messages so far
2025-02-26 19:40:50,998 - INFO - Received 6000 messages so far
2025-02-26 19:40:50,998 - INFO - Received 6100 messages so far
2025-02-26 19:40:50,998 - INFO - Received 6200 messages so far
2025-02-26 19:40:50,999 - INFO - Received 6300 messages so far
2025-02-26 19:40:50,999 - INFO - Received 6400 messages so far
2025-02-26 19:40:50,999 - INFO - Received 6500 messages so far
2025-02-26 19:40:50,999 - INFO - Received 6600 messages so far
2025-02-26 19:40:50,999 - INFO - Received 6700 messages so far
2025-02-26 19:40:51,000 - INFO - Received 6800 messages so far
2025-02-26 19:40:51,000 - INFO - Received 6900 messages so far
2025-02-26 19:40:51,000 - INFO - Received 7000 messages so far
2025-02-26 19:40:51,000 - INFO - Received 7100 messages so far
2025-02-26 19:40:51,000 - INFO - Received 7200 messages so far
2025-02-26 19:40:51,001 - INFO - Received 7300 messages so far
2025-02-26 19:40:51,001 - INFO - Received 7400 messages so far
2025-02-26 19:40:51,001 - INFO - Received 7500 messages so far
2025-02-26 19:40:51,001 - INFO - Received 7600 messages so far
2025-02-26 19:40:51,001 - INFO - Received 7700 messages so far
2025-02-26 19:40:51,002 - INFO - Received 7800 messages so far
2025-02-26 19:40:51,002 - INFO - Received 7900 messages so far
2025-02-26 19:40:51,002 - INFO - Received 8000 messages so far
2025-02-26 19:40:51,002 - INFO - Received 8100 messages so far
2025-02-26 19:40:51,002 - INFO - Received 8200 messages so far
2025-02-26 19:40:51,003 - INFO - Received 8300 messages so far
2025-02-26 19:40:51,003 - INFO - Received 8400 messages so far
2025-02-26 19:40:51,003 - INFO - Received 8500 messages so far
2025-02-26 19:40:51,003 - INFO - Received 8600 messages so far
2025-02-26 19:40:51,003 - INFO - Received 8700 messages so far
2025-02-26 19:40:51,060 - INFO - Received 8800 messages so far
2025-02-26 19:40:51,061 - INFO - Received 8900 messages so far
2025-02-26 19:40:51,061 - INFO - Received 9000 messages so far
2025-02-26 19:40:51,061 - INFO - Received 9100 messages so far
2025-02-26 19:40:51,061 - INFO - Received 9200 messages so far
2025-02-26 19:40:51,061 - INFO - Received 9300 messages so far
2025-02-26 19:40:51,062 - INFO - Received 9400 messages so far
2025-02-26 19:40:51,062 - INFO - Received 9500 messages so far
2025-02-26 19:40:51,062 - INFO - Received 9600 messages so far
2025-02-26 19:40:51,062 - INFO - Received 9700 messages so far
2025-02-26 19:40:51,062 - INFO - Received 9800 messages so far
2025-02-26 19:40:51,063 - INFO - Received 9900 messages so far
2025-02-26 19:40:51,063 - INFO - Received 10000 messages so far
2025-02-26 19:40:51,063 - INFO - Total messages consumed: 10000
2025-02-26 19:40:51,151 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:51,155 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:51,155 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:51,155 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:51,155 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:51,162 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:51,166 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:51,166 - INFO - Number of columns: 66
2025-02-26 19:40:51,176 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
6036        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6934        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.006661     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7789        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8349        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4031        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:51,176 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:51,206 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:51,251 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    3d390eb19a6c1898              fd390eb19a6c1898  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:51,251 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.   443.   134.  1900.    80.     0. 21116.
   547.   123.   133. 21115.   136.   138.    22.   135.    67.]
2025-02-26 19:40:51,252 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:51,258 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:51,259 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:51,259 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:51,261 - INFO - DataFrame shape after NA dropping: (899, 23)
2025-02-26 19:40:51,262 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:51,262 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:51,262 - INFO - X shape: (899, 21), y shape: (899,)
2025-02-26 19:40:51,262 - INFO - Label distribution in training data: {'DNS': 751, 'HTTPS': 133, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:51,264 - INFO - Training model...
2025-02-26 19:40:51,379 - INFO - Predicting on test data...
2025-02-26 19:40:51,393 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 147.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 0.9354838709677419,
    "recall": 1.0,
    "f1-score": 0.9666666666666667,
    "support": 29.0
  },
  "accuracy": 0.9888888888888889,
  "macro avg": {
    "precision": 0.978494623655914,
    "recall": 0.8333333333333334,
    "f1-score": 0.8777777777777778,
    "support": 180.0
  },
  "weighted avg": {
    "precision": 0.9896057347670251,
    "recall": 0.9888888888888889,
    "f1-score": 0.9872222222222221,
    "support": 180.0
  }
}
2025-02-26 19:40:51,400 - INFO - Saved processed data locally to processed_data_20250226_194051.csv
2025-02-26 19:40:51,403 - INFO - JSON data size: 441754 bytes
2025-02-26 19:40:51,403 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:51,403 - INFO - Data sent successfully!
2025-02-26 19:40:51,403 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:51,404 - INFO - Starting data processing
2025-02-26 19:40:51,404 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:51,405 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:51,406 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:51,406 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:51,508 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:51,508 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:51,508 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:51,508 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:51,508 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:51,509 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:51,510 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:51,510 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:51,510 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:51,663 - INFO - Received 100 messages so far
2025-02-26 19:40:51,664 - INFO - Received 200 messages so far
2025-02-26 19:40:51,664 - INFO - Received 300 messages so far
2025-02-26 19:40:51,664 - INFO - Received 400 messages so far
2025-02-26 19:40:51,664 - INFO - Received 500 messages so far
2025-02-26 19:40:51,664 - INFO - Received 600 messages so far
2025-02-26 19:40:51,665 - INFO - Received 700 messages so far
2025-02-26 19:40:51,665 - INFO - Received 800 messages so far
2025-02-26 19:40:51,665 - INFO - Received 900 messages so far
2025-02-26 19:40:51,665 - INFO - Received 1000 messages so far
2025-02-26 19:40:51,665 - INFO - Received 1100 messages so far
2025-02-26 19:40:51,666 - INFO - Received 1200 messages so far
2025-02-26 19:40:51,666 - INFO - Received 1300 messages so far
2025-02-26 19:40:51,666 - INFO - Received 1400 messages so far
2025-02-26 19:40:51,666 - INFO - Received 1500 messages so far
2025-02-26 19:40:51,666 - INFO - Received 1600 messages so far
2025-02-26 19:40:51,667 - INFO - Received 1700 messages so far
2025-02-26 19:40:51,667 - INFO - Received 1800 messages so far
2025-02-26 19:40:51,667 - INFO - Received 1900 messages so far
2025-02-26 19:40:51,667 - INFO - Received 2000 messages so far
2025-02-26 19:40:51,667 - INFO - Received 2100 messages so far
2025-02-26 19:40:51,668 - INFO - Received 2200 messages so far
2025-02-26 19:40:51,668 - INFO - Received 2300 messages so far
2025-02-26 19:40:51,668 - INFO - Received 2400 messages so far
2025-02-26 19:40:51,668 - INFO - Received 2500 messages so far
2025-02-26 19:40:51,668 - INFO - Received 2600 messages so far
2025-02-26 19:40:51,669 - INFO - Received 2700 messages so far
2025-02-26 19:40:51,669 - INFO - Received 2800 messages so far
2025-02-26 19:40:51,669 - INFO - Received 2900 messages so far
2025-02-26 19:40:51,669 - INFO - Received 3000 messages so far
2025-02-26 19:40:51,669 - INFO - Received 3100 messages so far
2025-02-26 19:40:51,669 - INFO - Received 3200 messages so far
2025-02-26 19:40:51,670 - INFO - Received 3300 messages so far
2025-02-26 19:40:51,670 - INFO - Received 3400 messages so far
2025-02-26 19:40:51,670 - INFO - Received 3500 messages so far
2025-02-26 19:40:51,670 - INFO - Received 3600 messages so far
2025-02-26 19:40:51,670 - INFO - Received 3700 messages so far
2025-02-26 19:40:51,671 - INFO - Received 3800 messages so far
2025-02-26 19:40:51,671 - INFO - Received 3900 messages so far
2025-02-26 19:40:51,671 - INFO - Received 4000 messages so far
2025-02-26 19:40:51,671 - INFO - Received 4100 messages so far
2025-02-26 19:40:51,775 - INFO - Received 4200 messages so far
2025-02-26 19:40:51,776 - INFO - Received 4300 messages so far
2025-02-26 19:40:51,776 - INFO - Received 4400 messages so far
2025-02-26 19:40:51,776 - INFO - Received 4500 messages so far
2025-02-26 19:40:51,776 - INFO - Received 4600 messages so far
2025-02-26 19:40:51,776 - INFO - Received 4700 messages so far
2025-02-26 19:40:51,777 - INFO - Received 4800 messages so far
2025-02-26 19:40:51,777 - INFO - Received 4900 messages so far
2025-02-26 19:40:51,777 - INFO - Received 5000 messages so far
2025-02-26 19:40:51,777 - INFO - Received 5100 messages so far
2025-02-26 19:40:51,778 - INFO - Received 5200 messages so far
2025-02-26 19:40:51,778 - INFO - Received 5300 messages so far
2025-02-26 19:40:51,778 - INFO - Received 5400 messages so far
2025-02-26 19:40:51,778 - INFO - Received 5500 messages so far
2025-02-26 19:40:51,778 - INFO - Received 5600 messages so far
2025-02-26 19:40:51,779 - INFO - Received 5700 messages so far
2025-02-26 19:40:51,779 - INFO - Received 5800 messages so far
2025-02-26 19:40:51,779 - INFO - Received 5900 messages so far
2025-02-26 19:40:51,779 - INFO - Received 6000 messages so far
2025-02-26 19:40:51,779 - INFO - Received 6100 messages so far
2025-02-26 19:40:51,780 - INFO - Received 6200 messages so far
2025-02-26 19:40:51,780 - INFO - Received 6300 messages so far
2025-02-26 19:40:51,780 - INFO - Received 6400 messages so far
2025-02-26 19:40:51,780 - INFO - Received 6500 messages so far
2025-02-26 19:40:51,780 - INFO - Received 6600 messages so far
2025-02-26 19:40:51,781 - INFO - Received 6700 messages so far
2025-02-26 19:40:51,781 - INFO - Received 6800 messages so far
2025-02-26 19:40:51,781 - INFO - Received 6900 messages so far
2025-02-26 19:40:51,781 - INFO - Received 7000 messages so far
2025-02-26 19:40:51,781 - INFO - Received 7100 messages so far
2025-02-26 19:40:51,781 - INFO - Received 7200 messages so far
2025-02-26 19:40:51,782 - INFO - Received 7300 messages so far
2025-02-26 19:40:51,782 - INFO - Received 7400 messages so far
2025-02-26 19:40:51,782 - INFO - Received 7500 messages so far
2025-02-26 19:40:51,782 - INFO - Received 7600 messages so far
2025-02-26 19:40:51,782 - INFO - Received 7700 messages so far
2025-02-26 19:40:51,783 - INFO - Received 7800 messages so far
2025-02-26 19:40:51,783 - INFO - Received 7900 messages so far
2025-02-26 19:40:51,783 - INFO - Received 8000 messages so far
2025-02-26 19:40:51,783 - INFO - Received 8100 messages so far
2025-02-26 19:40:51,783 - INFO - Received 8200 messages so far
2025-02-26 19:40:51,784 - INFO - Received 8300 messages so far
2025-02-26 19:40:51,784 - INFO - Received 8400 messages so far
2025-02-26 19:40:51,784 - INFO - Received 8500 messages so far
2025-02-26 19:40:51,784 - INFO - Received 8600 messages so far
2025-02-26 19:40:51,785 - INFO - Received 8700 messages so far
2025-02-26 19:40:51,842 - INFO - Received 8800 messages so far
2025-02-26 19:40:51,842 - INFO - Received 8900 messages so far
2025-02-26 19:40:51,842 - INFO - Received 9000 messages so far
2025-02-26 19:40:51,843 - INFO - Received 9100 messages so far
2025-02-26 19:40:51,843 - INFO - Received 9200 messages so far
2025-02-26 19:40:51,843 - INFO - Received 9300 messages so far
2025-02-26 19:40:51,843 - INFO - Received 9400 messages so far
2025-02-26 19:40:51,843 - INFO - Received 9500 messages so far
2025-02-26 19:40:51,843 - INFO - Received 9600 messages so far
2025-02-26 19:40:51,844 - INFO - Received 9700 messages so far
2025-02-26 19:40:51,844 - INFO - Received 9800 messages so far
2025-02-26 19:40:51,844 - INFO - Received 9900 messages so far
2025-02-26 19:40:51,844 - INFO - Received 10000 messages so far
2025-02-26 19:40:51,844 - INFO - Total messages consumed: 10000
2025-02-26 19:40:51,937 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:51,941 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:51,941 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:51,941 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:51,941 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:51,948 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:51,952 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:51,952 - INFO - Number of columns: 66
2025-02-26 19:40:51,964 - INFO - DataFrame head:
      id.resp_p    id.orig_h     id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt                    query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD     RA    Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto   duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7342        NaN          NaN           NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN        NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
248       443.0  192.168.1.3  35.174.210.7   tcp      2147.0       415.0  1.740118e+09      NaN  NaN     NaN  Cc4oOD11mtuMpCJaL3    57076.0  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN         SF       True      False           0.0  DdAFRf       12.0         2747.0        6.0          727.0       6.0  52.937148     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9981       53.0  192.168.1.3   192.168.1.1   udp         NaN         NaN  1.740120e+09      NaN  NaN     NaN  ClsXKy3FAx5DUOzip4    56559.0  NaN  ogads-pa.googleapis.com     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  False  0.0     NaN  NaN    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN        NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8252        NaN          NaN           NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN        NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3648        NaN          NaN           NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN        NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:51,964 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:51,994 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:52,040 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    376acab97e4aab30              e456d0cc73137d45  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:52,040 - INFO - Unique values in 'id.resp_p' before labeling: [   nan   443.    53.  9092.  1900.   123. 21116.   133.  5353.    80.
   134.   135.   547. 21115.     0.   138.   136.    22.    67.]
2025-02-26 19:40:52,041 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:52,047 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:52,048 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:52,048 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:52,050 - INFO - DataFrame shape after NA dropping: (815, 23)
2025-02-26 19:40:52,050 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:52,050 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:52,051 - INFO - X shape: (815, 21), y shape: (815,)
2025-02-26 19:40:52,051 - INFO - Label distribution in training data: {'DNS': 682, 'HTTPS': 119, 'HTTP': 13, 'SSH': 1}
2025-02-26 19:40:52,052 - INFO - Training model...
2025-02-26 19:40:52,163 - INFO - Predicting on test data...
2025-02-26 19:40:52,177 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 140.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 22.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 163.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 163.0
  }
}
2025-02-26 19:40:52,184 - INFO - Saved processed data locally to processed_data_20250226_194052.csv
2025-02-26 19:40:52,186 - INFO - JSON data size: 405526 bytes
2025-02-26 19:40:52,186 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:52,187 - INFO - Data sent successfully!
2025-02-26 19:40:52,187 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:52,188 - INFO - Starting data processing
2025-02-26 19:40:52,188 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:52,188 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:52,189 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:52,189 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:52,291 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:52,291 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:52,292 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:52,292 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:52,292 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:52,293 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:52,293 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:52,293 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:52,293 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:52,444 - INFO - Received 100 messages so far
2025-02-26 19:40:52,444 - INFO - Received 200 messages so far
2025-02-26 19:40:52,444 - INFO - Received 300 messages so far
2025-02-26 19:40:52,445 - INFO - Received 400 messages so far
2025-02-26 19:40:52,445 - INFO - Received 500 messages so far
2025-02-26 19:40:52,445 - INFO - Received 600 messages so far
2025-02-26 19:40:52,445 - INFO - Received 700 messages so far
2025-02-26 19:40:52,445 - INFO - Received 800 messages so far
2025-02-26 19:40:52,446 - INFO - Received 900 messages so far
2025-02-26 19:40:52,446 - INFO - Received 1000 messages so far
2025-02-26 19:40:52,446 - INFO - Received 1100 messages so far
2025-02-26 19:40:52,446 - INFO - Received 1200 messages so far
2025-02-26 19:40:52,446 - INFO - Received 1300 messages so far
2025-02-26 19:40:52,447 - INFO - Received 1400 messages so far
2025-02-26 19:40:52,447 - INFO - Received 1500 messages so far
2025-02-26 19:40:52,447 - INFO - Received 1600 messages so far
2025-02-26 19:40:52,447 - INFO - Received 1700 messages so far
2025-02-26 19:40:52,447 - INFO - Received 1800 messages so far
2025-02-26 19:40:52,448 - INFO - Received 1900 messages so far
2025-02-26 19:40:52,448 - INFO - Received 2000 messages so far
2025-02-26 19:40:52,448 - INFO - Received 2100 messages so far
2025-02-26 19:40:52,448 - INFO - Received 2200 messages so far
2025-02-26 19:40:52,448 - INFO - Received 2300 messages so far
2025-02-26 19:40:52,448 - INFO - Received 2400 messages so far
2025-02-26 19:40:52,449 - INFO - Received 2500 messages so far
2025-02-26 19:40:52,449 - INFO - Received 2600 messages so far
2025-02-26 19:40:52,449 - INFO - Received 2700 messages so far
2025-02-26 19:40:52,449 - INFO - Received 2800 messages so far
2025-02-26 19:40:52,449 - INFO - Received 2900 messages so far
2025-02-26 19:40:52,450 - INFO - Received 3000 messages so far
2025-02-26 19:40:52,450 - INFO - Received 3100 messages so far
2025-02-26 19:40:52,450 - INFO - Received 3200 messages so far
2025-02-26 19:40:52,450 - INFO - Received 3300 messages so far
2025-02-26 19:40:52,450 - INFO - Received 3400 messages so far
2025-02-26 19:40:52,451 - INFO - Received 3500 messages so far
2025-02-26 19:40:52,451 - INFO - Received 3600 messages so far
2025-02-26 19:40:52,451 - INFO - Received 3700 messages so far
2025-02-26 19:40:52,451 - INFO - Received 3800 messages so far
2025-02-26 19:40:52,451 - INFO - Received 3900 messages so far
2025-02-26 19:40:52,452 - INFO - Received 4000 messages so far
2025-02-26 19:40:52,452 - INFO - Received 4100 messages so far
2025-02-26 19:40:52,505 - INFO - Received 4200 messages so far
2025-02-26 19:40:52,505 - INFO - Received 4300 messages so far
2025-02-26 19:40:52,505 - INFO - Received 4400 messages so far
2025-02-26 19:40:52,505 - INFO - Received 4500 messages so far
2025-02-26 19:40:52,506 - INFO - Received 4600 messages so far
2025-02-26 19:40:52,506 - INFO - Received 4700 messages so far
2025-02-26 19:40:52,506 - INFO - Received 4800 messages so far
2025-02-26 19:40:52,507 - INFO - Received 4900 messages so far
2025-02-26 19:40:52,507 - INFO - Received 5000 messages so far
2025-02-26 19:40:52,507 - INFO - Received 5100 messages so far
2025-02-26 19:40:52,508 - INFO - Received 5200 messages so far
2025-02-26 19:40:52,508 - INFO - Received 5300 messages so far
2025-02-26 19:40:52,508 - INFO - Received 5400 messages so far
2025-02-26 19:40:52,509 - INFO - Received 5500 messages so far
2025-02-26 19:40:52,509 - INFO - Received 5600 messages so far
2025-02-26 19:40:52,509 - INFO - Received 5700 messages so far
2025-02-26 19:40:52,510 - INFO - Received 5800 messages so far
2025-02-26 19:40:52,510 - INFO - Received 5900 messages so far
2025-02-26 19:40:52,510 - INFO - Received 6000 messages so far
2025-02-26 19:40:52,510 - INFO - Received 6100 messages so far
2025-02-26 19:40:52,511 - INFO - Received 6200 messages so far
2025-02-26 19:40:52,511 - INFO - Received 6300 messages so far
2025-02-26 19:40:52,512 - INFO - Received 6400 messages so far
2025-02-26 19:40:52,512 - INFO - Received 6500 messages so far
2025-02-26 19:40:52,512 - INFO - Received 6600 messages so far
2025-02-26 19:40:52,513 - INFO - Received 6700 messages so far
2025-02-26 19:40:52,513 - INFO - Received 6800 messages so far
2025-02-26 19:40:52,513 - INFO - Received 6900 messages so far
2025-02-26 19:40:52,513 - INFO - Received 7000 messages so far
2025-02-26 19:40:52,513 - INFO - Received 7100 messages so far
2025-02-26 19:40:52,514 - INFO - Received 7200 messages so far
2025-02-26 19:40:52,514 - INFO - Received 7300 messages so far
2025-02-26 19:40:52,514 - INFO - Received 7400 messages so far
2025-02-26 19:40:52,514 - INFO - Received 7500 messages so far
2025-02-26 19:40:52,514 - INFO - Received 7600 messages so far
2025-02-26 19:40:52,515 - INFO - Received 7700 messages so far
2025-02-26 19:40:52,515 - INFO - Received 7800 messages so far
2025-02-26 19:40:52,515 - INFO - Received 7900 messages so far
2025-02-26 19:40:52,515 - INFO - Received 8000 messages so far
2025-02-26 19:40:52,515 - INFO - Received 8100 messages so far
2025-02-26 19:40:52,515 - INFO - Received 8200 messages so far
2025-02-26 19:40:52,516 - INFO - Received 8300 messages so far
2025-02-26 19:40:52,516 - INFO - Received 8400 messages so far
2025-02-26 19:40:52,516 - INFO - Received 8500 messages so far
2025-02-26 19:40:52,516 - INFO - Received 8600 messages so far
2025-02-26 19:40:52,517 - INFO - Received 8700 messages so far
2025-02-26 19:40:52,617 - INFO - Received 8800 messages so far
2025-02-26 19:40:52,617 - INFO - Received 8900 messages so far
2025-02-26 19:40:52,617 - INFO - Received 9000 messages so far
2025-02-26 19:40:52,617 - INFO - Received 9100 messages so far
2025-02-26 19:40:52,617 - INFO - Received 9200 messages so far
2025-02-26 19:40:52,618 - INFO - Received 9300 messages so far
2025-02-26 19:40:52,618 - INFO - Received 9400 messages so far
2025-02-26 19:40:52,618 - INFO - Received 9500 messages so far
2025-02-26 19:40:52,618 - INFO - Received 9600 messages so far
2025-02-26 19:40:52,618 - INFO - Received 9700 messages so far
2025-02-26 19:40:52,619 - INFO - Received 9800 messages so far
2025-02-26 19:40:52,619 - INFO - Received 9900 messages so far
2025-02-26 19:40:52,619 - INFO - Received 10000 messages so far
2025-02-26 19:40:52,619 - INFO - Total messages consumed: 10000
2025-02-26 19:40:52,708 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:52,712 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:52,712 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:52,712 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:52,712 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:52,719 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:52,723 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:52,723 - INFO - Number of columns: 66
2025-02-26 19:40:52,734 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                               query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD     RA    Z                                                                                               answers                   TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
1191        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN                                                                                                   NaN                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7618        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN                                                                                                   NaN                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7004        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                 NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN                                                                                                   NaN                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5030       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740119e+09      NaN  NaN     NaN  C94n7B32HYRMII14Xl    58418.0       NaN        dual-spo-0005.spo-msedge.net     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  False  0.0                                                                                                   NaN                    NaN    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5017       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740119e+09      NaN  NaN     NaN  CS4eJx2a6jKnsYHUQ3    54601.0  0.002651  word-telemetry.officeapps.live.com     1.0  C_INTERNET    1.0          A    0.0    NOERROR  False  False  True   True  0.0  [word-telemetry.wac.trafficmanager.net, pgtus1-word-telemetry-vip.officeapps.live.com, 52.108.78.30]  [205.0, 205.0, 205.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:52,734 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:52,764 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:52,810 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    b90b0ae34b0b9725              f90b0ae34b0b9725  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:52,810 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443.    80.  5353.  1900.   134.     0.   133.
   123.    67.   135.   138.   136. 21116.    22.   547. 21115.]
2025-02-26 19:40:52,812 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:52,817 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:52,818 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:52,818 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:52,820 - INFO - DataFrame shape after NA dropping: (861, 23)
2025-02-26 19:40:52,820 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:52,820 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:52,821 - INFO - X shape: (861, 21), y shape: (861,)
2025-02-26 19:40:52,821 - INFO - Label distribution in training data: {'DNS': 725, 'HTTPS': 123, 'HTTP': 12, 'SSH': 1}
2025-02-26 19:40:52,822 - INFO - Training model...
2025-02-26 19:40:52,936 - INFO - Predicting on test data...
2025-02-26 19:40:52,949 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 150.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 2.0
  },
  "HTTPS": {
    "precision": 0.9545454545454546,
    "recall": 1.0,
    "f1-score": 0.9767441860465116,
    "support": 21.0
  },
  "accuracy": 0.9942196531791907,
  "macro avg": {
    "precision": 0.9848484848484849,
    "recall": 0.8333333333333334,
    "f1-score": 0.8811369509043927,
    "support": 173.0
  },
  "weighted avg": {
    "precision": 0.9944823962165004,
    "recall": 0.9942196531791907,
    "f1-score": 0.993323475377515,
    "support": 173.0
  }
}
2025-02-26 19:40:52,956 - INFO - Saved processed data locally to processed_data_20250226_194052.csv
2025-02-26 19:40:52,959 - INFO - JSON data size: 424017 bytes
2025-02-26 19:40:52,959 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:52,959 - INFO - Data sent successfully!
2025-02-26 19:40:52,959 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:52,960 - INFO - Starting data processing
2025-02-26 19:40:52,960 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:52,961 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:52,961 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:52,962 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:53,063 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:53,063 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:53,064 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:53,064 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:53,064 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:53,065 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:53,065 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:53,065 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:53,065 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:53,219 - INFO - Received 100 messages so far
2025-02-26 19:40:53,219 - INFO - Received 200 messages so far
2025-02-26 19:40:53,220 - INFO - Received 300 messages so far
2025-02-26 19:40:53,220 - INFO - Received 400 messages so far
2025-02-26 19:40:53,220 - INFO - Received 500 messages so far
2025-02-26 19:40:53,220 - INFO - Received 600 messages so far
2025-02-26 19:40:53,220 - INFO - Received 700 messages so far
2025-02-26 19:40:53,221 - INFO - Received 800 messages so far
2025-02-26 19:40:53,221 - INFO - Received 900 messages so far
2025-02-26 19:40:53,221 - INFO - Received 1000 messages so far
2025-02-26 19:40:53,221 - INFO - Received 1100 messages so far
2025-02-26 19:40:53,221 - INFO - Received 1200 messages so far
2025-02-26 19:40:53,222 - INFO - Received 1300 messages so far
2025-02-26 19:40:53,222 - INFO - Received 1400 messages so far
2025-02-26 19:40:53,222 - INFO - Received 1500 messages so far
2025-02-26 19:40:53,222 - INFO - Received 1600 messages so far
2025-02-26 19:40:53,222 - INFO - Received 1700 messages so far
2025-02-26 19:40:53,223 - INFO - Received 1800 messages so far
2025-02-26 19:40:53,223 - INFO - Received 1900 messages so far
2025-02-26 19:40:53,223 - INFO - Received 2000 messages so far
2025-02-26 19:40:53,223 - INFO - Received 2100 messages so far
2025-02-26 19:40:53,223 - INFO - Received 2200 messages so far
2025-02-26 19:40:53,224 - INFO - Received 2300 messages so far
2025-02-26 19:40:53,224 - INFO - Received 2400 messages so far
2025-02-26 19:40:53,224 - INFO - Received 2500 messages so far
2025-02-26 19:40:53,224 - INFO - Received 2600 messages so far
2025-02-26 19:40:53,224 - INFO - Received 2700 messages so far
2025-02-26 19:40:53,224 - INFO - Received 2800 messages so far
2025-02-26 19:40:53,225 - INFO - Received 2900 messages so far
2025-02-26 19:40:53,225 - INFO - Received 3000 messages so far
2025-02-26 19:40:53,225 - INFO - Received 3100 messages so far
2025-02-26 19:40:53,225 - INFO - Received 3200 messages so far
2025-02-26 19:40:53,225 - INFO - Received 3300 messages so far
2025-02-26 19:40:53,226 - INFO - Received 3400 messages so far
2025-02-26 19:40:53,226 - INFO - Received 3500 messages so far
2025-02-26 19:40:53,226 - INFO - Received 3600 messages so far
2025-02-26 19:40:53,226 - INFO - Received 3700 messages so far
2025-02-26 19:40:53,226 - INFO - Received 3800 messages so far
2025-02-26 19:40:53,227 - INFO - Received 3900 messages so far
2025-02-26 19:40:53,227 - INFO - Received 4000 messages so far
2025-02-26 19:40:53,227 - INFO - Received 4100 messages so far
2025-02-26 19:40:53,281 - INFO - Received 4200 messages so far
2025-02-26 19:40:53,281 - INFO - Received 4300 messages so far
2025-02-26 19:40:53,282 - INFO - Received 4400 messages so far
2025-02-26 19:40:53,282 - INFO - Received 4500 messages so far
2025-02-26 19:40:53,282 - INFO - Received 4600 messages so far
2025-02-26 19:40:53,282 - INFO - Received 4700 messages so far
2025-02-26 19:40:53,282 - INFO - Received 4800 messages so far
2025-02-26 19:40:53,283 - INFO - Received 4900 messages so far
2025-02-26 19:40:53,283 - INFO - Received 5000 messages so far
2025-02-26 19:40:53,283 - INFO - Received 5100 messages so far
2025-02-26 19:40:53,283 - INFO - Received 5200 messages so far
2025-02-26 19:40:53,283 - INFO - Received 5300 messages so far
2025-02-26 19:40:53,284 - INFO - Received 5400 messages so far
2025-02-26 19:40:53,284 - INFO - Received 5500 messages so far
2025-02-26 19:40:53,284 - INFO - Received 5600 messages so far
2025-02-26 19:40:53,284 - INFO - Received 5700 messages so far
2025-02-26 19:40:53,284 - INFO - Received 5800 messages so far
2025-02-26 19:40:53,285 - INFO - Received 5900 messages so far
2025-02-26 19:40:53,285 - INFO - Received 6000 messages so far
2025-02-26 19:40:53,285 - INFO - Received 6100 messages so far
2025-02-26 19:40:53,285 - INFO - Received 6200 messages so far
2025-02-26 19:40:53,285 - INFO - Received 6300 messages so far
2025-02-26 19:40:53,286 - INFO - Received 6400 messages so far
2025-02-26 19:40:53,286 - INFO - Received 6500 messages so far
2025-02-26 19:40:53,286 - INFO - Received 6600 messages so far
2025-02-26 19:40:53,286 - INFO - Received 6700 messages so far
2025-02-26 19:40:53,286 - INFO - Received 6800 messages so far
2025-02-26 19:40:53,287 - INFO - Received 6900 messages so far
2025-02-26 19:40:53,287 - INFO - Received 7000 messages so far
2025-02-26 19:40:53,287 - INFO - Received 7100 messages so far
2025-02-26 19:40:53,287 - INFO - Received 7200 messages so far
2025-02-26 19:40:53,287 - INFO - Received 7300 messages so far
2025-02-26 19:40:53,288 - INFO - Received 7400 messages so far
2025-02-26 19:40:53,288 - INFO - Received 7500 messages so far
2025-02-26 19:40:53,288 - INFO - Received 7600 messages so far
2025-02-26 19:40:53,288 - INFO - Received 7700 messages so far
2025-02-26 19:40:53,288 - INFO - Received 7800 messages so far
2025-02-26 19:40:53,289 - INFO - Received 7900 messages so far
2025-02-26 19:40:53,289 - INFO - Received 8000 messages so far
2025-02-26 19:40:53,289 - INFO - Received 8100 messages so far
2025-02-26 19:40:53,289 - INFO - Received 8200 messages so far
2025-02-26 19:40:53,289 - INFO - Received 8300 messages so far
2025-02-26 19:40:53,290 - INFO - Received 8400 messages so far
2025-02-26 19:40:53,290 - INFO - Received 8500 messages so far
2025-02-26 19:40:53,290 - INFO - Received 8600 messages so far
2025-02-26 19:40:53,290 - INFO - Received 8700 messages so far
2025-02-26 19:40:53,348 - INFO - Received 8800 messages so far
2025-02-26 19:40:53,349 - INFO - Received 8900 messages so far
2025-02-26 19:40:53,349 - INFO - Received 9000 messages so far
2025-02-26 19:40:53,349 - INFO - Received 9100 messages so far
2025-02-26 19:40:53,349 - INFO - Received 9200 messages so far
2025-02-26 19:40:53,349 - INFO - Received 9300 messages so far
2025-02-26 19:40:53,350 - INFO - Received 9400 messages so far
2025-02-26 19:40:53,350 - INFO - Received 9500 messages so far
2025-02-26 19:40:53,350 - INFO - Received 9600 messages so far
2025-02-26 19:40:53,350 - INFO - Received 9700 messages so far
2025-02-26 19:40:53,350 - INFO - Received 9800 messages so far
2025-02-26 19:40:53,351 - INFO - Received 9900 messages so far
2025-02-26 19:40:53,351 - INFO - Received 10000 messages so far
2025-02-26 19:40:53,351 - INFO - Total messages consumed: 10000
2025-02-26 19:40:53,440 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:53,444 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:53,444 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:53,444 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:53,445 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:53,452 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:53,455 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:53,455 - INFO - Number of columns: 66
2025-02-26 19:40:53,467 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7628        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
880         NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4166        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.000000     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7215     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740119e+09      NaN  NaN     NaN  CcjwjE2F4B8SklPXPg    50664.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000503     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8052        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:53,467 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:53,497 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:53,543 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    7621c9ee35587231              f621c9ee35587231  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:53,543 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   443.  5353.   136.   123.   138.  1900.   134.
    80.     0. 21116.   547. 21115.   133.   135.    67.    22.]
2025-02-26 19:40:53,544 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:53,549 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:53,551 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:53,551 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:53,553 - INFO - DataFrame shape after NA dropping: (832, 23)
2025-02-26 19:40:53,553 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:53,553 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:53,554 - INFO - X shape: (832, 21), y shape: (832,)
2025-02-26 19:40:53,554 - INFO - Label distribution in training data: {'DNS': 699, 'HTTPS': 118, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:53,555 - INFO - Training model...
2025-02-26 19:40:53,669 - INFO - Predicting on test data...
2025-02-26 19:40:53,682 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 138.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 0.9259259259259259,
    "recall": 1.0,
    "f1-score": 0.9615384615384616,
    "support": 25.0
  },
  "accuracy": 0.9880239520958084,
  "macro avg": {
    "precision": 0.9753086419753086,
    "recall": 0.8333333333333334,
    "f1-score": 0.8760683760683761,
    "support": 167.0
  },
  "weighted avg": {
    "precision": 0.9889110667553782,
    "recall": 0.9880239520958084,
    "f1-score": 0.9862582527253186,
    "support": 167.0
  }
}
2025-02-26 19:40:53,689 - INFO - Saved processed data locally to processed_data_20250226_194053.csv
2025-02-26 19:40:53,692 - INFO - JSON data size: 409326 bytes
2025-02-26 19:40:53,692 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:53,692 - INFO - Data sent successfully!
2025-02-26 19:40:53,692 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:53,693 - INFO - Starting data processing
2025-02-26 19:40:53,693 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:53,694 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:53,695 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:53,695 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:53,797 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:53,797 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:53,797 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:53,797 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:53,797 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:53,798 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:53,798 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:53,798 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:53,799 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:53,991 - INFO - Received 100 messages so far
2025-02-26 19:40:53,992 - INFO - Received 200 messages so far
2025-02-26 19:40:53,992 - INFO - Received 300 messages so far
2025-02-26 19:40:53,992 - INFO - Received 400 messages so far
2025-02-26 19:40:53,992 - INFO - Received 500 messages so far
2025-02-26 19:40:53,993 - INFO - Received 600 messages so far
2025-02-26 19:40:53,993 - INFO - Received 700 messages so far
2025-02-26 19:40:53,993 - INFO - Received 800 messages so far
2025-02-26 19:40:53,993 - INFO - Received 900 messages so far
2025-02-26 19:40:53,993 - INFO - Received 1000 messages so far
2025-02-26 19:40:53,994 - INFO - Received 1100 messages so far
2025-02-26 19:40:53,994 - INFO - Received 1200 messages so far
2025-02-26 19:40:53,994 - INFO - Received 1300 messages so far
2025-02-26 19:40:53,994 - INFO - Received 1400 messages so far
2025-02-26 19:40:53,994 - INFO - Received 1500 messages so far
2025-02-26 19:40:53,995 - INFO - Received 1600 messages so far
2025-02-26 19:40:53,995 - INFO - Received 1700 messages so far
2025-02-26 19:40:53,995 - INFO - Received 1800 messages so far
2025-02-26 19:40:53,995 - INFO - Received 1900 messages so far
2025-02-26 19:40:53,995 - INFO - Received 2000 messages so far
2025-02-26 19:40:53,996 - INFO - Received 2100 messages so far
2025-02-26 19:40:53,996 - INFO - Received 2200 messages so far
2025-02-26 19:40:53,996 - INFO - Received 2300 messages so far
2025-02-26 19:40:53,996 - INFO - Received 2400 messages so far
2025-02-26 19:40:53,996 - INFO - Received 2500 messages so far
2025-02-26 19:40:53,996 - INFO - Received 2600 messages so far
2025-02-26 19:40:53,997 - INFO - Received 2700 messages so far
2025-02-26 19:40:53,997 - INFO - Received 2800 messages so far
2025-02-26 19:40:53,997 - INFO - Received 2900 messages so far
2025-02-26 19:40:53,997 - INFO - Received 3000 messages so far
2025-02-26 19:40:53,997 - INFO - Received 3100 messages so far
2025-02-26 19:40:53,998 - INFO - Received 3200 messages so far
2025-02-26 19:40:53,998 - INFO - Received 3300 messages so far
2025-02-26 19:40:53,998 - INFO - Received 3400 messages so far
2025-02-26 19:40:53,998 - INFO - Received 3500 messages so far
2025-02-26 19:40:53,998 - INFO - Received 3600 messages so far
2025-02-26 19:40:53,999 - INFO - Received 3700 messages so far
2025-02-26 19:40:53,999 - INFO - Received 3800 messages so far
2025-02-26 19:40:53,999 - INFO - Received 3900 messages so far
2025-02-26 19:40:53,999 - INFO - Received 4000 messages so far
2025-02-26 19:40:54,000 - INFO - Received 4100 messages so far
2025-02-26 19:40:54,055 - INFO - Received 4200 messages so far
2025-02-26 19:40:54,056 - INFO - Received 4300 messages so far
2025-02-26 19:40:54,056 - INFO - Received 4400 messages so far
2025-02-26 19:40:54,056 - INFO - Received 4500 messages so far
2025-02-26 19:40:54,056 - INFO - Received 4600 messages so far
2025-02-26 19:40:54,056 - INFO - Received 4700 messages so far
2025-02-26 19:40:54,057 - INFO - Received 4800 messages so far
2025-02-26 19:40:54,057 - INFO - Received 4900 messages so far
2025-02-26 19:40:54,057 - INFO - Received 5000 messages so far
2025-02-26 19:40:54,057 - INFO - Received 5100 messages so far
2025-02-26 19:40:54,057 - INFO - Received 5200 messages so far
2025-02-26 19:40:54,058 - INFO - Received 5300 messages so far
2025-02-26 19:40:54,058 - INFO - Received 5400 messages so far
2025-02-26 19:40:54,058 - INFO - Received 5500 messages so far
2025-02-26 19:40:54,058 - INFO - Received 5600 messages so far
2025-02-26 19:40:54,058 - INFO - Received 5700 messages so far
2025-02-26 19:40:54,059 - INFO - Received 5800 messages so far
2025-02-26 19:40:54,059 - INFO - Received 5900 messages so far
2025-02-26 19:40:54,059 - INFO - Received 6000 messages so far
2025-02-26 19:40:54,059 - INFO - Received 6100 messages so far
2025-02-26 19:40:54,059 - INFO - Received 6200 messages so far
2025-02-26 19:40:54,060 - INFO - Received 6300 messages so far
2025-02-26 19:40:54,060 - INFO - Received 6400 messages so far
2025-02-26 19:40:54,060 - INFO - Received 6500 messages so far
2025-02-26 19:40:54,060 - INFO - Received 6600 messages so far
2025-02-26 19:40:54,060 - INFO - Received 6700 messages so far
2025-02-26 19:40:54,061 - INFO - Received 6800 messages so far
2025-02-26 19:40:54,061 - INFO - Received 6900 messages so far
2025-02-26 19:40:54,061 - INFO - Received 7000 messages so far
2025-02-26 19:40:54,061 - INFO - Received 7100 messages so far
2025-02-26 19:40:54,061 - INFO - Received 7200 messages so far
2025-02-26 19:40:54,062 - INFO - Received 7300 messages so far
2025-02-26 19:40:54,062 - INFO - Received 7400 messages so far
2025-02-26 19:40:54,062 - INFO - Received 7500 messages so far
2025-02-26 19:40:54,062 - INFO - Received 7600 messages so far
2025-02-26 19:40:54,062 - INFO - Received 7700 messages so far
2025-02-26 19:40:54,063 - INFO - Received 7800 messages so far
2025-02-26 19:40:54,063 - INFO - Received 7900 messages so far
2025-02-26 19:40:54,063 - INFO - Received 8000 messages so far
2025-02-26 19:40:54,063 - INFO - Received 8100 messages so far
2025-02-26 19:40:54,063 - INFO - Received 8200 messages so far
2025-02-26 19:40:54,063 - INFO - Received 8300 messages so far
2025-02-26 19:40:54,064 - INFO - Received 8400 messages so far
2025-02-26 19:40:54,064 - INFO - Received 8500 messages so far
2025-02-26 19:40:54,064 - INFO - Received 8600 messages so far
2025-02-26 19:40:54,064 - INFO - Received 8700 messages so far
2025-02-26 19:40:54,120 - INFO - Received 8800 messages so far
2025-02-26 19:40:54,121 - INFO - Received 8900 messages so far
2025-02-26 19:40:54,121 - INFO - Received 9000 messages so far
2025-02-26 19:40:54,121 - INFO - Received 9100 messages so far
2025-02-26 19:40:54,121 - INFO - Received 9200 messages so far
2025-02-26 19:40:54,122 - INFO - Received 9300 messages so far
2025-02-26 19:40:54,122 - INFO - Received 9400 messages so far
2025-02-26 19:40:54,122 - INFO - Received 9500 messages so far
2025-02-26 19:40:54,122 - INFO - Received 9600 messages so far
2025-02-26 19:40:54,122 - INFO - Received 9700 messages so far
2025-02-26 19:40:54,122 - INFO - Received 9800 messages so far
2025-02-26 19:40:54,123 - INFO - Received 9900 messages so far
2025-02-26 19:40:54,123 - INFO - Received 10000 messages so far
2025-02-26 19:40:54,123 - INFO - Total messages consumed: 10000
2025-02-26 19:40:54,211 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:54,214 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:54,215 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:54,215 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:54,215 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:54,222 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:54,225 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:54,226 - INFO - Number of columns: 66
2025-02-26 19:40:54,237 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3750        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6250        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9707       53.0  192.168.1.3  192.168.1.1   udp        52.0       220.0  1.740120e+09      NaN  NaN     dns  C6FRWxHEz97jUiPZb    57668.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           80.0        1.0          248.0      17.0  0.001386     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
585         NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5719        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:54,237 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:54,267 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:54,312 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    c456d0cc73137d45              e456d0cc73137d45  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:54,313 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443.  1900.  5353.   123.   138.   134. 21116.
   136.    80.   133.    67.   135.     0.    22.   547. 21115.]
2025-02-26 19:40:54,314 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:54,319 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:54,320 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:54,320 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:54,323 - INFO - DataFrame shape after NA dropping: (827, 23)
2025-02-26 19:40:54,323 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:54,323 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:54,323 - INFO - X shape: (827, 21), y shape: (827,)
2025-02-26 19:40:54,324 - INFO - Label distribution in training data: {'DNS': 687, 'HTTPS': 125, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:54,325 - INFO - Training model...
2025-02-26 19:40:54,435 - INFO - Predicting on test data...
2025-02-26 19:40:54,449 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 143.0
  },
  "HTTP": {
    "precision": 0.5,
    "recall": 1.0,
    "f1-score": 0.6666666666666666,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 0.9545454545454546,
    "f1-score": 0.9767441860465116,
    "support": 22.0
  },
  "accuracy": 0.9939759036144579,
  "macro avg": {
    "precision": 0.8333333333333334,
    "recall": 0.9848484848484849,
    "f1-score": 0.8811369509043927,
    "support": 166.0
  },
  "weighted avg": {
    "precision": 0.9969879518072289,
    "recall": 0.9939759036144579,
    "f1-score": 0.9949098720463248,
    "support": 166.0
  }
}
2025-02-26 19:40:54,456 - INFO - Saved processed data locally to processed_data_20250226_194054.csv
2025-02-26 19:40:54,458 - INFO - JSON data size: 405723 bytes
2025-02-26 19:40:54,458 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:54,458 - INFO - Data sent successfully!
2025-02-26 19:40:54,458 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:54,459 - INFO - Starting data processing
2025-02-26 19:40:54,459 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:54,460 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:54,461 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:54,461 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:54,562 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:54,562 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:54,563 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:54,563 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:54,564 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:54,564 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:54,565 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:54,565 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:54,565 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:54,719 - INFO - Received 100 messages so far
2025-02-26 19:40:54,719 - INFO - Received 200 messages so far
2025-02-26 19:40:54,720 - INFO - Received 300 messages so far
2025-02-26 19:40:54,720 - INFO - Received 400 messages so far
2025-02-26 19:40:54,720 - INFO - Received 500 messages so far
2025-02-26 19:40:54,720 - INFO - Received 600 messages so far
2025-02-26 19:40:54,720 - INFO - Received 700 messages so far
2025-02-26 19:40:54,721 - INFO - Received 800 messages so far
2025-02-26 19:40:54,721 - INFO - Received 900 messages so far
2025-02-26 19:40:54,721 - INFO - Received 1000 messages so far
2025-02-26 19:40:54,721 - INFO - Received 1100 messages so far
2025-02-26 19:40:54,721 - INFO - Received 1200 messages so far
2025-02-26 19:40:54,722 - INFO - Received 1300 messages so far
2025-02-26 19:40:54,722 - INFO - Received 1400 messages so far
2025-02-26 19:40:54,722 - INFO - Received 1500 messages so far
2025-02-26 19:40:54,722 - INFO - Received 1600 messages so far
2025-02-26 19:40:54,722 - INFO - Received 1700 messages so far
2025-02-26 19:40:54,723 - INFO - Received 1800 messages so far
2025-02-26 19:40:54,723 - INFO - Received 1900 messages so far
2025-02-26 19:40:54,723 - INFO - Received 2000 messages so far
2025-02-26 19:40:54,723 - INFO - Received 2100 messages so far
2025-02-26 19:40:54,723 - INFO - Received 2200 messages so far
2025-02-26 19:40:54,724 - INFO - Received 2300 messages so far
2025-02-26 19:40:54,724 - INFO - Received 2400 messages so far
2025-02-26 19:40:54,724 - INFO - Received 2500 messages so far
2025-02-26 19:40:54,724 - INFO - Received 2600 messages so far
2025-02-26 19:40:54,724 - INFO - Received 2700 messages so far
2025-02-26 19:40:54,725 - INFO - Received 2800 messages so far
2025-02-26 19:40:54,725 - INFO - Received 2900 messages so far
2025-02-26 19:40:54,725 - INFO - Received 3000 messages so far
2025-02-26 19:40:54,725 - INFO - Received 3100 messages so far
2025-02-26 19:40:54,725 - INFO - Received 3200 messages so far
2025-02-26 19:40:54,725 - INFO - Received 3300 messages so far
2025-02-26 19:40:54,726 - INFO - Received 3400 messages so far
2025-02-26 19:40:54,726 - INFO - Received 3500 messages so far
2025-02-26 19:40:54,726 - INFO - Received 3600 messages so far
2025-02-26 19:40:54,726 - INFO - Received 3700 messages so far
2025-02-26 19:40:54,726 - INFO - Received 3800 messages so far
2025-02-26 19:40:54,727 - INFO - Received 3900 messages so far
2025-02-26 19:40:54,727 - INFO - Received 4000 messages so far
2025-02-26 19:40:54,727 - INFO - Received 4100 messages so far
2025-02-26 19:40:54,821 - INFO - Received 4200 messages so far
2025-02-26 19:40:54,821 - INFO - Received 4300 messages so far
2025-02-26 19:40:54,821 - INFO - Received 4400 messages so far
2025-02-26 19:40:54,821 - INFO - Received 4500 messages so far
2025-02-26 19:40:54,821 - INFO - Received 4600 messages so far
2025-02-26 19:40:54,822 - INFO - Received 4700 messages so far
2025-02-26 19:40:54,822 - INFO - Received 4800 messages so far
2025-02-26 19:40:54,822 - INFO - Received 4900 messages so far
2025-02-26 19:40:54,822 - INFO - Received 5000 messages so far
2025-02-26 19:40:54,822 - INFO - Received 5100 messages so far
2025-02-26 19:40:54,823 - INFO - Received 5200 messages so far
2025-02-26 19:40:54,823 - INFO - Received 5300 messages so far
2025-02-26 19:40:54,823 - INFO - Received 5400 messages so far
2025-02-26 19:40:54,823 - INFO - Received 5500 messages so far
2025-02-26 19:40:54,823 - INFO - Received 5600 messages so far
2025-02-26 19:40:54,824 - INFO - Received 5700 messages so far
2025-02-26 19:40:54,824 - INFO - Received 5800 messages so far
2025-02-26 19:40:54,824 - INFO - Received 5900 messages so far
2025-02-26 19:40:54,824 - INFO - Received 6000 messages so far
2025-02-26 19:40:54,824 - INFO - Received 6100 messages so far
2025-02-26 19:40:54,825 - INFO - Received 6200 messages so far
2025-02-26 19:40:54,825 - INFO - Received 6300 messages so far
2025-02-26 19:40:54,825 - INFO - Received 6400 messages so far
2025-02-26 19:40:54,825 - INFO - Received 6500 messages so far
2025-02-26 19:40:54,825 - INFO - Received 6600 messages so far
2025-02-26 19:40:54,826 - INFO - Received 6700 messages so far
2025-02-26 19:40:54,826 - INFO - Received 6800 messages so far
2025-02-26 19:40:54,826 - INFO - Received 6900 messages so far
2025-02-26 19:40:54,826 - INFO - Received 7000 messages so far
2025-02-26 19:40:54,826 - INFO - Received 7100 messages so far
2025-02-26 19:40:54,827 - INFO - Received 7200 messages so far
2025-02-26 19:40:54,827 - INFO - Received 7300 messages so far
2025-02-26 19:40:54,827 - INFO - Received 7400 messages so far
2025-02-26 19:40:54,827 - INFO - Received 7500 messages so far
2025-02-26 19:40:54,827 - INFO - Received 7600 messages so far
2025-02-26 19:40:54,828 - INFO - Received 7700 messages so far
2025-02-26 19:40:54,828 - INFO - Received 7800 messages so far
2025-02-26 19:40:54,828 - INFO - Received 7900 messages so far
2025-02-26 19:40:54,828 - INFO - Received 8000 messages so far
2025-02-26 19:40:54,828 - INFO - Received 8100 messages so far
2025-02-26 19:40:54,829 - INFO - Received 8200 messages so far
2025-02-26 19:40:54,829 - INFO - Received 8300 messages so far
2025-02-26 19:40:54,829 - INFO - Received 8400 messages so far
2025-02-26 19:40:54,829 - INFO - Received 8500 messages so far
2025-02-26 19:40:54,829 - INFO - Received 8600 messages so far
2025-02-26 19:40:54,830 - INFO - Received 8700 messages so far
2025-02-26 19:40:54,886 - INFO - Received 8800 messages so far
2025-02-26 19:40:54,886 - INFO - Received 8900 messages so far
2025-02-26 19:40:54,886 - INFO - Received 9000 messages so far
2025-02-26 19:40:54,886 - INFO - Received 9100 messages so far
2025-02-26 19:40:54,886 - INFO - Received 9200 messages so far
2025-02-26 19:40:54,887 - INFO - Received 9300 messages so far
2025-02-26 19:40:54,887 - INFO - Received 9400 messages so far
2025-02-26 19:40:54,887 - INFO - Received 9500 messages so far
2025-02-26 19:40:54,887 - INFO - Received 9600 messages so far
2025-02-26 19:40:54,887 - INFO - Received 9700 messages so far
2025-02-26 19:40:54,888 - INFO - Received 9800 messages so far
2025-02-26 19:40:54,888 - INFO - Received 9900 messages so far
2025-02-26 19:40:54,888 - INFO - Received 10000 messages so far
2025-02-26 19:40:54,888 - INFO - Total messages consumed: 10000
2025-02-26 19:40:54,977 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:54,981 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:54,981 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:54,981 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:54,981 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:54,989 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:54,992 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:54,992 - INFO - Number of columns: 66
2025-02-26 19:40:55,002 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7552        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005748     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2958        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4219        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9341        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6663        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.006053     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:55,002 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:55,033 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:55,078 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    6b77933b392d05f9              eb77933b392d05f9  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:55,079 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443.  5353.   133.   547.  1900.   134.    80.
    22.   135.    67.   123.     0.   138.   136. 21116. 21115.]
2025-02-26 19:40:55,080 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:55,085 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:55,086 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:55,086 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:55,088 - INFO - DataFrame shape after NA dropping: (905, 23)
2025-02-26 19:40:55,088 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:55,088 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:55,089 - INFO - X shape: (905, 21), y shape: (905,)
2025-02-26 19:40:55,089 - INFO - Label distribution in training data: {'DNS': 759, 'HTTPS': 131, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:55,090 - INFO - Training model...
2025-02-26 19:40:55,208 - INFO - Predicting on test data...
2025-02-26 19:40:55,222 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 153.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.3333333333333333,
    "f1-score": 0.5,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.9259259259259259,
    "recall": 1.0,
    "f1-score": 0.9615384615384616,
    "support": 25.0
  },
  "accuracy": 0.988950276243094,
  "macro avg": {
    "precision": 0.9753086419753086,
    "recall": 0.7777777777777777,
    "f1-score": 0.8205128205128206,
    "support": 181.0
  },
  "weighted avg": {
    "precision": 0.9897687742991611,
    "recall": 0.988950276243094,
    "f1-score": 0.9864003399915002,
    "support": 181.0
  }
}
2025-02-26 19:40:55,230 - INFO - Saved processed data locally to processed_data_20250226_194055.csv
2025-02-26 19:40:55,232 - INFO - JSON data size: 445177 bytes
2025-02-26 19:40:55,232 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:55,233 - INFO - Data sent successfully!
2025-02-26 19:40:55,233 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:55,234 - INFO - Starting data processing
2025-02-26 19:40:55,234 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:55,234 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:55,235 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:55,236 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:55,337 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:55,338 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:55,338 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:55,338 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:55,338 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:55,339 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:55,339 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:55,339 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:55,339 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:55,494 - INFO - Received 100 messages so far
2025-02-26 19:40:55,494 - INFO - Received 200 messages so far
2025-02-26 19:40:55,494 - INFO - Received 300 messages so far
2025-02-26 19:40:55,494 - INFO - Received 400 messages so far
2025-02-26 19:40:55,495 - INFO - Received 500 messages so far
2025-02-26 19:40:55,495 - INFO - Received 600 messages so far
2025-02-26 19:40:55,495 - INFO - Received 700 messages so far
2025-02-26 19:40:55,495 - INFO - Received 800 messages so far
2025-02-26 19:40:55,495 - INFO - Received 900 messages so far
2025-02-26 19:40:55,496 - INFO - Received 1000 messages so far
2025-02-26 19:40:55,496 - INFO - Received 1100 messages so far
2025-02-26 19:40:55,496 - INFO - Received 1200 messages so far
2025-02-26 19:40:55,496 - INFO - Received 1300 messages so far
2025-02-26 19:40:55,496 - INFO - Received 1400 messages so far
2025-02-26 19:40:55,496 - INFO - Received 1500 messages so far
2025-02-26 19:40:55,497 - INFO - Received 1600 messages so far
2025-02-26 19:40:55,497 - INFO - Received 1700 messages so far
2025-02-26 19:40:55,497 - INFO - Received 1800 messages so far
2025-02-26 19:40:55,497 - INFO - Received 1900 messages so far
2025-02-26 19:40:55,497 - INFO - Received 2000 messages so far
2025-02-26 19:40:55,498 - INFO - Received 2100 messages so far
2025-02-26 19:40:55,498 - INFO - Received 2200 messages so far
2025-02-26 19:40:55,498 - INFO - Received 2300 messages so far
2025-02-26 19:40:55,498 - INFO - Received 2400 messages so far
2025-02-26 19:40:55,498 - INFO - Received 2500 messages so far
2025-02-26 19:40:55,499 - INFO - Received 2600 messages so far
2025-02-26 19:40:55,499 - INFO - Received 2700 messages so far
2025-02-26 19:40:55,499 - INFO - Received 2800 messages so far
2025-02-26 19:40:55,499 - INFO - Received 2900 messages so far
2025-02-26 19:40:55,499 - INFO - Received 3000 messages so far
2025-02-26 19:40:55,500 - INFO - Received 3100 messages so far
2025-02-26 19:40:55,500 - INFO - Received 3200 messages so far
2025-02-26 19:40:55,500 - INFO - Received 3300 messages so far
2025-02-26 19:40:55,500 - INFO - Received 3400 messages so far
2025-02-26 19:40:55,500 - INFO - Received 3500 messages so far
2025-02-26 19:40:55,501 - INFO - Received 3600 messages so far
2025-02-26 19:40:55,501 - INFO - Received 3700 messages so far
2025-02-26 19:40:55,501 - INFO - Received 3800 messages so far
2025-02-26 19:40:55,501 - INFO - Received 3900 messages so far
2025-02-26 19:40:55,501 - INFO - Received 4000 messages so far
2025-02-26 19:40:55,502 - INFO - Received 4100 messages so far
2025-02-26 19:40:55,556 - INFO - Received 4200 messages so far
2025-02-26 19:40:55,557 - INFO - Received 4300 messages so far
2025-02-26 19:40:55,557 - INFO - Received 4400 messages so far
2025-02-26 19:40:55,557 - INFO - Received 4500 messages so far
2025-02-26 19:40:55,557 - INFO - Received 4600 messages so far
2025-02-26 19:40:55,558 - INFO - Received 4700 messages so far
2025-02-26 19:40:55,558 - INFO - Received 4800 messages so far
2025-02-26 19:40:55,558 - INFO - Received 4900 messages so far
2025-02-26 19:40:55,558 - INFO - Received 5000 messages so far
2025-02-26 19:40:55,558 - INFO - Received 5100 messages so far
2025-02-26 19:40:55,559 - INFO - Received 5200 messages so far
2025-02-26 19:40:55,559 - INFO - Received 5300 messages so far
2025-02-26 19:40:55,559 - INFO - Received 5400 messages so far
2025-02-26 19:40:55,559 - INFO - Received 5500 messages so far
2025-02-26 19:40:55,559 - INFO - Received 5600 messages so far
2025-02-26 19:40:55,560 - INFO - Received 5700 messages so far
2025-02-26 19:40:55,560 - INFO - Received 5800 messages so far
2025-02-26 19:40:55,560 - INFO - Received 5900 messages so far
2025-02-26 19:40:55,560 - INFO - Received 6000 messages so far
2025-02-26 19:40:55,560 - INFO - Received 6100 messages so far
2025-02-26 19:40:55,561 - INFO - Received 6200 messages so far
2025-02-26 19:40:55,561 - INFO - Received 6300 messages so far
2025-02-26 19:40:55,561 - INFO - Received 6400 messages so far
2025-02-26 19:40:55,561 - INFO - Received 6500 messages so far
2025-02-26 19:40:55,561 - INFO - Received 6600 messages so far
2025-02-26 19:40:55,561 - INFO - Received 6700 messages so far
2025-02-26 19:40:55,562 - INFO - Received 6800 messages so far
2025-02-26 19:40:55,562 - INFO - Received 6900 messages so far
2025-02-26 19:40:55,562 - INFO - Received 7000 messages so far
2025-02-26 19:40:55,562 - INFO - Received 7100 messages so far
2025-02-26 19:40:55,562 - INFO - Received 7200 messages so far
2025-02-26 19:40:55,563 - INFO - Received 7300 messages so far
2025-02-26 19:40:55,563 - INFO - Received 7400 messages so far
2025-02-26 19:40:55,563 - INFO - Received 7500 messages so far
2025-02-26 19:40:55,563 - INFO - Received 7600 messages so far
2025-02-26 19:40:55,563 - INFO - Received 7700 messages so far
2025-02-26 19:40:55,564 - INFO - Received 7800 messages so far
2025-02-26 19:40:55,564 - INFO - Received 7900 messages so far
2025-02-26 19:40:55,564 - INFO - Received 8000 messages so far
2025-02-26 19:40:55,564 - INFO - Received 8100 messages so far
2025-02-26 19:40:55,564 - INFO - Received 8200 messages so far
2025-02-26 19:40:55,565 - INFO - Received 8300 messages so far
2025-02-26 19:40:55,565 - INFO - Received 8400 messages so far
2025-02-26 19:40:55,565 - INFO - Received 8500 messages so far
2025-02-26 19:40:55,565 - INFO - Received 8600 messages so far
2025-02-26 19:40:55,566 - INFO - Received 8700 messages so far
2025-02-26 19:40:55,670 - INFO - Received 8800 messages so far
2025-02-26 19:40:55,670 - INFO - Received 8900 messages so far
2025-02-26 19:40:55,670 - INFO - Received 9000 messages so far
2025-02-26 19:40:55,670 - INFO - Received 9100 messages so far
2025-02-26 19:40:55,671 - INFO - Received 9200 messages so far
2025-02-26 19:40:55,671 - INFO - Received 9300 messages so far
2025-02-26 19:40:55,671 - INFO - Received 9400 messages so far
2025-02-26 19:40:55,671 - INFO - Received 9500 messages so far
2025-02-26 19:40:55,671 - INFO - Received 9600 messages so far
2025-02-26 19:40:55,672 - INFO - Received 9700 messages so far
2025-02-26 19:40:55,672 - INFO - Received 9800 messages so far
2025-02-26 19:40:55,672 - INFO - Received 9900 messages so far
2025-02-26 19:40:55,672 - INFO - Received 10000 messages so far
2025-02-26 19:40:55,672 - INFO - Total messages consumed: 10000
2025-02-26 19:40:55,762 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:55,766 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:55,766 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:55,766 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:55,767 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:55,774 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:55,777 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:55,778 - INFO - Number of columns: 66
2025-02-26 19:40:55,789 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                uid  id.orig_p       rtt                              query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                                                              answers           TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
1521        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                  NaN            NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7246     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740119e+09      NaN  NaN     NaN  CVDX41TcZHDhKyiT5    50960.0       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                  NaN            NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000184     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1279        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                  NaN            NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4150       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740119e+09      NaN  NaN     NaN  C8Mi83XdruMtMImhh    55725.0  0.002422  usc-word-edit.officeapps.live.com     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  True  0.0  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [141.0, 34.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5357        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                  NaN            NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:55,789 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:55,819 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:55,863 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version           client_initial_dcid client_scid                   server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                            19          19                            17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                            19           1                            17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13  e66e05fe576deac0adb1fa816be6              e545068f19ba9a27fe6c1bcaec57  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                             1          19                             1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:55,863 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   443.  5353.   136.   134.  1900.    22.   135.
    80.   123.   133.     0. 21115.    67.   138.   547. 21116.]
2025-02-26 19:40:55,865 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:55,870 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:55,871 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:55,871 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:55,873 - INFO - DataFrame shape after NA dropping: (887, 23)
2025-02-26 19:40:55,873 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:55,874 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:55,874 - INFO - X shape: (887, 21), y shape: (887,)
2025-02-26 19:40:55,874 - INFO - Label distribution in training data: {'DNS': 740, 'HTTPS': 132, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:55,875 - INFO - Training model...
2025-02-26 19:40:55,990 - INFO - Predicting on test data...
2025-02-26 19:40:56,004 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 159.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 18.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 178.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 178.0
  }
}
2025-02-26 19:40:56,011 - INFO - Saved processed data locally to processed_data_20250226_194056.csv
2025-02-26 19:40:56,013 - INFO - JSON data size: 436665 bytes
2025-02-26 19:40:56,013 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:56,014 - INFO - Data sent successfully!
2025-02-26 19:40:56,014 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:56,015 - INFO - Starting data processing
2025-02-26 19:40:56,015 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:56,015 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:56,016 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:56,016 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:56,118 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:56,118 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:56,118 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:56,119 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:56,119 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:56,119 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:56,120 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:56,120 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:56,120 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:56,275 - INFO - Received 100 messages so far
2025-02-26 19:40:56,275 - INFO - Received 200 messages so far
2025-02-26 19:40:56,275 - INFO - Received 300 messages so far
2025-02-26 19:40:56,275 - INFO - Received 400 messages so far
2025-02-26 19:40:56,275 - INFO - Received 500 messages so far
2025-02-26 19:40:56,276 - INFO - Received 600 messages so far
2025-02-26 19:40:56,276 - INFO - Received 700 messages so far
2025-02-26 19:40:56,276 - INFO - Received 800 messages so far
2025-02-26 19:40:56,276 - INFO - Received 900 messages so far
2025-02-26 19:40:56,276 - INFO - Received 1000 messages so far
2025-02-26 19:40:56,277 - INFO - Received 1100 messages so far
2025-02-26 19:40:56,277 - INFO - Received 1200 messages so far
2025-02-26 19:40:56,277 - INFO - Received 1300 messages so far
2025-02-26 19:40:56,277 - INFO - Received 1400 messages so far
2025-02-26 19:40:56,277 - INFO - Received 1500 messages so far
2025-02-26 19:40:56,278 - INFO - Received 1600 messages so far
2025-02-26 19:40:56,278 - INFO - Received 1700 messages so far
2025-02-26 19:40:56,278 - INFO - Received 1800 messages so far
2025-02-26 19:40:56,278 - INFO - Received 1900 messages so far
2025-02-26 19:40:56,278 - INFO - Received 2000 messages so far
2025-02-26 19:40:56,279 - INFO - Received 2100 messages so far
2025-02-26 19:40:56,279 - INFO - Received 2200 messages so far
2025-02-26 19:40:56,279 - INFO - Received 2300 messages so far
2025-02-26 19:40:56,279 - INFO - Received 2400 messages so far
2025-02-26 19:40:56,279 - INFO - Received 2500 messages so far
2025-02-26 19:40:56,280 - INFO - Received 2600 messages so far
2025-02-26 19:40:56,280 - INFO - Received 2700 messages so far
2025-02-26 19:40:56,280 - INFO - Received 2800 messages so far
2025-02-26 19:40:56,280 - INFO - Received 2900 messages so far
2025-02-26 19:40:56,280 - INFO - Received 3000 messages so far
2025-02-26 19:40:56,281 - INFO - Received 3100 messages so far
2025-02-26 19:40:56,281 - INFO - Received 3200 messages so far
2025-02-26 19:40:56,281 - INFO - Received 3300 messages so far
2025-02-26 19:40:56,281 - INFO - Received 3400 messages so far
2025-02-26 19:40:56,281 - INFO - Received 3500 messages so far
2025-02-26 19:40:56,281 - INFO - Received 3600 messages so far
2025-02-26 19:40:56,282 - INFO - Received 3700 messages so far
2025-02-26 19:40:56,282 - INFO - Received 3800 messages so far
2025-02-26 19:40:56,282 - INFO - Received 3900 messages so far
2025-02-26 19:40:56,282 - INFO - Received 4000 messages so far
2025-02-26 19:40:56,283 - INFO - Received 4100 messages so far
2025-02-26 19:40:56,336 - INFO - Received 4200 messages so far
2025-02-26 19:40:56,336 - INFO - Received 4300 messages so far
2025-02-26 19:40:56,336 - INFO - Received 4400 messages so far
2025-02-26 19:40:56,336 - INFO - Received 4500 messages so far
2025-02-26 19:40:56,337 - INFO - Received 4600 messages so far
2025-02-26 19:40:56,337 - INFO - Received 4700 messages so far
2025-02-26 19:40:56,337 - INFO - Received 4800 messages so far
2025-02-26 19:40:56,337 - INFO - Received 4900 messages so far
2025-02-26 19:40:56,337 - INFO - Received 5000 messages so far
2025-02-26 19:40:56,338 - INFO - Received 5100 messages so far
2025-02-26 19:40:56,338 - INFO - Received 5200 messages so far
2025-02-26 19:40:56,338 - INFO - Received 5300 messages so far
2025-02-26 19:40:56,338 - INFO - Received 5400 messages so far
2025-02-26 19:40:56,338 - INFO - Received 5500 messages so far
2025-02-26 19:40:56,339 - INFO - Received 5600 messages so far
2025-02-26 19:40:56,339 - INFO - Received 5700 messages so far
2025-02-26 19:40:56,339 - INFO - Received 5800 messages so far
2025-02-26 19:40:56,339 - INFO - Received 5900 messages so far
2025-02-26 19:40:56,339 - INFO - Received 6000 messages so far
2025-02-26 19:40:56,340 - INFO - Received 6100 messages so far
2025-02-26 19:40:56,340 - INFO - Received 6200 messages so far
2025-02-26 19:40:56,340 - INFO - Received 6300 messages so far
2025-02-26 19:40:56,340 - INFO - Received 6400 messages so far
2025-02-26 19:40:56,340 - INFO - Received 6500 messages so far
2025-02-26 19:40:56,341 - INFO - Received 6600 messages so far
2025-02-26 19:40:56,341 - INFO - Received 6700 messages so far
2025-02-26 19:40:56,341 - INFO - Received 6800 messages so far
2025-02-26 19:40:56,341 - INFO - Received 6900 messages so far
2025-02-26 19:40:56,341 - INFO - Received 7000 messages so far
2025-02-26 19:40:56,341 - INFO - Received 7100 messages so far
2025-02-26 19:40:56,342 - INFO - Received 7200 messages so far
2025-02-26 19:40:56,342 - INFO - Received 7300 messages so far
2025-02-26 19:40:56,342 - INFO - Received 7400 messages so far
2025-02-26 19:40:56,342 - INFO - Received 7500 messages so far
2025-02-26 19:40:56,342 - INFO - Received 7600 messages so far
2025-02-26 19:40:56,343 - INFO - Received 7700 messages so far
2025-02-26 19:40:56,343 - INFO - Received 7800 messages so far
2025-02-26 19:40:56,343 - INFO - Received 7900 messages so far
2025-02-26 19:40:56,343 - INFO - Received 8000 messages so far
2025-02-26 19:40:56,343 - INFO - Received 8100 messages so far
2025-02-26 19:40:56,344 - INFO - Received 8200 messages so far
2025-02-26 19:40:56,344 - INFO - Received 8300 messages so far
2025-02-26 19:40:56,344 - INFO - Received 8400 messages so far
2025-02-26 19:40:56,344 - INFO - Received 8500 messages so far
2025-02-26 19:40:56,344 - INFO - Received 8600 messages so far
2025-02-26 19:40:56,345 - INFO - Received 8700 messages so far
2025-02-26 19:40:56,400 - INFO - Received 8800 messages so far
2025-02-26 19:40:56,400 - INFO - Received 8900 messages so far
2025-02-26 19:40:56,400 - INFO - Received 9000 messages so far
2025-02-26 19:40:56,400 - INFO - Received 9100 messages so far
2025-02-26 19:40:56,401 - INFO - Received 9200 messages so far
2025-02-26 19:40:56,401 - INFO - Received 9300 messages so far
2025-02-26 19:40:56,401 - INFO - Received 9400 messages so far
2025-02-26 19:40:56,401 - INFO - Received 9500 messages so far
2025-02-26 19:40:56,401 - INFO - Received 9600 messages so far
2025-02-26 19:40:56,402 - INFO - Received 9700 messages so far
2025-02-26 19:40:56,402 - INFO - Received 9800 messages so far
2025-02-26 19:40:56,402 - INFO - Received 9900 messages so far
2025-02-26 19:40:56,402 - INFO - Received 10000 messages so far
2025-02-26 19:40:56,402 - INFO - Total messages consumed: 10000
2025-02-26 19:40:56,490 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:56,494 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:56,494 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:56,494 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:56,494 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:56,502 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:56,505 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:56,505 - INFO - Number of columns: 66
2025-02-26 19:40:56,515 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
352         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3189        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5513        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7349        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8894        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:56,515 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:56,543 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:56,585 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    1b03fbdb1202008c              fb03fbdb1202008c  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:56,585 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   443.  1900.  5353.    80. 21116.   136. 21115.
   133.   134.   547.   135.   123.     0.   138.    67.    22.]
2025-02-26 19:40:56,586 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:56,591 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:56,592 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:56,592 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:56,595 - INFO - DataFrame shape after NA dropping: (816, 23)
2025-02-26 19:40:56,595 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:56,595 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:56,595 - INFO - X shape: (816, 21), y shape: (816,)
2025-02-26 19:40:56,595 - INFO - Label distribution in training data: {'DNS': 680, 'HTTPS': 122, 'HTTP': 13, 'SSH': 1}
2025-02-26 19:40:56,596 - INFO - Training model...
2025-02-26 19:40:56,698 - INFO - Predicting on test data...
2025-02-26 19:40:56,711 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 139.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 25.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 164.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 164.0
  }
}
2025-02-26 19:40:56,718 - INFO - Saved processed data locally to processed_data_20250226_194056.csv
2025-02-26 19:40:56,720 - INFO - JSON data size: 400272 bytes
2025-02-26 19:40:56,720 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:56,721 - INFO - Data sent successfully!
2025-02-26 19:40:56,721 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:56,722 - INFO - Starting data processing
2025-02-26 19:40:56,722 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:56,722 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:56,723 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:56,723 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:56,825 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:56,825 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:56,825 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:56,825 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:56,825 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:56,826 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:56,826 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:56,827 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:56,827 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:57,026 - INFO - Received 100 messages so far
2025-02-26 19:40:57,027 - INFO - Received 200 messages so far
2025-02-26 19:40:57,027 - INFO - Received 300 messages so far
2025-02-26 19:40:57,027 - INFO - Received 400 messages so far
2025-02-26 19:40:57,027 - INFO - Received 500 messages so far
2025-02-26 19:40:57,028 - INFO - Received 600 messages so far
2025-02-26 19:40:57,028 - INFO - Received 700 messages so far
2025-02-26 19:40:57,028 - INFO - Received 800 messages so far
2025-02-26 19:40:57,028 - INFO - Received 900 messages so far
2025-02-26 19:40:57,028 - INFO - Received 1000 messages so far
2025-02-26 19:40:57,029 - INFO - Received 1100 messages so far
2025-02-26 19:40:57,029 - INFO - Received 1200 messages so far
2025-02-26 19:40:57,029 - INFO - Received 1300 messages so far
2025-02-26 19:40:57,029 - INFO - Received 1400 messages so far
2025-02-26 19:40:57,029 - INFO - Received 1500 messages so far
2025-02-26 19:40:57,030 - INFO - Received 1600 messages so far
2025-02-26 19:40:57,030 - INFO - Received 1700 messages so far
2025-02-26 19:40:57,030 - INFO - Received 1800 messages so far
2025-02-26 19:40:57,030 - INFO - Received 1900 messages so far
2025-02-26 19:40:57,030 - INFO - Received 2000 messages so far
2025-02-26 19:40:57,031 - INFO - Received 2100 messages so far
2025-02-26 19:40:57,031 - INFO - Received 2200 messages so far
2025-02-26 19:40:57,031 - INFO - Received 2300 messages so far
2025-02-26 19:40:57,031 - INFO - Received 2400 messages so far
2025-02-26 19:40:57,031 - INFO - Received 2500 messages so far
2025-02-26 19:40:57,032 - INFO - Received 2600 messages so far
2025-02-26 19:40:57,032 - INFO - Received 2700 messages so far
2025-02-26 19:40:57,032 - INFO - Received 2800 messages so far
2025-02-26 19:40:57,032 - INFO - Received 2900 messages so far
2025-02-26 19:40:57,032 - INFO - Received 3000 messages so far
2025-02-26 19:40:57,033 - INFO - Received 3100 messages so far
2025-02-26 19:40:57,033 - INFO - Received 3200 messages so far
2025-02-26 19:40:57,033 - INFO - Received 3300 messages so far
2025-02-26 19:40:57,033 - INFO - Received 3400 messages so far
2025-02-26 19:40:57,033 - INFO - Received 3500 messages so far
2025-02-26 19:40:57,033 - INFO - Received 3600 messages so far
2025-02-26 19:40:57,034 - INFO - Received 3700 messages so far
2025-02-26 19:40:57,034 - INFO - Received 3800 messages so far
2025-02-26 19:40:57,034 - INFO - Received 3900 messages so far
2025-02-26 19:40:57,034 - INFO - Received 4000 messages so far
2025-02-26 19:40:57,035 - INFO - Received 4100 messages so far
2025-02-26 19:40:57,088 - INFO - Received 4200 messages so far
2025-02-26 19:40:57,089 - INFO - Received 4300 messages so far
2025-02-26 19:40:57,089 - INFO - Received 4400 messages so far
2025-02-26 19:40:57,089 - INFO - Received 4500 messages so far
2025-02-26 19:40:57,089 - INFO - Received 4600 messages so far
2025-02-26 19:40:57,089 - INFO - Received 4700 messages so far
2025-02-26 19:40:57,090 - INFO - Received 4800 messages so far
2025-02-26 19:40:57,090 - INFO - Received 4900 messages so far
2025-02-26 19:40:57,090 - INFO - Received 5000 messages so far
2025-02-26 19:40:57,090 - INFO - Received 5100 messages so far
2025-02-26 19:40:57,090 - INFO - Received 5200 messages so far
2025-02-26 19:40:57,091 - INFO - Received 5300 messages so far
2025-02-26 19:40:57,091 - INFO - Received 5400 messages so far
2025-02-26 19:40:57,091 - INFO - Received 5500 messages so far
2025-02-26 19:40:57,091 - INFO - Received 5600 messages so far
2025-02-26 19:40:57,091 - INFO - Received 5700 messages so far
2025-02-26 19:40:57,091 - INFO - Received 5800 messages so far
2025-02-26 19:40:57,092 - INFO - Received 5900 messages so far
2025-02-26 19:40:57,092 - INFO - Received 6000 messages so far
2025-02-26 19:40:57,092 - INFO - Received 6100 messages so far
2025-02-26 19:40:57,092 - INFO - Received 6200 messages so far
2025-02-26 19:40:57,092 - INFO - Received 6300 messages so far
2025-02-26 19:40:57,093 - INFO - Received 6400 messages so far
2025-02-26 19:40:57,093 - INFO - Received 6500 messages so far
2025-02-26 19:40:57,093 - INFO - Received 6600 messages so far
2025-02-26 19:40:57,093 - INFO - Received 6700 messages so far
2025-02-26 19:40:57,093 - INFO - Received 6800 messages so far
2025-02-26 19:40:57,094 - INFO - Received 6900 messages so far
2025-02-26 19:40:57,094 - INFO - Received 7000 messages so far
2025-02-26 19:40:57,094 - INFO - Received 7100 messages so far
2025-02-26 19:40:57,094 - INFO - Received 7200 messages so far
2025-02-26 19:40:57,094 - INFO - Received 7300 messages so far
2025-02-26 19:40:57,095 - INFO - Received 7400 messages so far
2025-02-26 19:40:57,095 - INFO - Received 7500 messages so far
2025-02-26 19:40:57,095 - INFO - Received 7600 messages so far
2025-02-26 19:40:57,095 - INFO - Received 7700 messages so far
2025-02-26 19:40:57,095 - INFO - Received 7800 messages so far
2025-02-26 19:40:57,096 - INFO - Received 7900 messages so far
2025-02-26 19:40:57,096 - INFO - Received 8000 messages so far
2025-02-26 19:40:57,096 - INFO - Received 8100 messages so far
2025-02-26 19:40:57,096 - INFO - Received 8200 messages so far
2025-02-26 19:40:57,096 - INFO - Received 8300 messages so far
2025-02-26 19:40:57,096 - INFO - Received 8400 messages so far
2025-02-26 19:40:57,097 - INFO - Received 8500 messages so far
2025-02-26 19:40:57,097 - INFO - Received 8600 messages so far
2025-02-26 19:40:57,097 - INFO - Received 8700 messages so far
2025-02-26 19:40:57,152 - INFO - Received 8800 messages so far
2025-02-26 19:40:57,153 - INFO - Received 8900 messages so far
2025-02-26 19:40:57,153 - INFO - Received 9000 messages so far
2025-02-26 19:40:57,153 - INFO - Received 9100 messages so far
2025-02-26 19:40:57,153 - INFO - Received 9200 messages so far
2025-02-26 19:40:57,153 - INFO - Received 9300 messages so far
2025-02-26 19:40:57,154 - INFO - Received 9400 messages so far
2025-02-26 19:40:57,154 - INFO - Received 9500 messages so far
2025-02-26 19:40:57,154 - INFO - Received 9600 messages so far
2025-02-26 19:40:57,154 - INFO - Received 9700 messages so far
2025-02-26 19:40:57,154 - INFO - Received 9800 messages so far
2025-02-26 19:40:57,154 - INFO - Received 9900 messages so far
2025-02-26 19:40:57,155 - INFO - Received 10000 messages so far
2025-02-26 19:40:57,155 - INFO - Total messages consumed: 10000
2025-02-26 19:40:57,241 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:57,245 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:57,245 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:57,245 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:57,245 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:57,253 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:57,256 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:57,256 - INFO - Number of columns: 66
2025-02-26 19:40:57,267 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3678        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2176       53.0  192.168.1.3  192.168.1.1   udp        52.0       112.0  1.740118e+09      NaN  NaN     dns  CGmhcc3D5kdRRgKjRk    39356.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           80.0        1.0          140.0      17.0  0.001427     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3811        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9073        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7546        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:57,267 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:57,297 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:57,340 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    56c8fcf4a1052fc6              f6c8fcf4a1052fc6  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:57,341 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.   133.  9092.   443.  5353.  1900.   123.   136.    80.
   547.   138.     0.    22. 21116.   134. 21115.    67.   135.]
2025-02-26 19:40:57,342 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:57,347 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:57,348 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:57,348 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:57,350 - INFO - DataFrame shape after NA dropping: (905, 23)
2025-02-26 19:40:57,350 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:57,350 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:57,351 - INFO - X shape: (905, 21), y shape: (905,)
2025-02-26 19:40:57,351 - INFO - Label distribution in training data: {'DNS': 757, 'HTTPS': 133, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:57,352 - INFO - Training model...
2025-02-26 19:40:57,465 - INFO - Predicting on test data...
2025-02-26 19:40:57,479 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 147.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 30.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 181.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 181.0
  }
}
2025-02-26 19:40:57,486 - INFO - Saved processed data locally to processed_data_20250226_194057.csv
2025-02-26 19:40:57,489 - INFO - JSON data size: 443404 bytes
2025-02-26 19:40:57,489 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:57,489 - INFO - Data sent successfully!
2025-02-26 19:40:57,489 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:57,490 - INFO - Starting data processing
2025-02-26 19:40:57,490 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:57,491 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:57,491 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:57,491 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:57,593 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:57,593 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:57,593 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:57,593 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:57,594 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:57,594 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:57,595 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:57,595 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:57,595 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:57,748 - INFO - Received 100 messages so far
2025-02-26 19:40:57,748 - INFO - Received 200 messages so far
2025-02-26 19:40:57,749 - INFO - Received 300 messages so far
2025-02-26 19:40:57,749 - INFO - Received 400 messages so far
2025-02-26 19:40:57,749 - INFO - Received 500 messages so far
2025-02-26 19:40:57,749 - INFO - Received 600 messages so far
2025-02-26 19:40:57,749 - INFO - Received 700 messages so far
2025-02-26 19:40:57,750 - INFO - Received 800 messages so far
2025-02-26 19:40:57,750 - INFO - Received 900 messages so far
2025-02-26 19:40:57,750 - INFO - Received 1000 messages so far
2025-02-26 19:40:57,750 - INFO - Received 1100 messages so far
2025-02-26 19:40:57,750 - INFO - Received 1200 messages so far
2025-02-26 19:40:57,751 - INFO - Received 1300 messages so far
2025-02-26 19:40:57,751 - INFO - Received 1400 messages so far
2025-02-26 19:40:57,751 - INFO - Received 1500 messages so far
2025-02-26 19:40:57,751 - INFO - Received 1600 messages so far
2025-02-26 19:40:57,751 - INFO - Received 1700 messages so far
2025-02-26 19:40:57,752 - INFO - Received 1800 messages so far
2025-02-26 19:40:57,752 - INFO - Received 1900 messages so far
2025-02-26 19:40:57,752 - INFO - Received 2000 messages so far
2025-02-26 19:40:57,752 - INFO - Received 2100 messages so far
2025-02-26 19:40:57,752 - INFO - Received 2200 messages so far
2025-02-26 19:40:57,752 - INFO - Received 2300 messages so far
2025-02-26 19:40:57,753 - INFO - Received 2400 messages so far
2025-02-26 19:40:57,753 - INFO - Received 2500 messages so far
2025-02-26 19:40:57,753 - INFO - Received 2600 messages so far
2025-02-26 19:40:57,753 - INFO - Received 2700 messages so far
2025-02-26 19:40:57,753 - INFO - Received 2800 messages so far
2025-02-26 19:40:57,754 - INFO - Received 2900 messages so far
2025-02-26 19:40:57,754 - INFO - Received 3000 messages so far
2025-02-26 19:40:57,754 - INFO - Received 3100 messages so far
2025-02-26 19:40:57,754 - INFO - Received 3200 messages so far
2025-02-26 19:40:57,754 - INFO - Received 3300 messages so far
2025-02-26 19:40:57,755 - INFO - Received 3400 messages so far
2025-02-26 19:40:57,755 - INFO - Received 3500 messages so far
2025-02-26 19:40:57,755 - INFO - Received 3600 messages so far
2025-02-26 19:40:57,755 - INFO - Received 3700 messages so far
2025-02-26 19:40:57,755 - INFO - Received 3800 messages so far
2025-02-26 19:40:57,756 - INFO - Received 3900 messages so far
2025-02-26 19:40:57,756 - INFO - Received 4000 messages so far
2025-02-26 19:40:57,756 - INFO - Received 4100 messages so far
2025-02-26 19:40:57,808 - INFO - Received 4200 messages so far
2025-02-26 19:40:57,808 - INFO - Received 4300 messages so far
2025-02-26 19:40:57,808 - INFO - Received 4400 messages so far
2025-02-26 19:40:57,808 - INFO - Received 4500 messages so far
2025-02-26 19:40:57,809 - INFO - Received 4600 messages so far
2025-02-26 19:40:57,809 - INFO - Received 4700 messages so far
2025-02-26 19:40:57,809 - INFO - Received 4800 messages so far
2025-02-26 19:40:57,809 - INFO - Received 4900 messages so far
2025-02-26 19:40:57,809 - INFO - Received 5000 messages so far
2025-02-26 19:40:57,810 - INFO - Received 5100 messages so far
2025-02-26 19:40:57,810 - INFO - Received 5200 messages so far
2025-02-26 19:40:57,810 - INFO - Received 5300 messages so far
2025-02-26 19:40:57,810 - INFO - Received 5400 messages so far
2025-02-26 19:40:57,810 - INFO - Received 5500 messages so far
2025-02-26 19:40:57,811 - INFO - Received 5600 messages so far
2025-02-26 19:40:57,811 - INFO - Received 5700 messages so far
2025-02-26 19:40:57,811 - INFO - Received 5800 messages so far
2025-02-26 19:40:57,811 - INFO - Received 5900 messages so far
2025-02-26 19:40:57,811 - INFO - Received 6000 messages so far
2025-02-26 19:40:57,812 - INFO - Received 6100 messages so far
2025-02-26 19:40:57,812 - INFO - Received 6200 messages so far
2025-02-26 19:40:57,812 - INFO - Received 6300 messages so far
2025-02-26 19:40:57,812 - INFO - Received 6400 messages so far
2025-02-26 19:40:57,812 - INFO - Received 6500 messages so far
2025-02-26 19:40:57,813 - INFO - Received 6600 messages so far
2025-02-26 19:40:57,813 - INFO - Received 6700 messages so far
2025-02-26 19:40:57,813 - INFO - Received 6800 messages so far
2025-02-26 19:40:57,813 - INFO - Received 6900 messages so far
2025-02-26 19:40:57,813 - INFO - Received 7000 messages so far
2025-02-26 19:40:57,813 - INFO - Received 7100 messages so far
2025-02-26 19:40:57,814 - INFO - Received 7200 messages so far
2025-02-26 19:40:57,814 - INFO - Received 7300 messages so far
2025-02-26 19:40:57,814 - INFO - Received 7400 messages so far
2025-02-26 19:40:57,814 - INFO - Received 7500 messages so far
2025-02-26 19:40:57,814 - INFO - Received 7600 messages so far
2025-02-26 19:40:57,815 - INFO - Received 7700 messages so far
2025-02-26 19:40:57,815 - INFO - Received 7800 messages so far
2025-02-26 19:40:57,815 - INFO - Received 7900 messages so far
2025-02-26 19:40:57,815 - INFO - Received 8000 messages so far
2025-02-26 19:40:57,815 - INFO - Received 8100 messages so far
2025-02-26 19:40:57,816 - INFO - Received 8200 messages so far
2025-02-26 19:40:57,816 - INFO - Received 8300 messages so far
2025-02-26 19:40:57,816 - INFO - Received 8400 messages so far
2025-02-26 19:40:57,816 - INFO - Received 8500 messages so far
2025-02-26 19:40:57,816 - INFO - Received 8600 messages so far
2025-02-26 19:40:57,817 - INFO - Received 8700 messages so far
2025-02-26 19:40:57,907 - INFO - Received 8800 messages so far
2025-02-26 19:40:57,908 - INFO - Received 8900 messages so far
2025-02-26 19:40:57,908 - INFO - Received 9000 messages so far
2025-02-26 19:40:57,908 - INFO - Received 9100 messages so far
2025-02-26 19:40:57,908 - INFO - Received 9200 messages so far
2025-02-26 19:40:57,908 - INFO - Received 9300 messages so far
2025-02-26 19:40:57,909 - INFO - Received 9400 messages so far
2025-02-26 19:40:57,909 - INFO - Received 9500 messages so far
2025-02-26 19:40:57,909 - INFO - Received 9600 messages so far
2025-02-26 19:40:57,909 - INFO - Received 9700 messages so far
2025-02-26 19:40:57,909 - INFO - Received 9800 messages so far
2025-02-26 19:40:57,910 - INFO - Received 9900 messages so far
2025-02-26 19:40:57,910 - INFO - Received 10000 messages so far
2025-02-26 19:40:57,910 - INFO - Total messages consumed: 10000
2025-02-26 19:40:57,993 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:57,997 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:57,997 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:57,997 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:57,997 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:58,005 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:58,008 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:58,008 - INFO - Number of columns: 66
2025-02-26 19:40:58,019 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3327     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740119e+09      NaN  NaN     NaN  ClIgJb3WusvSgKJcDk    58246.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0   0.00014     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5972        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4345        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7445        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4362        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:58,019 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:58,049 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:58,093 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    8af1ef48d3289058              2336755850007c23  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:58,093 - INFO - Unique values in 'id.resp_p' before labeling: [ 9092.    nan    53.   443.   134.  5353.  1900.   123. 21116.   136.
   138.    22.   547.    67.   135.   133.    80.     0. 21115.]
2025-02-26 19:40:58,095 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:58,100 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:58,101 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:58,101 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:58,103 - INFO - DataFrame shape after NA dropping: (870, 23)
2025-02-26 19:40:58,103 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:58,103 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:58,104 - INFO - X shape: (870, 21), y shape: (870,)
2025-02-26 19:40:58,104 - INFO - Label distribution in training data: {'DNS': 726, 'HTTPS': 129, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:58,105 - INFO - Training model...
2025-02-26 19:40:58,219 - INFO - Predicting on test data...
2025-02-26 19:40:58,233 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 142.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 0.9333333333333333,
    "recall": 1.0,
    "f1-score": 0.9655172413793104,
    "support": 28.0
  },
  "accuracy": 0.9885057471264368,
  "macro avg": {
    "precision": 0.9777777777777779,
    "recall": 0.8333333333333334,
    "f1-score": 0.8773946360153256,
    "support": 174.0
  },
  "weighted avg": {
    "precision": 0.989272030651341,
    "recall": 0.9885057471264368,
    "f1-score": 0.9867882150878584,
    "support": 174.0
  }
}
2025-02-26 19:40:58,240 - INFO - Saved processed data locally to processed_data_20250226_194058.csv
2025-02-26 19:40:58,242 - INFO - JSON data size: 427918 bytes
2025-02-26 19:40:58,242 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:58,242 - INFO - Data sent successfully!
2025-02-26 19:40:58,242 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:58,243 - INFO - Starting data processing
2025-02-26 19:40:58,243 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:58,244 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:58,245 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:58,245 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:58,347 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:58,347 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:58,348 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:58,348 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:58,348 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:58,349 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:58,349 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:58,349 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:58,349 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:58,504 - INFO - Received 100 messages so far
2025-02-26 19:40:58,504 - INFO - Received 200 messages so far
2025-02-26 19:40:58,504 - INFO - Received 300 messages so far
2025-02-26 19:40:58,505 - INFO - Received 400 messages so far
2025-02-26 19:40:58,505 - INFO - Received 500 messages so far
2025-02-26 19:40:58,505 - INFO - Received 600 messages so far
2025-02-26 19:40:58,505 - INFO - Received 700 messages so far
2025-02-26 19:40:58,505 - INFO - Received 800 messages so far
2025-02-26 19:40:58,506 - INFO - Received 900 messages so far
2025-02-26 19:40:58,506 - INFO - Received 1000 messages so far
2025-02-26 19:40:58,506 - INFO - Received 1100 messages so far
2025-02-26 19:40:58,506 - INFO - Received 1200 messages so far
2025-02-26 19:40:58,506 - INFO - Received 1300 messages so far
2025-02-26 19:40:58,507 - INFO - Received 1400 messages so far
2025-02-26 19:40:58,507 - INFO - Received 1500 messages so far
2025-02-26 19:40:58,507 - INFO - Received 1600 messages so far
2025-02-26 19:40:58,507 - INFO - Received 1700 messages so far
2025-02-26 19:40:58,507 - INFO - Received 1800 messages so far
2025-02-26 19:40:58,507 - INFO - Received 1900 messages so far
2025-02-26 19:40:58,508 - INFO - Received 2000 messages so far
2025-02-26 19:40:58,508 - INFO - Received 2100 messages so far
2025-02-26 19:40:58,508 - INFO - Received 2200 messages so far
2025-02-26 19:40:58,508 - INFO - Received 2300 messages so far
2025-02-26 19:40:58,508 - INFO - Received 2400 messages so far
2025-02-26 19:40:58,509 - INFO - Received 2500 messages so far
2025-02-26 19:40:58,509 - INFO - Received 2600 messages so far
2025-02-26 19:40:58,509 - INFO - Received 2700 messages so far
2025-02-26 19:40:58,509 - INFO - Received 2800 messages so far
2025-02-26 19:40:58,509 - INFO - Received 2900 messages so far
2025-02-26 19:40:58,510 - INFO - Received 3000 messages so far
2025-02-26 19:40:58,510 - INFO - Received 3100 messages so far
2025-02-26 19:40:58,510 - INFO - Received 3200 messages so far
2025-02-26 19:40:58,510 - INFO - Received 3300 messages so far
2025-02-26 19:40:58,510 - INFO - Received 3400 messages so far
2025-02-26 19:40:58,511 - INFO - Received 3500 messages so far
2025-02-26 19:40:58,511 - INFO - Received 3600 messages so far
2025-02-26 19:40:58,511 - INFO - Received 3700 messages so far
2025-02-26 19:40:58,511 - INFO - Received 3800 messages so far
2025-02-26 19:40:58,511 - INFO - Received 3900 messages so far
2025-02-26 19:40:58,511 - INFO - Received 4000 messages so far
2025-02-26 19:40:58,512 - INFO - Received 4100 messages so far
2025-02-26 19:40:58,566 - INFO - Received 4200 messages so far
2025-02-26 19:40:58,567 - INFO - Received 4300 messages so far
2025-02-26 19:40:58,567 - INFO - Received 4400 messages so far
2025-02-26 19:40:58,567 - INFO - Received 4500 messages so far
2025-02-26 19:40:58,567 - INFO - Received 4600 messages so far
2025-02-26 19:40:58,567 - INFO - Received 4700 messages so far
2025-02-26 19:40:58,568 - INFO - Received 4800 messages so far
2025-02-26 19:40:58,568 - INFO - Received 4900 messages so far
2025-02-26 19:40:58,568 - INFO - Received 5000 messages so far
2025-02-26 19:40:58,568 - INFO - Received 5100 messages so far
2025-02-26 19:40:58,568 - INFO - Received 5200 messages so far
2025-02-26 19:40:58,569 - INFO - Received 5300 messages so far
2025-02-26 19:40:58,569 - INFO - Received 5400 messages so far
2025-02-26 19:40:58,569 - INFO - Received 5500 messages so far
2025-02-26 19:40:58,569 - INFO - Received 5600 messages so far
2025-02-26 19:40:58,569 - INFO - Received 5700 messages so far
2025-02-26 19:40:58,569 - INFO - Received 5800 messages so far
2025-02-26 19:40:58,570 - INFO - Received 5900 messages so far
2025-02-26 19:40:58,570 - INFO - Received 6000 messages so far
2025-02-26 19:40:58,570 - INFO - Received 6100 messages so far
2025-02-26 19:40:58,570 - INFO - Received 6200 messages so far
2025-02-26 19:40:58,570 - INFO - Received 6300 messages so far
2025-02-26 19:40:58,571 - INFO - Received 6400 messages so far
2025-02-26 19:40:58,571 - INFO - Received 6500 messages so far
2025-02-26 19:40:58,571 - INFO - Received 6600 messages so far
2025-02-26 19:40:58,571 - INFO - Received 6700 messages so far
2025-02-26 19:40:58,571 - INFO - Received 6800 messages so far
2025-02-26 19:40:58,572 - INFO - Received 6900 messages so far
2025-02-26 19:40:58,572 - INFO - Received 7000 messages so far
2025-02-26 19:40:58,572 - INFO - Received 7100 messages so far
2025-02-26 19:40:58,572 - INFO - Received 7200 messages so far
2025-02-26 19:40:58,572 - INFO - Received 7300 messages so far
2025-02-26 19:40:58,573 - INFO - Received 7400 messages so far
2025-02-26 19:40:58,573 - INFO - Received 7500 messages so far
2025-02-26 19:40:58,573 - INFO - Received 7600 messages so far
2025-02-26 19:40:58,573 - INFO - Received 7700 messages so far
2025-02-26 19:40:58,573 - INFO - Received 7800 messages so far
2025-02-26 19:40:58,573 - INFO - Received 7900 messages so far
2025-02-26 19:40:58,574 - INFO - Received 8000 messages so far
2025-02-26 19:40:58,574 - INFO - Received 8100 messages so far
2025-02-26 19:40:58,574 - INFO - Received 8200 messages so far
2025-02-26 19:40:58,574 - INFO - Received 8300 messages so far
2025-02-26 19:40:58,574 - INFO - Received 8400 messages so far
2025-02-26 19:40:58,575 - INFO - Received 8500 messages so far
2025-02-26 19:40:58,575 - INFO - Received 8600 messages so far
2025-02-26 19:40:58,575 - INFO - Received 8700 messages so far
2025-02-26 19:40:58,631 - INFO - Received 8800 messages so far
2025-02-26 19:40:58,632 - INFO - Received 8900 messages so far
2025-02-26 19:40:58,632 - INFO - Received 9000 messages so far
2025-02-26 19:40:58,632 - INFO - Received 9100 messages so far
2025-02-26 19:40:58,632 - INFO - Received 9200 messages so far
2025-02-26 19:40:58,632 - INFO - Received 9300 messages so far
2025-02-26 19:40:58,633 - INFO - Received 9400 messages so far
2025-02-26 19:40:58,633 - INFO - Received 9500 messages so far
2025-02-26 19:40:58,633 - INFO - Received 9600 messages so far
2025-02-26 19:40:58,633 - INFO - Received 9700 messages so far
2025-02-26 19:40:58,633 - INFO - Received 9800 messages so far
2025-02-26 19:40:58,634 - INFO - Received 9900 messages so far
2025-02-26 19:40:58,634 - INFO - Received 10000 messages so far
2025-02-26 19:40:58,634 - INFO - Total messages consumed: 10000
2025-02-26 19:40:58,722 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:58,726 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:58,726 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:58,726 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:58,726 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:58,734 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:58,737 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:58,737 - INFO - Number of columns: 66
2025-02-26 19:40:58,748 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                              query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                                                                                                                 answers                            TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7569       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740119e+09      NaN  NaN     NaN  CnJLRl3h0J0PhowKx9    51486.0  0.001457  usc-word-edit.officeapps.live.com     1.0  C_INTERNET    1.0          A    0.0    NOERROR  False  False  True  True  0.0  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net, wac-0003.wac-msedge.net, 52.108.8.12, 52.108.9.12]  [15.0, 27.0, 31.0, 19.0, 19.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3816        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                     NaN                             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8840        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                     NaN                             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2409        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                     NaN                             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6422        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                     NaN                             NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.006795     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:58,748 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:58,778 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:58,822 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    376acab97e4aab30              f6c8fcf4a1052fc6  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:58,822 - INFO - Unique values in 'id.resp_p' before labeling: [   53.    nan  1900.  9092.   443.  5353.   134.    80. 21116.   135.
   138.   123.   547.     0. 21115.    67.   133.    22.   136.]
2025-02-26 19:40:58,824 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:58,828 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:58,830 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:58,830 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:58,832 - INFO - DataFrame shape after NA dropping: (743, 23)
2025-02-26 19:40:58,832 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:58,832 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:58,832 - INFO - X shape: (743, 21), y shape: (743,)
2025-02-26 19:40:58,833 - INFO - Label distribution in training data: {'DNS': 614, 'HTTPS': 116, 'HTTP': 12, 'SSH': 1}
2025-02-26 19:40:58,833 - INFO - Training model...
2025-02-26 19:40:58,943 - INFO - Predicting on test data...
2025-02-26 19:40:58,955 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 126.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 22.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 149.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 149.0
  }
}
2025-02-26 19:40:58,961 - INFO - Saved processed data locally to processed_data_20250226_194058.csv
2025-02-26 19:40:58,963 - INFO - JSON data size: 365478 bytes
2025-02-26 19:40:58,964 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:58,964 - INFO - Data sent successfully!
2025-02-26 19:40:58,964 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:58,965 - INFO - Starting data processing
2025-02-26 19:40:58,965 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:58,965 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:58,966 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:58,966 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:59,068 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:59,068 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:59,068 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:59,068 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:59,068 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:59,069 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:59,069 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:59,070 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:59,070 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:59,263 - INFO - Received 100 messages so far
2025-02-26 19:40:59,264 - INFO - Received 200 messages so far
2025-02-26 19:40:59,264 - INFO - Received 300 messages so far
2025-02-26 19:40:59,264 - INFO - Received 400 messages so far
2025-02-26 19:40:59,264 - INFO - Received 500 messages so far
2025-02-26 19:40:59,265 - INFO - Received 600 messages so far
2025-02-26 19:40:59,265 - INFO - Received 700 messages so far
2025-02-26 19:40:59,265 - INFO - Received 800 messages so far
2025-02-26 19:40:59,265 - INFO - Received 900 messages so far
2025-02-26 19:40:59,265 - INFO - Received 1000 messages so far
2025-02-26 19:40:59,265 - INFO - Received 1100 messages so far
2025-02-26 19:40:59,266 - INFO - Received 1200 messages so far
2025-02-26 19:40:59,266 - INFO - Received 1300 messages so far
2025-02-26 19:40:59,266 - INFO - Received 1400 messages so far
2025-02-26 19:40:59,266 - INFO - Received 1500 messages so far
2025-02-26 19:40:59,266 - INFO - Received 1600 messages so far
2025-02-26 19:40:59,267 - INFO - Received 1700 messages so far
2025-02-26 19:40:59,267 - INFO - Received 1800 messages so far
2025-02-26 19:40:59,267 - INFO - Received 1900 messages so far
2025-02-26 19:40:59,267 - INFO - Received 2000 messages so far
2025-02-26 19:40:59,267 - INFO - Received 2100 messages so far
2025-02-26 19:40:59,268 - INFO - Received 2200 messages so far
2025-02-26 19:40:59,268 - INFO - Received 2300 messages so far
2025-02-26 19:40:59,268 - INFO - Received 2400 messages so far
2025-02-26 19:40:59,268 - INFO - Received 2500 messages so far
2025-02-26 19:40:59,268 - INFO - Received 2600 messages so far
2025-02-26 19:40:59,269 - INFO - Received 2700 messages so far
2025-02-26 19:40:59,269 - INFO - Received 2800 messages so far
2025-02-26 19:40:59,269 - INFO - Received 2900 messages so far
2025-02-26 19:40:59,269 - INFO - Received 3000 messages so far
2025-02-26 19:40:59,269 - INFO - Received 3100 messages so far
2025-02-26 19:40:59,269 - INFO - Received 3200 messages so far
2025-02-26 19:40:59,270 - INFO - Received 3300 messages so far
2025-02-26 19:40:59,270 - INFO - Received 3400 messages so far
2025-02-26 19:40:59,270 - INFO - Received 3500 messages so far
2025-02-26 19:40:59,270 - INFO - Received 3600 messages so far
2025-02-26 19:40:59,270 - INFO - Received 3700 messages so far
2025-02-26 19:40:59,271 - INFO - Received 3800 messages so far
2025-02-26 19:40:59,271 - INFO - Received 3900 messages so far
2025-02-26 19:40:59,271 - INFO - Received 4000 messages so far
2025-02-26 19:40:59,271 - INFO - Received 4100 messages so far
2025-02-26 19:40:59,323 - INFO - Received 4200 messages so far
2025-02-26 19:40:59,324 - INFO - Received 4300 messages so far
2025-02-26 19:40:59,324 - INFO - Received 4400 messages so far
2025-02-26 19:40:59,324 - INFO - Received 4500 messages so far
2025-02-26 19:40:59,324 - INFO - Received 4600 messages so far
2025-02-26 19:40:59,324 - INFO - Received 4700 messages so far
2025-02-26 19:40:59,325 - INFO - Received 4800 messages so far
2025-02-26 19:40:59,325 - INFO - Received 4900 messages so far
2025-02-26 19:40:59,325 - INFO - Received 5000 messages so far
2025-02-26 19:40:59,325 - INFO - Received 5100 messages so far
2025-02-26 19:40:59,325 - INFO - Received 5200 messages so far
2025-02-26 19:40:59,326 - INFO - Received 5300 messages so far
2025-02-26 19:40:59,326 - INFO - Received 5400 messages so far
2025-02-26 19:40:59,326 - INFO - Received 5500 messages so far
2025-02-26 19:40:59,326 - INFO - Received 5600 messages so far
2025-02-26 19:40:59,326 - INFO - Received 5700 messages so far
2025-02-26 19:40:59,327 - INFO - Received 5800 messages so far
2025-02-26 19:40:59,327 - INFO - Received 5900 messages so far
2025-02-26 19:40:59,327 - INFO - Received 6000 messages so far
2025-02-26 19:40:59,327 - INFO - Received 6100 messages so far
2025-02-26 19:40:59,327 - INFO - Received 6200 messages so far
2025-02-26 19:40:59,328 - INFO - Received 6300 messages so far
2025-02-26 19:40:59,328 - INFO - Received 6400 messages so far
2025-02-26 19:40:59,328 - INFO - Received 6500 messages so far
2025-02-26 19:40:59,328 - INFO - Received 6600 messages so far
2025-02-26 19:40:59,328 - INFO - Received 6700 messages so far
2025-02-26 19:40:59,329 - INFO - Received 6800 messages so far
2025-02-26 19:40:59,329 - INFO - Received 6900 messages so far
2025-02-26 19:40:59,329 - INFO - Received 7000 messages so far
2025-02-26 19:40:59,329 - INFO - Received 7100 messages so far
2025-02-26 19:40:59,329 - INFO - Received 7200 messages so far
2025-02-26 19:40:59,329 - INFO - Received 7300 messages so far
2025-02-26 19:40:59,330 - INFO - Received 7400 messages so far
2025-02-26 19:40:59,330 - INFO - Received 7500 messages so far
2025-02-26 19:40:59,330 - INFO - Received 7600 messages so far
2025-02-26 19:40:59,330 - INFO - Received 7700 messages so far
2025-02-26 19:40:59,330 - INFO - Received 7800 messages so far
2025-02-26 19:40:59,331 - INFO - Received 7900 messages so far
2025-02-26 19:40:59,331 - INFO - Received 8000 messages so far
2025-02-26 19:40:59,331 - INFO - Received 8100 messages so far
2025-02-26 19:40:59,331 - INFO - Received 8200 messages so far
2025-02-26 19:40:59,331 - INFO - Received 8300 messages so far
2025-02-26 19:40:59,332 - INFO - Received 8400 messages so far
2025-02-26 19:40:59,332 - INFO - Received 8500 messages so far
2025-02-26 19:40:59,332 - INFO - Received 8600 messages so far
2025-02-26 19:40:59,332 - INFO - Received 8700 messages so far
2025-02-26 19:40:59,387 - INFO - Received 8800 messages so far
2025-02-26 19:40:59,388 - INFO - Received 8900 messages so far
2025-02-26 19:40:59,388 - INFO - Received 9000 messages so far
2025-02-26 19:40:59,388 - INFO - Received 9100 messages so far
2025-02-26 19:40:59,388 - INFO - Received 9200 messages so far
2025-02-26 19:40:59,388 - INFO - Received 9300 messages so far
2025-02-26 19:40:59,389 - INFO - Received 9400 messages so far
2025-02-26 19:40:59,389 - INFO - Received 9500 messages so far
2025-02-26 19:40:59,389 - INFO - Received 9600 messages so far
2025-02-26 19:40:59,389 - INFO - Received 9700 messages so far
2025-02-26 19:40:59,389 - INFO - Received 9800 messages so far
2025-02-26 19:40:59,390 - INFO - Received 9900 messages so far
2025-02-26 19:40:59,390 - INFO - Received 10000 messages so far
2025-02-26 19:40:59,390 - INFO - Total messages consumed: 10000
2025-02-26 19:40:59,476 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:40:59,480 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:59,480 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:40:59,480 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:40:59,481 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:40:59,488 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:40:59,491 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:40:59,491 - INFO - Number of columns: 66
2025-02-26 19:40:59,501 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
5016        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005897     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6085        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8834        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5922        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
872         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:40:59,501 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:40:59,531 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:40:59,573 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    89520c813b739a8f              e9520c813b739a8f  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:40:59,574 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.   443.    53.  1900.    80.    22.   134.  5353.   133.
   123. 21116.   136. 21115.   135.   547.   138.     0.    67.]
2025-02-26 19:40:59,575 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:40:59,580 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:59,581 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:40:59,581 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:40:59,583 - INFO - DataFrame shape after NA dropping: (908, 23)
2025-02-26 19:40:59,584 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:40:59,584 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:40:59,584 - INFO - X shape: (908, 21), y shape: (908,)
2025-02-26 19:40:59,584 - INFO - Label distribution in training data: {'DNS': 760, 'HTTPS': 133, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:40:59,585 - INFO - Training model...
2025-02-26 19:40:59,699 - INFO - Predicting on test data...
2025-02-26 19:40:59,713 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 151.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.3333333333333333,
    "f1-score": 0.5,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.9333333333333333,
    "recall": 1.0,
    "f1-score": 0.9655172413793104,
    "support": 28.0
  },
  "accuracy": 0.989010989010989,
  "macro avg": {
    "precision": 0.9777777777777779,
    "recall": 0.7777777777777777,
    "f1-score": 0.8218390804597702,
    "support": 182.0
  },
  "weighted avg": {
    "precision": 0.9897435897435897,
    "recall": 0.989010989010989,
    "f1-score": 0.9864532019704434,
    "support": 182.0
  }
}
2025-02-26 19:40:59,721 - INFO - Saved processed data locally to processed_data_20250226_194059.csv
2025-02-26 19:40:59,723 - INFO - JSON data size: 447284 bytes
2025-02-26 19:40:59,723 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:40:59,723 - INFO - Data sent successfully!
2025-02-26 19:40:59,723 - INFO - Data processing and transmission completed successfully
2025-02-26 19:40:59,725 - INFO - Starting data processing
2025-02-26 19:40:59,725 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:40:59,725 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:40:59,726 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:40:59,726 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:40:59,828 - INFO - Broker version identified as 2.5.0
2025-02-26 19:40:59,828 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:40:59,829 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:40:59,829 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:40:59,829 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:40:59,830 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:40:59,830 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:40:59,830 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:40:59,830 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:40:59,983 - INFO - Received 100 messages so far
2025-02-26 19:40:59,984 - INFO - Received 200 messages so far
2025-02-26 19:40:59,984 - INFO - Received 300 messages so far
2025-02-26 19:40:59,984 - INFO - Received 400 messages so far
2025-02-26 19:40:59,984 - INFO - Received 500 messages so far
2025-02-26 19:40:59,984 - INFO - Received 600 messages so far
2025-02-26 19:40:59,985 - INFO - Received 700 messages so far
2025-02-26 19:40:59,985 - INFO - Received 800 messages so far
2025-02-26 19:40:59,985 - INFO - Received 900 messages so far
2025-02-26 19:40:59,985 - INFO - Received 1000 messages so far
2025-02-26 19:40:59,985 - INFO - Received 1100 messages so far
2025-02-26 19:40:59,986 - INFO - Received 1200 messages so far
2025-02-26 19:40:59,986 - INFO - Received 1300 messages so far
2025-02-26 19:40:59,986 - INFO - Received 1400 messages so far
2025-02-26 19:40:59,986 - INFO - Received 1500 messages so far
2025-02-26 19:40:59,986 - INFO - Received 1600 messages so far
2025-02-26 19:40:59,987 - INFO - Received 1700 messages so far
2025-02-26 19:40:59,987 - INFO - Received 1800 messages so far
2025-02-26 19:40:59,987 - INFO - Received 1900 messages so far
2025-02-26 19:40:59,987 - INFO - Received 2000 messages so far
2025-02-26 19:40:59,987 - INFO - Received 2100 messages so far
2025-02-26 19:40:59,988 - INFO - Received 2200 messages so far
2025-02-26 19:40:59,988 - INFO - Received 2300 messages so far
2025-02-26 19:40:59,988 - INFO - Received 2400 messages so far
2025-02-26 19:40:59,988 - INFO - Received 2500 messages so far
2025-02-26 19:40:59,988 - INFO - Received 2600 messages so far
2025-02-26 19:40:59,989 - INFO - Received 2700 messages so far
2025-02-26 19:40:59,989 - INFO - Received 2800 messages so far
2025-02-26 19:40:59,989 - INFO - Received 2900 messages so far
2025-02-26 19:40:59,989 - INFO - Received 3000 messages so far
2025-02-26 19:40:59,989 - INFO - Received 3100 messages so far
2025-02-26 19:40:59,989 - INFO - Received 3200 messages so far
2025-02-26 19:40:59,990 - INFO - Received 3300 messages so far
2025-02-26 19:40:59,990 - INFO - Received 3400 messages so far
2025-02-26 19:40:59,990 - INFO - Received 3500 messages so far
2025-02-26 19:40:59,990 - INFO - Received 3600 messages so far
2025-02-26 19:40:59,990 - INFO - Received 3700 messages so far
2025-02-26 19:40:59,991 - INFO - Received 3800 messages so far
2025-02-26 19:40:59,991 - INFO - Received 3900 messages so far
2025-02-26 19:40:59,991 - INFO - Received 4000 messages so far
2025-02-26 19:40:59,991 - INFO - Received 4100 messages so far
2025-02-26 19:41:00,082 - INFO - Received 4200 messages so far
2025-02-26 19:41:00,082 - INFO - Received 4300 messages so far
2025-02-26 19:41:00,082 - INFO - Received 4400 messages so far
2025-02-26 19:41:00,082 - INFO - Received 4500 messages so far
2025-02-26 19:41:00,083 - INFO - Received 4600 messages so far
2025-02-26 19:41:00,083 - INFO - Received 4700 messages so far
2025-02-26 19:41:00,083 - INFO - Received 4800 messages so far
2025-02-26 19:41:00,083 - INFO - Received 4900 messages so far
2025-02-26 19:41:00,083 - INFO - Received 5000 messages so far
2025-02-26 19:41:00,084 - INFO - Received 5100 messages so far
2025-02-26 19:41:00,084 - INFO - Received 5200 messages so far
2025-02-26 19:41:00,084 - INFO - Received 5300 messages so far
2025-02-26 19:41:00,084 - INFO - Received 5400 messages so far
2025-02-26 19:41:00,084 - INFO - Received 5500 messages so far
2025-02-26 19:41:00,085 - INFO - Received 5600 messages so far
2025-02-26 19:41:00,085 - INFO - Received 5700 messages so far
2025-02-26 19:41:00,085 - INFO - Received 5800 messages so far
2025-02-26 19:41:00,085 - INFO - Received 5900 messages so far
2025-02-26 19:41:00,085 - INFO - Received 6000 messages so far
2025-02-26 19:41:00,086 - INFO - Received 6100 messages so far
2025-02-26 19:41:00,086 - INFO - Received 6200 messages so far
2025-02-26 19:41:00,086 - INFO - Received 6300 messages so far
2025-02-26 19:41:00,086 - INFO - Received 6400 messages so far
2025-02-26 19:41:00,086 - INFO - Received 6500 messages so far
2025-02-26 19:41:00,087 - INFO - Received 6600 messages so far
2025-02-26 19:41:00,087 - INFO - Received 6700 messages so far
2025-02-26 19:41:00,087 - INFO - Received 6800 messages so far
2025-02-26 19:41:00,087 - INFO - Received 6900 messages so far
2025-02-26 19:41:00,087 - INFO - Received 7000 messages so far
2025-02-26 19:41:00,087 - INFO - Received 7100 messages so far
2025-02-26 19:41:00,088 - INFO - Received 7200 messages so far
2025-02-26 19:41:00,088 - INFO - Received 7300 messages so far
2025-02-26 19:41:00,088 - INFO - Received 7400 messages so far
2025-02-26 19:41:00,088 - INFO - Received 7500 messages so far
2025-02-26 19:41:00,088 - INFO - Received 7600 messages so far
2025-02-26 19:41:00,089 - INFO - Received 7700 messages so far
2025-02-26 19:41:00,089 - INFO - Received 7800 messages so far
2025-02-26 19:41:00,089 - INFO - Received 7900 messages so far
2025-02-26 19:41:00,089 - INFO - Received 8000 messages so far
2025-02-26 19:41:00,089 - INFO - Received 8100 messages so far
2025-02-26 19:41:00,090 - INFO - Received 8200 messages so far
2025-02-26 19:41:00,090 - INFO - Received 8300 messages so far
2025-02-26 19:41:00,090 - INFO - Received 8400 messages so far
2025-02-26 19:41:00,090 - INFO - Received 8500 messages so far
2025-02-26 19:41:00,090 - INFO - Received 8600 messages so far
2025-02-26 19:41:00,091 - INFO - Received 8700 messages so far
2025-02-26 19:41:00,146 - INFO - Received 8800 messages so far
2025-02-26 19:41:00,147 - INFO - Received 8900 messages so far
2025-02-26 19:41:00,147 - INFO - Received 9000 messages so far
2025-02-26 19:41:00,147 - INFO - Received 9100 messages so far
2025-02-26 19:41:00,147 - INFO - Received 9200 messages so far
2025-02-26 19:41:00,147 - INFO - Received 9300 messages so far
2025-02-26 19:41:00,148 - INFO - Received 9400 messages so far
2025-02-26 19:41:00,148 - INFO - Received 9500 messages so far
2025-02-26 19:41:00,148 - INFO - Received 9600 messages so far
2025-02-26 19:41:00,148 - INFO - Received 9700 messages so far
2025-02-26 19:41:00,148 - INFO - Received 9800 messages so far
2025-02-26 19:41:00,149 - INFO - Received 9900 messages so far
2025-02-26 19:41:00,149 - INFO - Received 10000 messages so far
2025-02-26 19:41:00,149 - INFO - Total messages consumed: 10000
2025-02-26 19:41:00,234 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:41:00,238 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:00,238 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:41:00,238 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:00,238 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:41:00,246 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:41:00,249 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:41:00,249 - INFO - Number of columns: 66
2025-02-26 19:41:00,261 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt                                          query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD     RA    Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9737        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN                                            NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9662       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740120e+09      NaN  NaN     NaN  CsCSou1VGHqyAGVSNl    42031.0  NaN  pgtca1-word-telemetry-vip.officeapps.live.com     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  False  0.0     NaN  NaN    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4488        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN                                            NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.008315     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7356        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN                                            NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
546        53.0  192.168.1.3  192.168.1.1   udp        74.0       144.0  1.740118e+09      NaN  NaN     dns  CLXjJD33yYqavjQg91    40364.0  NaN                                            NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0          102.0        1.0          172.0      17.0  0.001231     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:41:00,261 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:41:00,292 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:41:00,335 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    ca26477d8c98f7b3              ea26477d8c98f7b3  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:41:00,336 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.   138.   133.   123.  1900.   443.    80.
   134.   547.    22.   136. 21116.   135.     0. 21115.    67.]
2025-02-26 19:41:00,337 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:41:00,342 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:00,343 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:41:00,343 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:41:00,345 - INFO - DataFrame shape after NA dropping: (826, 23)
2025-02-26 19:41:00,345 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:41:00,345 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:41:00,346 - INFO - X shape: (826, 21), y shape: (826,)
2025-02-26 19:41:00,346 - INFO - Label distribution in training data: {'DNS': 687, 'HTTPS': 126, 'HTTP': 12, 'SSH': 1}
2025-02-26 19:41:00,347 - INFO - Training model...
2025-02-26 19:41:00,457 - INFO - Predicting on test data...
2025-02-26 19:41:00,470 - INFO - Classification report:
{
  "DNS": {
    "precision": 0.9928571428571429,
    "recall": 1.0,
    "f1-score": 0.996415770609319,
    "support": 139.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 26.0
  },
  "SSH": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "accuracy": 0.9939759036144579,
  "macro avg": {
    "precision": 0.6642857142857143,
    "recall": 0.6666666666666666,
    "f1-score": 0.6654719235364396,
    "support": 166.0
  },
  "weighted avg": {
    "precision": 0.9879948364888125,
    "recall": 0.9939759036144579,
    "f1-score": 0.9909746512933455,
    "support": 166.0
  }
}
2025-02-26 19:41:00,477 - INFO - Saved processed data locally to processed_data_20250226_194100.csv
2025-02-26 19:41:00,479 - INFO - JSON data size: 406508 bytes
2025-02-26 19:41:00,479 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:41:00,479 - INFO - Data sent successfully!
2025-02-26 19:41:00,479 - INFO - Data processing and transmission completed successfully
2025-02-26 19:41:00,480 - INFO - Starting data processing
2025-02-26 19:41:00,481 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:41:00,481 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:41:00,482 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:41:00,482 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:41:00,584 - INFO - Broker version identified as 2.5.0
2025-02-26 19:41:00,584 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:41:00,584 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:41:00,584 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:41:00,584 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:41:00,585 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:41:00,585 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:41:00,586 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:41:00,586 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:41:00,738 - INFO - Received 100 messages so far
2025-02-26 19:41:00,739 - INFO - Received 200 messages so far
2025-02-26 19:41:00,739 - INFO - Received 300 messages so far
2025-02-26 19:41:00,739 - INFO - Received 400 messages so far
2025-02-26 19:41:00,739 - INFO - Received 500 messages so far
2025-02-26 19:41:00,739 - INFO - Received 600 messages so far
2025-02-26 19:41:00,740 - INFO - Received 700 messages so far
2025-02-26 19:41:00,740 - INFO - Received 800 messages so far
2025-02-26 19:41:00,740 - INFO - Received 900 messages so far
2025-02-26 19:41:00,740 - INFO - Received 1000 messages so far
2025-02-26 19:41:00,740 - INFO - Received 1100 messages so far
2025-02-26 19:41:00,740 - INFO - Received 1200 messages so far
2025-02-26 19:41:00,741 - INFO - Received 1300 messages so far
2025-02-26 19:41:00,741 - INFO - Received 1400 messages so far
2025-02-26 19:41:00,741 - INFO - Received 1500 messages so far
2025-02-26 19:41:00,741 - INFO - Received 1600 messages so far
2025-02-26 19:41:00,741 - INFO - Received 1700 messages so far
2025-02-26 19:41:00,742 - INFO - Received 1800 messages so far
2025-02-26 19:41:00,742 - INFO - Received 1900 messages so far
2025-02-26 19:41:00,742 - INFO - Received 2000 messages so far
2025-02-26 19:41:00,742 - INFO - Received 2100 messages so far
2025-02-26 19:41:00,742 - INFO - Received 2200 messages so far
2025-02-26 19:41:00,743 - INFO - Received 2300 messages so far
2025-02-26 19:41:00,743 - INFO - Received 2400 messages so far
2025-02-26 19:41:00,743 - INFO - Received 2500 messages so far
2025-02-26 19:41:00,743 - INFO - Received 2600 messages so far
2025-02-26 19:41:00,743 - INFO - Received 2700 messages so far
2025-02-26 19:41:00,744 - INFO - Received 2800 messages so far
2025-02-26 19:41:00,744 - INFO - Received 2900 messages so far
2025-02-26 19:41:00,744 - INFO - Received 3000 messages so far
2025-02-26 19:41:00,744 - INFO - Received 3100 messages so far
2025-02-26 19:41:00,744 - INFO - Received 3200 messages so far
2025-02-26 19:41:00,745 - INFO - Received 3300 messages so far
2025-02-26 19:41:00,745 - INFO - Received 3400 messages so far
2025-02-26 19:41:00,745 - INFO - Received 3500 messages so far
2025-02-26 19:41:00,745 - INFO - Received 3600 messages so far
2025-02-26 19:41:00,746 - INFO - Received 3700 messages so far
2025-02-26 19:41:00,746 - INFO - Received 3800 messages so far
2025-02-26 19:41:00,746 - INFO - Received 3900 messages so far
2025-02-26 19:41:00,746 - INFO - Received 4000 messages so far
2025-02-26 19:41:00,746 - INFO - Received 4100 messages so far
2025-02-26 19:41:00,802 - INFO - Received 4200 messages so far
2025-02-26 19:41:00,802 - INFO - Received 4300 messages so far
2025-02-26 19:41:00,802 - INFO - Received 4400 messages so far
2025-02-26 19:41:00,802 - INFO - Received 4500 messages so far
2025-02-26 19:41:00,802 - INFO - Received 4600 messages so far
2025-02-26 19:41:00,803 - INFO - Received 4700 messages so far
2025-02-26 19:41:00,803 - INFO - Received 4800 messages so far
2025-02-26 19:41:00,803 - INFO - Received 4900 messages so far
2025-02-26 19:41:00,803 - INFO - Received 5000 messages so far
2025-02-26 19:41:00,803 - INFO - Received 5100 messages so far
2025-02-26 19:41:00,804 - INFO - Received 5200 messages so far
2025-02-26 19:41:00,804 - INFO - Received 5300 messages so far
2025-02-26 19:41:00,804 - INFO - Received 5400 messages so far
2025-02-26 19:41:00,804 - INFO - Received 5500 messages so far
2025-02-26 19:41:00,804 - INFO - Received 5600 messages so far
2025-02-26 19:41:00,805 - INFO - Received 5700 messages so far
2025-02-26 19:41:00,805 - INFO - Received 5800 messages so far
2025-02-26 19:41:00,805 - INFO - Received 5900 messages so far
2025-02-26 19:41:00,805 - INFO - Received 6000 messages so far
2025-02-26 19:41:00,805 - INFO - Received 6100 messages so far
2025-02-26 19:41:00,806 - INFO - Received 6200 messages so far
2025-02-26 19:41:00,806 - INFO - Received 6300 messages so far
2025-02-26 19:41:00,806 - INFO - Received 6400 messages so far
2025-02-26 19:41:00,806 - INFO - Received 6500 messages so far
2025-02-26 19:41:00,806 - INFO - Received 6600 messages so far
2025-02-26 19:41:00,807 - INFO - Received 6700 messages so far
2025-02-26 19:41:00,807 - INFO - Received 6800 messages so far
2025-02-26 19:41:00,807 - INFO - Received 6900 messages so far
2025-02-26 19:41:00,807 - INFO - Received 7000 messages so far
2025-02-26 19:41:00,807 - INFO - Received 7100 messages so far
2025-02-26 19:41:00,808 - INFO - Received 7200 messages so far
2025-02-26 19:41:00,808 - INFO - Received 7300 messages so far
2025-02-26 19:41:00,808 - INFO - Received 7400 messages so far
2025-02-26 19:41:00,808 - INFO - Received 7500 messages so far
2025-02-26 19:41:00,808 - INFO - Received 7600 messages so far
2025-02-26 19:41:00,809 - INFO - Received 7700 messages so far
2025-02-26 19:41:00,809 - INFO - Received 7800 messages so far
2025-02-26 19:41:00,809 - INFO - Received 7900 messages so far
2025-02-26 19:41:00,809 - INFO - Received 8000 messages so far
2025-02-26 19:41:00,809 - INFO - Received 8100 messages so far
2025-02-26 19:41:00,810 - INFO - Received 8200 messages so far
2025-02-26 19:41:00,810 - INFO - Received 8300 messages so far
2025-02-26 19:41:00,810 - INFO - Received 8400 messages so far
2025-02-26 19:41:00,810 - INFO - Received 8500 messages so far
2025-02-26 19:41:00,811 - INFO - Received 8600 messages so far
2025-02-26 19:41:00,811 - INFO - Received 8700 messages so far
2025-02-26 19:41:00,909 - INFO - Received 8800 messages so far
2025-02-26 19:41:00,910 - INFO - Received 8900 messages so far
2025-02-26 19:41:00,910 - INFO - Received 9000 messages so far
2025-02-26 19:41:00,910 - INFO - Received 9100 messages so far
2025-02-26 19:41:00,910 - INFO - Received 9200 messages so far
2025-02-26 19:41:00,910 - INFO - Received 9300 messages so far
2025-02-26 19:41:00,911 - INFO - Received 9400 messages so far
2025-02-26 19:41:00,911 - INFO - Received 9500 messages so far
2025-02-26 19:41:00,911 - INFO - Received 9600 messages so far
2025-02-26 19:41:00,911 - INFO - Received 9700 messages so far
2025-02-26 19:41:00,911 - INFO - Received 9800 messages so far
2025-02-26 19:41:00,912 - INFO - Received 9900 messages so far
2025-02-26 19:41:00,912 - INFO - Received 10000 messages so far
2025-02-26 19:41:00,912 - INFO - Total messages consumed: 10000
2025-02-26 19:41:01,001 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:41:01,004 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:01,005 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:41:01,005 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:01,005 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:41:01,012 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:41:01,016 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:41:01,016 - INFO - Number of columns: 66
2025-02-26 19:41:01,027 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                   query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                                                                                                                                                                                                                                                                          answers                                                   TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
2026        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
843        53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740118e+09      NaN  NaN     NaN  CJFSeC2L0eLu4Zblfh    38634.0  0.001972  iup0-my.sharepoint.com     1.0  C_INTERNET    1.0          A    0.0    NOERROR  False  False  True  True  0.0  [iup0.sharepoint.com, 5711-ipv4v6e.clump.dprodmgd105.aa-rt.sharepoint.com, 193491-ipv4v6e.farm.dprodmgd105.aa-rt.sharepoint.com, 193491-ipv4v6e.farm.dprodmgd105.sharepointonline.com.akadns.net, 193491-ipv4v6.farm.dprodmgd105.aa-rt.sharepoint.com.dual-spo-0005.spo-msedge.net, dual-spo-0005.spo-msedge.net, 13.107.138.10, 13.107.136.10]  [2424.0, 2340.0, 50.0, 50.0, 252.0, 46.0, 46.0, 46.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8533     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  C2SHiC4ArTkfsgN0Wa    40612.0       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                    NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000530     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1485        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3888       53.0  192.168.1.3  192.168.1.1   udp        62.0       396.0  1.740119e+09      NaN  NaN     dns  CR6ErD23BumUeXUaD6    46684.0       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                    NaN      NaN         SF       True       True           0.0      Dd        1.0           90.0        1.0          424.0      17.0  0.001906     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:41:01,028 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:41:01,059 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:41:01,102 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    0ac96b6b462a8d5d              eac96b6b462a8d5d  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:41:01,103 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.    22.   443.  1900.   123.    80. 21116.
 21115.   134.   138.   136.     0.   133.   547.    67.   135.]
2025-02-26 19:41:01,104 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:41:01,109 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:01,110 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:41:01,111 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:41:01,113 - INFO - DataFrame shape after NA dropping: (832, 23)
2025-02-26 19:41:01,113 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:41:01,113 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:41:01,113 - INFO - X shape: (832, 21), y shape: (832,)
2025-02-26 19:41:01,114 - INFO - Label distribution in training data: {'DNS': 694, 'HTTPS': 126, 'HTTP': 12}
2025-02-26 19:41:01,115 - INFO - Training model...
2025-02-26 19:41:01,228 - INFO - Predicting on test data...
2025-02-26 19:41:01,240 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 147.0
  },
  "HTTP": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 0.95,
    "recall": 1.0,
    "f1-score": 0.9743589743589743,
    "support": 19.0
  },
  "accuracy": 0.9940119760479041,
  "macro avg": {
    "precision": 0.65,
    "recall": 0.6666666666666666,
    "f1-score": 0.6581196581196581,
    "support": 167.0
  },
  "weighted avg": {
    "precision": 0.9883233532934133,
    "recall": 0.9940119760479041,
    "f1-score": 0.9910947336097036,
    "support": 167.0
  }
}
2025-02-26 19:41:01,247 - INFO - Saved processed data locally to processed_data_20250226_194101.csv
2025-02-26 19:41:01,249 - INFO - JSON data size: 408131 bytes
2025-02-26 19:41:01,249 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:41:01,249 - INFO - Data sent successfully!
2025-02-26 19:41:01,249 - INFO - Data processing and transmission completed successfully
2025-02-26 19:41:01,250 - INFO - Starting data processing
2025-02-26 19:41:01,250 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:41:01,251 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:41:01,251 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:41:01,252 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:41:01,353 - INFO - Broker version identified as 2.5.0
2025-02-26 19:41:01,353 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:41:01,354 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:41:01,354 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:41:01,354 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:41:01,355 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:41:01,355 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:41:01,355 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:41:01,355 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:41:01,508 - INFO - Received 100 messages so far
2025-02-26 19:41:01,508 - INFO - Received 200 messages so far
2025-02-26 19:41:01,508 - INFO - Received 300 messages so far
2025-02-26 19:41:01,508 - INFO - Received 400 messages so far
2025-02-26 19:41:01,508 - INFO - Received 500 messages so far
2025-02-26 19:41:01,509 - INFO - Received 600 messages so far
2025-02-26 19:41:01,509 - INFO - Received 700 messages so far
2025-02-26 19:41:01,509 - INFO - Received 800 messages so far
2025-02-26 19:41:01,509 - INFO - Received 900 messages so far
2025-02-26 19:41:01,509 - INFO - Received 1000 messages so far
2025-02-26 19:41:01,510 - INFO - Received 1100 messages so far
2025-02-26 19:41:01,510 - INFO - Received 1200 messages so far
2025-02-26 19:41:01,510 - INFO - Received 1300 messages so far
2025-02-26 19:41:01,510 - INFO - Received 1400 messages so far
2025-02-26 19:41:01,510 - INFO - Received 1500 messages so far
2025-02-26 19:41:01,511 - INFO - Received 1600 messages so far
2025-02-26 19:41:01,511 - INFO - Received 1700 messages so far
2025-02-26 19:41:01,511 - INFO - Received 1800 messages so far
2025-02-26 19:41:01,511 - INFO - Received 1900 messages so far
2025-02-26 19:41:01,511 - INFO - Received 2000 messages so far
2025-02-26 19:41:01,512 - INFO - Received 2100 messages so far
2025-02-26 19:41:01,512 - INFO - Received 2200 messages so far
2025-02-26 19:41:01,512 - INFO - Received 2300 messages so far
2025-02-26 19:41:01,512 - INFO - Received 2400 messages so far
2025-02-26 19:41:01,512 - INFO - Received 2500 messages so far
2025-02-26 19:41:01,513 - INFO - Received 2600 messages so far
2025-02-26 19:41:01,513 - INFO - Received 2700 messages so far
2025-02-26 19:41:01,513 - INFO - Received 2800 messages so far
2025-02-26 19:41:01,513 - INFO - Received 2900 messages so far
2025-02-26 19:41:01,513 - INFO - Received 3000 messages so far
2025-02-26 19:41:01,514 - INFO - Received 3100 messages so far
2025-02-26 19:41:01,514 - INFO - Received 3200 messages so far
2025-02-26 19:41:01,514 - INFO - Received 3300 messages so far
2025-02-26 19:41:01,514 - INFO - Received 3400 messages so far
2025-02-26 19:41:01,514 - INFO - Received 3500 messages so far
2025-02-26 19:41:01,514 - INFO - Received 3600 messages so far
2025-02-26 19:41:01,515 - INFO - Received 3700 messages so far
2025-02-26 19:41:01,515 - INFO - Received 3800 messages so far
2025-02-26 19:41:01,515 - INFO - Received 3900 messages so far
2025-02-26 19:41:01,515 - INFO - Received 4000 messages so far
2025-02-26 19:41:01,516 - INFO - Received 4100 messages so far
2025-02-26 19:41:01,568 - INFO - Received 4200 messages so far
2025-02-26 19:41:01,569 - INFO - Received 4300 messages so far
2025-02-26 19:41:01,569 - INFO - Received 4400 messages so far
2025-02-26 19:41:01,569 - INFO - Received 4500 messages so far
2025-02-26 19:41:01,569 - INFO - Received 4600 messages so far
2025-02-26 19:41:01,569 - INFO - Received 4700 messages so far
2025-02-26 19:41:01,570 - INFO - Received 4800 messages so far
2025-02-26 19:41:01,570 - INFO - Received 4900 messages so far
2025-02-26 19:41:01,570 - INFO - Received 5000 messages so far
2025-02-26 19:41:01,570 - INFO - Received 5100 messages so far
2025-02-26 19:41:01,570 - INFO - Received 5200 messages so far
2025-02-26 19:41:01,571 - INFO - Received 5300 messages so far
2025-02-26 19:41:01,571 - INFO - Received 5400 messages so far
2025-02-26 19:41:01,571 - INFO - Received 5500 messages so far
2025-02-26 19:41:01,571 - INFO - Received 5600 messages so far
2025-02-26 19:41:01,571 - INFO - Received 5700 messages so far
2025-02-26 19:41:01,572 - INFO - Received 5800 messages so far
2025-02-26 19:41:01,572 - INFO - Received 5900 messages so far
2025-02-26 19:41:01,572 - INFO - Received 6000 messages so far
2025-02-26 19:41:01,572 - INFO - Received 6100 messages so far
2025-02-26 19:41:01,572 - INFO - Received 6200 messages so far
2025-02-26 19:41:01,573 - INFO - Received 6300 messages so far
2025-02-26 19:41:01,573 - INFO - Received 6400 messages so far
2025-02-26 19:41:01,573 - INFO - Received 6500 messages so far
2025-02-26 19:41:01,573 - INFO - Received 6600 messages so far
2025-02-26 19:41:01,573 - INFO - Received 6700 messages so far
2025-02-26 19:41:01,574 - INFO - Received 6800 messages so far
2025-02-26 19:41:01,574 - INFO - Received 6900 messages so far
2025-02-26 19:41:01,574 - INFO - Received 7000 messages so far
2025-02-26 19:41:01,574 - INFO - Received 7100 messages so far
2025-02-26 19:41:01,574 - INFO - Received 7200 messages so far
2025-02-26 19:41:01,575 - INFO - Received 7300 messages so far
2025-02-26 19:41:01,575 - INFO - Received 7400 messages so far
2025-02-26 19:41:01,575 - INFO - Received 7500 messages so far
2025-02-26 19:41:01,575 - INFO - Received 7600 messages so far
2025-02-26 19:41:01,575 - INFO - Received 7700 messages so far
2025-02-26 19:41:01,575 - INFO - Received 7800 messages so far
2025-02-26 19:41:01,576 - INFO - Received 7900 messages so far
2025-02-26 19:41:01,576 - INFO - Received 8000 messages so far
2025-02-26 19:41:01,576 - INFO - Received 8100 messages so far
2025-02-26 19:41:01,576 - INFO - Received 8200 messages so far
2025-02-26 19:41:01,576 - INFO - Received 8300 messages so far
2025-02-26 19:41:01,577 - INFO - Received 8400 messages so far
2025-02-26 19:41:01,577 - INFO - Received 8500 messages so far
2025-02-26 19:41:01,577 - INFO - Received 8600 messages so far
2025-02-26 19:41:01,577 - INFO - Received 8700 messages so far
2025-02-26 19:41:01,637 - INFO - Received 8800 messages so far
2025-02-26 19:41:01,638 - INFO - Received 8900 messages so far
2025-02-26 19:41:01,638 - INFO - Received 9000 messages so far
2025-02-26 19:41:01,638 - INFO - Received 9100 messages so far
2025-02-26 19:41:01,638 - INFO - Received 9200 messages so far
2025-02-26 19:41:01,639 - INFO - Received 9300 messages so far
2025-02-26 19:41:01,639 - INFO - Received 9400 messages so far
2025-02-26 19:41:01,639 - INFO - Received 9500 messages so far
2025-02-26 19:41:01,639 - INFO - Received 9600 messages so far
2025-02-26 19:41:01,639 - INFO - Received 9700 messages so far
2025-02-26 19:41:01,640 - INFO - Received 9800 messages so far
2025-02-26 19:41:01,640 - INFO - Received 9900 messages so far
2025-02-26 19:41:01,640 - INFO - Received 10000 messages so far
2025-02-26 19:41:01,640 - INFO - Total messages consumed: 10000
2025-02-26 19:41:01,730 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:41:01,734 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:01,735 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:41:01,735 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:01,735 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:41:01,742 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:41:01,746 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:41:01,746 - INFO - Number of columns: 66
2025-02-26 19:41:01,756 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9825        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1541        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3770        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1314        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1499        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:41:01,756 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:41:01,787 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:41:01,831 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    1edec4bdcc72bfa6              fd390eb19a6c1898  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:41:01,831 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.   443.   123.   138. 21116. 21115.    80.
     0.  1900.   133.   134.   136.    67.   135.   547.    22.]
2025-02-26 19:41:01,832 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:41:01,837 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:01,839 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:41:01,839 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:41:01,841 - INFO - DataFrame shape after NA dropping: (775, 23)
2025-02-26 19:41:01,841 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:41:01,841 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:41:01,842 - INFO - X shape: (775, 21), y shape: (775,)
2025-02-26 19:41:01,842 - INFO - Label distribution in training data: {'DNS': 644, 'HTTPS': 118, 'HTTP': 12, 'SSH': 1}
2025-02-26 19:41:01,843 - INFO - Training model...
2025-02-26 19:41:01,952 - INFO - Predicting on test data...
2025-02-26 19:41:01,965 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 133.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 0.85,
    "recall": 1.0,
    "f1-score": 0.918918918918919,
    "support": 17.0
  },
  "SSH": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "accuracy": 0.9806451612903225,
  "macro avg": {
    "precision": 0.7125,
    "recall": 0.625,
    "f1-score": 0.6463963963963963,
    "support": 155.0
  },
  "weighted avg": {
    "precision": 0.9770967741935483,
    "recall": 0.9806451612903225,
    "f1-score": 0.9760534728276663,
    "support": 155.0
  }
}
2025-02-26 19:41:01,971 - INFO - Saved processed data locally to processed_data_20250226_194101.csv
2025-02-26 19:41:01,974 - INFO - JSON data size: 380935 bytes
2025-02-26 19:41:01,974 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:41:01,974 - INFO - Data sent successfully!
2025-02-26 19:41:01,974 - INFO - Data processing and transmission completed successfully
2025-02-26 19:41:01,975 - INFO - Starting data processing
2025-02-26 19:41:01,975 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:41:01,975 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:41:01,976 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:41:01,976 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:41:02,078 - INFO - Broker version identified as 2.5.0
2025-02-26 19:41:02,078 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:41:02,079 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:41:02,079 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:41:02,079 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:41:02,080 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:41:02,080 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:41:02,080 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:41:02,080 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:41:02,278 - INFO - Received 100 messages so far
2025-02-26 19:41:02,278 - INFO - Received 200 messages so far
2025-02-26 19:41:02,278 - INFO - Received 300 messages so far
2025-02-26 19:41:02,278 - INFO - Received 400 messages so far
2025-02-26 19:41:02,279 - INFO - Received 500 messages so far
2025-02-26 19:41:02,279 - INFO - Received 600 messages so far
2025-02-26 19:41:02,279 - INFO - Received 700 messages so far
2025-02-26 19:41:02,279 - INFO - Received 800 messages so far
2025-02-26 19:41:02,279 - INFO - Received 900 messages so far
2025-02-26 19:41:02,280 - INFO - Received 1000 messages so far
2025-02-26 19:41:02,280 - INFO - Received 1100 messages so far
2025-02-26 19:41:02,280 - INFO - Received 1200 messages so far
2025-02-26 19:41:02,280 - INFO - Received 1300 messages so far
2025-02-26 19:41:02,280 - INFO - Received 1400 messages so far
2025-02-26 19:41:02,281 - INFO - Received 1500 messages so far
2025-02-26 19:41:02,281 - INFO - Received 1600 messages so far
2025-02-26 19:41:02,281 - INFO - Received 1700 messages so far
2025-02-26 19:41:02,281 - INFO - Received 1800 messages so far
2025-02-26 19:41:02,281 - INFO - Received 1900 messages so far
2025-02-26 19:41:02,282 - INFO - Received 2000 messages so far
2025-02-26 19:41:02,282 - INFO - Received 2100 messages so far
2025-02-26 19:41:02,282 - INFO - Received 2200 messages so far
2025-02-26 19:41:02,282 - INFO - Received 2300 messages so far
2025-02-26 19:41:02,282 - INFO - Received 2400 messages so far
2025-02-26 19:41:02,283 - INFO - Received 2500 messages so far
2025-02-26 19:41:02,283 - INFO - Received 2600 messages so far
2025-02-26 19:41:02,283 - INFO - Received 2700 messages so far
2025-02-26 19:41:02,283 - INFO - Received 2800 messages so far
2025-02-26 19:41:02,283 - INFO - Received 2900 messages so far
2025-02-26 19:41:02,284 - INFO - Received 3000 messages so far
2025-02-26 19:41:02,284 - INFO - Received 3100 messages so far
2025-02-26 19:41:02,284 - INFO - Received 3200 messages so far
2025-02-26 19:41:02,284 - INFO - Received 3300 messages so far
2025-02-26 19:41:02,284 - INFO - Received 3400 messages so far
2025-02-26 19:41:02,285 - INFO - Received 3500 messages so far
2025-02-26 19:41:02,285 - INFO - Received 3600 messages so far
2025-02-26 19:41:02,285 - INFO - Received 3700 messages so far
2025-02-26 19:41:02,285 - INFO - Received 3800 messages so far
2025-02-26 19:41:02,285 - INFO - Received 3900 messages so far
2025-02-26 19:41:02,286 - INFO - Received 4000 messages so far
2025-02-26 19:41:02,286 - INFO - Received 4100 messages so far
2025-02-26 19:41:02,341 - INFO - Received 4200 messages so far
2025-02-26 19:41:02,341 - INFO - Received 4300 messages so far
2025-02-26 19:41:02,341 - INFO - Received 4400 messages so far
2025-02-26 19:41:02,342 - INFO - Received 4500 messages so far
2025-02-26 19:41:02,342 - INFO - Received 4600 messages so far
2025-02-26 19:41:02,342 - INFO - Received 4700 messages so far
2025-02-26 19:41:02,342 - INFO - Received 4800 messages so far
2025-02-26 19:41:02,342 - INFO - Received 4900 messages so far
2025-02-26 19:41:02,343 - INFO - Received 5000 messages so far
2025-02-26 19:41:02,343 - INFO - Received 5100 messages so far
2025-02-26 19:41:02,343 - INFO - Received 5200 messages so far
2025-02-26 19:41:02,343 - INFO - Received 5300 messages so far
2025-02-26 19:41:02,343 - INFO - Received 5400 messages so far
2025-02-26 19:41:02,344 - INFO - Received 5500 messages so far
2025-02-26 19:41:02,344 - INFO - Received 5600 messages so far
2025-02-26 19:41:02,344 - INFO - Received 5700 messages so far
2025-02-26 19:41:02,344 - INFO - Received 5800 messages so far
2025-02-26 19:41:02,344 - INFO - Received 5900 messages so far
2025-02-26 19:41:02,345 - INFO - Received 6000 messages so far
2025-02-26 19:41:02,345 - INFO - Received 6100 messages so far
2025-02-26 19:41:02,345 - INFO - Received 6200 messages so far
2025-02-26 19:41:02,345 - INFO - Received 6300 messages so far
2025-02-26 19:41:02,345 - INFO - Received 6400 messages so far
2025-02-26 19:41:02,346 - INFO - Received 6500 messages so far
2025-02-26 19:41:02,346 - INFO - Received 6600 messages so far
2025-02-26 19:41:02,346 - INFO - Received 6700 messages so far
2025-02-26 19:41:02,346 - INFO - Received 6800 messages so far
2025-02-26 19:41:02,346 - INFO - Received 6900 messages so far
2025-02-26 19:41:02,347 - INFO - Received 7000 messages so far
2025-02-26 19:41:02,347 - INFO - Received 7100 messages so far
2025-02-26 19:41:02,347 - INFO - Received 7200 messages so far
2025-02-26 19:41:02,347 - INFO - Received 7300 messages so far
2025-02-26 19:41:02,347 - INFO - Received 7400 messages so far
2025-02-26 19:41:02,348 - INFO - Received 7500 messages so far
2025-02-26 19:41:02,348 - INFO - Received 7600 messages so far
2025-02-26 19:41:02,348 - INFO - Received 7700 messages so far
2025-02-26 19:41:02,348 - INFO - Received 7800 messages so far
2025-02-26 19:41:02,348 - INFO - Received 7900 messages so far
2025-02-26 19:41:02,348 - INFO - Received 8000 messages so far
2025-02-26 19:41:02,349 - INFO - Received 8100 messages so far
2025-02-26 19:41:02,349 - INFO - Received 8200 messages so far
2025-02-26 19:41:02,349 - INFO - Received 8300 messages so far
2025-02-26 19:41:02,349 - INFO - Received 8400 messages so far
2025-02-26 19:41:02,349 - INFO - Received 8500 messages so far
2025-02-26 19:41:02,350 - INFO - Received 8600 messages so far
2025-02-26 19:41:02,350 - INFO - Received 8700 messages so far
2025-02-26 19:41:02,405 - INFO - Received 8800 messages so far
2025-02-26 19:41:02,406 - INFO - Received 8900 messages so far
2025-02-26 19:41:02,406 - INFO - Received 9000 messages so far
2025-02-26 19:41:02,406 - INFO - Received 9100 messages so far
2025-02-26 19:41:02,406 - INFO - Received 9200 messages so far
2025-02-26 19:41:02,406 - INFO - Received 9300 messages so far
2025-02-26 19:41:02,407 - INFO - Received 9400 messages so far
2025-02-26 19:41:02,407 - INFO - Received 9500 messages so far
2025-02-26 19:41:02,407 - INFO - Received 9600 messages so far
2025-02-26 19:41:02,407 - INFO - Received 9700 messages so far
2025-02-26 19:41:02,407 - INFO - Received 9800 messages so far
2025-02-26 19:41:02,407 - INFO - Received 9900 messages so far
2025-02-26 19:41:02,408 - INFO - Received 10000 messages so far
2025-02-26 19:41:02,408 - INFO - Total messages consumed: 10000
2025-02-26 19:41:02,495 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:41:02,499 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:02,499 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:41:02,499 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:02,499 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:41:02,507 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:41:02,510 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:41:02,510 - INFO - Number of columns: 66
2025-02-26 19:41:02,522 - INFO - DataFrame head:
      id.resp_p    id.orig_h      id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                             query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                              answers          TTLs rejected conn_state local_orig local_resp  missed_bytes   history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto    duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3286     9092.0  192.168.1.3    192.168.1.4   tcp         0.0         0.0  1.740119e+09      NaN  NaN     NaN  CMBxrw2UMsxqyrWcJ5    57842.0       NaN                               NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                  NaN           NaN      NaN        REJ       True       True           0.0        Sr        1.0           60.0        1.0           40.0       6.0    0.000555     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1415      443.0  192.168.1.3  104.18.32.137   tcp     13530.0      4252.0  1.740118e+09      NaN  NaN     ssl   CGsm4yg3HP6MYnZec    52878.0       NaN                               NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                  NaN           NaN      NaN         SF       True      False           0.0  ShADadFf       24.0        14786.0       20.0         5300.0       6.0  283.614018     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8904        NaN          NaN            NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN       NaN                               NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                  NaN           NaN      NaN        NaN        NaN        NaN           NaN       NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7382        NaN          NaN            NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                               NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                  NaN           NaN      NaN        NaN        NaN        NaN           NaN       NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1655       53.0  192.168.1.3    192.168.1.1   udp         NaN         NaN  1.740118e+09      NaN  NaN     NaN  CHW8X31pPxSRVsLSh1    35086.0  0.002415  mobile.events.data.microsoft.com     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  True  0.0  [mobile.events.data.trafficmanager.net, onedscolprdwus17.westus.cloudapp.azure.com]  [95.0, 19.0]    False        NaN        NaN        NaN           NaN       NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:41:02,522 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:41:02,552 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:41:02,597 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    fb5090d671c8a979              fb5090d671c8a979  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:41:02,597 - INFO - Unique values in 'id.resp_p' before labeling: [ 9092.   443.    nan    53.  5353.  1900.   133.   123.   135.   138.
    80. 21116.   136.    22.    67.   134.     0.   547. 21115.]
2025-02-26 19:41:02,598 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:41:02,603 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:02,605 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:41:02,605 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:41:02,607 - INFO - DataFrame shape after NA dropping: (900, 23)
2025-02-26 19:41:02,607 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:41:02,607 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:41:02,608 - INFO - X shape: (900, 21), y shape: (900,)
2025-02-26 19:41:02,608 - INFO - Label distribution in training data: {'DNS': 752, 'HTTPS': 133, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:02,609 - INFO - Training model...
2025-02-26 19:41:02,724 - INFO - Predicting on test data...
2025-02-26 19:41:02,738 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 153.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 2.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 25.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 180.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 180.0
  }
}
2025-02-26 19:41:02,745 - INFO - Saved processed data locally to processed_data_20250226_194102.csv
2025-02-26 19:41:02,748 - INFO - JSON data size: 440834 bytes
2025-02-26 19:41:02,748 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:41:02,748 - INFO - Data sent successfully!
2025-02-26 19:41:02,748 - INFO - Data processing and transmission completed successfully
2025-02-26 19:41:02,749 - INFO - Starting data processing
2025-02-26 19:41:02,749 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:41:02,750 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:41:02,751 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:41:02,751 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:41:02,853 - INFO - Broker version identified as 2.5.0
2025-02-26 19:41:02,853 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:41:02,853 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:41:02,853 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:41:02,853 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:41:02,854 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:41:02,854 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:41:02,855 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:41:02,855 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:41:03,008 - INFO - Received 100 messages so far
2025-02-26 19:41:03,008 - INFO - Received 200 messages so far
2025-02-26 19:41:03,008 - INFO - Received 300 messages so far
2025-02-26 19:41:03,009 - INFO - Received 400 messages so far
2025-02-26 19:41:03,009 - INFO - Received 500 messages so far
2025-02-26 19:41:03,009 - INFO - Received 600 messages so far
2025-02-26 19:41:03,009 - INFO - Received 700 messages so far
2025-02-26 19:41:03,009 - INFO - Received 800 messages so far
2025-02-26 19:41:03,010 - INFO - Received 900 messages so far
2025-02-26 19:41:03,010 - INFO - Received 1000 messages so far
2025-02-26 19:41:03,010 - INFO - Received 1100 messages so far
2025-02-26 19:41:03,010 - INFO - Received 1200 messages so far
2025-02-26 19:41:03,010 - INFO - Received 1300 messages so far
2025-02-26 19:41:03,011 - INFO - Received 1400 messages so far
2025-02-26 19:41:03,011 - INFO - Received 1500 messages so far
2025-02-26 19:41:03,011 - INFO - Received 1600 messages so far
2025-02-26 19:41:03,011 - INFO - Received 1700 messages so far
2025-02-26 19:41:03,011 - INFO - Received 1800 messages so far
2025-02-26 19:41:03,011 - INFO - Received 1900 messages so far
2025-02-26 19:41:03,012 - INFO - Received 2000 messages so far
2025-02-26 19:41:03,012 - INFO - Received 2100 messages so far
2025-02-26 19:41:03,012 - INFO - Received 2200 messages so far
2025-02-26 19:41:03,012 - INFO - Received 2300 messages so far
2025-02-26 19:41:03,012 - INFO - Received 2400 messages so far
2025-02-26 19:41:03,013 - INFO - Received 2500 messages so far
2025-02-26 19:41:03,013 - INFO - Received 2600 messages so far
2025-02-26 19:41:03,013 - INFO - Received 2700 messages so far
2025-02-26 19:41:03,013 - INFO - Received 2800 messages so far
2025-02-26 19:41:03,013 - INFO - Received 2900 messages so far
2025-02-26 19:41:03,014 - INFO - Received 3000 messages so far
2025-02-26 19:41:03,014 - INFO - Received 3100 messages so far
2025-02-26 19:41:03,014 - INFO - Received 3200 messages so far
2025-02-26 19:41:03,014 - INFO - Received 3300 messages so far
2025-02-26 19:41:03,014 - INFO - Received 3400 messages so far
2025-02-26 19:41:03,015 - INFO - Received 3500 messages so far
2025-02-26 19:41:03,015 - INFO - Received 3600 messages so far
2025-02-26 19:41:03,015 - INFO - Received 3700 messages so far
2025-02-26 19:41:03,015 - INFO - Received 3800 messages so far
2025-02-26 19:41:03,015 - INFO - Received 3900 messages so far
2025-02-26 19:41:03,016 - INFO - Received 4000 messages so far
2025-02-26 19:41:03,016 - INFO - Received 4100 messages so far
2025-02-26 19:41:03,119 - INFO - Received 4200 messages so far
2025-02-26 19:41:03,119 - INFO - Received 4300 messages so far
2025-02-26 19:41:03,119 - INFO - Received 4400 messages so far
2025-02-26 19:41:03,120 - INFO - Received 4500 messages so far
2025-02-26 19:41:03,120 - INFO - Received 4600 messages so far
2025-02-26 19:41:03,120 - INFO - Received 4700 messages so far
2025-02-26 19:41:03,120 - INFO - Received 4800 messages so far
2025-02-26 19:41:03,121 - INFO - Received 4900 messages so far
2025-02-26 19:41:03,121 - INFO - Received 5000 messages so far
2025-02-26 19:41:03,121 - INFO - Received 5100 messages so far
2025-02-26 19:41:03,121 - INFO - Received 5200 messages so far
2025-02-26 19:41:03,121 - INFO - Received 5300 messages so far
2025-02-26 19:41:03,122 - INFO - Received 5400 messages so far
2025-02-26 19:41:03,122 - INFO - Received 5500 messages so far
2025-02-26 19:41:03,122 - INFO - Received 5600 messages so far
2025-02-26 19:41:03,122 - INFO - Received 5700 messages so far
2025-02-26 19:41:03,123 - INFO - Received 5800 messages so far
2025-02-26 19:41:03,123 - INFO - Received 5900 messages so far
2025-02-26 19:41:03,123 - INFO - Received 6000 messages so far
2025-02-26 19:41:03,123 - INFO - Received 6100 messages so far
2025-02-26 19:41:03,123 - INFO - Received 6200 messages so far
2025-02-26 19:41:03,124 - INFO - Received 6300 messages so far
2025-02-26 19:41:03,124 - INFO - Received 6400 messages so far
2025-02-26 19:41:03,124 - INFO - Received 6500 messages so far
2025-02-26 19:41:03,124 - INFO - Received 6600 messages so far
2025-02-26 19:41:03,125 - INFO - Received 6700 messages so far
2025-02-26 19:41:03,125 - INFO - Received 6800 messages so far
2025-02-26 19:41:03,125 - INFO - Received 6900 messages so far
2025-02-26 19:41:03,125 - INFO - Received 7000 messages so far
2025-02-26 19:41:03,125 - INFO - Received 7100 messages so far
2025-02-26 19:41:03,126 - INFO - Received 7200 messages so far
2025-02-26 19:41:03,126 - INFO - Received 7300 messages so far
2025-02-26 19:41:03,126 - INFO - Received 7400 messages so far
2025-02-26 19:41:03,126 - INFO - Received 7500 messages so far
2025-02-26 19:41:03,127 - INFO - Received 7600 messages so far
2025-02-26 19:41:03,127 - INFO - Received 7700 messages so far
2025-02-26 19:41:03,127 - INFO - Received 7800 messages so far
2025-02-26 19:41:03,127 - INFO - Received 7900 messages so far
2025-02-26 19:41:03,127 - INFO - Received 8000 messages so far
2025-02-26 19:41:03,128 - INFO - Received 8100 messages so far
2025-02-26 19:41:03,128 - INFO - Received 8200 messages so far
2025-02-26 19:41:03,128 - INFO - Received 8300 messages so far
2025-02-26 19:41:03,128 - INFO - Received 8400 messages so far
2025-02-26 19:41:03,129 - INFO - Received 8500 messages so far
2025-02-26 19:41:03,129 - INFO - Received 8600 messages so far
2025-02-26 19:41:03,129 - INFO - Received 8700 messages so far
2025-02-26 19:41:03,187 - INFO - Received 8800 messages so far
2025-02-26 19:41:03,187 - INFO - Received 8900 messages so far
2025-02-26 19:41:03,187 - INFO - Received 9000 messages so far
2025-02-26 19:41:03,187 - INFO - Received 9100 messages so far
2025-02-26 19:41:03,188 - INFO - Received 9200 messages so far
2025-02-26 19:41:03,188 - INFO - Received 9300 messages so far
2025-02-26 19:41:03,188 - INFO - Received 9400 messages so far
2025-02-26 19:41:03,188 - INFO - Received 9500 messages so far
2025-02-26 19:41:03,188 - INFO - Received 9600 messages so far
2025-02-26 19:41:03,189 - INFO - Received 9700 messages so far
2025-02-26 19:41:03,189 - INFO - Received 9800 messages so far
2025-02-26 19:41:03,189 - INFO - Received 9900 messages so far
2025-02-26 19:41:03,189 - INFO - Received 10000 messages so far
2025-02-26 19:41:03,189 - INFO - Total messages consumed: 10000
2025-02-26 19:41:03,285 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:41:03,289 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:03,289 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:41:03,289 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:03,290 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:41:03,298 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:41:03,301 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:41:03,301 - INFO - Number of columns: 66
2025-02-26 19:41:03,312 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9023        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7866        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.008836     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6536        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7587        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.009721     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3904        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.007222     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:41:03,312 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:41:03,342 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:41:03,386 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    6b77933b392d05f9              eb77933b392d05f9  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:41:03,387 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443.  5353.   133.   123.  1900.    67.   138.
    80. 21115.   134.   547.    22.     0. 21116.   136.   135.]
2025-02-26 19:41:03,388 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:41:03,393 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:03,394 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:41:03,394 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:41:03,396 - INFO - DataFrame shape after NA dropping: (872, 23)
2025-02-26 19:41:03,396 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:41:03,396 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:41:03,397 - INFO - X shape: (872, 21), y shape: (872,)
2025-02-26 19:41:03,397 - INFO - Label distribution in training data: {'DNS': 727, 'HTTPS': 130, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:03,398 - INFO - Training model...
2025-02-26 19:41:03,506 - INFO - Predicting on test data...
2025-02-26 19:41:03,519 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 141.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.6666666666666666,
    "f1-score": 0.8,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.96875,
    "recall": 1.0,
    "f1-score": 0.9841269841269841,
    "support": 31.0
  },
  "accuracy": 0.9942857142857143,
  "macro avg": {
    "precision": 0.9895833333333334,
    "recall": 0.8888888888888888,
    "f1-score": 0.928042328042328,
    "support": 175.0
  },
  "weighted avg": {
    "precision": 0.9944642857142857,
    "recall": 0.9942857142857143,
    "f1-score": 0.9937596371882086,
    "support": 175.0
  }
}
2025-02-26 19:41:03,525 - INFO - Saved processed data locally to processed_data_20250226_194103.csv
2025-02-26 19:41:03,528 - INFO - JSON data size: 428295 bytes
2025-02-26 19:41:03,528 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 19:41:03,528 - INFO - Data sent successfully!
2025-02-26 19:41:03,528 - INFO - Data processing and transmission completed successfully
2025-02-26 19:41:03,529 - INFO - Starting data processing
2025-02-26 19:41:03,529 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 19:41:03,530 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 19:41:03,530 - INFO - Probing node bootstrap-0 broker version
2025-02-26 19:41:03,531 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 19:41:03,632 - INFO - Broker version identified as 2.5.0
2025-02-26 19:41:03,632 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 19:41:03,633 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 19:41:03,633 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 19:41:03,633 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 19:41:03,634 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 19:41:03,634 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 19:41:03,634 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 19:41:03,634 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 19:41:03,789 - INFO - Received 100 messages so far
2025-02-26 19:41:03,789 - INFO - Received 200 messages so far
2025-02-26 19:41:03,789 - INFO - Received 300 messages so far
2025-02-26 19:41:03,789 - INFO - Received 400 messages so far
2025-02-26 19:41:03,789 - INFO - Received 500 messages so far
2025-02-26 19:41:03,790 - INFO - Received 600 messages so far
2025-02-26 19:41:03,790 - INFO - Received 700 messages so far
2025-02-26 19:41:03,790 - INFO - Received 800 messages so far
2025-02-26 19:41:03,790 - INFO - Received 900 messages so far
2025-02-26 19:41:03,790 - INFO - Received 1000 messages so far
2025-02-26 19:41:03,791 - INFO - Received 1100 messages so far
2025-02-26 19:41:03,791 - INFO - Received 1200 messages so far
2025-02-26 19:41:03,791 - INFO - Received 1300 messages so far
2025-02-26 19:41:03,791 - INFO - Received 1400 messages so far
2025-02-26 19:41:03,791 - INFO - Received 1500 messages so far
2025-02-26 19:41:03,792 - INFO - Received 1600 messages so far
2025-02-26 19:41:03,792 - INFO - Received 1700 messages so far
2025-02-26 19:41:03,792 - INFO - Received 1800 messages so far
2025-02-26 19:41:03,792 - INFO - Received 1900 messages so far
2025-02-26 19:41:03,792 - INFO - Received 2000 messages so far
2025-02-26 19:41:03,793 - INFO - Received 2100 messages so far
2025-02-26 19:41:03,793 - INFO - Received 2200 messages so far
2025-02-26 19:41:03,793 - INFO - Received 2300 messages so far
2025-02-26 19:41:03,793 - INFO - Received 2400 messages so far
2025-02-26 19:41:03,793 - INFO - Received 2500 messages so far
2025-02-26 19:41:03,794 - INFO - Received 2600 messages so far
2025-02-26 19:41:03,794 - INFO - Received 2700 messages so far
2025-02-26 19:41:03,794 - INFO - Received 2800 messages so far
2025-02-26 19:41:03,794 - INFO - Received 2900 messages so far
2025-02-26 19:41:03,794 - INFO - Received 3000 messages so far
2025-02-26 19:41:03,795 - INFO - Received 3100 messages so far
2025-02-26 19:41:03,795 - INFO - Received 3200 messages so far
2025-02-26 19:41:03,795 - INFO - Received 3300 messages so far
2025-02-26 19:41:03,795 - INFO - Received 3400 messages so far
2025-02-26 19:41:03,795 - INFO - Received 3500 messages so far
2025-02-26 19:41:03,796 - INFO - Received 3600 messages so far
2025-02-26 19:41:03,796 - INFO - Received 3700 messages so far
2025-02-26 19:41:03,796 - INFO - Received 3800 messages so far
2025-02-26 19:41:03,796 - INFO - Received 3900 messages so far
2025-02-26 19:41:03,796 - INFO - Received 4000 messages so far
2025-02-26 19:41:03,797 - INFO - Received 4100 messages so far
2025-02-26 19:41:03,851 - INFO - Received 4200 messages so far
2025-02-26 19:41:03,852 - INFO - Received 4300 messages so far
2025-02-26 19:41:03,852 - INFO - Received 4400 messages so far
2025-02-26 19:41:03,852 - INFO - Received 4500 messages so far
2025-02-26 19:41:03,852 - INFO - Received 4600 messages so far
2025-02-26 19:41:03,853 - INFO - Received 4700 messages so far
2025-02-26 19:41:03,853 - INFO - Received 4800 messages so far
2025-02-26 19:41:03,853 - INFO - Received 4900 messages so far
2025-02-26 19:41:03,853 - INFO - Received 5000 messages so far
2025-02-26 19:41:03,853 - INFO - Received 5100 messages so far
2025-02-26 19:41:03,854 - INFO - Received 5200 messages so far
2025-02-26 19:41:03,854 - INFO - Received 5300 messages so far
2025-02-26 19:41:03,854 - INFO - Received 5400 messages so far
2025-02-26 19:41:03,854 - INFO - Received 5500 messages so far
2025-02-26 19:41:03,854 - INFO - Received 5600 messages so far
2025-02-26 19:41:03,855 - INFO - Received 5700 messages so far
2025-02-26 19:41:03,855 - INFO - Received 5800 messages so far
2025-02-26 19:41:03,855 - INFO - Received 5900 messages so far
2025-02-26 19:41:03,855 - INFO - Received 6000 messages so far
2025-02-26 19:41:03,855 - INFO - Received 6100 messages so far
2025-02-26 19:41:03,856 - INFO - Received 6200 messages so far
2025-02-26 19:41:03,856 - INFO - Received 6300 messages so far
2025-02-26 19:41:03,856 - INFO - Received 6400 messages so far
2025-02-26 19:41:03,856 - INFO - Received 6500 messages so far
2025-02-26 19:41:03,856 - INFO - Received 6600 messages so far
2025-02-26 19:41:03,856 - INFO - Received 6700 messages so far
2025-02-26 19:41:03,857 - INFO - Received 6800 messages so far
2025-02-26 19:41:03,857 - INFO - Received 6900 messages so far
2025-02-26 19:41:03,857 - INFO - Received 7000 messages so far
2025-02-26 19:41:03,857 - INFO - Received 7100 messages so far
2025-02-26 19:41:03,857 - INFO - Received 7200 messages so far
2025-02-26 19:41:03,858 - INFO - Received 7300 messages so far
2025-02-26 19:41:03,858 - INFO - Received 7400 messages so far
2025-02-26 19:41:03,858 - INFO - Received 7500 messages so far
2025-02-26 19:41:03,858 - INFO - Received 7600 messages so far
2025-02-26 19:41:03,858 - INFO - Received 7700 messages so far
2025-02-26 19:41:03,859 - INFO - Received 7800 messages so far
2025-02-26 19:41:03,859 - INFO - Received 7900 messages so far
2025-02-26 19:41:03,859 - INFO - Received 8000 messages so far
2025-02-26 19:41:03,859 - INFO - Received 8100 messages so far
2025-02-26 19:41:03,859 - INFO - Received 8200 messages so far
2025-02-26 19:41:03,860 - INFO - Received 8300 messages so far
2025-02-26 19:41:03,860 - INFO - Received 8400 messages so far
2025-02-26 19:41:03,860 - INFO - Received 8500 messages so far
2025-02-26 19:41:03,860 - INFO - Received 8600 messages so far
2025-02-26 19:41:03,861 - INFO - Received 8700 messages so far
2025-02-26 19:41:03,915 - INFO - Received 8800 messages so far
2025-02-26 19:41:03,915 - INFO - Received 8900 messages so far
2025-02-26 19:41:03,915 - INFO - Received 9000 messages so far
2025-02-26 19:41:03,916 - INFO - Received 9100 messages so far
2025-02-26 19:41:03,916 - INFO - Received 9200 messages so far
2025-02-26 19:41:03,916 - INFO - Received 9300 messages so far
2025-02-26 19:41:03,916 - INFO - Received 9400 messages so far
2025-02-26 19:41:03,916 - INFO - Received 9500 messages so far
2025-02-26 19:41:03,917 - INFO - Received 9600 messages so far
2025-02-26 19:41:03,917 - INFO - Received 9700 messages so far
2025-02-26 19:41:03,917 - INFO - Received 9800 messages so far
2025-02-26 19:41:03,917 - INFO - Received 9900 messages so far
2025-02-26 19:41:03,917 - INFO - Received 10000 messages so far
2025-02-26 19:41:03,918 - INFO - Total messages consumed: 10000
2025-02-26 19:41:04,002 - INFO - Messages converted to DataFrame successfully!
2025-02-26 19:41:04,006 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:04,006 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 19:41:04,006 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 19:41:04,007 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 19:41:04,014 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 19:41:04,018 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 19:41:04,018 - INFO - Number of columns: 66
2025-02-26 19:41:04,028 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
5080        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7426        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9539        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1836        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005324     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4707        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 19:41:04,028 - INFO - DataFrame shape: (10000, 66)
2025-02-26 19:41:04,059 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 19:41:04,144 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    b90b0ae34b0b9725              f90b0ae34b0b9725  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 19:41:04,145 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   443.   123.    80.  5353.   135.  1900.   138.
   134.   136.   133. 21116.    67.    22.     0.   547. 21115.]
2025-02-26 19:41:04,146 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 19:41:04,151 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:04,152 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 19:41:04,152 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 19:41:04,154 - INFO - DataFrame shape after NA dropping: (907, 23)
2025-02-26 19:41:04,154 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 19:41:04,154 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 19:41:04,155 - INFO - X shape: (907, 21), y shape: (907,)
2025-02-26 19:41:04,155 - INFO - Label distribution in training data: {'DNS': 758, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 19:41:04,156 - INFO - Training model...
2025-02-26 19:41:04,248 - INFO - Process interrupted by user.
2025-02-26 20:02:42,092 - INFO - Starting livepreprocessing_socket.py
2025-02-26 20:02:42,092 - INFO - Sending test message to socket server
2025-02-26 20:02:42,092 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:42,092 - INFO - Data sent successfully!
2025-02-26 20:02:42,092 - INFO - Test message sent successfully
2025-02-26 20:02:42,092 - INFO - Socket communication test successful, proceeding with data processing
2025-02-26 20:02:42,093 - INFO - Starting data processing
2025-02-26 20:02:42,093 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:42,094 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:42,094 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:42,094 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:42,196 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:42,197 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:42,197 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:42,197 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:42,197 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:42,198 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:42,198 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:42,199 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:42,199 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:42,357 - INFO - Received 100 messages so far
2025-02-26 20:02:42,357 - INFO - Received 200 messages so far
2025-02-26 20:02:42,357 - INFO - Received 300 messages so far
2025-02-26 20:02:42,357 - INFO - Received 400 messages so far
2025-02-26 20:02:42,357 - INFO - Received 500 messages so far
2025-02-26 20:02:42,358 - INFO - Received 600 messages so far
2025-02-26 20:02:42,358 - INFO - Received 700 messages so far
2025-02-26 20:02:42,358 - INFO - Received 800 messages so far
2025-02-26 20:02:42,359 - INFO - Received 900 messages so far
2025-02-26 20:02:42,359 - INFO - Received 1000 messages so far
2025-02-26 20:02:42,359 - INFO - Received 1100 messages so far
2025-02-26 20:02:42,359 - INFO - Received 1200 messages so far
2025-02-26 20:02:42,359 - INFO - Received 1300 messages so far
2025-02-26 20:02:42,360 - INFO - Received 1400 messages so far
2025-02-26 20:02:42,360 - INFO - Received 1500 messages so far
2025-02-26 20:02:42,360 - INFO - Received 1600 messages so far
2025-02-26 20:02:42,360 - INFO - Received 1700 messages so far
2025-02-26 20:02:42,360 - INFO - Received 1800 messages so far
2025-02-26 20:02:42,361 - INFO - Received 1900 messages so far
2025-02-26 20:02:42,361 - INFO - Received 2000 messages so far
2025-02-26 20:02:42,361 - INFO - Received 2100 messages so far
2025-02-26 20:02:42,361 - INFO - Received 2200 messages so far
2025-02-26 20:02:42,361 - INFO - Received 2300 messages so far
2025-02-26 20:02:42,362 - INFO - Received 2400 messages so far
2025-02-26 20:02:42,362 - INFO - Received 2500 messages so far
2025-02-26 20:02:42,362 - INFO - Received 2600 messages so far
2025-02-26 20:02:42,362 - INFO - Received 2700 messages so far
2025-02-26 20:02:42,362 - INFO - Received 2800 messages so far
2025-02-26 20:02:42,363 - INFO - Received 2900 messages so far
2025-02-26 20:02:42,363 - INFO - Received 3000 messages so far
2025-02-26 20:02:42,363 - INFO - Received 3100 messages so far
2025-02-26 20:02:42,363 - INFO - Received 3200 messages so far
2025-02-26 20:02:42,363 - INFO - Received 3300 messages so far
2025-02-26 20:02:42,364 - INFO - Received 3400 messages so far
2025-02-26 20:02:42,364 - INFO - Received 3500 messages so far
2025-02-26 20:02:42,364 - INFO - Received 3600 messages so far
2025-02-26 20:02:42,364 - INFO - Received 3700 messages so far
2025-02-26 20:02:42,364 - INFO - Received 3800 messages so far
2025-02-26 20:02:42,365 - INFO - Received 3900 messages so far
2025-02-26 20:02:42,365 - INFO - Received 4000 messages so far
2025-02-26 20:02:42,365 - INFO - Received 4100 messages so far
2025-02-26 20:02:42,424 - INFO - Received 4200 messages so far
2025-02-26 20:02:42,424 - INFO - Received 4300 messages so far
2025-02-26 20:02:42,424 - INFO - Received 4400 messages so far
2025-02-26 20:02:42,425 - INFO - Received 4500 messages so far
2025-02-26 20:02:42,425 - INFO - Received 4600 messages so far
2025-02-26 20:02:42,425 - INFO - Received 4700 messages so far
2025-02-26 20:02:42,426 - INFO - Received 4800 messages so far
2025-02-26 20:02:42,426 - INFO - Received 4900 messages so far
2025-02-26 20:02:42,426 - INFO - Received 5000 messages so far
2025-02-26 20:02:42,426 - INFO - Received 5100 messages so far
2025-02-26 20:02:42,426 - INFO - Received 5200 messages so far
2025-02-26 20:02:42,427 - INFO - Received 5300 messages so far
2025-02-26 20:02:42,427 - INFO - Received 5400 messages so far
2025-02-26 20:02:42,427 - INFO - Received 5500 messages so far
2025-02-26 20:02:42,427 - INFO - Received 5600 messages so far
2025-02-26 20:02:42,427 - INFO - Received 5700 messages so far
2025-02-26 20:02:42,428 - INFO - Received 5800 messages so far
2025-02-26 20:02:42,428 - INFO - Received 5900 messages so far
2025-02-26 20:02:42,428 - INFO - Received 6000 messages so far
2025-02-26 20:02:42,428 - INFO - Received 6100 messages so far
2025-02-26 20:02:42,428 - INFO - Received 6200 messages so far
2025-02-26 20:02:42,428 - INFO - Received 6300 messages so far
2025-02-26 20:02:42,429 - INFO - Received 6400 messages so far
2025-02-26 20:02:42,429 - INFO - Received 6500 messages so far
2025-02-26 20:02:42,429 - INFO - Received 6600 messages so far
2025-02-26 20:02:42,429 - INFO - Received 6700 messages so far
2025-02-26 20:02:42,429 - INFO - Received 6800 messages so far
2025-02-26 20:02:42,430 - INFO - Received 6900 messages so far
2025-02-26 20:02:42,430 - INFO - Received 7000 messages so far
2025-02-26 20:02:42,430 - INFO - Received 7100 messages so far
2025-02-26 20:02:42,430 - INFO - Received 7200 messages so far
2025-02-26 20:02:42,430 - INFO - Received 7300 messages so far
2025-02-26 20:02:42,431 - INFO - Received 7400 messages so far
2025-02-26 20:02:42,431 - INFO - Received 7500 messages so far
2025-02-26 20:02:42,431 - INFO - Received 7600 messages so far
2025-02-26 20:02:42,431 - INFO - Received 7700 messages so far
2025-02-26 20:02:42,431 - INFO - Received 7800 messages so far
2025-02-26 20:02:42,432 - INFO - Received 7900 messages so far
2025-02-26 20:02:42,432 - INFO - Received 8000 messages so far
2025-02-26 20:02:42,432 - INFO - Received 8100 messages so far
2025-02-26 20:02:42,432 - INFO - Received 8200 messages so far
2025-02-26 20:02:42,432 - INFO - Received 8300 messages so far
2025-02-26 20:02:42,433 - INFO - Received 8400 messages so far
2025-02-26 20:02:42,433 - INFO - Received 8500 messages so far
2025-02-26 20:02:42,433 - INFO - Received 8600 messages so far
2025-02-26 20:02:42,433 - INFO - Received 8700 messages so far
2025-02-26 20:02:42,527 - INFO - Received 8800 messages so far
2025-02-26 20:02:42,528 - INFO - Received 8900 messages so far
2025-02-26 20:02:42,528 - INFO - Received 9000 messages so far
2025-02-26 20:02:42,528 - INFO - Received 9100 messages so far
2025-02-26 20:02:42,528 - INFO - Received 9200 messages so far
2025-02-26 20:02:42,529 - INFO - Received 9300 messages so far
2025-02-26 20:02:42,529 - INFO - Received 9400 messages so far
2025-02-26 20:02:42,529 - INFO - Received 9500 messages so far
2025-02-26 20:02:42,529 - INFO - Received 9600 messages so far
2025-02-26 20:02:42,530 - INFO - Received 9700 messages so far
2025-02-26 20:02:42,530 - INFO - Received 9800 messages so far
2025-02-26 20:02:42,530 - INFO - Received 9900 messages so far
2025-02-26 20:02:42,530 - INFO - Received 10000 messages so far
2025-02-26 20:02:42,530 - INFO - Total messages consumed: 10000
2025-02-26 20:02:42,617 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:42,621 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:42,621 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:42,621 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:42,621 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:42,632 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:42,632 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:42,632 - INFO - Number of columns: 66
2025-02-26 20:02:42,644 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p       rtt                   query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                                                                                                                                                                                                                                                                          answers                                                   TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
6482        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6809        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6530        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
843        53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740118e+09      NaN  NaN     NaN  CJFSeC2L0eLu4Zblfh    38634.0  0.001972  iup0-my.sharepoint.com     1.0  C_INTERNET    1.0          A    0.0    NOERROR  False  False  True  True  0.0  [iup0.sharepoint.com, 5711-ipv4v6e.clump.dprodmgd105.aa-rt.sharepoint.com, 193491-ipv4v6e.farm.dprodmgd105.aa-rt.sharepoint.com, 193491-ipv4v6e.farm.dprodmgd105.sharepointonline.com.akadns.net, 193491-ipv4v6.farm.dprodmgd105.aa-rt.sharepoint.com.dual-spo-0005.spo-msedge.net, dual-spo-0005.spo-msedge.net, 13.107.138.10, 13.107.136.10]  [2424.0, 2340.0, 50.0, 50.0, 252.0, 46.0, 46.0, 46.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2417        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN       NaN                     NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                                                                                                                                              NaN                                                    NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:42,644 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:42,675 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:42,717 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    56c8fcf4a1052fc6              f6c8fcf4a1052fc6  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:42,717 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443.  1900. 21116.  5353.   123. 21115.   138.
    80.   136.   134.    22.    67.   133.   135.     0.   547.]
2025-02-26 20:02:42,718 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:42,724 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:42,725 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:42,725 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:42,727 - INFO - DataFrame shape after NA dropping: (891, 23)
2025-02-26 20:02:42,727 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:42,727 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:42,728 - INFO - X shape: (891, 21), y shape: (891,)
2025-02-26 20:02:42,728 - INFO - Label distribution in training data: {'DNS': 742, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:42,729 - INFO - Training model...
2025-02-26 20:02:42,846 - INFO - Predicting on test data...
2025-02-26 20:02:42,860 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 147.0
  },
  "HTTP": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 0.96875,
    "recall": 1.0,
    "f1-score": 0.9841269841269841,
    "support": 31.0
  },
  "accuracy": 0.994413407821229,
  "macro avg": {
    "precision": 0.65625,
    "recall": 0.6666666666666666,
    "f1-score": 0.6613756613756614,
    "support": 179.0
  },
  "weighted avg": {
    "precision": 0.9890013966480447,
    "recall": 0.994413407821229,
    "f1-score": 0.9916644497650084,
    "support": 179.0
  }
}
2025-02-26 20:02:42,867 - INFO - Saved processed data locally to processed_data_20250226_200242.csv
2025-02-26 20:02:42,869 - INFO - JSON data size: 442298 bytes
2025-02-26 20:02:42,869 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:42,870 - INFO - Data sent successfully!
2025-02-26 20:02:42,870 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:42,871 - INFO - Starting data processing
2025-02-26 20:02:42,871 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:42,871 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:42,871 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:42,871 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:42,974 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:42,974 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:42,974 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:42,975 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:42,975 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:42,976 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:42,976 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:42,976 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:42,976 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:43,131 - INFO - Received 100 messages so far
2025-02-26 20:02:43,132 - INFO - Received 200 messages so far
2025-02-26 20:02:43,132 - INFO - Received 300 messages so far
2025-02-26 20:02:43,132 - INFO - Received 400 messages so far
2025-02-26 20:02:43,132 - INFO - Received 500 messages so far
2025-02-26 20:02:43,133 - INFO - Received 600 messages so far
2025-02-26 20:02:43,133 - INFO - Received 700 messages so far
2025-02-26 20:02:43,133 - INFO - Received 800 messages so far
2025-02-26 20:02:43,133 - INFO - Received 900 messages so far
2025-02-26 20:02:43,133 - INFO - Received 1000 messages so far
2025-02-26 20:02:43,134 - INFO - Received 1100 messages so far
2025-02-26 20:02:43,134 - INFO - Received 1200 messages so far
2025-02-26 20:02:43,134 - INFO - Received 1300 messages so far
2025-02-26 20:02:43,134 - INFO - Received 1400 messages so far
2025-02-26 20:02:43,135 - INFO - Received 1500 messages so far
2025-02-26 20:02:43,135 - INFO - Received 1600 messages so far
2025-02-26 20:02:43,135 - INFO - Received 1700 messages so far
2025-02-26 20:02:43,135 - INFO - Received 1800 messages so far
2025-02-26 20:02:43,135 - INFO - Received 1900 messages so far
2025-02-26 20:02:43,136 - INFO - Received 2000 messages so far
2025-02-26 20:02:43,136 - INFO - Received 2100 messages so far
2025-02-26 20:02:43,136 - INFO - Received 2200 messages so far
2025-02-26 20:02:43,136 - INFO - Received 2300 messages so far
2025-02-26 20:02:43,136 - INFO - Received 2400 messages so far
2025-02-26 20:02:43,137 - INFO - Received 2500 messages so far
2025-02-26 20:02:43,137 - INFO - Received 2600 messages so far
2025-02-26 20:02:43,137 - INFO - Received 2700 messages so far
2025-02-26 20:02:43,137 - INFO - Received 2800 messages so far
2025-02-26 20:02:43,137 - INFO - Received 2900 messages so far
2025-02-26 20:02:43,138 - INFO - Received 3000 messages so far
2025-02-26 20:02:43,138 - INFO - Received 3100 messages so far
2025-02-26 20:02:43,138 - INFO - Received 3200 messages so far
2025-02-26 20:02:43,138 - INFO - Received 3300 messages so far
2025-02-26 20:02:43,138 - INFO - Received 3400 messages so far
2025-02-26 20:02:43,139 - INFO - Received 3500 messages so far
2025-02-26 20:02:43,139 - INFO - Received 3600 messages so far
2025-02-26 20:02:43,139 - INFO - Received 3700 messages so far
2025-02-26 20:02:43,139 - INFO - Received 3800 messages so far
2025-02-26 20:02:43,139 - INFO - Received 3900 messages so far
2025-02-26 20:02:43,139 - INFO - Received 4000 messages so far
2025-02-26 20:02:43,140 - INFO - Received 4100 messages so far
2025-02-26 20:02:43,195 - INFO - Received 4200 messages so far
2025-02-26 20:02:43,196 - INFO - Received 4300 messages so far
2025-02-26 20:02:43,196 - INFO - Received 4400 messages so far
2025-02-26 20:02:43,196 - INFO - Received 4500 messages so far
2025-02-26 20:02:43,196 - INFO - Received 4600 messages so far
2025-02-26 20:02:43,196 - INFO - Received 4700 messages so far
2025-02-26 20:02:43,197 - INFO - Received 4800 messages so far
2025-02-26 20:02:43,197 - INFO - Received 4900 messages so far
2025-02-26 20:02:43,197 - INFO - Received 5000 messages so far
2025-02-26 20:02:43,197 - INFO - Received 5100 messages so far
2025-02-26 20:02:43,197 - INFO - Received 5200 messages so far
2025-02-26 20:02:43,198 - INFO - Received 5300 messages so far
2025-02-26 20:02:43,198 - INFO - Received 5400 messages so far
2025-02-26 20:02:43,198 - INFO - Received 5500 messages so far
2025-02-26 20:02:43,198 - INFO - Received 5600 messages so far
2025-02-26 20:02:43,198 - INFO - Received 5700 messages so far
2025-02-26 20:02:43,199 - INFO - Received 5800 messages so far
2025-02-26 20:02:43,199 - INFO - Received 5900 messages so far
2025-02-26 20:02:43,199 - INFO - Received 6000 messages so far
2025-02-26 20:02:43,199 - INFO - Received 6100 messages so far
2025-02-26 20:02:43,199 - INFO - Received 6200 messages so far
2025-02-26 20:02:43,200 - INFO - Received 6300 messages so far
2025-02-26 20:02:43,200 - INFO - Received 6400 messages so far
2025-02-26 20:02:43,200 - INFO - Received 6500 messages so far
2025-02-26 20:02:43,200 - INFO - Received 6600 messages so far
2025-02-26 20:02:43,200 - INFO - Received 6700 messages so far
2025-02-26 20:02:43,200 - INFO - Received 6800 messages so far
2025-02-26 20:02:43,201 - INFO - Received 6900 messages so far
2025-02-26 20:02:43,201 - INFO - Received 7000 messages so far
2025-02-26 20:02:43,201 - INFO - Received 7100 messages so far
2025-02-26 20:02:43,201 - INFO - Received 7200 messages so far
2025-02-26 20:02:43,201 - INFO - Received 7300 messages so far
2025-02-26 20:02:43,202 - INFO - Received 7400 messages so far
2025-02-26 20:02:43,202 - INFO - Received 7500 messages so far
2025-02-26 20:02:43,202 - INFO - Received 7600 messages so far
2025-02-26 20:02:43,202 - INFO - Received 7700 messages so far
2025-02-26 20:02:43,202 - INFO - Received 7800 messages so far
2025-02-26 20:02:43,203 - INFO - Received 7900 messages so far
2025-02-26 20:02:43,203 - INFO - Received 8000 messages so far
2025-02-26 20:02:43,203 - INFO - Received 8100 messages so far
2025-02-26 20:02:43,203 - INFO - Received 8200 messages so far
2025-02-26 20:02:43,203 - INFO - Received 8300 messages so far
2025-02-26 20:02:43,204 - INFO - Received 8400 messages so far
2025-02-26 20:02:43,204 - INFO - Received 8500 messages so far
2025-02-26 20:02:43,204 - INFO - Received 8600 messages so far
2025-02-26 20:02:43,204 - INFO - Received 8700 messages so far
2025-02-26 20:02:43,264 - INFO - Received 8800 messages so far
2025-02-26 20:02:43,264 - INFO - Received 8900 messages so far
2025-02-26 20:02:43,265 - INFO - Received 9000 messages so far
2025-02-26 20:02:43,265 - INFO - Received 9100 messages so far
2025-02-26 20:02:43,265 - INFO - Received 9200 messages so far
2025-02-26 20:02:43,265 - INFO - Received 9300 messages so far
2025-02-26 20:02:43,265 - INFO - Received 9400 messages so far
2025-02-26 20:02:43,266 - INFO - Received 9500 messages so far
2025-02-26 20:02:43,266 - INFO - Received 9600 messages so far
2025-02-26 20:02:43,266 - INFO - Received 9700 messages so far
2025-02-26 20:02:43,266 - INFO - Received 9800 messages so far
2025-02-26 20:02:43,266 - INFO - Received 9900 messages so far
2025-02-26 20:02:43,267 - INFO - Received 10000 messages so far
2025-02-26 20:02:43,267 - INFO - Total messages consumed: 10000
2025-02-26 20:02:43,353 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:43,356 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:43,357 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:43,357 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:43,357 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:43,364 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:43,367 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:43,367 - INFO - Number of columns: 66
2025-02-26 20:02:43,378 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                uid  id.orig_p       rtt                              query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                                                              answers           TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
4636        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                  NaN            NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4291        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                  NaN            NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1795     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740118e+09      NaN  NaN     NaN  ChOwZsAzuWNOZzUq1    55094.0       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                  NaN            NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000268     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6398       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740119e+09      NaN  NaN     NaN  Cl3wvT3Yo9SneF2nC    52747.0  0.002516  usc-word-edit.officeapps.live.com     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  True  0.0  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [261.0, 29.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8490     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  C9J5J5YlbTR6SxRo8    51642.0       NaN                                NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                  NaN            NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000414     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:43,378 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:43,409 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:43,450 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    6b77933b392d05f9              eb77933b392d05f9  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:43,451 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   443.  5353.   138.  1900.    80.   134.   133.
   123.   135. 21116.   547.   136.    22. 21115.     0.    67.]
2025-02-26 20:02:43,452 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:43,456 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:43,458 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:43,458 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:43,460 - INFO - DataFrame shape after NA dropping: (847, 23)
2025-02-26 20:02:43,460 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:43,460 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:43,460 - INFO - X shape: (847, 21), y shape: (847,)
2025-02-26 20:02:43,461 - INFO - Label distribution in training data: {'DNS': 705, 'HTTPS': 127, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:43,461 - INFO - Training model...
2025-02-26 20:02:43,575 - INFO - Predicting on test data...
2025-02-26 20:02:43,589 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 138.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.3333333333333333,
    "f1-score": 0.5,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.9354838709677419,
    "recall": 1.0,
    "f1-score": 0.9666666666666667,
    "support": 29.0
  },
  "accuracy": 0.9882352941176471,
  "macro avg": {
    "precision": 0.978494623655914,
    "recall": 0.7777777777777777,
    "f1-score": 0.8222222222222223,
    "support": 170.0
  },
  "weighted avg": {
    "precision": 0.9889943074003795,
    "recall": 0.9882352941176471,
    "f1-score": 0.9854901960784314,
    "support": 170.0
  }
}
2025-02-26 20:02:43,595 - INFO - Saved processed data locally to processed_data_20250226_200243.csv
2025-02-26 20:02:43,597 - INFO - JSON data size: 416762 bytes
2025-02-26 20:02:43,597 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:43,598 - INFO - Data sent successfully!
2025-02-26 20:02:43,598 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:43,599 - INFO - Starting data processing
2025-02-26 20:02:43,599 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:43,599 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:43,599 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:43,599 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:43,702 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:43,702 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:43,702 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:43,702 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:43,702 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:43,703 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:43,704 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:43,704 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:43,704 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:43,899 - INFO - Received 100 messages so far
2025-02-26 20:02:43,900 - INFO - Received 200 messages so far
2025-02-26 20:02:43,900 - INFO - Received 300 messages so far
2025-02-26 20:02:43,900 - INFO - Received 400 messages so far
2025-02-26 20:02:43,900 - INFO - Received 500 messages so far
2025-02-26 20:02:43,900 - INFO - Received 600 messages so far
2025-02-26 20:02:43,901 - INFO - Received 700 messages so far
2025-02-26 20:02:43,901 - INFO - Received 800 messages so far
2025-02-26 20:02:43,901 - INFO - Received 900 messages so far
2025-02-26 20:02:43,901 - INFO - Received 1000 messages so far
2025-02-26 20:02:43,901 - INFO - Received 1100 messages so far
2025-02-26 20:02:43,902 - INFO - Received 1200 messages so far
2025-02-26 20:02:43,902 - INFO - Received 1300 messages so far
2025-02-26 20:02:43,902 - INFO - Received 1400 messages so far
2025-02-26 20:02:43,902 - INFO - Received 1500 messages so far
2025-02-26 20:02:43,902 - INFO - Received 1600 messages so far
2025-02-26 20:02:43,903 - INFO - Received 1700 messages so far
2025-02-26 20:02:43,903 - INFO - Received 1800 messages so far
2025-02-26 20:02:43,903 - INFO - Received 1900 messages so far
2025-02-26 20:02:43,903 - INFO - Received 2000 messages so far
2025-02-26 20:02:43,903 - INFO - Received 2100 messages so far
2025-02-26 20:02:43,904 - INFO - Received 2200 messages so far
2025-02-26 20:02:43,904 - INFO - Received 2300 messages so far
2025-02-26 20:02:43,904 - INFO - Received 2400 messages so far
2025-02-26 20:02:43,904 - INFO - Received 2500 messages so far
2025-02-26 20:02:43,905 - INFO - Received 2600 messages so far
2025-02-26 20:02:43,905 - INFO - Received 2700 messages so far
2025-02-26 20:02:43,905 - INFO - Received 2800 messages so far
2025-02-26 20:02:43,905 - INFO - Received 2900 messages so far
2025-02-26 20:02:43,905 - INFO - Received 3000 messages so far
2025-02-26 20:02:43,906 - INFO - Received 3100 messages so far
2025-02-26 20:02:43,906 - INFO - Received 3200 messages so far
2025-02-26 20:02:43,906 - INFO - Received 3300 messages so far
2025-02-26 20:02:43,906 - INFO - Received 3400 messages so far
2025-02-26 20:02:43,906 - INFO - Received 3500 messages so far
2025-02-26 20:02:43,907 - INFO - Received 3600 messages so far
2025-02-26 20:02:43,907 - INFO - Received 3700 messages so far
2025-02-26 20:02:43,907 - INFO - Received 3800 messages so far
2025-02-26 20:02:43,907 - INFO - Received 3900 messages so far
2025-02-26 20:02:43,907 - INFO - Received 4000 messages so far
2025-02-26 20:02:43,908 - INFO - Received 4100 messages so far
2025-02-26 20:02:43,960 - INFO - Received 4200 messages so far
2025-02-26 20:02:43,960 - INFO - Received 4300 messages so far
2025-02-26 20:02:43,960 - INFO - Received 4400 messages so far
2025-02-26 20:02:43,960 - INFO - Received 4500 messages so far
2025-02-26 20:02:43,961 - INFO - Received 4600 messages so far
2025-02-26 20:02:43,961 - INFO - Received 4700 messages so far
2025-02-26 20:02:43,961 - INFO - Received 4800 messages so far
2025-02-26 20:02:43,961 - INFO - Received 4900 messages so far
2025-02-26 20:02:43,961 - INFO - Received 5000 messages so far
2025-02-26 20:02:43,962 - INFO - Received 5100 messages so far
2025-02-26 20:02:43,962 - INFO - Received 5200 messages so far
2025-02-26 20:02:43,962 - INFO - Received 5300 messages so far
2025-02-26 20:02:43,962 - INFO - Received 5400 messages so far
2025-02-26 20:02:43,962 - INFO - Received 5500 messages so far
2025-02-26 20:02:43,963 - INFO - Received 5600 messages so far
2025-02-26 20:02:43,963 - INFO - Received 5700 messages so far
2025-02-26 20:02:43,963 - INFO - Received 5800 messages so far
2025-02-26 20:02:43,963 - INFO - Received 5900 messages so far
2025-02-26 20:02:43,963 - INFO - Received 6000 messages so far
2025-02-26 20:02:43,964 - INFO - Received 6100 messages so far
2025-02-26 20:02:43,964 - INFO - Received 6200 messages so far
2025-02-26 20:02:43,964 - INFO - Received 6300 messages so far
2025-02-26 20:02:43,964 - INFO - Received 6400 messages so far
2025-02-26 20:02:43,964 - INFO - Received 6500 messages so far
2025-02-26 20:02:43,965 - INFO - Received 6600 messages so far
2025-02-26 20:02:43,965 - INFO - Received 6700 messages so far
2025-02-26 20:02:43,965 - INFO - Received 6800 messages so far
2025-02-26 20:02:43,965 - INFO - Received 6900 messages so far
2025-02-26 20:02:43,965 - INFO - Received 7000 messages so far
2025-02-26 20:02:43,966 - INFO - Received 7100 messages so far
2025-02-26 20:02:43,966 - INFO - Received 7200 messages so far
2025-02-26 20:02:43,966 - INFO - Received 7300 messages so far
2025-02-26 20:02:43,966 - INFO - Received 7400 messages so far
2025-02-26 20:02:43,966 - INFO - Received 7500 messages so far
2025-02-26 20:02:43,967 - INFO - Received 7600 messages so far
2025-02-26 20:02:43,967 - INFO - Received 7700 messages so far
2025-02-26 20:02:43,967 - INFO - Received 7800 messages so far
2025-02-26 20:02:43,967 - INFO - Received 7900 messages so far
2025-02-26 20:02:43,967 - INFO - Received 8000 messages so far
2025-02-26 20:02:43,968 - INFO - Received 8100 messages so far
2025-02-26 20:02:43,968 - INFO - Received 8200 messages so far
2025-02-26 20:02:43,968 - INFO - Received 8300 messages so far
2025-02-26 20:02:43,968 - INFO - Received 8400 messages so far
2025-02-26 20:02:43,968 - INFO - Received 8500 messages so far
2025-02-26 20:02:43,968 - INFO - Received 8600 messages so far
2025-02-26 20:02:43,969 - INFO - Received 8700 messages so far
2025-02-26 20:02:44,024 - INFO - Received 8800 messages so far
2025-02-26 20:02:44,024 - INFO - Received 8900 messages so far
2025-02-26 20:02:44,024 - INFO - Received 9000 messages so far
2025-02-26 20:02:44,024 - INFO - Received 9100 messages so far
2025-02-26 20:02:44,024 - INFO - Received 9200 messages so far
2025-02-26 20:02:44,025 - INFO - Received 9300 messages so far
2025-02-26 20:02:44,025 - INFO - Received 9400 messages so far
2025-02-26 20:02:44,025 - INFO - Received 9500 messages so far
2025-02-26 20:02:44,025 - INFO - Received 9600 messages so far
2025-02-26 20:02:44,026 - INFO - Received 9700 messages so far
2025-02-26 20:02:44,026 - INFO - Received 9800 messages so far
2025-02-26 20:02:44,026 - INFO - Received 9900 messages so far
2025-02-26 20:02:44,026 - INFO - Received 10000 messages so far
2025-02-26 20:02:44,026 - INFO - Total messages consumed: 10000
2025-02-26 20:02:44,112 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:44,116 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:44,116 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:44,116 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:44,116 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:44,129 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:44,129 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:44,129 - INFO - Number of columns: 66
2025-02-26 20:02:44,141 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt            query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD     RA    Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
2812        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN              NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9997       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740120e+09      NaN  NaN     NaN  CavLU5499VZf6D85oa    46131.0  NaN  play.google.com     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  False  0.0     NaN  NaN    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
864        53.0  192.168.1.3  192.168.1.1   udp        51.0       380.0  1.740118e+09      NaN  NaN     dns  CwM0GD1nQ2tm6p35Q2    35771.0  NaN              NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           79.0        1.0          408.0      17.0  0.002276     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2530        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN              NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8074        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN              NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:44,141 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:44,172 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:44,216 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    2fe788e3cc713726              efe788e3cc713726  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:44,216 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  1900.  9092.   443.   133.  5353.   123.    80.   138.
   136.     0.    22.   135.   134. 21116. 21115.    67.   547.]
2025-02-26 20:02:44,217 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:44,223 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:44,224 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:44,224 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:44,226 - INFO - DataFrame shape after NA dropping: (848, 23)
2025-02-26 20:02:44,226 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:44,226 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:44,226 - INFO - X shape: (848, 21), y shape: (848,)
2025-02-26 20:02:44,227 - INFO - Label distribution in training data: {'DNS': 705, 'HTTPS': 128, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:44,228 - INFO - Training model...
2025-02-26 20:02:44,341 - INFO - Predicting on test data...
2025-02-26 20:02:44,354 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 137.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 32.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 170.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 170.0
  }
}
2025-02-26 20:02:44,360 - INFO - Saved processed data locally to processed_data_20250226_200244.csv
2025-02-26 20:02:44,362 - INFO - JSON data size: 416048 bytes
2025-02-26 20:02:44,362 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:44,363 - INFO - Data sent successfully!
2025-02-26 20:02:44,363 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:44,363 - INFO - Starting data processing
2025-02-26 20:02:44,364 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:44,364 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:44,365 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:44,365 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:44,466 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:44,467 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:44,467 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:44,467 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:44,467 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:44,468 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:44,468 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:44,468 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:44,468 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:44,622 - INFO - Received 100 messages so far
2025-02-26 20:02:44,623 - INFO - Received 200 messages so far
2025-02-26 20:02:44,623 - INFO - Received 300 messages so far
2025-02-26 20:02:44,623 - INFO - Received 400 messages so far
2025-02-26 20:02:44,623 - INFO - Received 500 messages so far
2025-02-26 20:02:44,624 - INFO - Received 600 messages so far
2025-02-26 20:02:44,624 - INFO - Received 700 messages so far
2025-02-26 20:02:44,624 - INFO - Received 800 messages so far
2025-02-26 20:02:44,624 - INFO - Received 900 messages so far
2025-02-26 20:02:44,624 - INFO - Received 1000 messages so far
2025-02-26 20:02:44,625 - INFO - Received 1100 messages so far
2025-02-26 20:02:44,625 - INFO - Received 1200 messages so far
2025-02-26 20:02:44,625 - INFO - Received 1300 messages so far
2025-02-26 20:02:44,625 - INFO - Received 1400 messages so far
2025-02-26 20:02:44,625 - INFO - Received 1500 messages so far
2025-02-26 20:02:44,626 - INFO - Received 1600 messages so far
2025-02-26 20:02:44,626 - INFO - Received 1700 messages so far
2025-02-26 20:02:44,626 - INFO - Received 1800 messages so far
2025-02-26 20:02:44,626 - INFO - Received 1900 messages so far
2025-02-26 20:02:44,626 - INFO - Received 2000 messages so far
2025-02-26 20:02:44,627 - INFO - Received 2100 messages so far
2025-02-26 20:02:44,627 - INFO - Received 2200 messages so far
2025-02-26 20:02:44,627 - INFO - Received 2300 messages so far
2025-02-26 20:02:44,627 - INFO - Received 2400 messages so far
2025-02-26 20:02:44,627 - INFO - Received 2500 messages so far
2025-02-26 20:02:44,628 - INFO - Received 2600 messages so far
2025-02-26 20:02:44,628 - INFO - Received 2700 messages so far
2025-02-26 20:02:44,628 - INFO - Received 2800 messages so far
2025-02-26 20:02:44,628 - INFO - Received 2900 messages so far
2025-02-26 20:02:44,628 - INFO - Received 3000 messages so far
2025-02-26 20:02:44,628 - INFO - Received 3100 messages so far
2025-02-26 20:02:44,629 - INFO - Received 3200 messages so far
2025-02-26 20:02:44,629 - INFO - Received 3300 messages so far
2025-02-26 20:02:44,629 - INFO - Received 3400 messages so far
2025-02-26 20:02:44,629 - INFO - Received 3500 messages so far
2025-02-26 20:02:44,629 - INFO - Received 3600 messages so far
2025-02-26 20:02:44,630 - INFO - Received 3700 messages so far
2025-02-26 20:02:44,630 - INFO - Received 3800 messages so far
2025-02-26 20:02:44,630 - INFO - Received 3900 messages so far
2025-02-26 20:02:44,630 - INFO - Received 4000 messages so far
2025-02-26 20:02:44,631 - INFO - Received 4100 messages so far
2025-02-26 20:02:44,685 - INFO - Received 4200 messages so far
2025-02-26 20:02:44,685 - INFO - Received 4300 messages so far
2025-02-26 20:02:44,685 - INFO - Received 4400 messages so far
2025-02-26 20:02:44,685 - INFO - Received 4500 messages so far
2025-02-26 20:02:44,685 - INFO - Received 4600 messages so far
2025-02-26 20:02:44,686 - INFO - Received 4700 messages so far
2025-02-26 20:02:44,686 - INFO - Received 4800 messages so far
2025-02-26 20:02:44,686 - INFO - Received 4900 messages so far
2025-02-26 20:02:44,686 - INFO - Received 5000 messages so far
2025-02-26 20:02:44,686 - INFO - Received 5100 messages so far
2025-02-26 20:02:44,687 - INFO - Received 5200 messages so far
2025-02-26 20:02:44,687 - INFO - Received 5300 messages so far
2025-02-26 20:02:44,687 - INFO - Received 5400 messages so far
2025-02-26 20:02:44,687 - INFO - Received 5500 messages so far
2025-02-26 20:02:44,687 - INFO - Received 5600 messages so far
2025-02-26 20:02:44,688 - INFO - Received 5700 messages so far
2025-02-26 20:02:44,688 - INFO - Received 5800 messages so far
2025-02-26 20:02:44,688 - INFO - Received 5900 messages so far
2025-02-26 20:02:44,688 - INFO - Received 6000 messages so far
2025-02-26 20:02:44,688 - INFO - Received 6100 messages so far
2025-02-26 20:02:44,689 - INFO - Received 6200 messages so far
2025-02-26 20:02:44,689 - INFO - Received 6300 messages so far
2025-02-26 20:02:44,689 - INFO - Received 6400 messages so far
2025-02-26 20:02:44,689 - INFO - Received 6500 messages so far
2025-02-26 20:02:44,689 - INFO - Received 6600 messages so far
2025-02-26 20:02:44,690 - INFO - Received 6700 messages so far
2025-02-26 20:02:44,690 - INFO - Received 6800 messages so far
2025-02-26 20:02:44,690 - INFO - Received 6900 messages so far
2025-02-26 20:02:44,690 - INFO - Received 7000 messages so far
2025-02-26 20:02:44,690 - INFO - Received 7100 messages so far
2025-02-26 20:02:44,691 - INFO - Received 7200 messages so far
2025-02-26 20:02:44,691 - INFO - Received 7300 messages so far
2025-02-26 20:02:44,691 - INFO - Received 7400 messages so far
2025-02-26 20:02:44,691 - INFO - Received 7500 messages so far
2025-02-26 20:02:44,691 - INFO - Received 7600 messages so far
2025-02-26 20:02:44,692 - INFO - Received 7700 messages so far
2025-02-26 20:02:44,692 - INFO - Received 7800 messages so far
2025-02-26 20:02:44,692 - INFO - Received 7900 messages so far
2025-02-26 20:02:44,692 - INFO - Received 8000 messages so far
2025-02-26 20:02:44,692 - INFO - Received 8100 messages so far
2025-02-26 20:02:44,692 - INFO - Received 8200 messages so far
2025-02-26 20:02:44,693 - INFO - Received 8300 messages so far
2025-02-26 20:02:44,693 - INFO - Received 8400 messages so far
2025-02-26 20:02:44,693 - INFO - Received 8500 messages so far
2025-02-26 20:02:44,693 - INFO - Received 8600 messages so far
2025-02-26 20:02:44,694 - INFO - Received 8700 messages so far
2025-02-26 20:02:44,786 - INFO - Received 8800 messages so far
2025-02-26 20:02:44,786 - INFO - Received 8900 messages so far
2025-02-26 20:02:44,786 - INFO - Received 9000 messages so far
2025-02-26 20:02:44,786 - INFO - Received 9100 messages so far
2025-02-26 20:02:44,787 - INFO - Received 9200 messages so far
2025-02-26 20:02:44,787 - INFO - Received 9300 messages so far
2025-02-26 20:02:44,787 - INFO - Received 9400 messages so far
2025-02-26 20:02:44,787 - INFO - Received 9500 messages so far
2025-02-26 20:02:44,788 - INFO - Received 9600 messages so far
2025-02-26 20:02:44,788 - INFO - Received 9700 messages so far
2025-02-26 20:02:44,788 - INFO - Received 9800 messages so far
2025-02-26 20:02:44,788 - INFO - Received 9900 messages so far
2025-02-26 20:02:44,788 - INFO - Received 10000 messages so far
2025-02-26 20:02:44,788 - INFO - Total messages consumed: 10000
2025-02-26 20:02:44,869 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:44,873 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:44,873 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:44,873 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:44,873 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:44,885 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:44,886 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:44,886 - INFO - Number of columns: 66
2025-02-26 20:02:44,897 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3353       53.0  192.168.1.3  192.168.1.1   udp        52.0       112.0  1.740119e+09      NaN  NaN     dns   CQDEkz2OV2FtPNGQk    46901.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           80.0        1.0          140.0      17.0  0.018297     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8486     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  CUgyk23w71tYkzdSjd    51614.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000188     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3378        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7229     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740119e+09      NaN  NaN     NaN  CVCkG14SxCQnmNVjC9    50806.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000140     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1675     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740118e+09      NaN  NaN     NaN  Ccc9sr1ufPq9EqtJE6    53990.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000266     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:44,897 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:44,928 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:44,971 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    376acab97e4aab30              eb77933b392d05f9  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:44,971 - INFO - Unique values in 'id.resp_p' before labeling: [   53.  9092.    nan  1900.   443.  5353.   123.    80.   134.   138.
   136. 21115. 21116.   133.   547.    67.   135.     0.    22.]
2025-02-26 20:02:44,972 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:44,977 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:44,978 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:44,978 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:44,981 - INFO - DataFrame shape after NA dropping: (773, 23)
2025-02-26 20:02:44,981 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:44,981 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:44,981 - INFO - X shape: (773, 21), y shape: (773,)
2025-02-26 20:02:44,982 - INFO - Label distribution in training data: {'DNS': 643, 'HTTPS': 117, 'HTTP': 12, 'SSH': 1}
2025-02-26 20:02:44,983 - INFO - Training model...
2025-02-26 20:02:45,095 - INFO - Predicting on test data...
2025-02-26 20:02:45,110 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 131.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 24.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 155.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 155.0
  }
}
2025-02-26 20:02:45,116 - INFO - Saved processed data locally to processed_data_20250226_200245.csv
2025-02-26 20:02:45,118 - INFO - JSON data size: 379501 bytes
2025-02-26 20:02:45,118 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:45,118 - INFO - Data sent successfully!
2025-02-26 20:02:45,118 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:45,119 - INFO - Starting data processing
2025-02-26 20:02:45,119 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:45,120 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:45,120 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:45,120 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:45,222 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:45,222 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:45,222 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:45,223 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:45,223 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:45,223 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:45,224 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:45,224 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:45,224 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:45,377 - INFO - Received 100 messages so far
2025-02-26 20:02:45,378 - INFO - Received 200 messages so far
2025-02-26 20:02:45,378 - INFO - Received 300 messages so far
2025-02-26 20:02:45,378 - INFO - Received 400 messages so far
2025-02-26 20:02:45,378 - INFO - Received 500 messages so far
2025-02-26 20:02:45,378 - INFO - Received 600 messages so far
2025-02-26 20:02:45,379 - INFO - Received 700 messages so far
2025-02-26 20:02:45,379 - INFO - Received 800 messages so far
2025-02-26 20:02:45,379 - INFO - Received 900 messages so far
2025-02-26 20:02:45,379 - INFO - Received 1000 messages so far
2025-02-26 20:02:45,379 - INFO - Received 1100 messages so far
2025-02-26 20:02:45,380 - INFO - Received 1200 messages so far
2025-02-26 20:02:45,380 - INFO - Received 1300 messages so far
2025-02-26 20:02:45,380 - INFO - Received 1400 messages so far
2025-02-26 20:02:45,380 - INFO - Received 1500 messages so far
2025-02-26 20:02:45,380 - INFO - Received 1600 messages so far
2025-02-26 20:02:45,381 - INFO - Received 1700 messages so far
2025-02-26 20:02:45,381 - INFO - Received 1800 messages so far
2025-02-26 20:02:45,381 - INFO - Received 1900 messages so far
2025-02-26 20:02:45,381 - INFO - Received 2000 messages so far
2025-02-26 20:02:45,381 - INFO - Received 2100 messages so far
2025-02-26 20:02:45,382 - INFO - Received 2200 messages so far
2025-02-26 20:02:45,382 - INFO - Received 2300 messages so far
2025-02-26 20:02:45,382 - INFO - Received 2400 messages so far
2025-02-26 20:02:45,382 - INFO - Received 2500 messages so far
2025-02-26 20:02:45,382 - INFO - Received 2600 messages so far
2025-02-26 20:02:45,383 - INFO - Received 2700 messages so far
2025-02-26 20:02:45,383 - INFO - Received 2800 messages so far
2025-02-26 20:02:45,383 - INFO - Received 2900 messages so far
2025-02-26 20:02:45,383 - INFO - Received 3000 messages so far
2025-02-26 20:02:45,383 - INFO - Received 3100 messages so far
2025-02-26 20:02:45,384 - INFO - Received 3200 messages so far
2025-02-26 20:02:45,384 - INFO - Received 3300 messages so far
2025-02-26 20:02:45,384 - INFO - Received 3400 messages so far
2025-02-26 20:02:45,384 - INFO - Received 3500 messages so far
2025-02-26 20:02:45,384 - INFO - Received 3600 messages so far
2025-02-26 20:02:45,385 - INFO - Received 3700 messages so far
2025-02-26 20:02:45,385 - INFO - Received 3800 messages so far
2025-02-26 20:02:45,385 - INFO - Received 3900 messages so far
2025-02-26 20:02:45,385 - INFO - Received 4000 messages so far
2025-02-26 20:02:45,385 - INFO - Received 4100 messages so far
2025-02-26 20:02:45,439 - INFO - Received 4200 messages so far
2025-02-26 20:02:45,439 - INFO - Received 4300 messages so far
2025-02-26 20:02:45,439 - INFO - Received 4400 messages so far
2025-02-26 20:02:45,439 - INFO - Received 4500 messages so far
2025-02-26 20:02:45,439 - INFO - Received 4600 messages so far
2025-02-26 20:02:45,440 - INFO - Received 4700 messages so far
2025-02-26 20:02:45,440 - INFO - Received 4800 messages so far
2025-02-26 20:02:45,440 - INFO - Received 4900 messages so far
2025-02-26 20:02:45,440 - INFO - Received 5000 messages so far
2025-02-26 20:02:45,440 - INFO - Received 5100 messages so far
2025-02-26 20:02:45,441 - INFO - Received 5200 messages so far
2025-02-26 20:02:45,441 - INFO - Received 5300 messages so far
2025-02-26 20:02:45,441 - INFO - Received 5400 messages so far
2025-02-26 20:02:45,441 - INFO - Received 5500 messages so far
2025-02-26 20:02:45,441 - INFO - Received 5600 messages so far
2025-02-26 20:02:45,442 - INFO - Received 5700 messages so far
2025-02-26 20:02:45,442 - INFO - Received 5800 messages so far
2025-02-26 20:02:45,442 - INFO - Received 5900 messages so far
2025-02-26 20:02:45,442 - INFO - Received 6000 messages so far
2025-02-26 20:02:45,442 - INFO - Received 6100 messages so far
2025-02-26 20:02:45,443 - INFO - Received 6200 messages so far
2025-02-26 20:02:45,443 - INFO - Received 6300 messages so far
2025-02-26 20:02:45,443 - INFO - Received 6400 messages so far
2025-02-26 20:02:45,443 - INFO - Received 6500 messages so far
2025-02-26 20:02:45,443 - INFO - Received 6600 messages so far
2025-02-26 20:02:45,444 - INFO - Received 6700 messages so far
2025-02-26 20:02:45,444 - INFO - Received 6800 messages so far
2025-02-26 20:02:45,444 - INFO - Received 6900 messages so far
2025-02-26 20:02:45,444 - INFO - Received 7000 messages so far
2025-02-26 20:02:45,444 - INFO - Received 7100 messages so far
2025-02-26 20:02:45,445 - INFO - Received 7200 messages so far
2025-02-26 20:02:45,445 - INFO - Received 7300 messages so far
2025-02-26 20:02:45,445 - INFO - Received 7400 messages so far
2025-02-26 20:02:45,445 - INFO - Received 7500 messages so far
2025-02-26 20:02:45,445 - INFO - Received 7600 messages so far
2025-02-26 20:02:45,446 - INFO - Received 7700 messages so far
2025-02-26 20:02:45,446 - INFO - Received 7800 messages so far
2025-02-26 20:02:45,446 - INFO - Received 7900 messages so far
2025-02-26 20:02:45,446 - INFO - Received 8000 messages so far
2025-02-26 20:02:45,446 - INFO - Received 8100 messages so far
2025-02-26 20:02:45,447 - INFO - Received 8200 messages so far
2025-02-26 20:02:45,447 - INFO - Received 8300 messages so far
2025-02-26 20:02:45,447 - INFO - Received 8400 messages so far
2025-02-26 20:02:45,447 - INFO - Received 8500 messages so far
2025-02-26 20:02:45,447 - INFO - Received 8600 messages so far
2025-02-26 20:02:45,448 - INFO - Received 8700 messages so far
2025-02-26 20:02:45,506 - INFO - Received 8800 messages so far
2025-02-26 20:02:45,507 - INFO - Received 8900 messages so far
2025-02-26 20:02:45,507 - INFO - Received 9000 messages so far
2025-02-26 20:02:45,507 - INFO - Received 9100 messages so far
2025-02-26 20:02:45,507 - INFO - Received 9200 messages so far
2025-02-26 20:02:45,507 - INFO - Received 9300 messages so far
2025-02-26 20:02:45,508 - INFO - Received 9400 messages so far
2025-02-26 20:02:45,508 - INFO - Received 9500 messages so far
2025-02-26 20:02:45,508 - INFO - Received 9600 messages so far
2025-02-26 20:02:45,508 - INFO - Received 9700 messages so far
2025-02-26 20:02:45,508 - INFO - Received 9800 messages so far
2025-02-26 20:02:45,509 - INFO - Received 9900 messages so far
2025-02-26 20:02:45,509 - INFO - Received 10000 messages so far
2025-02-26 20:02:45,509 - INFO - Total messages consumed: 10000
2025-02-26 20:02:45,592 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:45,595 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:45,595 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:45,595 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:45,596 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:45,603 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:45,606 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:45,606 - INFO - Number of columns: 66
2025-02-26 20:02:45,616 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
8472     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  CzW8Nr3mUQFJOKQ7v6    34290.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000184     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6940       53.0  192.168.1.3  192.168.1.1   udp        62.0       271.0  1.740119e+09      NaN  NaN     dns  CJnIGI2eu0tzFZjonf    60041.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           90.0        1.0          299.0      17.0  0.002014     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2283        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1604        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2256        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:45,616 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:45,646 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:45,691 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    7621c9ee35587231              f621c9ee35587231  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:45,691 - INFO - Unique values in 'id.resp_p' before labeling: [ 9092.    53.    nan  5353.   443.   136. 21116.    80.  1900.   133.
   138.   123.    67.   547.    22.   134. 21115.     0.   135.]
2025-02-26 20:02:45,693 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:45,698 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:45,699 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:45,699 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:45,701 - INFO - DataFrame shape after NA dropping: (826, 23)
2025-02-26 20:02:45,701 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:45,702 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:45,702 - INFO - X shape: (826, 21), y shape: (826,)
2025-02-26 20:02:45,702 - INFO - Label distribution in training data: {'DNS': 685, 'HTTPS': 127, 'HTTP': 13, 'SSH': 1}
2025-02-26 20:02:45,703 - INFO - Training model...
2025-02-26 20:02:45,816 - INFO - Predicting on test data...
2025-02-26 20:02:45,830 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 137.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.3333333333333333,
    "f1-score": 0.5,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.9285714285714286,
    "recall": 1.0,
    "f1-score": 0.9629629629629629,
    "support": 26.0
  },
  "accuracy": 0.9879518072289156,
  "macro avg": {
    "precision": 0.9761904761904763,
    "recall": 0.7777777777777777,
    "f1-score": 0.8209876543209876,
    "support": 166.0
  },
  "weighted avg": {
    "precision": 0.9888123924268503,
    "recall": 0.9879518072289156,
    "f1-score": 0.9851628737170905,
    "support": 166.0
  }
}
2025-02-26 20:02:45,837 - INFO - Saved processed data locally to processed_data_20250226_200245.csv
2025-02-26 20:02:45,839 - INFO - JSON data size: 409598 bytes
2025-02-26 20:02:45,839 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:45,839 - INFO - Data sent successfully!
2025-02-26 20:02:45,839 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:45,840 - INFO - Starting data processing
2025-02-26 20:02:45,840 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:45,841 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:45,842 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:45,842 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:45,944 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:45,944 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:45,944 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:45,944 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:45,944 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:45,945 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:45,945 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:45,945 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:45,945 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:46,135 - INFO - Received 100 messages so far
2025-02-26 20:02:46,136 - INFO - Received 200 messages so far
2025-02-26 20:02:46,136 - INFO - Received 300 messages so far
2025-02-26 20:02:46,136 - INFO - Received 400 messages so far
2025-02-26 20:02:46,136 - INFO - Received 500 messages so far
2025-02-26 20:02:46,137 - INFO - Received 600 messages so far
2025-02-26 20:02:46,137 - INFO - Received 700 messages so far
2025-02-26 20:02:46,137 - INFO - Received 800 messages so far
2025-02-26 20:02:46,137 - INFO - Received 900 messages so far
2025-02-26 20:02:46,137 - INFO - Received 1000 messages so far
2025-02-26 20:02:46,137 - INFO - Received 1100 messages so far
2025-02-26 20:02:46,138 - INFO - Received 1200 messages so far
2025-02-26 20:02:46,138 - INFO - Received 1300 messages so far
2025-02-26 20:02:46,138 - INFO - Received 1400 messages so far
2025-02-26 20:02:46,138 - INFO - Received 1500 messages so far
2025-02-26 20:02:46,138 - INFO - Received 1600 messages so far
2025-02-26 20:02:46,139 - INFO - Received 1700 messages so far
2025-02-26 20:02:46,139 - INFO - Received 1800 messages so far
2025-02-26 20:02:46,139 - INFO - Received 1900 messages so far
2025-02-26 20:02:46,139 - INFO - Received 2000 messages so far
2025-02-26 20:02:46,139 - INFO - Received 2100 messages so far
2025-02-26 20:02:46,140 - INFO - Received 2200 messages so far
2025-02-26 20:02:46,140 - INFO - Received 2300 messages so far
2025-02-26 20:02:46,140 - INFO - Received 2400 messages so far
2025-02-26 20:02:46,140 - INFO - Received 2500 messages so far
2025-02-26 20:02:46,140 - INFO - Received 2600 messages so far
2025-02-26 20:02:46,141 - INFO - Received 2700 messages so far
2025-02-26 20:02:46,141 - INFO - Received 2800 messages so far
2025-02-26 20:02:46,141 - INFO - Received 2900 messages so far
2025-02-26 20:02:46,141 - INFO - Received 3000 messages so far
2025-02-26 20:02:46,141 - INFO - Received 3100 messages so far
2025-02-26 20:02:46,142 - INFO - Received 3200 messages so far
2025-02-26 20:02:46,142 - INFO - Received 3300 messages so far
2025-02-26 20:02:46,142 - INFO - Received 3400 messages so far
2025-02-26 20:02:46,142 - INFO - Received 3500 messages so far
2025-02-26 20:02:46,142 - INFO - Received 3600 messages so far
2025-02-26 20:02:46,143 - INFO - Received 3700 messages so far
2025-02-26 20:02:46,143 - INFO - Received 3800 messages so far
2025-02-26 20:02:46,143 - INFO - Received 3900 messages so far
2025-02-26 20:02:46,143 - INFO - Received 4000 messages so far
2025-02-26 20:02:46,144 - INFO - Received 4100 messages so far
2025-02-26 20:02:46,196 - INFO - Received 4200 messages so far
2025-02-26 20:02:46,196 - INFO - Received 4300 messages so far
2025-02-26 20:02:46,196 - INFO - Received 4400 messages so far
2025-02-26 20:02:46,196 - INFO - Received 4500 messages so far
2025-02-26 20:02:46,197 - INFO - Received 4600 messages so far
2025-02-26 20:02:46,197 - INFO - Received 4700 messages so far
2025-02-26 20:02:46,197 - INFO - Received 4800 messages so far
2025-02-26 20:02:46,197 - INFO - Received 4900 messages so far
2025-02-26 20:02:46,197 - INFO - Received 5000 messages so far
2025-02-26 20:02:46,198 - INFO - Received 5100 messages so far
2025-02-26 20:02:46,198 - INFO - Received 5200 messages so far
2025-02-26 20:02:46,198 - INFO - Received 5300 messages so far
2025-02-26 20:02:46,198 - INFO - Received 5400 messages so far
2025-02-26 20:02:46,198 - INFO - Received 5500 messages so far
2025-02-26 20:02:46,199 - INFO - Received 5600 messages so far
2025-02-26 20:02:46,199 - INFO - Received 5700 messages so far
2025-02-26 20:02:46,199 - INFO - Received 5800 messages so far
2025-02-26 20:02:46,199 - INFO - Received 5900 messages so far
2025-02-26 20:02:46,199 - INFO - Received 6000 messages so far
2025-02-26 20:02:46,200 - INFO - Received 6100 messages so far
2025-02-26 20:02:46,200 - INFO - Received 6200 messages so far
2025-02-26 20:02:46,200 - INFO - Received 6300 messages so far
2025-02-26 20:02:46,200 - INFO - Received 6400 messages so far
2025-02-26 20:02:46,200 - INFO - Received 6500 messages so far
2025-02-26 20:02:46,201 - INFO - Received 6600 messages so far
2025-02-26 20:02:46,201 - INFO - Received 6700 messages so far
2025-02-26 20:02:46,201 - INFO - Received 6800 messages so far
2025-02-26 20:02:46,201 - INFO - Received 6900 messages so far
2025-02-26 20:02:46,201 - INFO - Received 7000 messages so far
2025-02-26 20:02:46,202 - INFO - Received 7100 messages so far
2025-02-26 20:02:46,202 - INFO - Received 7200 messages so far
2025-02-26 20:02:46,202 - INFO - Received 7300 messages so far
2025-02-26 20:02:46,202 - INFO - Received 7400 messages so far
2025-02-26 20:02:46,202 - INFO - Received 7500 messages so far
2025-02-26 20:02:46,202 - INFO - Received 7600 messages so far
2025-02-26 20:02:46,203 - INFO - Received 7700 messages so far
2025-02-26 20:02:46,203 - INFO - Received 7800 messages so far
2025-02-26 20:02:46,203 - INFO - Received 7900 messages so far
2025-02-26 20:02:46,203 - INFO - Received 8000 messages so far
2025-02-26 20:02:46,203 - INFO - Received 8100 messages so far
2025-02-26 20:02:46,204 - INFO - Received 8200 messages so far
2025-02-26 20:02:46,204 - INFO - Received 8300 messages so far
2025-02-26 20:02:46,204 - INFO - Received 8400 messages so far
2025-02-26 20:02:46,204 - INFO - Received 8500 messages so far
2025-02-26 20:02:46,204 - INFO - Received 8600 messages so far
2025-02-26 20:02:46,205 - INFO - Received 8700 messages so far
2025-02-26 20:02:46,263 - INFO - Received 8800 messages so far
2025-02-26 20:02:46,264 - INFO - Received 8900 messages so far
2025-02-26 20:02:46,264 - INFO - Received 9000 messages so far
2025-02-26 20:02:46,264 - INFO - Received 9100 messages so far
2025-02-26 20:02:46,265 - INFO - Received 9200 messages so far
2025-02-26 20:02:46,266 - INFO - Received 9300 messages so far
2025-02-26 20:02:46,266 - INFO - Received 9400 messages so far
2025-02-26 20:02:46,267 - INFO - Received 9500 messages so far
2025-02-26 20:02:46,267 - INFO - Received 9600 messages so far
2025-02-26 20:02:46,267 - INFO - Received 9700 messages so far
2025-02-26 20:02:46,268 - INFO - Received 9800 messages so far
2025-02-26 20:02:46,268 - INFO - Received 9900 messages so far
2025-02-26 20:02:46,268 - INFO - Received 10000 messages so far
2025-02-26 20:02:46,268 - INFO - Total messages consumed: 10000
2025-02-26 20:02:46,359 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:46,363 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:46,363 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:46,364 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:46,364 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:46,371 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:46,374 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:46,374 - INFO - Number of columns: 66
2025-02-26 20:02:46,384 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9425        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4370        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2996        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.009495     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7712        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2410        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:46,385 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:46,415 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:46,458 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    2fe788e3cc713726              efe788e3cc713726  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:46,459 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   443.  5353.  1900.   133.   135.     0.   123.
 21115.    22.    80.   134.   138.   136. 21116.   547.    67.]
2025-02-26 20:02:46,460 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:46,465 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:46,466 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:46,466 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:46,468 - INFO - DataFrame shape after NA dropping: (889, 23)
2025-02-26 20:02:46,468 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:46,468 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:46,469 - INFO - X shape: (889, 21), y shape: (889,)
2025-02-26 20:02:46,469 - INFO - Label distribution in training data: {'DNS': 741, 'HTTPS': 133, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:46,470 - INFO - Training model...
2025-02-26 20:02:46,583 - INFO - Predicting on test data...
2025-02-26 20:02:46,597 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 148.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.8,
    "f1-score": 0.8888888888888888,
    "support": 5.0
  },
  "HTTPS": {
    "precision": 0.9615384615384616,
    "recall": 1.0,
    "f1-score": 0.9803921568627451,
    "support": 25.0
  },
  "accuracy": 0.9943820224719101,
  "macro avg": {
    "precision": 0.9871794871794872,
    "recall": 0.9333333333333332,
    "f1-score": 0.9564270152505446,
    "support": 178.0
  },
  "weighted avg": {
    "precision": 0.9945980985306828,
    "recall": 0.9943820224719101,
    "f1-score": 0.9941249908202981,
    "support": 178.0
  }
}
2025-02-26 20:02:46,604 - INFO - Saved processed data locally to processed_data_20250226_200246.csv
2025-02-26 20:02:46,606 - INFO - JSON data size: 438703 bytes
2025-02-26 20:02:46,606 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:46,607 - INFO - Data sent successfully!
2025-02-26 20:02:46,607 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:46,608 - INFO - Starting data processing
2025-02-26 20:02:46,608 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:46,608 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:46,609 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:46,609 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:46,711 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:46,711 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:46,711 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:46,712 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:46,712 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:46,712 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:46,713 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:46,713 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:46,713 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:46,863 - INFO - Received 100 messages so far
2025-02-26 20:02:46,863 - INFO - Received 200 messages so far
2025-02-26 20:02:46,864 - INFO - Received 300 messages so far
2025-02-26 20:02:46,864 - INFO - Received 400 messages so far
2025-02-26 20:02:46,864 - INFO - Received 500 messages so far
2025-02-26 20:02:46,864 - INFO - Received 600 messages so far
2025-02-26 20:02:46,864 - INFO - Received 700 messages so far
2025-02-26 20:02:46,864 - INFO - Received 800 messages so far
2025-02-26 20:02:46,865 - INFO - Received 900 messages so far
2025-02-26 20:02:46,865 - INFO - Received 1000 messages so far
2025-02-26 20:02:46,865 - INFO - Received 1100 messages so far
2025-02-26 20:02:46,865 - INFO - Received 1200 messages so far
2025-02-26 20:02:46,865 - INFO - Received 1300 messages so far
2025-02-26 20:02:46,866 - INFO - Received 1400 messages so far
2025-02-26 20:02:46,866 - INFO - Received 1500 messages so far
2025-02-26 20:02:46,866 - INFO - Received 1600 messages so far
2025-02-26 20:02:46,866 - INFO - Received 1700 messages so far
2025-02-26 20:02:46,866 - INFO - Received 1800 messages so far
2025-02-26 20:02:46,867 - INFO - Received 1900 messages so far
2025-02-26 20:02:46,867 - INFO - Received 2000 messages so far
2025-02-26 20:02:46,867 - INFO - Received 2100 messages so far
2025-02-26 20:02:46,867 - INFO - Received 2200 messages so far
2025-02-26 20:02:46,867 - INFO - Received 2300 messages so far
2025-02-26 20:02:46,868 - INFO - Received 2400 messages so far
2025-02-26 20:02:46,868 - INFO - Received 2500 messages so far
2025-02-26 20:02:46,868 - INFO - Received 2600 messages so far
2025-02-26 20:02:46,868 - INFO - Received 2700 messages so far
2025-02-26 20:02:46,868 - INFO - Received 2800 messages so far
2025-02-26 20:02:46,869 - INFO - Received 2900 messages so far
2025-02-26 20:02:46,869 - INFO - Received 3000 messages so far
2025-02-26 20:02:46,869 - INFO - Received 3100 messages so far
2025-02-26 20:02:46,869 - INFO - Received 3200 messages so far
2025-02-26 20:02:46,869 - INFO - Received 3300 messages so far
2025-02-26 20:02:46,869 - INFO - Received 3400 messages so far
2025-02-26 20:02:46,870 - INFO - Received 3500 messages so far
2025-02-26 20:02:46,870 - INFO - Received 3600 messages so far
2025-02-26 20:02:46,870 - INFO - Received 3700 messages so far
2025-02-26 20:02:46,870 - INFO - Received 3800 messages so far
2025-02-26 20:02:46,870 - INFO - Received 3900 messages so far
2025-02-26 20:02:46,871 - INFO - Received 4000 messages so far
2025-02-26 20:02:46,871 - INFO - Received 4100 messages so far
2025-02-26 20:02:46,957 - INFO - Received 4200 messages so far
2025-02-26 20:02:46,957 - INFO - Received 4300 messages so far
2025-02-26 20:02:46,957 - INFO - Received 4400 messages so far
2025-02-26 20:02:46,957 - INFO - Received 4500 messages so far
2025-02-26 20:02:46,958 - INFO - Received 4600 messages so far
2025-02-26 20:02:46,958 - INFO - Received 4700 messages so far
2025-02-26 20:02:46,958 - INFO - Received 4800 messages so far
2025-02-26 20:02:46,958 - INFO - Received 4900 messages so far
2025-02-26 20:02:46,958 - INFO - Received 5000 messages so far
2025-02-26 20:02:46,959 - INFO - Received 5100 messages so far
2025-02-26 20:02:46,959 - INFO - Received 5200 messages so far
2025-02-26 20:02:46,959 - INFO - Received 5300 messages so far
2025-02-26 20:02:46,959 - INFO - Received 5400 messages so far
2025-02-26 20:02:46,959 - INFO - Received 5500 messages so far
2025-02-26 20:02:46,960 - INFO - Received 5600 messages so far
2025-02-26 20:02:46,960 - INFO - Received 5700 messages so far
2025-02-26 20:02:46,960 - INFO - Received 5800 messages so far
2025-02-26 20:02:46,960 - INFO - Received 5900 messages so far
2025-02-26 20:02:46,960 - INFO - Received 6000 messages so far
2025-02-26 20:02:46,961 - INFO - Received 6100 messages so far
2025-02-26 20:02:46,961 - INFO - Received 6200 messages so far
2025-02-26 20:02:46,961 - INFO - Received 6300 messages so far
2025-02-26 20:02:46,961 - INFO - Received 6400 messages so far
2025-02-26 20:02:46,961 - INFO - Received 6500 messages so far
2025-02-26 20:02:46,962 - INFO - Received 6600 messages so far
2025-02-26 20:02:46,962 - INFO - Received 6700 messages so far
2025-02-26 20:02:46,962 - INFO - Received 6800 messages so far
2025-02-26 20:02:46,962 - INFO - Received 6900 messages so far
2025-02-26 20:02:46,962 - INFO - Received 7000 messages so far
2025-02-26 20:02:46,963 - INFO - Received 7100 messages so far
2025-02-26 20:02:46,963 - INFO - Received 7200 messages so far
2025-02-26 20:02:46,963 - INFO - Received 7300 messages so far
2025-02-26 20:02:46,963 - INFO - Received 7400 messages so far
2025-02-26 20:02:46,963 - INFO - Received 7500 messages so far
2025-02-26 20:02:46,964 - INFO - Received 7600 messages so far
2025-02-26 20:02:46,964 - INFO - Received 7700 messages so far
2025-02-26 20:02:46,964 - INFO - Received 7800 messages so far
2025-02-26 20:02:46,964 - INFO - Received 7900 messages so far
2025-02-26 20:02:46,964 - INFO - Received 8000 messages so far
2025-02-26 20:02:46,965 - INFO - Received 8100 messages so far
2025-02-26 20:02:46,965 - INFO - Received 8200 messages so far
2025-02-26 20:02:46,965 - INFO - Received 8300 messages so far
2025-02-26 20:02:46,965 - INFO - Received 8400 messages so far
2025-02-26 20:02:46,965 - INFO - Received 8500 messages so far
2025-02-26 20:02:46,966 - INFO - Received 8600 messages so far
2025-02-26 20:02:46,966 - INFO - Received 8700 messages so far
2025-02-26 20:02:47,021 - INFO - Received 8800 messages so far
2025-02-26 20:02:47,021 - INFO - Received 8900 messages so far
2025-02-26 20:02:47,021 - INFO - Received 9000 messages so far
2025-02-26 20:02:47,022 - INFO - Received 9100 messages so far
2025-02-26 20:02:47,022 - INFO - Received 9200 messages so far
2025-02-26 20:02:47,022 - INFO - Received 9300 messages so far
2025-02-26 20:02:47,022 - INFO - Received 9400 messages so far
2025-02-26 20:02:47,022 - INFO - Received 9500 messages so far
2025-02-26 20:02:47,023 - INFO - Received 9600 messages so far
2025-02-26 20:02:47,023 - INFO - Received 9700 messages so far
2025-02-26 20:02:47,023 - INFO - Received 9800 messages so far
2025-02-26 20:02:47,023 - INFO - Received 9900 messages so far
2025-02-26 20:02:47,023 - INFO - Received 10000 messages so far
2025-02-26 20:02:47,024 - INFO - Total messages consumed: 10000
2025-02-26 20:02:47,108 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:47,111 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:47,111 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:47,111 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:47,112 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:47,119 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:47,122 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:47,122 - INFO - Number of columns: 66
2025-02-26 20:02:47,133 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
1754       53.0  192.168.1.3  192.168.1.1   udp        62.0       396.0  1.740118e+09      NaN  NaN     dns  CcNxDqAFGhLIjIPs2    50560.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           90.0        1.0          424.0      17.0  0.002166     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7689        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6549        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
650         NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2229        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:47,133 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:47,162 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:47,207 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    c456d0cc73137d45              e456d0cc73137d45  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:47,207 - INFO - Unique values in 'id.resp_p' before labeling: [   53.    nan  9092.   123.   443.  5353.   134. 21116.    80.  1900.
    22.     0.   133.   136. 21115.   138.    67.   547.   135.]
2025-02-26 20:02:47,208 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:47,213 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:47,215 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:47,215 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:47,217 - INFO - DataFrame shape after NA dropping: (853, 23)
2025-02-26 20:02:47,217 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:47,217 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:47,218 - INFO - X shape: (853, 21), y shape: (853,)
2025-02-26 20:02:47,218 - INFO - Label distribution in training data: {'DNS': 711, 'HTTPS': 128, 'HTTP': 13, 'SSH': 1}
2025-02-26 20:02:47,219 - INFO - Training model...
2025-02-26 20:02:47,332 - INFO - Predicting on test data...
2025-02-26 20:02:47,346 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 147.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 2.0
  },
  "HTTPS": {
    "precision": 0.9565217391304348,
    "recall": 1.0,
    "f1-score": 0.9777777777777777,
    "support": 22.0
  },
  "accuracy": 0.9941520467836257,
  "macro avg": {
    "precision": 0.9855072463768115,
    "recall": 0.8333333333333334,
    "f1-score": 0.8814814814814814,
    "support": 171.0
  },
  "weighted avg": {
    "precision": 0.9944063056191202,
    "recall": 0.9941520467836257,
    "f1-score": 0.9932423651721899,
    "support": 171.0
  }
}
2025-02-26 20:02:47,352 - INFO - Saved processed data locally to processed_data_20250226_200247.csv
2025-02-26 20:02:47,355 - INFO - JSON data size: 418819 bytes
2025-02-26 20:02:47,355 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:47,355 - INFO - Data sent successfully!
2025-02-26 20:02:47,355 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:47,356 - INFO - Starting data processing
2025-02-26 20:02:47,356 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:47,357 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:47,357 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:47,357 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:47,459 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:47,459 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:47,459 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:47,459 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:47,459 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:47,460 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:47,460 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:47,460 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:47,461 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:47,613 - INFO - Received 100 messages so far
2025-02-26 20:02:47,613 - INFO - Received 200 messages so far
2025-02-26 20:02:47,614 - INFO - Received 300 messages so far
2025-02-26 20:02:47,614 - INFO - Received 400 messages so far
2025-02-26 20:02:47,614 - INFO - Received 500 messages so far
2025-02-26 20:02:47,614 - INFO - Received 600 messages so far
2025-02-26 20:02:47,615 - INFO - Received 700 messages so far
2025-02-26 20:02:47,615 - INFO - Received 800 messages so far
2025-02-26 20:02:47,615 - INFO - Received 900 messages so far
2025-02-26 20:02:47,615 - INFO - Received 1000 messages so far
2025-02-26 20:02:47,615 - INFO - Received 1100 messages so far
2025-02-26 20:02:47,615 - INFO - Received 1200 messages so far
2025-02-26 20:02:47,616 - INFO - Received 1300 messages so far
2025-02-26 20:02:47,616 - INFO - Received 1400 messages so far
2025-02-26 20:02:47,616 - INFO - Received 1500 messages so far
2025-02-26 20:02:47,616 - INFO - Received 1600 messages so far
2025-02-26 20:02:47,616 - INFO - Received 1700 messages so far
2025-02-26 20:02:47,617 - INFO - Received 1800 messages so far
2025-02-26 20:02:47,617 - INFO - Received 1900 messages so far
2025-02-26 20:02:47,617 - INFO - Received 2000 messages so far
2025-02-26 20:02:47,617 - INFO - Received 2100 messages so far
2025-02-26 20:02:47,617 - INFO - Received 2200 messages so far
2025-02-26 20:02:47,618 - INFO - Received 2300 messages so far
2025-02-26 20:02:47,618 - INFO - Received 2400 messages so far
2025-02-26 20:02:47,618 - INFO - Received 2500 messages so far
2025-02-26 20:02:47,618 - INFO - Received 2600 messages so far
2025-02-26 20:02:47,618 - INFO - Received 2700 messages so far
2025-02-26 20:02:47,619 - INFO - Received 2800 messages so far
2025-02-26 20:02:47,619 - INFO - Received 2900 messages so far
2025-02-26 20:02:47,619 - INFO - Received 3000 messages so far
2025-02-26 20:02:47,619 - INFO - Received 3100 messages so far
2025-02-26 20:02:47,619 - INFO - Received 3200 messages so far
2025-02-26 20:02:47,620 - INFO - Received 3300 messages so far
2025-02-26 20:02:47,620 - INFO - Received 3400 messages so far
2025-02-26 20:02:47,620 - INFO - Received 3500 messages so far
2025-02-26 20:02:47,620 - INFO - Received 3600 messages so far
2025-02-26 20:02:47,620 - INFO - Received 3700 messages so far
2025-02-26 20:02:47,621 - INFO - Received 3800 messages so far
2025-02-26 20:02:47,621 - INFO - Received 3900 messages so far
2025-02-26 20:02:47,621 - INFO - Received 4000 messages so far
2025-02-26 20:02:47,621 - INFO - Received 4100 messages so far
2025-02-26 20:02:47,675 - INFO - Received 4200 messages so far
2025-02-26 20:02:47,675 - INFO - Received 4300 messages so far
2025-02-26 20:02:47,675 - INFO - Received 4400 messages so far
2025-02-26 20:02:47,676 - INFO - Received 4500 messages so far
2025-02-26 20:02:47,676 - INFO - Received 4600 messages so far
2025-02-26 20:02:47,676 - INFO - Received 4700 messages so far
2025-02-26 20:02:47,676 - INFO - Received 4800 messages so far
2025-02-26 20:02:47,676 - INFO - Received 4900 messages so far
2025-02-26 20:02:47,677 - INFO - Received 5000 messages so far
2025-02-26 20:02:47,677 - INFO - Received 5100 messages so far
2025-02-26 20:02:47,677 - INFO - Received 5200 messages so far
2025-02-26 20:02:47,677 - INFO - Received 5300 messages so far
2025-02-26 20:02:47,677 - INFO - Received 5400 messages so far
2025-02-26 20:02:47,678 - INFO - Received 5500 messages so far
2025-02-26 20:02:47,678 - INFO - Received 5600 messages so far
2025-02-26 20:02:47,678 - INFO - Received 5700 messages so far
2025-02-26 20:02:47,678 - INFO - Received 5800 messages so far
2025-02-26 20:02:47,678 - INFO - Received 5900 messages so far
2025-02-26 20:02:47,679 - INFO - Received 6000 messages so far
2025-02-26 20:02:47,679 - INFO - Received 6100 messages so far
2025-02-26 20:02:47,679 - INFO - Received 6200 messages so far
2025-02-26 20:02:47,679 - INFO - Received 6300 messages so far
2025-02-26 20:02:47,679 - INFO - Received 6400 messages so far
2025-02-26 20:02:47,679 - INFO - Received 6500 messages so far
2025-02-26 20:02:47,680 - INFO - Received 6600 messages so far
2025-02-26 20:02:47,680 - INFO - Received 6700 messages so far
2025-02-26 20:02:47,680 - INFO - Received 6800 messages so far
2025-02-26 20:02:47,680 - INFO - Received 6900 messages so far
2025-02-26 20:02:47,680 - INFO - Received 7000 messages so far
2025-02-26 20:02:47,681 - INFO - Received 7100 messages so far
2025-02-26 20:02:47,681 - INFO - Received 7200 messages so far
2025-02-26 20:02:47,681 - INFO - Received 7300 messages so far
2025-02-26 20:02:47,681 - INFO - Received 7400 messages so far
2025-02-26 20:02:47,682 - INFO - Received 7500 messages so far
2025-02-26 20:02:47,682 - INFO - Received 7600 messages so far
2025-02-26 20:02:47,682 - INFO - Received 7700 messages so far
2025-02-26 20:02:47,682 - INFO - Received 7800 messages so far
2025-02-26 20:02:47,682 - INFO - Received 7900 messages so far
2025-02-26 20:02:47,683 - INFO - Received 8000 messages so far
2025-02-26 20:02:47,683 - INFO - Received 8100 messages so far
2025-02-26 20:02:47,683 - INFO - Received 8200 messages so far
2025-02-26 20:02:47,683 - INFO - Received 8300 messages so far
2025-02-26 20:02:47,683 - INFO - Received 8400 messages so far
2025-02-26 20:02:47,684 - INFO - Received 8500 messages so far
2025-02-26 20:02:47,684 - INFO - Received 8600 messages so far
2025-02-26 20:02:47,684 - INFO - Received 8700 messages so far
2025-02-26 20:02:47,781 - INFO - Received 8800 messages so far
2025-02-26 20:02:47,782 - INFO - Received 8900 messages so far
2025-02-26 20:02:47,782 - INFO - Received 9000 messages so far
2025-02-26 20:02:47,782 - INFO - Received 9100 messages so far
2025-02-26 20:02:47,782 - INFO - Received 9200 messages so far
2025-02-26 20:02:47,783 - INFO - Received 9300 messages so far
2025-02-26 20:02:47,783 - INFO - Received 9400 messages so far
2025-02-26 20:02:47,783 - INFO - Received 9500 messages so far
2025-02-26 20:02:47,783 - INFO - Received 9600 messages so far
2025-02-26 20:02:47,783 - INFO - Received 9700 messages so far
2025-02-26 20:02:47,784 - INFO - Received 9800 messages so far
2025-02-26 20:02:47,784 - INFO - Received 9900 messages so far
2025-02-26 20:02:47,784 - INFO - Received 10000 messages so far
2025-02-26 20:02:47,784 - INFO - Total messages consumed: 10000
2025-02-26 20:02:47,872 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:47,876 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:47,876 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:47,876 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:47,876 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:47,883 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:47,886 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:47,887 - INFO - Number of columns: 66
2025-02-26 20:02:47,897 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
328         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6307        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9444        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4012        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
747         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:47,897 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:47,928 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:47,972 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    1b03fbdb1202008c              fb03fbdb1202008c  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:47,973 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.  5353.   443.   123.  1900.    80.   133.   134.
   136. 21116.   138.   547.   135.    22. 21115.     0.    67.]
2025-02-26 20:02:47,974 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:47,979 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:47,980 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:47,980 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:47,983 - INFO - DataFrame shape after NA dropping: (886, 23)
2025-02-26 20:02:47,983 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:47,983 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:47,983 - INFO - X shape: (886, 21), y shape: (886,)
2025-02-26 20:02:47,983 - INFO - Label distribution in training data: {'DNS': 740, 'HTTPS': 131, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:47,984 - INFO - Training model...
2025-02-26 20:02:48,099 - INFO - Predicting on test data...
2025-02-26 20:02:48,113 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 149.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 2.0
  },
  "HTTPS": {
    "precision": 0.9629629629629629,
    "recall": 1.0,
    "f1-score": 0.9811320754716981,
    "support": 26.0
  },
  "SSH": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "accuracy": 0.9943820224719101,
  "macro avg": {
    "precision": 0.7407407407407407,
    "recall": 0.75,
    "f1-score": 0.7452830188679245,
    "support": 178.0
  },
  "weighted avg": {
    "precision": 0.9889721181856014,
    "recall": 0.9943820224719101,
    "f1-score": 0.9916260334958661,
    "support": 178.0
  }
}
2025-02-26 20:02:48,121 - INFO - Saved processed data locally to processed_data_20250226_200248.csv
2025-02-26 20:02:48,123 - INFO - JSON data size: 436369 bytes
2025-02-26 20:02:48,123 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:48,123 - INFO - Data sent successfully!
2025-02-26 20:02:48,123 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:48,124 - INFO - Starting data processing
2025-02-26 20:02:48,124 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:48,125 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:48,126 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:48,126 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:48,228 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:48,228 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:48,228 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:48,228 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:48,228 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:48,229 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:48,230 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:48,230 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:48,230 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:48,382 - INFO - Received 100 messages so far
2025-02-26 20:02:48,383 - INFO - Received 200 messages so far
2025-02-26 20:02:48,383 - INFO - Received 300 messages so far
2025-02-26 20:02:48,383 - INFO - Received 400 messages so far
2025-02-26 20:02:48,383 - INFO - Received 500 messages so far
2025-02-26 20:02:48,383 - INFO - Received 600 messages so far
2025-02-26 20:02:48,384 - INFO - Received 700 messages so far
2025-02-26 20:02:48,384 - INFO - Received 800 messages so far
2025-02-26 20:02:48,384 - INFO - Received 900 messages so far
2025-02-26 20:02:48,384 - INFO - Received 1000 messages so far
2025-02-26 20:02:48,384 - INFO - Received 1100 messages so far
2025-02-26 20:02:48,385 - INFO - Received 1200 messages so far
2025-02-26 20:02:48,385 - INFO - Received 1300 messages so far
2025-02-26 20:02:48,385 - INFO - Received 1400 messages so far
2025-02-26 20:02:48,385 - INFO - Received 1500 messages so far
2025-02-26 20:02:48,385 - INFO - Received 1600 messages so far
2025-02-26 20:02:48,386 - INFO - Received 1700 messages so far
2025-02-26 20:02:48,386 - INFO - Received 1800 messages so far
2025-02-26 20:02:48,386 - INFO - Received 1900 messages so far
2025-02-26 20:02:48,386 - INFO - Received 2000 messages so far
2025-02-26 20:02:48,386 - INFO - Received 2100 messages so far
2025-02-26 20:02:48,387 - INFO - Received 2200 messages so far
2025-02-26 20:02:48,387 - INFO - Received 2300 messages so far
2025-02-26 20:02:48,387 - INFO - Received 2400 messages so far
2025-02-26 20:02:48,387 - INFO - Received 2500 messages so far
2025-02-26 20:02:48,387 - INFO - Received 2600 messages so far
2025-02-26 20:02:48,388 - INFO - Received 2700 messages so far
2025-02-26 20:02:48,388 - INFO - Received 2800 messages so far
2025-02-26 20:02:48,388 - INFO - Received 2900 messages so far
2025-02-26 20:02:48,388 - INFO - Received 3000 messages so far
2025-02-26 20:02:48,388 - INFO - Received 3100 messages so far
2025-02-26 20:02:48,389 - INFO - Received 3200 messages so far
2025-02-26 20:02:48,389 - INFO - Received 3300 messages so far
2025-02-26 20:02:48,389 - INFO - Received 3400 messages so far
2025-02-26 20:02:48,389 - INFO - Received 3500 messages so far
2025-02-26 20:02:48,389 - INFO - Received 3600 messages so far
2025-02-26 20:02:48,390 - INFO - Received 3700 messages so far
2025-02-26 20:02:48,390 - INFO - Received 3800 messages so far
2025-02-26 20:02:48,390 - INFO - Received 3900 messages so far
2025-02-26 20:02:48,390 - INFO - Received 4000 messages so far
2025-02-26 20:02:48,391 - INFO - Received 4100 messages so far
2025-02-26 20:02:48,444 - INFO - Received 4200 messages so far
2025-02-26 20:02:48,445 - INFO - Received 4300 messages so far
2025-02-26 20:02:48,445 - INFO - Received 4400 messages so far
2025-02-26 20:02:48,445 - INFO - Received 4500 messages so far
2025-02-26 20:02:48,445 - INFO - Received 4600 messages so far
2025-02-26 20:02:48,445 - INFO - Received 4700 messages so far
2025-02-26 20:02:48,446 - INFO - Received 4800 messages so far
2025-02-26 20:02:48,446 - INFO - Received 4900 messages so far
2025-02-26 20:02:48,446 - INFO - Received 5000 messages so far
2025-02-26 20:02:48,446 - INFO - Received 5100 messages so far
2025-02-26 20:02:48,446 - INFO - Received 5200 messages so far
2025-02-26 20:02:48,447 - INFO - Received 5300 messages so far
2025-02-26 20:02:48,447 - INFO - Received 5400 messages so far
2025-02-26 20:02:48,447 - INFO - Received 5500 messages so far
2025-02-26 20:02:48,447 - INFO - Received 5600 messages so far
2025-02-26 20:02:48,447 - INFO - Received 5700 messages so far
2025-02-26 20:02:48,448 - INFO - Received 5800 messages so far
2025-02-26 20:02:48,448 - INFO - Received 5900 messages so far
2025-02-26 20:02:48,448 - INFO - Received 6000 messages so far
2025-02-26 20:02:48,448 - INFO - Received 6100 messages so far
2025-02-26 20:02:48,448 - INFO - Received 6200 messages so far
2025-02-26 20:02:48,449 - INFO - Received 6300 messages so far
2025-02-26 20:02:48,449 - INFO - Received 6400 messages so far
2025-02-26 20:02:48,449 - INFO - Received 6500 messages so far
2025-02-26 20:02:48,449 - INFO - Received 6600 messages so far
2025-02-26 20:02:48,449 - INFO - Received 6700 messages so far
2025-02-26 20:02:48,450 - INFO - Received 6800 messages so far
2025-02-26 20:02:48,450 - INFO - Received 6900 messages so far
2025-02-26 20:02:48,450 - INFO - Received 7000 messages so far
2025-02-26 20:02:48,450 - INFO - Received 7100 messages so far
2025-02-26 20:02:48,450 - INFO - Received 7200 messages so far
2025-02-26 20:02:48,450 - INFO - Received 7300 messages so far
2025-02-26 20:02:48,451 - INFO - Received 7400 messages so far
2025-02-26 20:02:48,451 - INFO - Received 7500 messages so far
2025-02-26 20:02:48,451 - INFO - Received 7600 messages so far
2025-02-26 20:02:48,451 - INFO - Received 7700 messages so far
2025-02-26 20:02:48,451 - INFO - Received 7800 messages so far
2025-02-26 20:02:48,452 - INFO - Received 7900 messages so far
2025-02-26 20:02:48,452 - INFO - Received 8000 messages so far
2025-02-26 20:02:48,452 - INFO - Received 8100 messages so far
2025-02-26 20:02:48,452 - INFO - Received 8200 messages so far
2025-02-26 20:02:48,452 - INFO - Received 8300 messages so far
2025-02-26 20:02:48,453 - INFO - Received 8400 messages so far
2025-02-26 20:02:48,453 - INFO - Received 8500 messages so far
2025-02-26 20:02:48,453 - INFO - Received 8600 messages so far
2025-02-26 20:02:48,453 - INFO - Received 8700 messages so far
2025-02-26 20:02:48,510 - INFO - Received 8800 messages so far
2025-02-26 20:02:48,510 - INFO - Received 8900 messages so far
2025-02-26 20:02:48,510 - INFO - Received 9000 messages so far
2025-02-26 20:02:48,510 - INFO - Received 9100 messages so far
2025-02-26 20:02:48,511 - INFO - Received 9200 messages so far
2025-02-26 20:02:48,511 - INFO - Received 9300 messages so far
2025-02-26 20:02:48,511 - INFO - Received 9400 messages so far
2025-02-26 20:02:48,511 - INFO - Received 9500 messages so far
2025-02-26 20:02:48,511 - INFO - Received 9600 messages so far
2025-02-26 20:02:48,512 - INFO - Received 9700 messages so far
2025-02-26 20:02:48,512 - INFO - Received 9800 messages so far
2025-02-26 20:02:48,512 - INFO - Received 9900 messages so far
2025-02-26 20:02:48,512 - INFO - Received 10000 messages so far
2025-02-26 20:02:48,512 - INFO - Total messages consumed: 10000
2025-02-26 20:02:48,599 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:48,603 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:48,603 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:48,603 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:48,603 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:48,611 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:48,614 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:48,614 - INFO - Number of columns: 66
2025-02-26 20:02:48,625 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
6112       53.0  192.168.1.3  192.168.1.1   udp        62.0       396.0  1.740119e+09      NaN  NaN     dns  CcrAxq3nGivllCIQbc    49125.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           90.0        1.0          424.0      17.0  0.002352     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8478        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.005854     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3411        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8939        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4361        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:48,625 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:48,656 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:48,701 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    b90b0ae34b0b9725              f90b0ae34b0b9725  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:48,702 - INFO - Unique values in 'id.resp_p' before labeling: [   53.    nan  9092.   443.  1900.   133.   123.  5353.   134.    80.
   138. 21116.   136.   135. 21115.    67.   547.    22.     0.]
2025-02-26 20:02:48,703 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:48,708 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:48,709 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:48,709 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:48,712 - INFO - DataFrame shape after NA dropping: (907, 23)
2025-02-26 20:02:48,712 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:48,712 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:48,712 - INFO - X shape: (907, 21), y shape: (907,)
2025-02-26 20:02:48,713 - INFO - Label distribution in training data: {'DNS': 759, 'HTTPS': 133, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:48,714 - INFO - Training model...
2025-02-26 20:02:48,831 - INFO - Predicting on test data...
2025-02-26 20:02:48,845 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 146.0
  },
  "HTTP": {
    "precision": 0.8,
    "recall": 1.0,
    "f1-score": 0.8888888888888888,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 0.96875,
    "f1-score": 0.9841269841269841,
    "support": 32.0
  },
  "accuracy": 0.9945054945054945,
  "macro avg": {
    "precision": 0.9333333333333332,
    "recall": 0.9895833333333334,
    "f1-score": 0.9576719576719577,
    "support": 182.0
  },
  "weighted avg": {
    "precision": 0.9956043956043955,
    "recall": 0.9945054945054945,
    "f1-score": 0.9947671376242804,
    "support": 182.0
  }
}
2025-02-26 20:02:48,852 - INFO - Saved processed data locally to processed_data_20250226_200248.csv
2025-02-26 20:02:48,854 - INFO - JSON data size: 444191 bytes
2025-02-26 20:02:48,855 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:48,855 - INFO - Data sent successfully!
2025-02-26 20:02:48,855 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:48,856 - INFO - Starting data processing
2025-02-26 20:02:48,856 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:48,856 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:48,856 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:48,857 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:48,959 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:48,959 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:48,959 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:48,959 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:48,959 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:48,960 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:48,961 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:48,961 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:48,961 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:49,156 - INFO - Received 100 messages so far
2025-02-26 20:02:49,156 - INFO - Received 200 messages so far
2025-02-26 20:02:49,157 - INFO - Received 300 messages so far
2025-02-26 20:02:49,157 - INFO - Received 400 messages so far
2025-02-26 20:02:49,157 - INFO - Received 500 messages so far
2025-02-26 20:02:49,157 - INFO - Received 600 messages so far
2025-02-26 20:02:49,157 - INFO - Received 700 messages so far
2025-02-26 20:02:49,158 - INFO - Received 800 messages so far
2025-02-26 20:02:49,158 - INFO - Received 900 messages so far
2025-02-26 20:02:49,158 - INFO - Received 1000 messages so far
2025-02-26 20:02:49,158 - INFO - Received 1100 messages so far
2025-02-26 20:02:49,158 - INFO - Received 1200 messages so far
2025-02-26 20:02:49,159 - INFO - Received 1300 messages so far
2025-02-26 20:02:49,159 - INFO - Received 1400 messages so far
2025-02-26 20:02:49,159 - INFO - Received 1500 messages so far
2025-02-26 20:02:49,159 - INFO - Received 1600 messages so far
2025-02-26 20:02:49,159 - INFO - Received 1700 messages so far
2025-02-26 20:02:49,160 - INFO - Received 1800 messages so far
2025-02-26 20:02:49,160 - INFO - Received 1900 messages so far
2025-02-26 20:02:49,160 - INFO - Received 2000 messages so far
2025-02-26 20:02:49,160 - INFO - Received 2100 messages so far
2025-02-26 20:02:49,160 - INFO - Received 2200 messages so far
2025-02-26 20:02:49,161 - INFO - Received 2300 messages so far
2025-02-26 20:02:49,161 - INFO - Received 2400 messages so far
2025-02-26 20:02:49,161 - INFO - Received 2500 messages so far
2025-02-26 20:02:49,161 - INFO - Received 2600 messages so far
2025-02-26 20:02:49,161 - INFO - Received 2700 messages so far
2025-02-26 20:02:49,162 - INFO - Received 2800 messages so far
2025-02-26 20:02:49,162 - INFO - Received 2900 messages so far
2025-02-26 20:02:49,162 - INFO - Received 3000 messages so far
2025-02-26 20:02:49,162 - INFO - Received 3100 messages so far
2025-02-26 20:02:49,162 - INFO - Received 3200 messages so far
2025-02-26 20:02:49,163 - INFO - Received 3300 messages so far
2025-02-26 20:02:49,163 - INFO - Received 3400 messages so far
2025-02-26 20:02:49,163 - INFO - Received 3500 messages so far
2025-02-26 20:02:49,163 - INFO - Received 3600 messages so far
2025-02-26 20:02:49,163 - INFO - Received 3700 messages so far
2025-02-26 20:02:49,164 - INFO - Received 3800 messages so far
2025-02-26 20:02:49,164 - INFO - Received 3900 messages so far
2025-02-26 20:02:49,164 - INFO - Received 4000 messages so far
2025-02-26 20:02:49,164 - INFO - Received 4100 messages so far
2025-02-26 20:02:49,218 - INFO - Received 4200 messages so far
2025-02-26 20:02:49,218 - INFO - Received 4300 messages so far
2025-02-26 20:02:49,219 - INFO - Received 4400 messages so far
2025-02-26 20:02:49,219 - INFO - Received 4500 messages so far
2025-02-26 20:02:49,219 - INFO - Received 4600 messages so far
2025-02-26 20:02:49,219 - INFO - Received 4700 messages so far
2025-02-26 20:02:49,220 - INFO - Received 4800 messages so far
2025-02-26 20:02:49,220 - INFO - Received 4900 messages so far
2025-02-26 20:02:49,220 - INFO - Received 5000 messages so far
2025-02-26 20:02:49,220 - INFO - Received 5100 messages so far
2025-02-26 20:02:49,220 - INFO - Received 5200 messages so far
2025-02-26 20:02:49,220 - INFO - Received 5300 messages so far
2025-02-26 20:02:49,221 - INFO - Received 5400 messages so far
2025-02-26 20:02:49,221 - INFO - Received 5500 messages so far
2025-02-26 20:02:49,221 - INFO - Received 5600 messages so far
2025-02-26 20:02:49,221 - INFO - Received 5700 messages so far
2025-02-26 20:02:49,221 - INFO - Received 5800 messages so far
2025-02-26 20:02:49,222 - INFO - Received 5900 messages so far
2025-02-26 20:02:49,222 - INFO - Received 6000 messages so far
2025-02-26 20:02:49,222 - INFO - Received 6100 messages so far
2025-02-26 20:02:49,222 - INFO - Received 6200 messages so far
2025-02-26 20:02:49,222 - INFO - Received 6300 messages so far
2025-02-26 20:02:49,223 - INFO - Received 6400 messages so far
2025-02-26 20:02:49,223 - INFO - Received 6500 messages so far
2025-02-26 20:02:49,223 - INFO - Received 6600 messages so far
2025-02-26 20:02:49,223 - INFO - Received 6700 messages so far
2025-02-26 20:02:49,223 - INFO - Received 6800 messages so far
2025-02-26 20:02:49,224 - INFO - Received 6900 messages so far
2025-02-26 20:02:49,224 - INFO - Received 7000 messages so far
2025-02-26 20:02:49,224 - INFO - Received 7100 messages so far
2025-02-26 20:02:49,224 - INFO - Received 7200 messages so far
2025-02-26 20:02:49,224 - INFO - Received 7300 messages so far
2025-02-26 20:02:49,225 - INFO - Received 7400 messages so far
2025-02-26 20:02:49,225 - INFO - Received 7500 messages so far
2025-02-26 20:02:49,225 - INFO - Received 7600 messages so far
2025-02-26 20:02:49,225 - INFO - Received 7700 messages so far
2025-02-26 20:02:49,225 - INFO - Received 7800 messages so far
2025-02-26 20:02:49,226 - INFO - Received 7900 messages so far
2025-02-26 20:02:49,226 - INFO - Received 8000 messages so far
2025-02-26 20:02:49,226 - INFO - Received 8100 messages so far
2025-02-26 20:02:49,226 - INFO - Received 8200 messages so far
2025-02-26 20:02:49,226 - INFO - Received 8300 messages so far
2025-02-26 20:02:49,226 - INFO - Received 8400 messages so far
2025-02-26 20:02:49,227 - INFO - Received 8500 messages so far
2025-02-26 20:02:49,227 - INFO - Received 8600 messages so far
2025-02-26 20:02:49,227 - INFO - Received 8700 messages so far
2025-02-26 20:02:49,283 - INFO - Received 8800 messages so far
2025-02-26 20:02:49,283 - INFO - Received 8900 messages so far
2025-02-26 20:02:49,283 - INFO - Received 9000 messages so far
2025-02-26 20:02:49,283 - INFO - Received 9100 messages so far
2025-02-26 20:02:49,283 - INFO - Received 9200 messages so far
2025-02-26 20:02:49,284 - INFO - Received 9300 messages so far
2025-02-26 20:02:49,284 - INFO - Received 9400 messages so far
2025-02-26 20:02:49,284 - INFO - Received 9500 messages so far
2025-02-26 20:02:49,284 - INFO - Received 9600 messages so far
2025-02-26 20:02:49,284 - INFO - Received 9700 messages so far
2025-02-26 20:02:49,285 - INFO - Received 9800 messages so far
2025-02-26 20:02:49,285 - INFO - Received 9900 messages so far
2025-02-26 20:02:49,285 - INFO - Received 10000 messages so far
2025-02-26 20:02:49,285 - INFO - Total messages consumed: 10000
2025-02-26 20:02:49,373 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:49,377 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:49,377 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:49,377 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:49,377 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:49,385 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:49,388 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:49,388 - INFO - Number of columns: 66
2025-02-26 20:02:49,398 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
2607        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7936        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5982        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5178        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6326        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:49,398 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:49,430 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:49,475 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    2fe788e3cc713726              efe788e3cc713726  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:49,475 - INFO - Unique values in 'id.resp_p' before labeling: [   nan   443.    53.  9092.   136.  1900.    80.   133.  5353.   123.
   134. 21115.     0.   138.   135.    67.   547.    22. 21116.]
2025-02-26 20:02:49,476 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:49,482 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:49,483 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:49,483 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:49,485 - INFO - DataFrame shape after NA dropping: (811, 23)
2025-02-26 20:02:49,485 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:49,485 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:49,486 - INFO - X shape: (811, 21), y shape: (811,)
2025-02-26 20:02:49,486 - INFO - Label distribution in training data: {'DNS': 684, 'HTTPS': 114, 'HTTP': 12, 'SSH': 1}
2025-02-26 20:02:49,487 - INFO - Training model...
2025-02-26 20:02:49,597 - INFO - Predicting on test data...
2025-02-26 20:02:49,610 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 137.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 2.0
  },
  "HTTPS": {
    "precision": 0.96,
    "recall": 1.0,
    "f1-score": 0.9795918367346939,
    "support": 24.0
  },
  "accuracy": 0.9938650306748467,
  "macro avg": {
    "precision": 0.9866666666666667,
    "recall": 0.8333333333333334,
    "f1-score": 0.8820861678004533,
    "support": 163.0
  },
  "weighted avg": {
    "precision": 0.9941104294478527,
    "recall": 0.9938650306748467,
    "f1-score": 0.9929051375151288,
    "support": 163.0
  }
}
2025-02-26 20:02:49,616 - INFO - Saved processed data locally to processed_data_20250226_200249.csv
2025-02-26 20:02:49,618 - INFO - JSON data size: 397765 bytes
2025-02-26 20:02:49,618 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:49,618 - INFO - Data sent successfully!
2025-02-26 20:02:49,619 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:49,619 - INFO - Starting data processing
2025-02-26 20:02:49,620 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:49,620 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:49,621 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:49,621 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:49,723 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:49,723 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:49,723 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:49,723 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:49,723 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:49,724 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:49,724 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:49,725 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:49,725 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:49,878 - INFO - Received 100 messages so far
2025-02-26 20:02:49,878 - INFO - Received 200 messages so far
2025-02-26 20:02:49,879 - INFO - Received 300 messages so far
2025-02-26 20:02:49,879 - INFO - Received 400 messages so far
2025-02-26 20:02:49,879 - INFO - Received 500 messages so far
2025-02-26 20:02:49,879 - INFO - Received 600 messages so far
2025-02-26 20:02:49,879 - INFO - Received 700 messages so far
2025-02-26 20:02:49,880 - INFO - Received 800 messages so far
2025-02-26 20:02:49,880 - INFO - Received 900 messages so far
2025-02-26 20:02:49,880 - INFO - Received 1000 messages so far
2025-02-26 20:02:49,880 - INFO - Received 1100 messages so far
2025-02-26 20:02:49,880 - INFO - Received 1200 messages so far
2025-02-26 20:02:49,881 - INFO - Received 1300 messages so far
2025-02-26 20:02:49,881 - INFO - Received 1400 messages so far
2025-02-26 20:02:49,881 - INFO - Received 1500 messages so far
2025-02-26 20:02:49,881 - INFO - Received 1600 messages so far
2025-02-26 20:02:49,881 - INFO - Received 1700 messages so far
2025-02-26 20:02:49,882 - INFO - Received 1800 messages so far
2025-02-26 20:02:49,882 - INFO - Received 1900 messages so far
2025-02-26 20:02:49,882 - INFO - Received 2000 messages so far
2025-02-26 20:02:49,882 - INFO - Received 2100 messages so far
2025-02-26 20:02:49,882 - INFO - Received 2200 messages so far
2025-02-26 20:02:49,883 - INFO - Received 2300 messages so far
2025-02-26 20:02:49,883 - INFO - Received 2400 messages so far
2025-02-26 20:02:49,883 - INFO - Received 2500 messages so far
2025-02-26 20:02:49,883 - INFO - Received 2600 messages so far
2025-02-26 20:02:49,883 - INFO - Received 2700 messages so far
2025-02-26 20:02:49,884 - INFO - Received 2800 messages so far
2025-02-26 20:02:49,884 - INFO - Received 2900 messages so far
2025-02-26 20:02:49,884 - INFO - Received 3000 messages so far
2025-02-26 20:02:49,884 - INFO - Received 3100 messages so far
2025-02-26 20:02:49,884 - INFO - Received 3200 messages so far
2025-02-26 20:02:49,885 - INFO - Received 3300 messages so far
2025-02-26 20:02:49,885 - INFO - Received 3400 messages so far
2025-02-26 20:02:49,885 - INFO - Received 3500 messages so far
2025-02-26 20:02:49,885 - INFO - Received 3600 messages so far
2025-02-26 20:02:49,885 - INFO - Received 3700 messages so far
2025-02-26 20:02:49,885 - INFO - Received 3800 messages so far
2025-02-26 20:02:49,886 - INFO - Received 3900 messages so far
2025-02-26 20:02:49,886 - INFO - Received 4000 messages so far
2025-02-26 20:02:49,886 - INFO - Received 4100 messages so far
2025-02-26 20:02:49,981 - INFO - Received 4200 messages so far
2025-02-26 20:02:49,981 - INFO - Received 4300 messages so far
2025-02-26 20:02:49,981 - INFO - Received 4400 messages so far
2025-02-26 20:02:49,981 - INFO - Received 4500 messages so far
2025-02-26 20:02:49,981 - INFO - Received 4600 messages so far
2025-02-26 20:02:49,982 - INFO - Received 4700 messages so far
2025-02-26 20:02:49,982 - INFO - Received 4800 messages so far
2025-02-26 20:02:49,982 - INFO - Received 4900 messages so far
2025-02-26 20:02:49,982 - INFO - Received 5000 messages so far
2025-02-26 20:02:49,982 - INFO - Received 5100 messages so far
2025-02-26 20:02:49,983 - INFO - Received 5200 messages so far
2025-02-26 20:02:49,983 - INFO - Received 5300 messages so far
2025-02-26 20:02:49,983 - INFO - Received 5400 messages so far
2025-02-26 20:02:49,983 - INFO - Received 5500 messages so far
2025-02-26 20:02:49,983 - INFO - Received 5600 messages so far
2025-02-26 20:02:49,984 - INFO - Received 5700 messages so far
2025-02-26 20:02:49,984 - INFO - Received 5800 messages so far
2025-02-26 20:02:49,984 - INFO - Received 5900 messages so far
2025-02-26 20:02:49,984 - INFO - Received 6000 messages so far
2025-02-26 20:02:49,984 - INFO - Received 6100 messages so far
2025-02-26 20:02:49,985 - INFO - Received 6200 messages so far
2025-02-26 20:02:49,985 - INFO - Received 6300 messages so far
2025-02-26 20:02:49,985 - INFO - Received 6400 messages so far
2025-02-26 20:02:49,985 - INFO - Received 6500 messages so far
2025-02-26 20:02:49,985 - INFO - Received 6600 messages so far
2025-02-26 20:02:49,986 - INFO - Received 6700 messages so far
2025-02-26 20:02:49,986 - INFO - Received 6800 messages so far
2025-02-26 20:02:49,986 - INFO - Received 6900 messages so far
2025-02-26 20:02:49,986 - INFO - Received 7000 messages so far
2025-02-26 20:02:49,986 - INFO - Received 7100 messages so far
2025-02-26 20:02:49,987 - INFO - Received 7200 messages so far
2025-02-26 20:02:49,987 - INFO - Received 7300 messages so far
2025-02-26 20:02:49,987 - INFO - Received 7400 messages so far
2025-02-26 20:02:49,987 - INFO - Received 7500 messages so far
2025-02-26 20:02:49,987 - INFO - Received 7600 messages so far
2025-02-26 20:02:49,988 - INFO - Received 7700 messages so far
2025-02-26 20:02:49,988 - INFO - Received 7800 messages so far
2025-02-26 20:02:49,988 - INFO - Received 7900 messages so far
2025-02-26 20:02:49,988 - INFO - Received 8000 messages so far
2025-02-26 20:02:49,988 - INFO - Received 8100 messages so far
2025-02-26 20:02:49,989 - INFO - Received 8200 messages so far
2025-02-26 20:02:49,989 - INFO - Received 8300 messages so far
2025-02-26 20:02:49,989 - INFO - Received 8400 messages so far
2025-02-26 20:02:49,989 - INFO - Received 8500 messages so far
2025-02-26 20:02:49,989 - INFO - Received 8600 messages so far
2025-02-26 20:02:49,990 - INFO - Received 8700 messages so far
2025-02-26 20:02:50,045 - INFO - Received 8800 messages so far
2025-02-26 20:02:50,045 - INFO - Received 8900 messages so far
2025-02-26 20:02:50,045 - INFO - Received 9000 messages so far
2025-02-26 20:02:50,045 - INFO - Received 9100 messages so far
2025-02-26 20:02:50,046 - INFO - Received 9200 messages so far
2025-02-26 20:02:50,046 - INFO - Received 9300 messages so far
2025-02-26 20:02:50,046 - INFO - Received 9400 messages so far
2025-02-26 20:02:50,046 - INFO - Received 9500 messages so far
2025-02-26 20:02:50,046 - INFO - Received 9600 messages so far
2025-02-26 20:02:50,047 - INFO - Received 9700 messages so far
2025-02-26 20:02:50,047 - INFO - Received 9800 messages so far
2025-02-26 20:02:50,047 - INFO - Received 9900 messages so far
2025-02-26 20:02:50,047 - INFO - Received 10000 messages so far
2025-02-26 20:02:50,047 - INFO - Total messages consumed: 10000
2025-02-26 20:02:50,135 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:50,139 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:50,139 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:50,139 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:50,139 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:50,146 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:50,149 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:50,149 - INFO - Number of columns: 66
2025-02-26 20:02:50,160 - INFO - DataFrame head:
      id.resp_p    id.orig_h     id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid                                 cipher      curve            server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9907        NaN          NaN           NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN                                    NaN        NaN                    NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3650        NaN          NaN           NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN                                    NaN        NaN                    NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1891        NaN          NaN           NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN                                    NaN        NaN                    NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
329         NaN          NaN           NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN                                    NaN        NaN                    NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7830      443.0  192.168.1.3  13.107.42.16   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  Covr9y10CRpyTpgiSg    55814.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN  TLSv12                 NaN         NaN         NaN  TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384  secp384r1  config.edge.skype.com   False        True  CsxuknGIti            h2          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:50,160 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:50,190 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:50,237 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version           client_initial_dcid client_scid                   server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                            19          19                            17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                            19           1                            17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13  e66e05fe576deac0adb1fa816be6              e545068f19ba9a27fe6c1bcaec57  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                             1          19                             1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:50,237 - INFO - Unique values in 'id.resp_p' before labeling: [   nan   443.  9092.  1900.    53.   133.  5353.    80.   138.    22.
   123.   136.   134.   135. 21115.     0.    67. 21116.   547.]
2025-02-26 20:02:50,238 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:50,243 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:50,245 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:50,245 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:50,247 - INFO - DataFrame shape after NA dropping: (859, 23)
2025-02-26 20:02:50,247 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:50,247 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:50,247 - INFO - X shape: (859, 21), y shape: (859,)
2025-02-26 20:02:50,248 - INFO - Label distribution in training data: {'DNS': 718, 'HTTPS': 127, 'HTTP': 13, 'SSH': 1}
2025-02-26 20:02:50,249 - INFO - Training model...
2025-02-26 20:02:50,361 - INFO - Predicting on test data...
2025-02-26 20:02:50,374 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 141.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.6,
    "f1-score": 0.75,
    "support": 5.0
  },
  "HTTPS": {
    "precision": 0.9285714285714286,
    "recall": 1.0,
    "f1-score": 0.9629629629629629,
    "support": 26.0
  },
  "accuracy": 0.9883720930232558,
  "macro avg": {
    "precision": 0.9761904761904763,
    "recall": 0.8666666666666667,
    "f1-score": 0.9043209876543209,
    "support": 172.0
  },
  "weighted avg": {
    "precision": 0.989202657807309,
    "recall": 0.9883720930232558,
    "f1-score": 0.9871339362618432,
    "support": 172.0
  }
}
2025-02-26 20:02:50,380 - INFO - Saved processed data locally to processed_data_20250226_200250.csv
2025-02-26 20:02:50,382 - INFO - JSON data size: 422195 bytes
2025-02-26 20:02:50,382 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:50,382 - INFO - Data sent successfully!
2025-02-26 20:02:50,382 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:50,383 - INFO - Starting data processing
2025-02-26 20:02:50,383 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:50,384 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:50,384 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:50,384 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:50,486 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:50,486 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:50,486 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:50,487 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:50,487 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:50,491 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:50,491 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:50,491 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:50,491 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:50,644 - INFO - Received 100 messages so far
2025-02-26 20:02:50,645 - INFO - Received 200 messages so far
2025-02-26 20:02:50,645 - INFO - Received 300 messages so far
2025-02-26 20:02:50,645 - INFO - Received 400 messages so far
2025-02-26 20:02:50,645 - INFO - Received 500 messages so far
2025-02-26 20:02:50,645 - INFO - Received 600 messages so far
2025-02-26 20:02:50,646 - INFO - Received 700 messages so far
2025-02-26 20:02:50,646 - INFO - Received 800 messages so far
2025-02-26 20:02:50,646 - INFO - Received 900 messages so far
2025-02-26 20:02:50,646 - INFO - Received 1000 messages so far
2025-02-26 20:02:50,646 - INFO - Received 1100 messages so far
2025-02-26 20:02:50,647 - INFO - Received 1200 messages so far
2025-02-26 20:02:50,647 - INFO - Received 1300 messages so far
2025-02-26 20:02:50,647 - INFO - Received 1400 messages so far
2025-02-26 20:02:50,647 - INFO - Received 1500 messages so far
2025-02-26 20:02:50,647 - INFO - Received 1600 messages so far
2025-02-26 20:02:50,648 - INFO - Received 1700 messages so far
2025-02-26 20:02:50,648 - INFO - Received 1800 messages so far
2025-02-26 20:02:50,648 - INFO - Received 1900 messages so far
2025-02-26 20:02:50,648 - INFO - Received 2000 messages so far
2025-02-26 20:02:50,648 - INFO - Received 2100 messages so far
2025-02-26 20:02:50,648 - INFO - Received 2200 messages so far
2025-02-26 20:02:50,649 - INFO - Received 2300 messages so far
2025-02-26 20:02:50,649 - INFO - Received 2400 messages so far
2025-02-26 20:02:50,649 - INFO - Received 2500 messages so far
2025-02-26 20:02:50,649 - INFO - Received 2600 messages so far
2025-02-26 20:02:50,649 - INFO - Received 2700 messages so far
2025-02-26 20:02:50,650 - INFO - Received 2800 messages so far
2025-02-26 20:02:50,650 - INFO - Received 2900 messages so far
2025-02-26 20:02:50,650 - INFO - Received 3000 messages so far
2025-02-26 20:02:50,650 - INFO - Received 3100 messages so far
2025-02-26 20:02:50,650 - INFO - Received 3200 messages so far
2025-02-26 20:02:50,651 - INFO - Received 3300 messages so far
2025-02-26 20:02:50,651 - INFO - Received 3400 messages so far
2025-02-26 20:02:50,651 - INFO - Received 3500 messages so far
2025-02-26 20:02:50,651 - INFO - Received 3600 messages so far
2025-02-26 20:02:50,651 - INFO - Received 3700 messages so far
2025-02-26 20:02:50,652 - INFO - Received 3800 messages so far
2025-02-26 20:02:50,652 - INFO - Received 3900 messages so far
2025-02-26 20:02:50,652 - INFO - Received 4000 messages so far
2025-02-26 20:02:50,652 - INFO - Received 4100 messages so far
2025-02-26 20:02:50,710 - INFO - Received 4200 messages so far
2025-02-26 20:02:50,710 - INFO - Received 4300 messages so far
2025-02-26 20:02:50,710 - INFO - Received 4400 messages so far
2025-02-26 20:02:50,710 - INFO - Received 4500 messages so far
2025-02-26 20:02:50,711 - INFO - Received 4600 messages so far
2025-02-26 20:02:50,711 - INFO - Received 4700 messages so far
2025-02-26 20:02:50,711 - INFO - Received 4800 messages so far
2025-02-26 20:02:50,711 - INFO - Received 4900 messages so far
2025-02-26 20:02:50,711 - INFO - Received 5000 messages so far
2025-02-26 20:02:50,712 - INFO - Received 5100 messages so far
2025-02-26 20:02:50,712 - INFO - Received 5200 messages so far
2025-02-26 20:02:50,712 - INFO - Received 5300 messages so far
2025-02-26 20:02:50,712 - INFO - Received 5400 messages so far
2025-02-26 20:02:50,712 - INFO - Received 5500 messages so far
2025-02-26 20:02:50,713 - INFO - Received 5600 messages so far
2025-02-26 20:02:50,713 - INFO - Received 5700 messages so far
2025-02-26 20:02:50,713 - INFO - Received 5800 messages so far
2025-02-26 20:02:50,713 - INFO - Received 5900 messages so far
2025-02-26 20:02:50,713 - INFO - Received 6000 messages so far
2025-02-26 20:02:50,714 - INFO - Received 6100 messages so far
2025-02-26 20:02:50,714 - INFO - Received 6200 messages so far
2025-02-26 20:02:50,714 - INFO - Received 6300 messages so far
2025-02-26 20:02:50,714 - INFO - Received 6400 messages so far
2025-02-26 20:02:50,714 - INFO - Received 6500 messages so far
2025-02-26 20:02:50,715 - INFO - Received 6600 messages so far
2025-02-26 20:02:50,715 - INFO - Received 6700 messages so far
2025-02-26 20:02:50,715 - INFO - Received 6800 messages so far
2025-02-26 20:02:50,715 - INFO - Received 6900 messages so far
2025-02-26 20:02:50,715 - INFO - Received 7000 messages so far
2025-02-26 20:02:50,715 - INFO - Received 7100 messages so far
2025-02-26 20:02:50,716 - INFO - Received 7200 messages so far
2025-02-26 20:02:50,716 - INFO - Received 7300 messages so far
2025-02-26 20:02:50,716 - INFO - Received 7400 messages so far
2025-02-26 20:02:50,716 - INFO - Received 7500 messages so far
2025-02-26 20:02:50,716 - INFO - Received 7600 messages so far
2025-02-26 20:02:50,717 - INFO - Received 7700 messages so far
2025-02-26 20:02:50,717 - INFO - Received 7800 messages so far
2025-02-26 20:02:50,717 - INFO - Received 7900 messages so far
2025-02-26 20:02:50,717 - INFO - Received 8000 messages so far
2025-02-26 20:02:50,717 - INFO - Received 8100 messages so far
2025-02-26 20:02:50,718 - INFO - Received 8200 messages so far
2025-02-26 20:02:50,718 - INFO - Received 8300 messages so far
2025-02-26 20:02:50,718 - INFO - Received 8400 messages so far
2025-02-26 20:02:50,718 - INFO - Received 8500 messages so far
2025-02-26 20:02:50,718 - INFO - Received 8600 messages so far
2025-02-26 20:02:50,719 - INFO - Received 8700 messages so far
2025-02-26 20:02:50,775 - INFO - Received 8800 messages so far
2025-02-26 20:02:50,775 - INFO - Received 8900 messages so far
2025-02-26 20:02:50,775 - INFO - Received 9000 messages so far
2025-02-26 20:02:50,776 - INFO - Received 9100 messages so far
2025-02-26 20:02:50,776 - INFO - Received 9200 messages so far
2025-02-26 20:02:50,776 - INFO - Received 9300 messages so far
2025-02-26 20:02:50,776 - INFO - Received 9400 messages so far
2025-02-26 20:02:50,776 - INFO - Received 9500 messages so far
2025-02-26 20:02:50,777 - INFO - Received 9600 messages so far
2025-02-26 20:02:50,777 - INFO - Received 9700 messages so far
2025-02-26 20:02:50,777 - INFO - Received 9800 messages so far
2025-02-26 20:02:50,777 - INFO - Received 9900 messages so far
2025-02-26 20:02:50,777 - INFO - Received 10000 messages so far
2025-02-26 20:02:50,777 - INFO - Total messages consumed: 10000
2025-02-26 20:02:50,863 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:50,867 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:50,867 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:50,867 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:50,868 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:50,875 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:50,878 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:50,878 - INFO - Number of columns: 66
2025-02-26 20:02:50,888 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
1251        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3623        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.007205     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6358        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8950        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3822        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:50,888 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:50,918 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:51,006 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    56c8fcf4a1052fc6              f6c8fcf4a1052fc6  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:51,006 - INFO - Unique values in 'id.resp_p' before labeling: [   nan   123.  9092.    53.   443.  1900.    80.   134.  5353. 21115.
   133.   136. 21116.   138.   135.     0.    22.    67.   547.]
2025-02-26 20:02:51,008 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:51,015 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:51,017 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:51,017 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:51,019 - INFO - DataFrame shape after NA dropping: (841, 23)
2025-02-26 20:02:51,019 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:51,019 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:51,020 - INFO - X shape: (841, 21), y shape: (841,)
2025-02-26 20:02:51,020 - INFO - Label distribution in training data: {'DNS': 706, 'HTTPS': 121, 'HTTP': 13, 'SSH': 1}
2025-02-26 20:02:51,021 - INFO - Training model...
2025-02-26 20:02:51,131 - INFO - Predicting on test data...
2025-02-26 20:02:51,145 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 133.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.3333333333333333,
    "f1-score": 0.5,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.9428571428571428,
    "recall": 1.0,
    "f1-score": 0.9705882352941176,
    "support": 33.0
  },
  "accuracy": 0.9881656804733728,
  "macro avg": {
    "precision": 0.980952380952381,
    "recall": 0.7777777777777777,
    "f1-score": 0.823529411764706,
    "support": 169.0
  },
  "weighted avg": {
    "precision": 0.9888419273034657,
    "recall": 0.9881656804733728,
    "f1-score": 0.9853811347024016,
    "support": 169.0
  }
}
2025-02-26 20:02:51,151 - INFO - Saved processed data locally to processed_data_20250226_200251.csv
2025-02-26 20:02:51,154 - INFO - JSON data size: 416076 bytes
2025-02-26 20:02:51,154 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:51,154 - INFO - Data sent successfully!
2025-02-26 20:02:51,154 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:51,155 - INFO - Starting data processing
2025-02-26 20:02:51,155 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:51,156 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:51,157 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:51,157 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:51,258 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:51,259 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:51,259 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:51,259 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:51,259 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:51,260 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:51,260 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:51,260 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:51,260 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:51,413 - INFO - Received 100 messages so far
2025-02-26 20:02:51,413 - INFO - Received 200 messages so far
2025-02-26 20:02:51,413 - INFO - Received 300 messages so far
2025-02-26 20:02:51,413 - INFO - Received 400 messages so far
2025-02-26 20:02:51,413 - INFO - Received 500 messages so far
2025-02-26 20:02:51,414 - INFO - Received 600 messages so far
2025-02-26 20:02:51,414 - INFO - Received 700 messages so far
2025-02-26 20:02:51,414 - INFO - Received 800 messages so far
2025-02-26 20:02:51,414 - INFO - Received 900 messages so far
2025-02-26 20:02:51,414 - INFO - Received 1000 messages so far
2025-02-26 20:02:51,415 - INFO - Received 1100 messages so far
2025-02-26 20:02:51,415 - INFO - Received 1200 messages so far
2025-02-26 20:02:51,415 - INFO - Received 1300 messages so far
2025-02-26 20:02:51,415 - INFO - Received 1400 messages so far
2025-02-26 20:02:51,415 - INFO - Received 1500 messages so far
2025-02-26 20:02:51,416 - INFO - Received 1600 messages so far
2025-02-26 20:02:51,416 - INFO - Received 1700 messages so far
2025-02-26 20:02:51,416 - INFO - Received 1800 messages so far
2025-02-26 20:02:51,416 - INFO - Received 1900 messages so far
2025-02-26 20:02:51,416 - INFO - Received 2000 messages so far
2025-02-26 20:02:51,417 - INFO - Received 2100 messages so far
2025-02-26 20:02:51,417 - INFO - Received 2200 messages so far
2025-02-26 20:02:51,417 - INFO - Received 2300 messages so far
2025-02-26 20:02:51,417 - INFO - Received 2400 messages so far
2025-02-26 20:02:51,417 - INFO - Received 2500 messages so far
2025-02-26 20:02:51,417 - INFO - Received 2600 messages so far
2025-02-26 20:02:51,418 - INFO - Received 2700 messages so far
2025-02-26 20:02:51,418 - INFO - Received 2800 messages so far
2025-02-26 20:02:51,418 - INFO - Received 2900 messages so far
2025-02-26 20:02:51,418 - INFO - Received 3000 messages so far
2025-02-26 20:02:51,418 - INFO - Received 3100 messages so far
2025-02-26 20:02:51,419 - INFO - Received 3200 messages so far
2025-02-26 20:02:51,419 - INFO - Received 3300 messages so far
2025-02-26 20:02:51,419 - INFO - Received 3400 messages so far
2025-02-26 20:02:51,419 - INFO - Received 3500 messages so far
2025-02-26 20:02:51,419 - INFO - Received 3600 messages so far
2025-02-26 20:02:51,420 - INFO - Received 3700 messages so far
2025-02-26 20:02:51,420 - INFO - Received 3800 messages so far
2025-02-26 20:02:51,420 - INFO - Received 3900 messages so far
2025-02-26 20:02:51,420 - INFO - Received 4000 messages so far
2025-02-26 20:02:51,421 - INFO - Received 4100 messages so far
2025-02-26 20:02:51,476 - INFO - Received 4200 messages so far
2025-02-26 20:02:51,476 - INFO - Received 4300 messages so far
2025-02-26 20:02:51,476 - INFO - Received 4400 messages so far
2025-02-26 20:02:51,476 - INFO - Received 4500 messages so far
2025-02-26 20:02:51,477 - INFO - Received 4600 messages so far
2025-02-26 20:02:51,477 - INFO - Received 4700 messages so far
2025-02-26 20:02:51,477 - INFO - Received 4800 messages so far
2025-02-26 20:02:51,477 - INFO - Received 4900 messages so far
2025-02-26 20:02:51,477 - INFO - Received 5000 messages so far
2025-02-26 20:02:51,478 - INFO - Received 5100 messages so far
2025-02-26 20:02:51,478 - INFO - Received 5200 messages so far
2025-02-26 20:02:51,478 - INFO - Received 5300 messages so far
2025-02-26 20:02:51,478 - INFO - Received 5400 messages so far
2025-02-26 20:02:51,478 - INFO - Received 5500 messages so far
2025-02-26 20:02:51,479 - INFO - Received 5600 messages so far
2025-02-26 20:02:51,479 - INFO - Received 5700 messages so far
2025-02-26 20:02:51,479 - INFO - Received 5800 messages so far
2025-02-26 20:02:51,479 - INFO - Received 5900 messages so far
2025-02-26 20:02:51,479 - INFO - Received 6000 messages so far
2025-02-26 20:02:51,480 - INFO - Received 6100 messages so far
2025-02-26 20:02:51,480 - INFO - Received 6200 messages so far
2025-02-26 20:02:51,480 - INFO - Received 6300 messages so far
2025-02-26 20:02:51,480 - INFO - Received 6400 messages so far
2025-02-26 20:02:51,480 - INFO - Received 6500 messages so far
2025-02-26 20:02:51,481 - INFO - Received 6600 messages so far
2025-02-26 20:02:51,481 - INFO - Received 6700 messages so far
2025-02-26 20:02:51,481 - INFO - Received 6800 messages so far
2025-02-26 20:02:51,481 - INFO - Received 6900 messages so far
2025-02-26 20:02:51,481 - INFO - Received 7000 messages so far
2025-02-26 20:02:51,482 - INFO - Received 7100 messages so far
2025-02-26 20:02:51,482 - INFO - Received 7200 messages so far
2025-02-26 20:02:51,482 - INFO - Received 7300 messages so far
2025-02-26 20:02:51,482 - INFO - Received 7400 messages so far
2025-02-26 20:02:51,482 - INFO - Received 7500 messages so far
2025-02-26 20:02:51,483 - INFO - Received 7600 messages so far
2025-02-26 20:02:51,483 - INFO - Received 7700 messages so far
2025-02-26 20:02:51,483 - INFO - Received 7800 messages so far
2025-02-26 20:02:51,483 - INFO - Received 7900 messages so far
2025-02-26 20:02:51,483 - INFO - Received 8000 messages so far
2025-02-26 20:02:51,483 - INFO - Received 8100 messages so far
2025-02-26 20:02:51,484 - INFO - Received 8200 messages so far
2025-02-26 20:02:51,484 - INFO - Received 8300 messages so far
2025-02-26 20:02:51,484 - INFO - Received 8400 messages so far
2025-02-26 20:02:51,484 - INFO - Received 8500 messages so far
2025-02-26 20:02:51,484 - INFO - Received 8600 messages so far
2025-02-26 20:02:51,485 - INFO - Received 8700 messages so far
2025-02-26 20:02:51,540 - INFO - Received 8800 messages so far
2025-02-26 20:02:51,541 - INFO - Received 8900 messages so far
2025-02-26 20:02:51,541 - INFO - Received 9000 messages so far
2025-02-26 20:02:51,541 - INFO - Received 9100 messages so far
2025-02-26 20:02:51,541 - INFO - Received 9200 messages so far
2025-02-26 20:02:51,541 - INFO - Received 9300 messages so far
2025-02-26 20:02:51,542 - INFO - Received 9400 messages so far
2025-02-26 20:02:51,542 - INFO - Received 9500 messages so far
2025-02-26 20:02:51,542 - INFO - Received 9600 messages so far
2025-02-26 20:02:51,542 - INFO - Received 9700 messages so far
2025-02-26 20:02:51,542 - INFO - Received 9800 messages so far
2025-02-26 20:02:51,543 - INFO - Received 9900 messages so far
2025-02-26 20:02:51,543 - INFO - Received 10000 messages so far
2025-02-26 20:02:51,543 - INFO - Total messages consumed: 10000
2025-02-26 20:02:51,628 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:51,632 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:51,632 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:51,632 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:51,632 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:51,640 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:51,642 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:51,643 - INFO - Number of columns: 66
2025-02-26 20:02:51,654 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9926        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6205        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3141        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8588     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  C8JSUv1WRqKnzep1C8    48596.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000915     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8580     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  CzHY1y1w0Rx9IatpB3    57768.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000261     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:51,654 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:51,684 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:51,730 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    8af1ef48d3289058              2336755850007c23  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:51,730 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   443.  5353.    80.  1900.   123.   133.   138.
    67.   134.    22. 21115.   136.   547.     0. 21116.   135.]
2025-02-26 20:02:51,731 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:51,736 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:51,738 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:51,738 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:51,740 - INFO - DataFrame shape after NA dropping: (877, 23)
2025-02-26 20:02:51,740 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:51,740 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:51,741 - INFO - X shape: (877, 21), y shape: (877,)
2025-02-26 20:02:51,741 - INFO - Label distribution in training data: {'DNS': 732, 'HTTPS': 131, 'HTTP': 13, 'SSH': 1}
2025-02-26 20:02:51,742 - INFO - Training model...
2025-02-26 20:02:51,855 - INFO - Predicting on test data...
2025-02-26 20:02:51,870 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 146.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.2,
    "f1-score": 0.3333333333333333,
    "support": 5.0
  },
  "HTTPS": {
    "precision": 0.8620689655172413,
    "recall": 1.0,
    "f1-score": 0.9259259259259259,
    "support": 25.0
  },
  "accuracy": 0.9772727272727273,
  "macro avg": {
    "precision": 0.9540229885057471,
    "recall": 0.7333333333333334,
    "f1-score": 0.7530864197530863,
    "support": 176.0
  },
  "weighted avg": {
    "precision": 0.9804075235109718,
    "recall": 0.9772727272727273,
    "f1-score": 0.9705387205387205,
    "support": 176.0
  }
}
2025-02-26 20:02:51,879 - INFO - Saved processed data locally to processed_data_20250226_200251.csv
2025-02-26 20:02:51,882 - INFO - JSON data size: 430765 bytes
2025-02-26 20:02:51,882 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:51,882 - INFO - Data sent successfully!
2025-02-26 20:02:51,882 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:51,884 - INFO - Starting data processing
2025-02-26 20:02:51,884 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:51,885 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:51,885 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:51,885 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:51,987 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:51,987 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:51,988 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:51,988 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:51,988 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:51,988 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:51,989 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:51,989 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:51,989 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:52,141 - INFO - Received 100 messages so far
2025-02-26 20:02:52,141 - INFO - Received 200 messages so far
2025-02-26 20:02:52,141 - INFO - Received 300 messages so far
2025-02-26 20:02:52,141 - INFO - Received 400 messages so far
2025-02-26 20:02:52,142 - INFO - Received 500 messages so far
2025-02-26 20:02:52,142 - INFO - Received 600 messages so far
2025-02-26 20:02:52,142 - INFO - Received 700 messages so far
2025-02-26 20:02:52,142 - INFO - Received 800 messages so far
2025-02-26 20:02:52,142 - INFO - Received 900 messages so far
2025-02-26 20:02:52,143 - INFO - Received 1000 messages so far
2025-02-26 20:02:52,143 - INFO - Received 1100 messages so far
2025-02-26 20:02:52,143 - INFO - Received 1200 messages so far
2025-02-26 20:02:52,143 - INFO - Received 1300 messages so far
2025-02-26 20:02:52,143 - INFO - Received 1400 messages so far
2025-02-26 20:02:52,144 - INFO - Received 1500 messages so far
2025-02-26 20:02:52,144 - INFO - Received 1600 messages so far
2025-02-26 20:02:52,144 - INFO - Received 1700 messages so far
2025-02-26 20:02:52,144 - INFO - Received 1800 messages so far
2025-02-26 20:02:52,144 - INFO - Received 1900 messages so far
2025-02-26 20:02:52,144 - INFO - Received 2000 messages so far
2025-02-26 20:02:52,145 - INFO - Received 2100 messages so far
2025-02-26 20:02:52,145 - INFO - Received 2200 messages so far
2025-02-26 20:02:52,145 - INFO - Received 2300 messages so far
2025-02-26 20:02:52,145 - INFO - Received 2400 messages so far
2025-02-26 20:02:52,145 - INFO - Received 2500 messages so far
2025-02-26 20:02:52,146 - INFO - Received 2600 messages so far
2025-02-26 20:02:52,146 - INFO - Received 2700 messages so far
2025-02-26 20:02:52,146 - INFO - Received 2800 messages so far
2025-02-26 20:02:52,146 - INFO - Received 2900 messages so far
2025-02-26 20:02:52,146 - INFO - Received 3000 messages so far
2025-02-26 20:02:52,147 - INFO - Received 3100 messages so far
2025-02-26 20:02:52,147 - INFO - Received 3200 messages so far
2025-02-26 20:02:52,147 - INFO - Received 3300 messages so far
2025-02-26 20:02:52,147 - INFO - Received 3400 messages so far
2025-02-26 20:02:52,147 - INFO - Received 3500 messages so far
2025-02-26 20:02:52,148 - INFO - Received 3600 messages so far
2025-02-26 20:02:52,148 - INFO - Received 3700 messages so far
2025-02-26 20:02:52,148 - INFO - Received 3800 messages so far
2025-02-26 20:02:52,148 - INFO - Received 3900 messages so far
2025-02-26 20:02:52,148 - INFO - Received 4000 messages so far
2025-02-26 20:02:52,149 - INFO - Received 4100 messages so far
2025-02-26 20:02:52,238 - INFO - Received 4200 messages so far
2025-02-26 20:02:52,239 - INFO - Received 4300 messages so far
2025-02-26 20:02:52,239 - INFO - Received 4400 messages so far
2025-02-26 20:02:52,239 - INFO - Received 4500 messages so far
2025-02-26 20:02:52,239 - INFO - Received 4600 messages so far
2025-02-26 20:02:52,240 - INFO - Received 4700 messages so far
2025-02-26 20:02:52,240 - INFO - Received 4800 messages so far
2025-02-26 20:02:52,240 - INFO - Received 4900 messages so far
2025-02-26 20:02:52,240 - INFO - Received 5000 messages so far
2025-02-26 20:02:52,240 - INFO - Received 5100 messages so far
2025-02-26 20:02:52,241 - INFO - Received 5200 messages so far
2025-02-26 20:02:52,241 - INFO - Received 5300 messages so far
2025-02-26 20:02:52,241 - INFO - Received 5400 messages so far
2025-02-26 20:02:52,241 - INFO - Received 5500 messages so far
2025-02-26 20:02:52,241 - INFO - Received 5600 messages so far
2025-02-26 20:02:52,242 - INFO - Received 5700 messages so far
2025-02-26 20:02:52,242 - INFO - Received 5800 messages so far
2025-02-26 20:02:52,242 - INFO - Received 5900 messages so far
2025-02-26 20:02:52,242 - INFO - Received 6000 messages so far
2025-02-26 20:02:52,242 - INFO - Received 6100 messages so far
2025-02-26 20:02:52,243 - INFO - Received 6200 messages so far
2025-02-26 20:02:52,243 - INFO - Received 6300 messages so far
2025-02-26 20:02:52,243 - INFO - Received 6400 messages so far
2025-02-26 20:02:52,243 - INFO - Received 6500 messages so far
2025-02-26 20:02:52,243 - INFO - Received 6600 messages so far
2025-02-26 20:02:52,243 - INFO - Received 6700 messages so far
2025-02-26 20:02:52,244 - INFO - Received 6800 messages so far
2025-02-26 20:02:52,244 - INFO - Received 6900 messages so far
2025-02-26 20:02:52,244 - INFO - Received 7000 messages so far
2025-02-26 20:02:52,244 - INFO - Received 7100 messages so far
2025-02-26 20:02:52,244 - INFO - Received 7200 messages so far
2025-02-26 20:02:52,245 - INFO - Received 7300 messages so far
2025-02-26 20:02:52,245 - INFO - Received 7400 messages so far
2025-02-26 20:02:52,245 - INFO - Received 7500 messages so far
2025-02-26 20:02:52,245 - INFO - Received 7600 messages so far
2025-02-26 20:02:52,245 - INFO - Received 7700 messages so far
2025-02-26 20:02:52,246 - INFO - Received 7800 messages so far
2025-02-26 20:02:52,246 - INFO - Received 7900 messages so far
2025-02-26 20:02:52,246 - INFO - Received 8000 messages so far
2025-02-26 20:02:52,246 - INFO - Received 8100 messages so far
2025-02-26 20:02:52,246 - INFO - Received 8200 messages so far
2025-02-26 20:02:52,247 - INFO - Received 8300 messages so far
2025-02-26 20:02:52,247 - INFO - Received 8400 messages so far
2025-02-26 20:02:52,247 - INFO - Received 8500 messages so far
2025-02-26 20:02:52,247 - INFO - Received 8600 messages so far
2025-02-26 20:02:52,248 - INFO - Received 8700 messages so far
2025-02-26 20:02:52,303 - INFO - Received 8800 messages so far
2025-02-26 20:02:52,303 - INFO - Received 8900 messages so far
2025-02-26 20:02:52,303 - INFO - Received 9000 messages so far
2025-02-26 20:02:52,304 - INFO - Received 9100 messages so far
2025-02-26 20:02:52,304 - INFO - Received 9200 messages so far
2025-02-26 20:02:52,304 - INFO - Received 9300 messages so far
2025-02-26 20:02:52,304 - INFO - Received 9400 messages so far
2025-02-26 20:02:52,304 - INFO - Received 9500 messages so far
2025-02-26 20:02:52,305 - INFO - Received 9600 messages so far
2025-02-26 20:02:52,305 - INFO - Received 9700 messages so far
2025-02-26 20:02:52,305 - INFO - Received 9800 messages so far
2025-02-26 20:02:52,305 - INFO - Received 9900 messages so far
2025-02-26 20:02:52,305 - INFO - Received 10000 messages so far
2025-02-26 20:02:52,305 - INFO - Total messages consumed: 10000
2025-02-26 20:02:52,394 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:52,398 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:52,398 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:52,398 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:52,399 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:52,406 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:52,409 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:52,410 - INFO - Number of columns: 66
2025-02-26 20:02:52,421 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt                    query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD     RA    Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
7863       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740120e+09      NaN  NaN     NaN  CdEMEK3H0RUKd0mmIf    40728.0  NaN  wac-0003.wac-msedge.net     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  False  0.0     NaN  NaN    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3968        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7161        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1679     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740118e+09      NaN  NaN     NaN   CV5T2ZHHlTluOEAwd    54022.0  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000159     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7616        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:52,421 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:52,451 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:52,497 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    376acab97e4aab30              e9520c813b739a8f  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:52,498 - INFO - Unique values in 'id.resp_p' before labeling: [   53.    nan  9092.   443.   123.    67.  5353.   136.  1900.    80.
   133.    22.   138.   134.   547. 21116. 21115.   135.     0.]
2025-02-26 20:02:52,499 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:52,504 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:52,505 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:52,505 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:52,507 - INFO - DataFrame shape after NA dropping: (795, 23)
2025-02-26 20:02:52,507 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:52,507 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:52,508 - INFO - X shape: (795, 21), y shape: (795,)
2025-02-26 20:02:52,508 - INFO - Label distribution in training data: {'DNS': 661, 'HTTPS': 122, 'HTTP': 12}
2025-02-26 20:02:52,509 - INFO - Training model...
2025-02-26 20:02:52,622 - INFO - Predicting on test data...
2025-02-26 20:02:52,634 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 140.0
  },
  "HTTP": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 0.9473684210526315,
    "recall": 1.0,
    "f1-score": 0.972972972972973,
    "support": 18.0
  },
  "accuracy": 0.9937106918238994,
  "macro avg": {
    "precision": 0.6491228070175438,
    "recall": 0.6666666666666666,
    "f1-score": 0.6576576576576577,
    "support": 159.0
  },
  "weighted avg": {
    "precision": 0.9877523998675936,
    "recall": 0.9937106918238994,
    "f1-score": 0.9906510283868775,
    "support": 159.0
  }
}
2025-02-26 20:02:52,641 - INFO - Saved processed data locally to processed_data_20250226_200252.csv
2025-02-26 20:02:52,643 - INFO - JSON data size: 392593 bytes
2025-02-26 20:02:52,643 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:52,643 - INFO - Data sent successfully!
2025-02-26 20:02:52,643 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:52,644 - INFO - Starting data processing
2025-02-26 20:02:52,644 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:52,644 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:52,645 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:52,645 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:52,747 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:52,747 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:52,747 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:52,747 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:52,747 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:52,748 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:52,748 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:52,748 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:52,748 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:52,902 - INFO - Received 100 messages so far
2025-02-26 20:02:52,902 - INFO - Received 200 messages so far
2025-02-26 20:02:52,902 - INFO - Received 300 messages so far
2025-02-26 20:02:52,902 - INFO - Received 400 messages so far
2025-02-26 20:02:52,903 - INFO - Received 500 messages so far
2025-02-26 20:02:52,903 - INFO - Received 600 messages so far
2025-02-26 20:02:52,903 - INFO - Received 700 messages so far
2025-02-26 20:02:52,903 - INFO - Received 800 messages so far
2025-02-26 20:02:52,903 - INFO - Received 900 messages so far
2025-02-26 20:02:52,904 - INFO - Received 1000 messages so far
2025-02-26 20:02:52,904 - INFO - Received 1100 messages so far
2025-02-26 20:02:52,904 - INFO - Received 1200 messages so far
2025-02-26 20:02:52,904 - INFO - Received 1300 messages so far
2025-02-26 20:02:52,904 - INFO - Received 1400 messages so far
2025-02-26 20:02:52,905 - INFO - Received 1500 messages so far
2025-02-26 20:02:52,905 - INFO - Received 1600 messages so far
2025-02-26 20:02:52,905 - INFO - Received 1700 messages so far
2025-02-26 20:02:52,905 - INFO - Received 1800 messages so far
2025-02-26 20:02:52,905 - INFO - Received 1900 messages so far
2025-02-26 20:02:52,906 - INFO - Received 2000 messages so far
2025-02-26 20:02:52,906 - INFO - Received 2100 messages so far
2025-02-26 20:02:52,906 - INFO - Received 2200 messages so far
2025-02-26 20:02:52,906 - INFO - Received 2300 messages so far
2025-02-26 20:02:52,906 - INFO - Received 2400 messages so far
2025-02-26 20:02:52,907 - INFO - Received 2500 messages so far
2025-02-26 20:02:52,907 - INFO - Received 2600 messages so far
2025-02-26 20:02:52,907 - INFO - Received 2700 messages so far
2025-02-26 20:02:52,907 - INFO - Received 2800 messages so far
2025-02-26 20:02:52,907 - INFO - Received 2900 messages so far
2025-02-26 20:02:52,908 - INFO - Received 3000 messages so far
2025-02-26 20:02:52,908 - INFO - Received 3100 messages so far
2025-02-26 20:02:52,908 - INFO - Received 3200 messages so far
2025-02-26 20:02:52,908 - INFO - Received 3300 messages so far
2025-02-26 20:02:52,908 - INFO - Received 3400 messages so far
2025-02-26 20:02:52,909 - INFO - Received 3500 messages so far
2025-02-26 20:02:52,909 - INFO - Received 3600 messages so far
2025-02-26 20:02:52,909 - INFO - Received 3700 messages so far
2025-02-26 20:02:52,909 - INFO - Received 3800 messages so far
2025-02-26 20:02:52,909 - INFO - Received 3900 messages so far
2025-02-26 20:02:52,910 - INFO - Received 4000 messages so far
2025-02-26 20:02:52,910 - INFO - Received 4100 messages so far
2025-02-26 20:02:52,964 - INFO - Received 4200 messages so far
2025-02-26 20:02:52,964 - INFO - Received 4300 messages so far
2025-02-26 20:02:52,964 - INFO - Received 4400 messages so far
2025-02-26 20:02:52,965 - INFO - Received 4500 messages so far
2025-02-26 20:02:52,965 - INFO - Received 4600 messages so far
2025-02-26 20:02:52,965 - INFO - Received 4700 messages so far
2025-02-26 20:02:52,965 - INFO - Received 4800 messages so far
2025-02-26 20:02:52,965 - INFO - Received 4900 messages so far
2025-02-26 20:02:52,966 - INFO - Received 5000 messages so far
2025-02-26 20:02:52,966 - INFO - Received 5100 messages so far
2025-02-26 20:02:52,966 - INFO - Received 5200 messages so far
2025-02-26 20:02:52,966 - INFO - Received 5300 messages so far
2025-02-26 20:02:52,966 - INFO - Received 5400 messages so far
2025-02-26 20:02:52,967 - INFO - Received 5500 messages so far
2025-02-26 20:02:52,967 - INFO - Received 5600 messages so far
2025-02-26 20:02:52,967 - INFO - Received 5700 messages so far
2025-02-26 20:02:52,967 - INFO - Received 5800 messages so far
2025-02-26 20:02:52,967 - INFO - Received 5900 messages so far
2025-02-26 20:02:52,968 - INFO - Received 6000 messages so far
2025-02-26 20:02:52,968 - INFO - Received 6100 messages so far
2025-02-26 20:02:52,968 - INFO - Received 6200 messages so far
2025-02-26 20:02:52,968 - INFO - Received 6300 messages so far
2025-02-26 20:02:52,968 - INFO - Received 6400 messages so far
2025-02-26 20:02:52,969 - INFO - Received 6500 messages so far
2025-02-26 20:02:52,969 - INFO - Received 6600 messages so far
2025-02-26 20:02:52,969 - INFO - Received 6700 messages so far
2025-02-26 20:02:52,969 - INFO - Received 6800 messages so far
2025-02-26 20:02:52,969 - INFO - Received 6900 messages so far
2025-02-26 20:02:52,970 - INFO - Received 7000 messages so far
2025-02-26 20:02:52,970 - INFO - Received 7100 messages so far
2025-02-26 20:02:52,970 - INFO - Received 7200 messages so far
2025-02-26 20:02:52,970 - INFO - Received 7300 messages so far
2025-02-26 20:02:52,970 - INFO - Received 7400 messages so far
2025-02-26 20:02:52,971 - INFO - Received 7500 messages so far
2025-02-26 20:02:52,971 - INFO - Received 7600 messages so far
2025-02-26 20:02:52,971 - INFO - Received 7700 messages so far
2025-02-26 20:02:52,971 - INFO - Received 7800 messages so far
2025-02-26 20:02:52,971 - INFO - Received 7900 messages so far
2025-02-26 20:02:52,972 - INFO - Received 8000 messages so far
2025-02-26 20:02:52,972 - INFO - Received 8100 messages so far
2025-02-26 20:02:52,972 - INFO - Received 8200 messages so far
2025-02-26 20:02:52,972 - INFO - Received 8300 messages so far
2025-02-26 20:02:52,972 - INFO - Received 8400 messages so far
2025-02-26 20:02:52,973 - INFO - Received 8500 messages so far
2025-02-26 20:02:52,973 - INFO - Received 8600 messages so far
2025-02-26 20:02:52,973 - INFO - Received 8700 messages so far
2025-02-26 20:02:53,075 - INFO - Received 8800 messages so far
2025-02-26 20:02:53,076 - INFO - Received 8900 messages so far
2025-02-26 20:02:53,076 - INFO - Received 9000 messages so far
2025-02-26 20:02:53,076 - INFO - Received 9100 messages so far
2025-02-26 20:02:53,076 - INFO - Received 9200 messages so far
2025-02-26 20:02:53,076 - INFO - Received 9300 messages so far
2025-02-26 20:02:53,077 - INFO - Received 9400 messages so far
2025-02-26 20:02:53,077 - INFO - Received 9500 messages so far
2025-02-26 20:02:53,077 - INFO - Received 9600 messages so far
2025-02-26 20:02:53,077 - INFO - Received 9700 messages so far
2025-02-26 20:02:53,077 - INFO - Received 9800 messages so far
2025-02-26 20:02:53,078 - INFO - Received 9900 messages so far
2025-02-26 20:02:53,078 - INFO - Received 10000 messages so far
2025-02-26 20:02:53,078 - INFO - Total messages consumed: 10000
2025-02-26 20:02:53,166 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:53,170 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:53,170 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:53,170 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:53,170 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:53,178 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:53,181 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:53,181 - INFO - Number of columns: 66
2025-02-26 20:02:53,191 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
6084        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1833        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.006763     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7927        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7530        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8279        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:53,191 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:53,221 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:53,265 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    a0e26dda6c2cf717              e0e26dda6c2cf717  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:53,265 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.   443.    53. 21116.  5353.   134.    80. 21115.  1900.
   123.   133.   136.   547.     0.   138.    67.   135.    22.]
2025-02-26 20:02:53,267 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:53,272 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:53,273 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:53,273 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:53,275 - INFO - DataFrame shape after NA dropping: (889, 23)
2025-02-26 20:02:53,275 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:53,275 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:53,276 - INFO - X shape: (889, 21), y shape: (889,)
2025-02-26 20:02:53,276 - INFO - Label distribution in training data: {'DNS': 741, 'HTTPS': 133, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:53,277 - INFO - Training model...
2025-02-26 20:02:53,389 - INFO - Predicting on test data...
2025-02-26 20:02:53,403 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 152.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.6666666666666666,
    "f1-score": 0.8,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.9583333333333334,
    "recall": 1.0,
    "f1-score": 0.9787234042553191,
    "support": 23.0
  },
  "accuracy": 0.9943820224719101,
  "macro avg": {
    "precision": 0.9861111111111112,
    "recall": 0.8888888888888888,
    "f1-score": 0.926241134751773,
    "support": 178.0
  },
  "weighted avg": {
    "precision": 0.9946161048689138,
    "recall": 0.9943820224719101,
    "f1-score": 0.9938799904374851,
    "support": 178.0
  }
}
2025-02-26 20:02:53,410 - INFO - Saved processed data locally to processed_data_20250226_200253.csv
2025-02-26 20:02:53,412 - INFO - JSON data size: 438036 bytes
2025-02-26 20:02:53,412 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:53,413 - INFO - Data sent successfully!
2025-02-26 20:02:53,413 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:53,414 - INFO - Starting data processing
2025-02-26 20:02:53,414 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:53,414 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:53,415 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:53,415 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:53,517 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:53,517 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:53,517 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:53,517 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:53,517 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:53,518 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:53,518 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:53,519 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:53,519 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:53,671 - INFO - Received 100 messages so far
2025-02-26 20:02:53,671 - INFO - Received 200 messages so far
2025-02-26 20:02:53,671 - INFO - Received 300 messages so far
2025-02-26 20:02:53,672 - INFO - Received 400 messages so far
2025-02-26 20:02:53,672 - INFO - Received 500 messages so far
2025-02-26 20:02:53,672 - INFO - Received 600 messages so far
2025-02-26 20:02:53,672 - INFO - Received 700 messages so far
2025-02-26 20:02:53,672 - INFO - Received 800 messages so far
2025-02-26 20:02:53,673 - INFO - Received 900 messages so far
2025-02-26 20:02:53,673 - INFO - Received 1000 messages so far
2025-02-26 20:02:53,673 - INFO - Received 1100 messages so far
2025-02-26 20:02:53,673 - INFO - Received 1200 messages so far
2025-02-26 20:02:53,673 - INFO - Received 1300 messages so far
2025-02-26 20:02:53,674 - INFO - Received 1400 messages so far
2025-02-26 20:02:53,674 - INFO - Received 1500 messages so far
2025-02-26 20:02:53,674 - INFO - Received 1600 messages so far
2025-02-26 20:02:53,674 - INFO - Received 1700 messages so far
2025-02-26 20:02:53,675 - INFO - Received 1800 messages so far
2025-02-26 20:02:53,675 - INFO - Received 1900 messages so far
2025-02-26 20:02:53,675 - INFO - Received 2000 messages so far
2025-02-26 20:02:53,675 - INFO - Received 2100 messages so far
2025-02-26 20:02:53,675 - INFO - Received 2200 messages so far
2025-02-26 20:02:53,676 - INFO - Received 2300 messages so far
2025-02-26 20:02:53,676 - INFO - Received 2400 messages so far
2025-02-26 20:02:53,676 - INFO - Received 2500 messages so far
2025-02-26 20:02:53,676 - INFO - Received 2600 messages so far
2025-02-26 20:02:53,676 - INFO - Received 2700 messages so far
2025-02-26 20:02:53,677 - INFO - Received 2800 messages so far
2025-02-26 20:02:53,677 - INFO - Received 2900 messages so far
2025-02-26 20:02:53,677 - INFO - Received 3000 messages so far
2025-02-26 20:02:53,677 - INFO - Received 3100 messages so far
2025-02-26 20:02:53,677 - INFO - Received 3200 messages so far
2025-02-26 20:02:53,678 - INFO - Received 3300 messages so far
2025-02-26 20:02:53,678 - INFO - Received 3400 messages so far
2025-02-26 20:02:53,678 - INFO - Received 3500 messages so far
2025-02-26 20:02:53,678 - INFO - Received 3600 messages so far
2025-02-26 20:02:53,678 - INFO - Received 3700 messages so far
2025-02-26 20:02:53,678 - INFO - Received 3800 messages so far
2025-02-26 20:02:53,679 - INFO - Received 3900 messages so far
2025-02-26 20:02:53,679 - INFO - Received 4000 messages so far
2025-02-26 20:02:53,679 - INFO - Received 4100 messages so far
2025-02-26 20:02:53,732 - INFO - Received 4200 messages so far
2025-02-26 20:02:53,733 - INFO - Received 4300 messages so far
2025-02-26 20:02:53,733 - INFO - Received 4400 messages so far
2025-02-26 20:02:53,733 - INFO - Received 4500 messages so far
2025-02-26 20:02:53,733 - INFO - Received 4600 messages so far
2025-02-26 20:02:53,733 - INFO - Received 4700 messages so far
2025-02-26 20:02:53,734 - INFO - Received 4800 messages so far
2025-02-26 20:02:53,734 - INFO - Received 4900 messages so far
2025-02-26 20:02:53,734 - INFO - Received 5000 messages so far
2025-02-26 20:02:53,734 - INFO - Received 5100 messages so far
2025-02-26 20:02:53,734 - INFO - Received 5200 messages so far
2025-02-26 20:02:53,735 - INFO - Received 5300 messages so far
2025-02-26 20:02:53,735 - INFO - Received 5400 messages so far
2025-02-26 20:02:53,735 - INFO - Received 5500 messages so far
2025-02-26 20:02:53,735 - INFO - Received 5600 messages so far
2025-02-26 20:02:53,735 - INFO - Received 5700 messages so far
2025-02-26 20:02:53,735 - INFO - Received 5800 messages so far
2025-02-26 20:02:53,736 - INFO - Received 5900 messages so far
2025-02-26 20:02:53,736 - INFO - Received 6000 messages so far
2025-02-26 20:02:53,736 - INFO - Received 6100 messages so far
2025-02-26 20:02:53,736 - INFO - Received 6200 messages so far
2025-02-26 20:02:53,736 - INFO - Received 6300 messages so far
2025-02-26 20:02:53,737 - INFO - Received 6400 messages so far
2025-02-26 20:02:53,737 - INFO - Received 6500 messages so far
2025-02-26 20:02:53,737 - INFO - Received 6600 messages so far
2025-02-26 20:02:53,737 - INFO - Received 6700 messages so far
2025-02-26 20:02:53,737 - INFO - Received 6800 messages so far
2025-02-26 20:02:53,738 - INFO - Received 6900 messages so far
2025-02-26 20:02:53,738 - INFO - Received 7000 messages so far
2025-02-26 20:02:53,738 - INFO - Received 7100 messages so far
2025-02-26 20:02:53,738 - INFO - Received 7200 messages so far
2025-02-26 20:02:53,738 - INFO - Received 7300 messages so far
2025-02-26 20:02:53,739 - INFO - Received 7400 messages so far
2025-02-26 20:02:53,739 - INFO - Received 7500 messages so far
2025-02-26 20:02:53,739 - INFO - Received 7600 messages so far
2025-02-26 20:02:53,739 - INFO - Received 7700 messages so far
2025-02-26 20:02:53,739 - INFO - Received 7800 messages so far
2025-02-26 20:02:53,740 - INFO - Received 7900 messages so far
2025-02-26 20:02:53,740 - INFO - Received 8000 messages so far
2025-02-26 20:02:53,740 - INFO - Received 8100 messages so far
2025-02-26 20:02:53,740 - INFO - Received 8200 messages so far
2025-02-26 20:02:53,740 - INFO - Received 8300 messages so far
2025-02-26 20:02:53,741 - INFO - Received 8400 messages so far
2025-02-26 20:02:53,741 - INFO - Received 8500 messages so far
2025-02-26 20:02:53,741 - INFO - Received 8600 messages so far
2025-02-26 20:02:53,741 - INFO - Received 8700 messages so far
2025-02-26 20:02:53,799 - INFO - Received 8800 messages so far
2025-02-26 20:02:53,800 - INFO - Received 8900 messages so far
2025-02-26 20:02:53,800 - INFO - Received 9000 messages so far
2025-02-26 20:02:53,800 - INFO - Received 9100 messages so far
2025-02-26 20:02:53,800 - INFO - Received 9200 messages so far
2025-02-26 20:02:53,800 - INFO - Received 9300 messages so far
2025-02-26 20:02:53,801 - INFO - Received 9400 messages so far
2025-02-26 20:02:53,801 - INFO - Received 9500 messages so far
2025-02-26 20:02:53,801 - INFO - Received 9600 messages so far
2025-02-26 20:02:53,801 - INFO - Received 9700 messages so far
2025-02-26 20:02:53,801 - INFO - Received 9800 messages so far
2025-02-26 20:02:53,802 - INFO - Received 9900 messages so far
2025-02-26 20:02:53,802 - INFO - Received 10000 messages so far
2025-02-26 20:02:53,802 - INFO - Total messages consumed: 10000
2025-02-26 20:02:53,890 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:53,894 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:53,894 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:53,894 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:53,894 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:53,902 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:53,905 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:53,905 - INFO - Number of columns: 66
2025-02-26 20:02:53,916 - INFO - DataFrame head:
      id.resp_p    id.orig_h      id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto    duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3295     9092.0  192.168.1.3    192.168.1.4   tcp         0.0         0.0  1.740119e+09      NaN  NaN     NaN   CUd96NlEDKHN37Lza    57922.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0    0.000464     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9210        NaN          NaN            NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5656        NaN          NaN            NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5811        NaN          NaN            NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1421      443.0  192.168.1.3  52.108.147.15   tcp      3822.0     29434.0  1.740118e+09      NaN  NaN     NaN  CXAjLi4RJupQu85aYd    58116.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True      False           0.0  AaDdFf       48.0         5741.0       45.0        31234.0       6.0  321.633377     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:53,916 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:53,945 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:53,988 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    2fe788e3cc713726              efe788e3cc713726  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:53,988 - INFO - Unique values in 'id.resp_p' before labeling: [ 9092.    nan   443.    53. 21116.  5353.   133.    80.   138.  1900.
   136.   123.   134.    67.   547.     0. 21115.    22.   135.]
2025-02-26 20:02:53,989 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:53,994 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:53,995 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:53,996 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:53,998 - INFO - DataFrame shape after NA dropping: (859, 23)
2025-02-26 20:02:53,998 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:53,998 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:53,999 - INFO - X shape: (859, 21), y shape: (859,)
2025-02-26 20:02:53,999 - INFO - Label distribution in training data: {'DNS': 719, 'HTTPS': 125, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:54,000 - INFO - Training model...
2025-02-26 20:02:54,115 - INFO - Predicting on test data...
2025-02-26 20:02:54,129 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 145.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 0.92,
    "recall": 1.0,
    "f1-score": 0.9583333333333334,
    "support": 23.0
  },
  "accuracy": 0.9883720930232558,
  "macro avg": {
    "precision": 0.9733333333333333,
    "recall": 0.8333333333333334,
    "f1-score": 0.875,
    "support": 172.0
  },
  "weighted avg": {
    "precision": 0.9893023255813953,
    "recall": 0.9883720930232558,
    "f1-score": 0.9866763565891472,
    "support": 172.0
  }
}
2025-02-26 20:02:54,136 - INFO - Saved processed data locally to processed_data_20250226_200254.csv
2025-02-26 20:02:54,138 - INFO - JSON data size: 421227 bytes
2025-02-26 20:02:54,138 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:54,138 - INFO - Data sent successfully!
2025-02-26 20:02:54,138 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:54,139 - INFO - Starting data processing
2025-02-26 20:02:54,140 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:54,140 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:54,141 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:54,141 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:54,242 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:54,242 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:54,243 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:54,243 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:54,243 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:54,244 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:54,244 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:54,244 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:54,244 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:54,441 - INFO - Received 100 messages so far
2025-02-26 20:02:54,442 - INFO - Received 200 messages so far
2025-02-26 20:02:54,442 - INFO - Received 300 messages so far
2025-02-26 20:02:54,442 - INFO - Received 400 messages so far
2025-02-26 20:02:54,442 - INFO - Received 500 messages so far
2025-02-26 20:02:54,442 - INFO - Received 600 messages so far
2025-02-26 20:02:54,443 - INFO - Received 700 messages so far
2025-02-26 20:02:54,443 - INFO - Received 800 messages so far
2025-02-26 20:02:54,443 - INFO - Received 900 messages so far
2025-02-26 20:02:54,443 - INFO - Received 1000 messages so far
2025-02-26 20:02:54,443 - INFO - Received 1100 messages so far
2025-02-26 20:02:54,444 - INFO - Received 1200 messages so far
2025-02-26 20:02:54,444 - INFO - Received 1300 messages so far
2025-02-26 20:02:54,444 - INFO - Received 1400 messages so far
2025-02-26 20:02:54,444 - INFO - Received 1500 messages so far
2025-02-26 20:02:54,444 - INFO - Received 1600 messages so far
2025-02-26 20:02:54,445 - INFO - Received 1700 messages so far
2025-02-26 20:02:54,445 - INFO - Received 1800 messages so far
2025-02-26 20:02:54,445 - INFO - Received 1900 messages so far
2025-02-26 20:02:54,445 - INFO - Received 2000 messages so far
2025-02-26 20:02:54,445 - INFO - Received 2100 messages so far
2025-02-26 20:02:54,446 - INFO - Received 2200 messages so far
2025-02-26 20:02:54,446 - INFO - Received 2300 messages so far
2025-02-26 20:02:54,446 - INFO - Received 2400 messages so far
2025-02-26 20:02:54,446 - INFO - Received 2500 messages so far
2025-02-26 20:02:54,446 - INFO - Received 2600 messages so far
2025-02-26 20:02:54,447 - INFO - Received 2700 messages so far
2025-02-26 20:02:54,447 - INFO - Received 2800 messages so far
2025-02-26 20:02:54,447 - INFO - Received 2900 messages so far
2025-02-26 20:02:54,447 - INFO - Received 3000 messages so far
2025-02-26 20:02:54,447 - INFO - Received 3100 messages so far
2025-02-26 20:02:54,447 - INFO - Received 3200 messages so far
2025-02-26 20:02:54,448 - INFO - Received 3300 messages so far
2025-02-26 20:02:54,448 - INFO - Received 3400 messages so far
2025-02-26 20:02:54,448 - INFO - Received 3500 messages so far
2025-02-26 20:02:54,448 - INFO - Received 3600 messages so far
2025-02-26 20:02:54,448 - INFO - Received 3700 messages so far
2025-02-26 20:02:54,449 - INFO - Received 3800 messages so far
2025-02-26 20:02:54,449 - INFO - Received 3900 messages so far
2025-02-26 20:02:54,449 - INFO - Received 4000 messages so far
2025-02-26 20:02:54,449 - INFO - Received 4100 messages so far
2025-02-26 20:02:54,503 - INFO - Received 4200 messages so far
2025-02-26 20:02:54,503 - INFO - Received 4300 messages so far
2025-02-26 20:02:54,503 - INFO - Received 4400 messages so far
2025-02-26 20:02:54,503 - INFO - Received 4500 messages so far
2025-02-26 20:02:54,503 - INFO - Received 4600 messages so far
2025-02-26 20:02:54,504 - INFO - Received 4700 messages so far
2025-02-26 20:02:54,504 - INFO - Received 4800 messages so far
2025-02-26 20:02:54,504 - INFO - Received 4900 messages so far
2025-02-26 20:02:54,504 - INFO - Received 5000 messages so far
2025-02-26 20:02:54,504 - INFO - Received 5100 messages so far
2025-02-26 20:02:54,505 - INFO - Received 5200 messages so far
2025-02-26 20:02:54,505 - INFO - Received 5300 messages so far
2025-02-26 20:02:54,505 - INFO - Received 5400 messages so far
2025-02-26 20:02:54,505 - INFO - Received 5500 messages so far
2025-02-26 20:02:54,505 - INFO - Received 5600 messages so far
2025-02-26 20:02:54,506 - INFO - Received 5700 messages so far
2025-02-26 20:02:54,506 - INFO - Received 5800 messages so far
2025-02-26 20:02:54,506 - INFO - Received 5900 messages so far
2025-02-26 20:02:54,506 - INFO - Received 6000 messages so far
2025-02-26 20:02:54,506 - INFO - Received 6100 messages so far
2025-02-26 20:02:54,507 - INFO - Received 6200 messages so far
2025-02-26 20:02:54,507 - INFO - Received 6300 messages so far
2025-02-26 20:02:54,507 - INFO - Received 6400 messages so far
2025-02-26 20:02:54,507 - INFO - Received 6500 messages so far
2025-02-26 20:02:54,507 - INFO - Received 6600 messages so far
2025-02-26 20:02:54,508 - INFO - Received 6700 messages so far
2025-02-26 20:02:54,508 - INFO - Received 6800 messages so far
2025-02-26 20:02:54,508 - INFO - Received 6900 messages so far
2025-02-26 20:02:54,508 - INFO - Received 7000 messages so far
2025-02-26 20:02:54,508 - INFO - Received 7100 messages so far
2025-02-26 20:02:54,509 - INFO - Received 7200 messages so far
2025-02-26 20:02:54,509 - INFO - Received 7300 messages so far
2025-02-26 20:02:54,509 - INFO - Received 7400 messages so far
2025-02-26 20:02:54,509 - INFO - Received 7500 messages so far
2025-02-26 20:02:54,509 - INFO - Received 7600 messages so far
2025-02-26 20:02:54,510 - INFO - Received 7700 messages so far
2025-02-26 20:02:54,510 - INFO - Received 7800 messages so far
2025-02-26 20:02:54,510 - INFO - Received 7900 messages so far
2025-02-26 20:02:54,510 - INFO - Received 8000 messages so far
2025-02-26 20:02:54,510 - INFO - Received 8100 messages so far
2025-02-26 20:02:54,511 - INFO - Received 8200 messages so far
2025-02-26 20:02:54,511 - INFO - Received 8300 messages so far
2025-02-26 20:02:54,511 - INFO - Received 8400 messages so far
2025-02-26 20:02:54,511 - INFO - Received 8500 messages so far
2025-02-26 20:02:54,511 - INFO - Received 8600 messages so far
2025-02-26 20:02:54,512 - INFO - Received 8700 messages so far
2025-02-26 20:02:54,569 - INFO - Received 8800 messages so far
2025-02-26 20:02:54,569 - INFO - Received 8900 messages so far
2025-02-26 20:02:54,569 - INFO - Received 9000 messages so far
2025-02-26 20:02:54,569 - INFO - Received 9100 messages so far
2025-02-26 20:02:54,570 - INFO - Received 9200 messages so far
2025-02-26 20:02:54,570 - INFO - Received 9300 messages so far
2025-02-26 20:02:54,570 - INFO - Received 9400 messages so far
2025-02-26 20:02:54,570 - INFO - Received 9500 messages so far
2025-02-26 20:02:54,570 - INFO - Received 9600 messages so far
2025-02-26 20:02:54,571 - INFO - Received 9700 messages so far
2025-02-26 20:02:54,571 - INFO - Received 9800 messages so far
2025-02-26 20:02:54,571 - INFO - Received 9900 messages so far
2025-02-26 20:02:54,571 - INFO - Received 10000 messages so far
2025-02-26 20:02:54,571 - INFO - Total messages consumed: 10000
2025-02-26 20:02:54,663 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:54,667 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:54,667 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:54,667 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:54,668 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:54,675 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:54,679 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:54,679 - INFO - Number of columns: 66
2025-02-26 20:02:54,690 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt                    query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD     RA    Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
8732        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6890        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2401        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8438        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1094       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740118e+09      NaN  NaN     NaN  CxLnqE19wEwWWflhra    54852.0  NaN  wac-0003.wac-msedge.net     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  False  0.0     NaN  NaN    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:54,690 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:54,721 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:54,765 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    8af1ef48d3289058              2336755850007c23  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:54,765 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.   443.   133.    80.  1900.   123.   134.
   136.     0.   135. 21116.    67. 21115.   138.    22.   547.]
2025-02-26 20:02:54,767 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:54,772 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:54,773 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:54,773 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:54,775 - INFO - DataFrame shape after NA dropping: (899, 23)
2025-02-26 20:02:54,775 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:54,775 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:54,776 - INFO - X shape: (899, 21), y shape: (899,)
2025-02-26 20:02:54,776 - INFO - Label distribution in training data: {'DNS': 752, 'HTTPS': 133, 'HTTP': 13, 'SSH': 1}
2025-02-26 20:02:54,777 - INFO - Training model...
2025-02-26 20:02:54,893 - INFO - Predicting on test data...
2025-02-26 20:02:54,906 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 148.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 2.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 30.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 180.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 180.0
  }
}
2025-02-26 20:02:54,914 - INFO - Saved processed data locally to processed_data_20250226_200254.csv
2025-02-26 20:02:54,916 - INFO - JSON data size: 442632 bytes
2025-02-26 20:02:54,916 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:54,916 - INFO - Data sent successfully!
2025-02-26 20:02:54,916 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:54,917 - INFO - Starting data processing
2025-02-26 20:02:54,917 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:54,918 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:54,919 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:54,919 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:55,021 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:55,021 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:55,021 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:55,021 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:55,022 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:55,023 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:55,023 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:55,023 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:55,023 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:55,177 - INFO - Received 100 messages so far
2025-02-26 20:02:55,177 - INFO - Received 200 messages so far
2025-02-26 20:02:55,177 - INFO - Received 300 messages so far
2025-02-26 20:02:55,177 - INFO - Received 400 messages so far
2025-02-26 20:02:55,178 - INFO - Received 500 messages so far
2025-02-26 20:02:55,178 - INFO - Received 600 messages so far
2025-02-26 20:02:55,178 - INFO - Received 700 messages so far
2025-02-26 20:02:55,178 - INFO - Received 800 messages so far
2025-02-26 20:02:55,178 - INFO - Received 900 messages so far
2025-02-26 20:02:55,179 - INFO - Received 1000 messages so far
2025-02-26 20:02:55,179 - INFO - Received 1100 messages so far
2025-02-26 20:02:55,179 - INFO - Received 1200 messages so far
2025-02-26 20:02:55,179 - INFO - Received 1300 messages so far
2025-02-26 20:02:55,179 - INFO - Received 1400 messages so far
2025-02-26 20:02:55,180 - INFO - Received 1500 messages so far
2025-02-26 20:02:55,180 - INFO - Received 1600 messages so far
2025-02-26 20:02:55,180 - INFO - Received 1700 messages so far
2025-02-26 20:02:55,180 - INFO - Received 1800 messages so far
2025-02-26 20:02:55,180 - INFO - Received 1900 messages so far
2025-02-26 20:02:55,181 - INFO - Received 2000 messages so far
2025-02-26 20:02:55,181 - INFO - Received 2100 messages so far
2025-02-26 20:02:55,181 - INFO - Received 2200 messages so far
2025-02-26 20:02:55,181 - INFO - Received 2300 messages so far
2025-02-26 20:02:55,181 - INFO - Received 2400 messages so far
2025-02-26 20:02:55,181 - INFO - Received 2500 messages so far
2025-02-26 20:02:55,182 - INFO - Received 2600 messages so far
2025-02-26 20:02:55,182 - INFO - Received 2700 messages so far
2025-02-26 20:02:55,182 - INFO - Received 2800 messages so far
2025-02-26 20:02:55,182 - INFO - Received 2900 messages so far
2025-02-26 20:02:55,182 - INFO - Received 3000 messages so far
2025-02-26 20:02:55,183 - INFO - Received 3100 messages so far
2025-02-26 20:02:55,183 - INFO - Received 3200 messages so far
2025-02-26 20:02:55,183 - INFO - Received 3300 messages so far
2025-02-26 20:02:55,183 - INFO - Received 3400 messages so far
2025-02-26 20:02:55,183 - INFO - Received 3500 messages so far
2025-02-26 20:02:55,184 - INFO - Received 3600 messages so far
2025-02-26 20:02:55,184 - INFO - Received 3700 messages so far
2025-02-26 20:02:55,184 - INFO - Received 3800 messages so far
2025-02-26 20:02:55,184 - INFO - Received 3900 messages so far
2025-02-26 20:02:55,184 - INFO - Received 4000 messages so far
2025-02-26 20:02:55,185 - INFO - Received 4100 messages so far
2025-02-26 20:02:55,279 - INFO - Received 4200 messages so far
2025-02-26 20:02:55,279 - INFO - Received 4300 messages so far
2025-02-26 20:02:55,280 - INFO - Received 4400 messages so far
2025-02-26 20:02:55,280 - INFO - Received 4500 messages so far
2025-02-26 20:02:55,280 - INFO - Received 4600 messages so far
2025-02-26 20:02:55,280 - INFO - Received 4700 messages so far
2025-02-26 20:02:55,280 - INFO - Received 4800 messages so far
2025-02-26 20:02:55,281 - INFO - Received 4900 messages so far
2025-02-26 20:02:55,281 - INFO - Received 5000 messages so far
2025-02-26 20:02:55,281 - INFO - Received 5100 messages so far
2025-02-26 20:02:55,281 - INFO - Received 5200 messages so far
2025-02-26 20:02:55,281 - INFO - Received 5300 messages so far
2025-02-26 20:02:55,282 - INFO - Received 5400 messages so far
2025-02-26 20:02:55,282 - INFO - Received 5500 messages so far
2025-02-26 20:02:55,282 - INFO - Received 5600 messages so far
2025-02-26 20:02:55,282 - INFO - Received 5700 messages so far
2025-02-26 20:02:55,282 - INFO - Received 5800 messages so far
2025-02-26 20:02:55,283 - INFO - Received 5900 messages so far
2025-02-26 20:02:55,283 - INFO - Received 6000 messages so far
2025-02-26 20:02:55,283 - INFO - Received 6100 messages so far
2025-02-26 20:02:55,283 - INFO - Received 6200 messages so far
2025-02-26 20:02:55,283 - INFO - Received 6300 messages so far
2025-02-26 20:02:55,284 - INFO - Received 6400 messages so far
2025-02-26 20:02:55,284 - INFO - Received 6500 messages so far
2025-02-26 20:02:55,284 - INFO - Received 6600 messages so far
2025-02-26 20:02:55,284 - INFO - Received 6700 messages so far
2025-02-26 20:02:55,284 - INFO - Received 6800 messages so far
2025-02-26 20:02:55,285 - INFO - Received 6900 messages so far
2025-02-26 20:02:55,285 - INFO - Received 7000 messages so far
2025-02-26 20:02:55,285 - INFO - Received 7100 messages so far
2025-02-26 20:02:55,285 - INFO - Received 7200 messages so far
2025-02-26 20:02:55,285 - INFO - Received 7300 messages so far
2025-02-26 20:02:55,286 - INFO - Received 7400 messages so far
2025-02-26 20:02:55,286 - INFO - Received 7500 messages so far
2025-02-26 20:02:55,286 - INFO - Received 7600 messages so far
2025-02-26 20:02:55,286 - INFO - Received 7700 messages so far
2025-02-26 20:02:55,286 - INFO - Received 7800 messages so far
2025-02-26 20:02:55,287 - INFO - Received 7900 messages so far
2025-02-26 20:02:55,287 - INFO - Received 8000 messages so far
2025-02-26 20:02:55,287 - INFO - Received 8100 messages so far
2025-02-26 20:02:55,287 - INFO - Received 8200 messages so far
2025-02-26 20:02:55,287 - INFO - Received 8300 messages so far
2025-02-26 20:02:55,288 - INFO - Received 8400 messages so far
2025-02-26 20:02:55,288 - INFO - Received 8500 messages so far
2025-02-26 20:02:55,288 - INFO - Received 8600 messages so far
2025-02-26 20:02:55,288 - INFO - Received 8700 messages so far
2025-02-26 20:02:55,345 - INFO - Received 8800 messages so far
2025-02-26 20:02:55,345 - INFO - Received 8900 messages so far
2025-02-26 20:02:55,345 - INFO - Received 9000 messages so far
2025-02-26 20:02:55,346 - INFO - Received 9100 messages so far
2025-02-26 20:02:55,346 - INFO - Received 9200 messages so far
2025-02-26 20:02:55,346 - INFO - Received 9300 messages so far
2025-02-26 20:02:55,346 - INFO - Received 9400 messages so far
2025-02-26 20:02:55,346 - INFO - Received 9500 messages so far
2025-02-26 20:02:55,347 - INFO - Received 9600 messages so far
2025-02-26 20:02:55,347 - INFO - Received 9700 messages so far
2025-02-26 20:02:55,347 - INFO - Received 9800 messages so far
2025-02-26 20:02:55,347 - INFO - Received 9900 messages so far
2025-02-26 20:02:55,347 - INFO - Received 10000 messages so far
2025-02-26 20:02:55,347 - INFO - Total messages consumed: 10000
2025-02-26 20:02:55,435 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:55,439 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:55,439 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:55,439 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:55,439 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:55,447 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:55,450 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:55,450 - INFO - Number of columns: 66
2025-02-26 20:02:55,460 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
4912        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3953        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3398        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4350        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
936         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:55,460 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:55,490 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:55,535 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    376acab97e4aab30              eb77933b392d05f9  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:55,535 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.   443. 21116.  1900.  9092.   133.  5353.   136.   123.
   134.     0.    80.    22.   138.   547. 21115.    67.   135.]
2025-02-26 20:02:55,536 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:55,542 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:55,543 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:55,543 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:55,545 - INFO - DataFrame shape after NA dropping: (860, 23)
2025-02-26 20:02:55,545 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:55,545 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:55,546 - INFO - X shape: (860, 21), y shape: (860,)
2025-02-26 20:02:55,546 - INFO - Label distribution in training data: {'DNS': 719, 'HTTPS': 126, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:55,547 - INFO - Training model...
2025-02-26 20:02:55,659 - INFO - Predicting on test data...
2025-02-26 20:02:55,673 - INFO - Classification report:
{
  "DNS": {
    "precision": 0.9855072463768116,
    "recall": 1.0,
    "f1-score": 0.9927007299270073,
    "support": 136.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.3333333333333333,
    "f1-score": 0.5,
    "support": 6.0
  },
  "HTTPS": {
    "precision": 0.90625,
    "recall": 1.0,
    "f1-score": 0.9508196721311475,
    "support": 29.0
  },
  "SSH": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "accuracy": 0.9709302325581395,
  "macro avg": {
    "precision": 0.7229393115942029,
    "recall": 0.5833333333333333,
    "f1-score": 0.6108801005145388,
    "support": 172.0
  },
  "weighted avg": {
    "precision": 0.9669199738793394,
    "recall": 0.9709302325581395,
    "f1-score": 0.9626806381504435,
    "support": 172.0
  }
}
2025-02-26 20:02:55,680 - INFO - Saved processed data locally to processed_data_20250226_200255.csv
2025-02-26 20:02:55,682 - INFO - JSON data size: 425581 bytes
2025-02-26 20:02:55,682 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:55,683 - INFO - Data sent successfully!
2025-02-26 20:02:55,683 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:55,684 - INFO - Starting data processing
2025-02-26 20:02:55,684 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:55,684 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:55,685 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:55,685 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:55,787 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:55,787 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:55,787 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:55,787 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:55,787 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:55,788 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:55,788 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:55,788 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:55,788 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:55,939 - INFO - Received 100 messages so far
2025-02-26 20:02:55,939 - INFO - Received 200 messages so far
2025-02-26 20:02:55,940 - INFO - Received 300 messages so far
2025-02-26 20:02:55,940 - INFO - Received 400 messages so far
2025-02-26 20:02:55,940 - INFO - Received 500 messages so far
2025-02-26 20:02:55,940 - INFO - Received 600 messages so far
2025-02-26 20:02:55,940 - INFO - Received 700 messages so far
2025-02-26 20:02:55,940 - INFO - Received 800 messages so far
2025-02-26 20:02:55,941 - INFO - Received 900 messages so far
2025-02-26 20:02:55,941 - INFO - Received 1000 messages so far
2025-02-26 20:02:55,941 - INFO - Received 1100 messages so far
2025-02-26 20:02:55,941 - INFO - Received 1200 messages so far
2025-02-26 20:02:55,941 - INFO - Received 1300 messages so far
2025-02-26 20:02:55,942 - INFO - Received 1400 messages so far
2025-02-26 20:02:55,942 - INFO - Received 1500 messages so far
2025-02-26 20:02:55,942 - INFO - Received 1600 messages so far
2025-02-26 20:02:55,942 - INFO - Received 1700 messages so far
2025-02-26 20:02:55,942 - INFO - Received 1800 messages so far
2025-02-26 20:02:55,943 - INFO - Received 1900 messages so far
2025-02-26 20:02:55,943 - INFO - Received 2000 messages so far
2025-02-26 20:02:55,943 - INFO - Received 2100 messages so far
2025-02-26 20:02:55,943 - INFO - Received 2200 messages so far
2025-02-26 20:02:55,943 - INFO - Received 2300 messages so far
2025-02-26 20:02:55,944 - INFO - Received 2400 messages so far
2025-02-26 20:02:55,944 - INFO - Received 2500 messages so far
2025-02-26 20:02:55,944 - INFO - Received 2600 messages so far
2025-02-26 20:02:55,944 - INFO - Received 2700 messages so far
2025-02-26 20:02:55,944 - INFO - Received 2800 messages so far
2025-02-26 20:02:55,945 - INFO - Received 2900 messages so far
2025-02-26 20:02:55,945 - INFO - Received 3000 messages so far
2025-02-26 20:02:55,945 - INFO - Received 3100 messages so far
2025-02-26 20:02:55,945 - INFO - Received 3200 messages so far
2025-02-26 20:02:55,945 - INFO - Received 3300 messages so far
2025-02-26 20:02:55,946 - INFO - Received 3400 messages so far
2025-02-26 20:02:55,946 - INFO - Received 3500 messages so far
2025-02-26 20:02:55,946 - INFO - Received 3600 messages so far
2025-02-26 20:02:55,946 - INFO - Received 3700 messages so far
2025-02-26 20:02:55,946 - INFO - Received 3800 messages so far
2025-02-26 20:02:55,947 - INFO - Received 3900 messages so far
2025-02-26 20:02:55,947 - INFO - Received 4000 messages so far
2025-02-26 20:02:55,947 - INFO - Received 4100 messages so far
2025-02-26 20:02:55,999 - INFO - Received 4200 messages so far
2025-02-26 20:02:55,999 - INFO - Received 4300 messages so far
2025-02-26 20:02:55,999 - INFO - Received 4400 messages so far
2025-02-26 20:02:55,999 - INFO - Received 4500 messages so far
2025-02-26 20:02:56,000 - INFO - Received 4600 messages so far
2025-02-26 20:02:56,000 - INFO - Received 4700 messages so far
2025-02-26 20:02:56,000 - INFO - Received 4800 messages so far
2025-02-26 20:02:56,000 - INFO - Received 4900 messages so far
2025-02-26 20:02:56,000 - INFO - Received 5000 messages so far
2025-02-26 20:02:56,001 - INFO - Received 5100 messages so far
2025-02-26 20:02:56,001 - INFO - Received 5200 messages so far
2025-02-26 20:02:56,001 - INFO - Received 5300 messages so far
2025-02-26 20:02:56,001 - INFO - Received 5400 messages so far
2025-02-26 20:02:56,001 - INFO - Received 5500 messages so far
2025-02-26 20:02:56,002 - INFO - Received 5600 messages so far
2025-02-26 20:02:56,002 - INFO - Received 5700 messages so far
2025-02-26 20:02:56,002 - INFO - Received 5800 messages so far
2025-02-26 20:02:56,002 - INFO - Received 5900 messages so far
2025-02-26 20:02:56,002 - INFO - Received 6000 messages so far
2025-02-26 20:02:56,003 - INFO - Received 6100 messages so far
2025-02-26 20:02:56,003 - INFO - Received 6200 messages so far
2025-02-26 20:02:56,003 - INFO - Received 6300 messages so far
2025-02-26 20:02:56,003 - INFO - Received 6400 messages so far
2025-02-26 20:02:56,003 - INFO - Received 6500 messages so far
2025-02-26 20:02:56,004 - INFO - Received 6600 messages so far
2025-02-26 20:02:56,004 - INFO - Received 6700 messages so far
2025-02-26 20:02:56,004 - INFO - Received 6800 messages so far
2025-02-26 20:02:56,004 - INFO - Received 6900 messages so far
2025-02-26 20:02:56,004 - INFO - Received 7000 messages so far
2025-02-26 20:02:56,005 - INFO - Received 7100 messages so far
2025-02-26 20:02:56,005 - INFO - Received 7200 messages so far
2025-02-26 20:02:56,005 - INFO - Received 7300 messages so far
2025-02-26 20:02:56,005 - INFO - Received 7400 messages so far
2025-02-26 20:02:56,005 - INFO - Received 7500 messages so far
2025-02-26 20:02:56,006 - INFO - Received 7600 messages so far
2025-02-26 20:02:56,006 - INFO - Received 7700 messages so far
2025-02-26 20:02:56,006 - INFO - Received 7800 messages so far
2025-02-26 20:02:56,006 - INFO - Received 7900 messages so far
2025-02-26 20:02:56,006 - INFO - Received 8000 messages so far
2025-02-26 20:02:56,006 - INFO - Received 8100 messages so far
2025-02-26 20:02:56,007 - INFO - Received 8200 messages so far
2025-02-26 20:02:56,007 - INFO - Received 8300 messages so far
2025-02-26 20:02:56,007 - INFO - Received 8400 messages so far
2025-02-26 20:02:56,007 - INFO - Received 8500 messages so far
2025-02-26 20:02:56,007 - INFO - Received 8600 messages so far
2025-02-26 20:02:56,008 - INFO - Received 8700 messages so far
2025-02-26 20:02:56,110 - INFO - Received 8800 messages so far
2025-02-26 20:02:56,110 - INFO - Received 8900 messages so far
2025-02-26 20:02:56,110 - INFO - Received 9000 messages so far
2025-02-26 20:02:56,110 - INFO - Received 9100 messages so far
2025-02-26 20:02:56,111 - INFO - Received 9200 messages so far
2025-02-26 20:02:56,111 - INFO - Received 9300 messages so far
2025-02-26 20:02:56,111 - INFO - Received 9400 messages so far
2025-02-26 20:02:56,111 - INFO - Received 9500 messages so far
2025-02-26 20:02:56,112 - INFO - Received 9600 messages so far
2025-02-26 20:02:56,112 - INFO - Received 9700 messages so far
2025-02-26 20:02:56,112 - INFO - Received 9800 messages so far
2025-02-26 20:02:56,112 - INFO - Received 9900 messages so far
2025-02-26 20:02:56,112 - INFO - Received 10000 messages so far
2025-02-26 20:02:56,112 - INFO - Total messages consumed: 10000
2025-02-26 20:02:56,203 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:56,208 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:56,209 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:56,209 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:56,209 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:56,217 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:56,220 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:56,220 - INFO - Number of columns: 66
2025-02-26 20:02:56,231 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
4605        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4655        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5735        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3296     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740119e+09      NaN  NaN     NaN  CSZpg63zYpFPiQ3nxc    57926.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000195     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6515        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:56,231 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:56,262 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:56,307 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version           client_initial_dcid client_scid                   server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                            19          19                            17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                            19           1                            17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13  e66e05fe576deac0adb1fa816be6              e545068f19ba9a27fe6c1bcaec57  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                             1          19                             1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:56,308 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.  5353.   443.    53.    80.   136.  1900.   138.     0.
   123.    67. 21116.   133.   134. 21115.    22.   547.   135.]
2025-02-26 20:02:56,309 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:56,315 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:56,317 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:56,317 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:56,319 - INFO - DataFrame shape after NA dropping: (909, 23)
2025-02-26 20:02:56,319 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:56,319 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:56,320 - INFO - X shape: (909, 21), y shape: (909,)
2025-02-26 20:02:56,320 - INFO - Label distribution in training data: {'DNS': 761, 'HTTPS': 133, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:56,321 - INFO - Training model...
2025-02-26 20:02:56,435 - INFO - Predicting on test data...
2025-02-26 20:02:56,449 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 156.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 2.0
  },
  "HTTPS": {
    "precision": 0.96,
    "recall": 1.0,
    "f1-score": 0.9795918367346939,
    "support": 24.0
  },
  "accuracy": 0.9945054945054945,
  "macro avg": {
    "precision": 0.9866666666666667,
    "recall": 0.8333333333333334,
    "f1-score": 0.8820861678004533,
    "support": 182.0
  },
  "weighted avg": {
    "precision": 0.9947252747252747,
    "recall": 0.9945054945054945,
    "f1-score": 0.9936458099723406,
    "support": 182.0
  }
}
2025-02-26 20:02:56,456 - INFO - Saved processed data locally to processed_data_20250226_200256.csv
2025-02-26 20:02:56,459 - INFO - JSON data size: 446648 bytes
2025-02-26 20:02:56,459 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:56,459 - INFO - Data sent successfully!
2025-02-26 20:02:56,459 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:56,462 - INFO - Starting data processing
2025-02-26 20:02:56,462 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:56,463 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:56,463 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:56,463 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:56,565 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:56,565 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:56,566 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:56,566 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:56,566 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:56,567 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:56,567 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:56,567 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:56,568 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:56,723 - INFO - Received 100 messages so far
2025-02-26 20:02:56,723 - INFO - Received 200 messages so far
2025-02-26 20:02:56,723 - INFO - Received 300 messages so far
2025-02-26 20:02:56,723 - INFO - Received 400 messages so far
2025-02-26 20:02:56,724 - INFO - Received 500 messages so far
2025-02-26 20:02:56,724 - INFO - Received 600 messages so far
2025-02-26 20:02:56,724 - INFO - Received 700 messages so far
2025-02-26 20:02:56,724 - INFO - Received 800 messages so far
2025-02-26 20:02:56,724 - INFO - Received 900 messages so far
2025-02-26 20:02:56,724 - INFO - Received 1000 messages so far
2025-02-26 20:02:56,725 - INFO - Received 1100 messages so far
2025-02-26 20:02:56,725 - INFO - Received 1200 messages so far
2025-02-26 20:02:56,725 - INFO - Received 1300 messages so far
2025-02-26 20:02:56,725 - INFO - Received 1400 messages so far
2025-02-26 20:02:56,725 - INFO - Received 1500 messages so far
2025-02-26 20:02:56,726 - INFO - Received 1600 messages so far
2025-02-26 20:02:56,726 - INFO - Received 1700 messages so far
2025-02-26 20:02:56,726 - INFO - Received 1800 messages so far
2025-02-26 20:02:56,726 - INFO - Received 1900 messages so far
2025-02-26 20:02:56,726 - INFO - Received 2000 messages so far
2025-02-26 20:02:56,727 - INFO - Received 2100 messages so far
2025-02-26 20:02:56,727 - INFO - Received 2200 messages so far
2025-02-26 20:02:56,727 - INFO - Received 2300 messages so far
2025-02-26 20:02:56,727 - INFO - Received 2400 messages so far
2025-02-26 20:02:56,727 - INFO - Received 2500 messages so far
2025-02-26 20:02:56,728 - INFO - Received 2600 messages so far
2025-02-26 20:02:56,728 - INFO - Received 2700 messages so far
2025-02-26 20:02:56,728 - INFO - Received 2800 messages so far
2025-02-26 20:02:56,728 - INFO - Received 2900 messages so far
2025-02-26 20:02:56,728 - INFO - Received 3000 messages so far
2025-02-26 20:02:56,729 - INFO - Received 3100 messages so far
2025-02-26 20:02:56,729 - INFO - Received 3200 messages so far
2025-02-26 20:02:56,729 - INFO - Received 3300 messages so far
2025-02-26 20:02:56,729 - INFO - Received 3400 messages so far
2025-02-26 20:02:56,729 - INFO - Received 3500 messages so far
2025-02-26 20:02:56,730 - INFO - Received 3600 messages so far
2025-02-26 20:02:56,730 - INFO - Received 3700 messages so far
2025-02-26 20:02:56,730 - INFO - Received 3800 messages so far
2025-02-26 20:02:56,730 - INFO - Received 3900 messages so far
2025-02-26 20:02:56,730 - INFO - Received 4000 messages so far
2025-02-26 20:02:56,731 - INFO - Received 4100 messages so far
2025-02-26 20:02:56,786 - INFO - Received 4200 messages so far
2025-02-26 20:02:56,786 - INFO - Received 4300 messages so far
2025-02-26 20:02:56,787 - INFO - Received 4400 messages so far
2025-02-26 20:02:56,787 - INFO - Received 4500 messages so far
2025-02-26 20:02:56,787 - INFO - Received 4600 messages so far
2025-02-26 20:02:56,787 - INFO - Received 4700 messages so far
2025-02-26 20:02:56,788 - INFO - Received 4800 messages so far
2025-02-26 20:02:56,788 - INFO - Received 4900 messages so far
2025-02-26 20:02:56,788 - INFO - Received 5000 messages so far
2025-02-26 20:02:56,788 - INFO - Received 5100 messages so far
2025-02-26 20:02:56,788 - INFO - Received 5200 messages so far
2025-02-26 20:02:56,789 - INFO - Received 5300 messages so far
2025-02-26 20:02:56,789 - INFO - Received 5400 messages so far
2025-02-26 20:02:56,789 - INFO - Received 5500 messages so far
2025-02-26 20:02:56,789 - INFO - Received 5600 messages so far
2025-02-26 20:02:56,789 - INFO - Received 5700 messages so far
2025-02-26 20:02:56,790 - INFO - Received 5800 messages so far
2025-02-26 20:02:56,790 - INFO - Received 5900 messages so far
2025-02-26 20:02:56,790 - INFO - Received 6000 messages so far
2025-02-26 20:02:56,790 - INFO - Received 6100 messages so far
2025-02-26 20:02:56,790 - INFO - Received 6200 messages so far
2025-02-26 20:02:56,791 - INFO - Received 6300 messages so far
2025-02-26 20:02:56,791 - INFO - Received 6400 messages so far
2025-02-26 20:02:56,791 - INFO - Received 6500 messages so far
2025-02-26 20:02:56,791 - INFO - Received 6600 messages so far
2025-02-26 20:02:56,791 - INFO - Received 6700 messages so far
2025-02-26 20:02:56,791 - INFO - Received 6800 messages so far
2025-02-26 20:02:56,792 - INFO - Received 6900 messages so far
2025-02-26 20:02:56,792 - INFO - Received 7000 messages so far
2025-02-26 20:02:56,792 - INFO - Received 7100 messages so far
2025-02-26 20:02:56,792 - INFO - Received 7200 messages so far
2025-02-26 20:02:56,792 - INFO - Received 7300 messages so far
2025-02-26 20:02:56,793 - INFO - Received 7400 messages so far
2025-02-26 20:02:56,793 - INFO - Received 7500 messages so far
2025-02-26 20:02:56,793 - INFO - Received 7600 messages so far
2025-02-26 20:02:56,793 - INFO - Received 7700 messages so far
2025-02-26 20:02:56,793 - INFO - Received 7800 messages so far
2025-02-26 20:02:56,794 - INFO - Received 7900 messages so far
2025-02-26 20:02:56,794 - INFO - Received 8000 messages so far
2025-02-26 20:02:56,794 - INFO - Received 8100 messages so far
2025-02-26 20:02:56,794 - INFO - Received 8200 messages so far
2025-02-26 20:02:56,794 - INFO - Received 8300 messages so far
2025-02-26 20:02:56,795 - INFO - Received 8400 messages so far
2025-02-26 20:02:56,795 - INFO - Received 8500 messages so far
2025-02-26 20:02:56,795 - INFO - Received 8600 messages so far
2025-02-26 20:02:56,795 - INFO - Received 8700 messages so far
2025-02-26 20:02:56,853 - INFO - Received 8800 messages so far
2025-02-26 20:02:56,853 - INFO - Received 8900 messages so far
2025-02-26 20:02:56,853 - INFO - Received 9000 messages so far
2025-02-26 20:02:56,854 - INFO - Received 9100 messages so far
2025-02-26 20:02:56,854 - INFO - Received 9200 messages so far
2025-02-26 20:02:56,854 - INFO - Received 9300 messages so far
2025-02-26 20:02:56,854 - INFO - Received 9400 messages so far
2025-02-26 20:02:56,854 - INFO - Received 9500 messages so far
2025-02-26 20:02:56,855 - INFO - Received 9600 messages so far
2025-02-26 20:02:56,855 - INFO - Received 9700 messages so far
2025-02-26 20:02:56,855 - INFO - Received 9800 messages so far
2025-02-26 20:02:56,855 - INFO - Received 9900 messages so far
2025-02-26 20:02:56,855 - INFO - Received 10000 messages so far
2025-02-26 20:02:56,856 - INFO - Total messages consumed: 10000
2025-02-26 20:02:56,945 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:56,949 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:56,949 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:56,949 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:56,949 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:56,957 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:56,960 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:56,961 - INFO - Number of columns: 66
2025-02-26 20:02:56,970 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3492        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7106        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9922        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3215        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8380        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:56,971 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:57,002 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:57,049 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    376acab97e4aab30              eac96b6b462a8d5d  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:57,049 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   443.   123. 21115.   134.  5353.    80.  1900.
   136.   138.   133. 21116.   135.     0.   547.    67.    22.]
2025-02-26 20:02:57,050 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:57,055 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:57,057 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:57,057 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:57,059 - INFO - DataFrame shape after NA dropping: (767, 23)
2025-02-26 20:02:57,059 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:57,059 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:57,059 - INFO - X shape: (767, 21), y shape: (767,)
2025-02-26 20:02:57,060 - INFO - Label distribution in training data: {'DNS': 635, 'HTTPS': 118, 'HTTP': 13, 'SSH': 1}
2025-02-26 20:02:57,061 - INFO - Training model...
2025-02-26 20:02:57,174 - INFO - Predicting on test data...
2025-02-26 20:02:57,189 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 128.0
  },
  "HTTP": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 0.9230769230769231,
    "recall": 1.0,
    "f1-score": 0.96,
    "support": 24.0
  },
  "SSH": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "accuracy": 0.987012987012987,
  "macro avg": {
    "precision": 0.4807692307692308,
    "recall": 0.5,
    "f1-score": 0.49,
    "support": 154.0
  },
  "weighted avg": {
    "precision": 0.9750249750249751,
    "recall": 0.987012987012987,
    "f1-score": 0.9807792207792208,
    "support": 154.0
  }
}
2025-02-26 20:02:57,196 - INFO - Saved processed data locally to processed_data_20250226_200257.csv
2025-02-26 20:02:57,198 - INFO - JSON data size: 379498 bytes
2025-02-26 20:02:57,198 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:57,198 - INFO - Data sent successfully!
2025-02-26 20:02:57,198 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:57,201 - INFO - Starting data processing
2025-02-26 20:02:57,201 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:57,201 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:57,201 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:57,201 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:57,303 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:57,303 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:57,304 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:57,304 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:57,304 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:57,304 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:57,305 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:57,305 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:57,305 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:57,504 - INFO - Received 100 messages so far
2025-02-26 20:02:57,504 - INFO - Received 200 messages so far
2025-02-26 20:02:57,504 - INFO - Received 300 messages so far
2025-02-26 20:02:57,505 - INFO - Received 400 messages so far
2025-02-26 20:02:57,505 - INFO - Received 500 messages so far
2025-02-26 20:02:57,505 - INFO - Received 600 messages so far
2025-02-26 20:02:57,505 - INFO - Received 700 messages so far
2025-02-26 20:02:57,506 - INFO - Received 800 messages so far
2025-02-26 20:02:57,506 - INFO - Received 900 messages so far
2025-02-26 20:02:57,506 - INFO - Received 1000 messages so far
2025-02-26 20:02:57,506 - INFO - Received 1100 messages so far
2025-02-26 20:02:57,506 - INFO - Received 1200 messages so far
2025-02-26 20:02:57,507 - INFO - Received 1300 messages so far
2025-02-26 20:02:57,507 - INFO - Received 1400 messages so far
2025-02-26 20:02:57,507 - INFO - Received 1500 messages so far
2025-02-26 20:02:57,507 - INFO - Received 1600 messages so far
2025-02-26 20:02:57,507 - INFO - Received 1700 messages so far
2025-02-26 20:02:57,508 - INFO - Received 1800 messages so far
2025-02-26 20:02:57,508 - INFO - Received 1900 messages so far
2025-02-26 20:02:57,508 - INFO - Received 2000 messages so far
2025-02-26 20:02:57,508 - INFO - Received 2100 messages so far
2025-02-26 20:02:57,508 - INFO - Received 2200 messages so far
2025-02-26 20:02:57,509 - INFO - Received 2300 messages so far
2025-02-26 20:02:57,509 - INFO - Received 2400 messages so far
2025-02-26 20:02:57,509 - INFO - Received 2500 messages so far
2025-02-26 20:02:57,509 - INFO - Received 2600 messages so far
2025-02-26 20:02:57,509 - INFO - Received 2700 messages so far
2025-02-26 20:02:57,510 - INFO - Received 2800 messages so far
2025-02-26 20:02:57,510 - INFO - Received 2900 messages so far
2025-02-26 20:02:57,510 - INFO - Received 3000 messages so far
2025-02-26 20:02:57,510 - INFO - Received 3100 messages so far
2025-02-26 20:02:57,510 - INFO - Received 3200 messages so far
2025-02-26 20:02:57,511 - INFO - Received 3300 messages so far
2025-02-26 20:02:57,511 - INFO - Received 3400 messages so far
2025-02-26 20:02:57,511 - INFO - Received 3500 messages so far
2025-02-26 20:02:57,511 - INFO - Received 3600 messages so far
2025-02-26 20:02:57,511 - INFO - Received 3700 messages so far
2025-02-26 20:02:57,512 - INFO - Received 3800 messages so far
2025-02-26 20:02:57,512 - INFO - Received 3900 messages so far
2025-02-26 20:02:57,512 - INFO - Received 4000 messages so far
2025-02-26 20:02:57,512 - INFO - Received 4100 messages so far
2025-02-26 20:02:57,566 - INFO - Received 4200 messages so far
2025-02-26 20:02:57,566 - INFO - Received 4300 messages so far
2025-02-26 20:02:57,567 - INFO - Received 4400 messages so far
2025-02-26 20:02:57,567 - INFO - Received 4500 messages so far
2025-02-26 20:02:57,567 - INFO - Received 4600 messages so far
2025-02-26 20:02:57,567 - INFO - Received 4700 messages so far
2025-02-26 20:02:57,567 - INFO - Received 4800 messages so far
2025-02-26 20:02:57,568 - INFO - Received 4900 messages so far
2025-02-26 20:02:57,568 - INFO - Received 5000 messages so far
2025-02-26 20:02:57,568 - INFO - Received 5100 messages so far
2025-02-26 20:02:57,568 - INFO - Received 5200 messages so far
2025-02-26 20:02:57,568 - INFO - Received 5300 messages so far
2025-02-26 20:02:57,569 - INFO - Received 5400 messages so far
2025-02-26 20:02:57,569 - INFO - Received 5500 messages so far
2025-02-26 20:02:57,569 - INFO - Received 5600 messages so far
2025-02-26 20:02:57,569 - INFO - Received 5700 messages so far
2025-02-26 20:02:57,569 - INFO - Received 5800 messages so far
2025-02-26 20:02:57,569 - INFO - Received 5900 messages so far
2025-02-26 20:02:57,570 - INFO - Received 6000 messages so far
2025-02-26 20:02:57,570 - INFO - Received 6100 messages so far
2025-02-26 20:02:57,570 - INFO - Received 6200 messages so far
2025-02-26 20:02:57,570 - INFO - Received 6300 messages so far
2025-02-26 20:02:57,570 - INFO - Received 6400 messages so far
2025-02-26 20:02:57,571 - INFO - Received 6500 messages so far
2025-02-26 20:02:57,571 - INFO - Received 6600 messages so far
2025-02-26 20:02:57,571 - INFO - Received 6700 messages so far
2025-02-26 20:02:57,571 - INFO - Received 6800 messages so far
2025-02-26 20:02:57,571 - INFO - Received 6900 messages so far
2025-02-26 20:02:57,572 - INFO - Received 7000 messages so far
2025-02-26 20:02:57,572 - INFO - Received 7100 messages so far
2025-02-26 20:02:57,572 - INFO - Received 7200 messages so far
2025-02-26 20:02:57,572 - INFO - Received 7300 messages so far
2025-02-26 20:02:57,572 - INFO - Received 7400 messages so far
2025-02-26 20:02:57,573 - INFO - Received 7500 messages so far
2025-02-26 20:02:57,573 - INFO - Received 7600 messages so far
2025-02-26 20:02:57,573 - INFO - Received 7700 messages so far
2025-02-26 20:02:57,573 - INFO - Received 7800 messages so far
2025-02-26 20:02:57,573 - INFO - Received 7900 messages so far
2025-02-26 20:02:57,574 - INFO - Received 8000 messages so far
2025-02-26 20:02:57,574 - INFO - Received 8100 messages so far
2025-02-26 20:02:57,574 - INFO - Received 8200 messages so far
2025-02-26 20:02:57,574 - INFO - Received 8300 messages so far
2025-02-26 20:02:57,574 - INFO - Received 8400 messages so far
2025-02-26 20:02:57,575 - INFO - Received 8500 messages so far
2025-02-26 20:02:57,575 - INFO - Received 8600 messages so far
2025-02-26 20:02:57,575 - INFO - Received 8700 messages so far
2025-02-26 20:02:57,630 - INFO - Received 8800 messages so far
2025-02-26 20:02:57,630 - INFO - Received 8900 messages so far
2025-02-26 20:02:57,631 - INFO - Received 9000 messages so far
2025-02-26 20:02:57,631 - INFO - Received 9100 messages so far
2025-02-26 20:02:57,631 - INFO - Received 9200 messages so far
2025-02-26 20:02:57,631 - INFO - Received 9300 messages so far
2025-02-26 20:02:57,631 - INFO - Received 9400 messages so far
2025-02-26 20:02:57,632 - INFO - Received 9500 messages so far
2025-02-26 20:02:57,632 - INFO - Received 9600 messages so far
2025-02-26 20:02:57,632 - INFO - Received 9700 messages so far
2025-02-26 20:02:57,632 - INFO - Received 9800 messages so far
2025-02-26 20:02:57,632 - INFO - Received 9900 messages so far
2025-02-26 20:02:57,633 - INFO - Received 10000 messages so far
2025-02-26 20:02:57,633 - INFO - Total messages consumed: 10000
2025-02-26 20:02:57,720 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:57,724 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:57,724 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:57,724 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:57,724 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:57,732 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:57,735 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:57,735 - INFO - Number of columns: 66
2025-02-26 20:02:57,745 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
4073        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3587        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1295        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5174        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3409        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:57,745 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:57,775 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:57,819 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    5b67465ea3a9f950              20e4136c52007c23  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:57,820 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.   443.  9092.  5353.  1900.   136.   133.   123.   547.
 21116.   138.   134.     0.    22.    80.   135. 21115.    67.]
2025-02-26 20:02:57,821 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:57,826 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:57,827 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:57,827 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:57,829 - INFO - DataFrame shape after NA dropping: (896, 23)
2025-02-26 20:02:57,829 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:57,829 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:57,830 - INFO - X shape: (896, 21), y shape: (896,)
2025-02-26 20:02:57,830 - INFO - Label distribution in training data: {'DNS': 748, 'HTTPS': 133, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:57,831 - INFO - Training model...
2025-02-26 20:02:57,944 - INFO - Predicting on test data...
2025-02-26 20:02:57,958 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 148.0
  },
  "HTTP": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 2.0
  },
  "HTTPS": {
    "precision": 0.9375,
    "recall": 1.0,
    "f1-score": 0.967741935483871,
    "support": 30.0
  },
  "accuracy": 0.9888888888888889,
  "macro avg": {
    "precision": 0.6458333333333334,
    "recall": 0.6666666666666666,
    "f1-score": 0.6559139784946236,
    "support": 180.0
  },
  "weighted avg": {
    "precision": 0.9784722222222222,
    "recall": 0.9888888888888889,
    "f1-score": 0.9835125448028674,
    "support": 180.0
  }
}
2025-02-26 20:02:57,965 - INFO - Saved processed data locally to processed_data_20250226_200257.csv
2025-02-26 20:02:57,968 - INFO - JSON data size: 439775 bytes
2025-02-26 20:02:57,968 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:57,968 - INFO - Data sent successfully!
2025-02-26 20:02:57,968 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:57,969 - INFO - Starting data processing
2025-02-26 20:02:57,969 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:57,970 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:57,970 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:57,970 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:58,072 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:58,073 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:58,073 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:58,073 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:58,073 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:58,074 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:58,074 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:58,074 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:58,074 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:58,228 - INFO - Received 100 messages so far
2025-02-26 20:02:58,228 - INFO - Received 200 messages so far
2025-02-26 20:02:58,229 - INFO - Received 300 messages so far
2025-02-26 20:02:58,229 - INFO - Received 400 messages so far
2025-02-26 20:02:58,229 - INFO - Received 500 messages so far
2025-02-26 20:02:58,229 - INFO - Received 600 messages so far
2025-02-26 20:02:58,229 - INFO - Received 700 messages so far
2025-02-26 20:02:58,230 - INFO - Received 800 messages so far
2025-02-26 20:02:58,230 - INFO - Received 900 messages so far
2025-02-26 20:02:58,230 - INFO - Received 1000 messages so far
2025-02-26 20:02:58,230 - INFO - Received 1100 messages so far
2025-02-26 20:02:58,230 - INFO - Received 1200 messages so far
2025-02-26 20:02:58,231 - INFO - Received 1300 messages so far
2025-02-26 20:02:58,231 - INFO - Received 1400 messages so far
2025-02-26 20:02:58,231 - INFO - Received 1500 messages so far
2025-02-26 20:02:58,231 - INFO - Received 1600 messages so far
2025-02-26 20:02:58,231 - INFO - Received 1700 messages so far
2025-02-26 20:02:58,232 - INFO - Received 1800 messages so far
2025-02-26 20:02:58,232 - INFO - Received 1900 messages so far
2025-02-26 20:02:58,232 - INFO - Received 2000 messages so far
2025-02-26 20:02:58,232 - INFO - Received 2100 messages so far
2025-02-26 20:02:58,232 - INFO - Received 2200 messages so far
2025-02-26 20:02:58,232 - INFO - Received 2300 messages so far
2025-02-26 20:02:58,233 - INFO - Received 2400 messages so far
2025-02-26 20:02:58,233 - INFO - Received 2500 messages so far
2025-02-26 20:02:58,233 - INFO - Received 2600 messages so far
2025-02-26 20:02:58,233 - INFO - Received 2700 messages so far
2025-02-26 20:02:58,233 - INFO - Received 2800 messages so far
2025-02-26 20:02:58,234 - INFO - Received 2900 messages so far
2025-02-26 20:02:58,234 - INFO - Received 3000 messages so far
2025-02-26 20:02:58,234 - INFO - Received 3100 messages so far
2025-02-26 20:02:58,234 - INFO - Received 3200 messages so far
2025-02-26 20:02:58,234 - INFO - Received 3300 messages so far
2025-02-26 20:02:58,235 - INFO - Received 3400 messages so far
2025-02-26 20:02:58,235 - INFO - Received 3500 messages so far
2025-02-26 20:02:58,235 - INFO - Received 3600 messages so far
2025-02-26 20:02:58,235 - INFO - Received 3700 messages so far
2025-02-26 20:02:58,235 - INFO - Received 3800 messages so far
2025-02-26 20:02:58,236 - INFO - Received 3900 messages so far
2025-02-26 20:02:58,236 - INFO - Received 4000 messages so far
2025-02-26 20:02:58,236 - INFO - Received 4100 messages so far
2025-02-26 20:02:58,290 - INFO - Received 4200 messages so far
2025-02-26 20:02:58,290 - INFO - Received 4300 messages so far
2025-02-26 20:02:58,290 - INFO - Received 4400 messages so far
2025-02-26 20:02:58,290 - INFO - Received 4500 messages so far
2025-02-26 20:02:58,291 - INFO - Received 4600 messages so far
2025-02-26 20:02:58,291 - INFO - Received 4700 messages so far
2025-02-26 20:02:58,291 - INFO - Received 4800 messages so far
2025-02-26 20:02:58,291 - INFO - Received 4900 messages so far
2025-02-26 20:02:58,291 - INFO - Received 5000 messages so far
2025-02-26 20:02:58,292 - INFO - Received 5100 messages so far
2025-02-26 20:02:58,292 - INFO - Received 5200 messages so far
2025-02-26 20:02:58,292 - INFO - Received 5300 messages so far
2025-02-26 20:02:58,292 - INFO - Received 5400 messages so far
2025-02-26 20:02:58,292 - INFO - Received 5500 messages so far
2025-02-26 20:02:58,293 - INFO - Received 5600 messages so far
2025-02-26 20:02:58,293 - INFO - Received 5700 messages so far
2025-02-26 20:02:58,293 - INFO - Received 5800 messages so far
2025-02-26 20:02:58,293 - INFO - Received 5900 messages so far
2025-02-26 20:02:58,293 - INFO - Received 6000 messages so far
2025-02-26 20:02:58,294 - INFO - Received 6100 messages so far
2025-02-26 20:02:58,294 - INFO - Received 6200 messages so far
2025-02-26 20:02:58,294 - INFO - Received 6300 messages so far
2025-02-26 20:02:58,294 - INFO - Received 6400 messages so far
2025-02-26 20:02:58,294 - INFO - Received 6500 messages so far
2025-02-26 20:02:58,295 - INFO - Received 6600 messages so far
2025-02-26 20:02:58,295 - INFO - Received 6700 messages so far
2025-02-26 20:02:58,295 - INFO - Received 6800 messages so far
2025-02-26 20:02:58,295 - INFO - Received 6900 messages so far
2025-02-26 20:02:58,295 - INFO - Received 7000 messages so far
2025-02-26 20:02:58,296 - INFO - Received 7100 messages so far
2025-02-26 20:02:58,296 - INFO - Received 7200 messages so far
2025-02-26 20:02:58,296 - INFO - Received 7300 messages so far
2025-02-26 20:02:58,296 - INFO - Received 7400 messages so far
2025-02-26 20:02:58,296 - INFO - Received 7500 messages so far
2025-02-26 20:02:58,297 - INFO - Received 7600 messages so far
2025-02-26 20:02:58,297 - INFO - Received 7700 messages so far
2025-02-26 20:02:58,297 - INFO - Received 7800 messages so far
2025-02-26 20:02:58,297 - INFO - Received 7900 messages so far
2025-02-26 20:02:58,297 - INFO - Received 8000 messages so far
2025-02-26 20:02:58,298 - INFO - Received 8100 messages so far
2025-02-26 20:02:58,298 - INFO - Received 8200 messages so far
2025-02-26 20:02:58,298 - INFO - Received 8300 messages so far
2025-02-26 20:02:58,298 - INFO - Received 8400 messages so far
2025-02-26 20:02:58,298 - INFO - Received 8500 messages so far
2025-02-26 20:02:58,298 - INFO - Received 8600 messages so far
2025-02-26 20:02:58,299 - INFO - Received 8700 messages so far
2025-02-26 20:02:58,394 - INFO - Received 8800 messages so far
2025-02-26 20:02:58,394 - INFO - Received 8900 messages so far
2025-02-26 20:02:58,395 - INFO - Received 9000 messages so far
2025-02-26 20:02:58,395 - INFO - Received 9100 messages so far
2025-02-26 20:02:58,395 - INFO - Received 9200 messages so far
2025-02-26 20:02:58,395 - INFO - Received 9300 messages so far
2025-02-26 20:02:58,395 - INFO - Received 9400 messages so far
2025-02-26 20:02:58,396 - INFO - Received 9500 messages so far
2025-02-26 20:02:58,396 - INFO - Received 9600 messages so far
2025-02-26 20:02:58,396 - INFO - Received 9700 messages so far
2025-02-26 20:02:58,396 - INFO - Received 9800 messages so far
2025-02-26 20:02:58,396 - INFO - Received 9900 messages so far
2025-02-26 20:02:58,397 - INFO - Received 10000 messages so far
2025-02-26 20:02:58,397 - INFO - Total messages consumed: 10000
2025-02-26 20:02:58,484 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:58,488 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:58,488 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:58,488 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:58,488 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:58,496 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:58,499 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:58,499 - INFO - Number of columns: 66
2025-02-26 20:02:58,510 - INFO - DataFrame head:
      id.resp_p    id.orig_h     id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes  history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto    duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
1955        NaN          NaN           NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN      NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6372       53.0  192.168.1.3   192.168.1.1   udp        58.0       418.0  1.740119e+09      NaN  NaN     dns  C8LEcJ1YTwPhFzH228    32802.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0       Dd        1.0           86.0        1.0          446.0      17.0    0.001605     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5839      443.0  192.168.1.3  13.89.178.27   tcp     88920.0      7550.0  1.740119e+09      NaN  NaN     ssl   CSpShpwOeUDX8KMS6    58722.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN       RSTR       True      False           0.0  ShADadr       53.0        91684.0       53.0        10302.0       6.0  158.261244     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1592        NaN          NaN           NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN      NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8797        NaN          NaN           NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN      NaN        NaN            NaN        NaN            NaN       NaN         NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:58,510 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:58,540 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:58,585 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    ca26477d8c98f7b3              ea26477d8c98f7b3  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:58,585 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.   443.  9092.    80.  5353.   123.   133.   134.  1900.
    22.   138.   136. 21116.   547.   135.    67.     0. 21115.]
2025-02-26 20:02:58,586 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:58,592 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:58,593 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:58,593 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:58,595 - INFO - DataFrame shape after NA dropping: (897, 23)
2025-02-26 20:02:58,595 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:58,595 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:58,596 - INFO - X shape: (897, 21), y shape: (897,)
2025-02-26 20:02:58,596 - INFO - Label distribution in training data: {'DNS': 752, 'HTTPS': 131, 'HTTP': 13, 'SSH': 1}
2025-02-26 20:02:58,597 - INFO - Training model...
2025-02-26 20:02:58,709 - INFO - Predicting on test data...
2025-02-26 20:02:58,722 - INFO - Classification report:
{
  "DNS": {
    "precision": 0.9931506849315068,
    "recall": 1.0,
    "f1-score": 0.9965635738831615,
    "support": 145.0
  },
  "HTTP": {
    "precision": 0.5,
    "recall": 1.0,
    "f1-score": 0.6666666666666666,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 0.9696969696969697,
    "f1-score": 0.9846153846153847,
    "support": 33.0
  },
  "SSH": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "accuracy": 0.9888888888888889,
  "macro avg": {
    "precision": 0.6232876712328768,
    "recall": 0.7424242424242424,
    "f1-score": 0.6619614062913032,
    "support": 180.0
  },
  "weighted avg": {
    "precision": 0.9861491628614916,
    "recall": 0.9888888888888889,
    "f1-score": 0.9870038476224042,
    "support": 180.0
  }
}
2025-02-26 20:02:58,729 - INFO - Saved processed data locally to processed_data_20250226_200258.csv
2025-02-26 20:02:58,731 - INFO - JSON data size: 440976 bytes
2025-02-26 20:02:58,731 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:58,731 - INFO - Data sent successfully!
2025-02-26 20:02:58,731 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:58,732 - INFO - Starting data processing
2025-02-26 20:02:58,732 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:58,733 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:58,733 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:58,734 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:58,835 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:58,835 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:58,836 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:58,836 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:58,836 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:58,836 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:58,837 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:58,837 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:58,837 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:58,991 - INFO - Received 100 messages so far
2025-02-26 20:02:58,992 - INFO - Received 200 messages so far
2025-02-26 20:02:58,992 - INFO - Received 300 messages so far
2025-02-26 20:02:58,992 - INFO - Received 400 messages so far
2025-02-26 20:02:58,992 - INFO - Received 500 messages so far
2025-02-26 20:02:58,992 - INFO - Received 600 messages so far
2025-02-26 20:02:58,993 - INFO - Received 700 messages so far
2025-02-26 20:02:58,993 - INFO - Received 800 messages so far
2025-02-26 20:02:58,993 - INFO - Received 900 messages so far
2025-02-26 20:02:58,993 - INFO - Received 1000 messages so far
2025-02-26 20:02:58,993 - INFO - Received 1100 messages so far
2025-02-26 20:02:58,994 - INFO - Received 1200 messages so far
2025-02-26 20:02:58,994 - INFO - Received 1300 messages so far
2025-02-26 20:02:58,994 - INFO - Received 1400 messages so far
2025-02-26 20:02:58,994 - INFO - Received 1500 messages so far
2025-02-26 20:02:58,994 - INFO - Received 1600 messages so far
2025-02-26 20:02:58,995 - INFO - Received 1700 messages so far
2025-02-26 20:02:58,995 - INFO - Received 1800 messages so far
2025-02-26 20:02:58,995 - INFO - Received 1900 messages so far
2025-02-26 20:02:58,995 - INFO - Received 2000 messages so far
2025-02-26 20:02:58,995 - INFO - Received 2100 messages so far
2025-02-26 20:02:58,995 - INFO - Received 2200 messages so far
2025-02-26 20:02:58,996 - INFO - Received 2300 messages so far
2025-02-26 20:02:58,996 - INFO - Received 2400 messages so far
2025-02-26 20:02:58,996 - INFO - Received 2500 messages so far
2025-02-26 20:02:58,996 - INFO - Received 2600 messages so far
2025-02-26 20:02:58,996 - INFO - Received 2700 messages so far
2025-02-26 20:02:58,997 - INFO - Received 2800 messages so far
2025-02-26 20:02:58,997 - INFO - Received 2900 messages so far
2025-02-26 20:02:58,997 - INFO - Received 3000 messages so far
2025-02-26 20:02:58,997 - INFO - Received 3100 messages so far
2025-02-26 20:02:58,997 - INFO - Received 3200 messages so far
2025-02-26 20:02:58,998 - INFO - Received 3300 messages so far
2025-02-26 20:02:58,998 - INFO - Received 3400 messages so far
2025-02-26 20:02:58,998 - INFO - Received 3500 messages so far
2025-02-26 20:02:58,998 - INFO - Received 3600 messages so far
2025-02-26 20:02:58,998 - INFO - Received 3700 messages so far
2025-02-26 20:02:58,999 - INFO - Received 3800 messages so far
2025-02-26 20:02:58,999 - INFO - Received 3900 messages so far
2025-02-26 20:02:58,999 - INFO - Received 4000 messages so far
2025-02-26 20:02:58,999 - INFO - Received 4100 messages so far
2025-02-26 20:02:59,053 - INFO - Received 4200 messages so far
2025-02-26 20:02:59,053 - INFO - Received 4300 messages so far
2025-02-26 20:02:59,053 - INFO - Received 4400 messages so far
2025-02-26 20:02:59,054 - INFO - Received 4500 messages so far
2025-02-26 20:02:59,054 - INFO - Received 4600 messages so far
2025-02-26 20:02:59,054 - INFO - Received 4700 messages so far
2025-02-26 20:02:59,054 - INFO - Received 4800 messages so far
2025-02-26 20:02:59,054 - INFO - Received 4900 messages so far
2025-02-26 20:02:59,055 - INFO - Received 5000 messages so far
2025-02-26 20:02:59,055 - INFO - Received 5100 messages so far
2025-02-26 20:02:59,055 - INFO - Received 5200 messages so far
2025-02-26 20:02:59,055 - INFO - Received 5300 messages so far
2025-02-26 20:02:59,055 - INFO - Received 5400 messages so far
2025-02-26 20:02:59,056 - INFO - Received 5500 messages so far
2025-02-26 20:02:59,056 - INFO - Received 5600 messages so far
2025-02-26 20:02:59,056 - INFO - Received 5700 messages so far
2025-02-26 20:02:59,056 - INFO - Received 5800 messages so far
2025-02-26 20:02:59,056 - INFO - Received 5900 messages so far
2025-02-26 20:02:59,057 - INFO - Received 6000 messages so far
2025-02-26 20:02:59,057 - INFO - Received 6100 messages so far
2025-02-26 20:02:59,057 - INFO - Received 6200 messages so far
2025-02-26 20:02:59,057 - INFO - Received 6300 messages so far
2025-02-26 20:02:59,057 - INFO - Received 6400 messages so far
2025-02-26 20:02:59,058 - INFO - Received 6500 messages so far
2025-02-26 20:02:59,058 - INFO - Received 6600 messages so far
2025-02-26 20:02:59,058 - INFO - Received 6700 messages so far
2025-02-26 20:02:59,058 - INFO - Received 6800 messages so far
2025-02-26 20:02:59,058 - INFO - Received 6900 messages so far
2025-02-26 20:02:59,059 - INFO - Received 7000 messages so far
2025-02-26 20:02:59,059 - INFO - Received 7100 messages so far
2025-02-26 20:02:59,059 - INFO - Received 7200 messages so far
2025-02-26 20:02:59,059 - INFO - Received 7300 messages so far
2025-02-26 20:02:59,059 - INFO - Received 7400 messages so far
2025-02-26 20:02:59,060 - INFO - Received 7500 messages so far
2025-02-26 20:02:59,060 - INFO - Received 7600 messages so far
2025-02-26 20:02:59,060 - INFO - Received 7700 messages so far
2025-02-26 20:02:59,060 - INFO - Received 7800 messages so far
2025-02-26 20:02:59,060 - INFO - Received 7900 messages so far
2025-02-26 20:02:59,061 - INFO - Received 8000 messages so far
2025-02-26 20:02:59,061 - INFO - Received 8100 messages so far
2025-02-26 20:02:59,061 - INFO - Received 8200 messages so far
2025-02-26 20:02:59,061 - INFO - Received 8300 messages so far
2025-02-26 20:02:59,061 - INFO - Received 8400 messages so far
2025-02-26 20:02:59,061 - INFO - Received 8500 messages so far
2025-02-26 20:02:59,062 - INFO - Received 8600 messages so far
2025-02-26 20:02:59,062 - INFO - Received 8700 messages so far
2025-02-26 20:02:59,118 - INFO - Received 8800 messages so far
2025-02-26 20:02:59,118 - INFO - Received 8900 messages so far
2025-02-26 20:02:59,118 - INFO - Received 9000 messages so far
2025-02-26 20:02:59,118 - INFO - Received 9100 messages so far
2025-02-26 20:02:59,118 - INFO - Received 9200 messages so far
2025-02-26 20:02:59,119 - INFO - Received 9300 messages so far
2025-02-26 20:02:59,119 - INFO - Received 9400 messages so far
2025-02-26 20:02:59,119 - INFO - Received 9500 messages so far
2025-02-26 20:02:59,119 - INFO - Received 9600 messages so far
2025-02-26 20:02:59,119 - INFO - Received 9700 messages so far
2025-02-26 20:02:59,120 - INFO - Received 9800 messages so far
2025-02-26 20:02:59,120 - INFO - Received 9900 messages so far
2025-02-26 20:02:59,120 - INFO - Received 10000 messages so far
2025-02-26 20:02:59,120 - INFO - Total messages consumed: 10000
2025-02-26 20:02:59,210 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:59,214 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:59,214 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:59,214 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:59,214 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:59,221 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:59,224 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:59,225 - INFO - Number of columns: 66
2025-02-26 20:02:59,235 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
8538     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  CAqcbE45THxqPozhMa    40640.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000171     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3992        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2151     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740118e+09      NaN  NaN     NaN  CeUl3w3wvWuDBBEsl6    51202.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000479     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4224        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9163        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:59,236 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:02:59,266 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:02:59,310 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    376acab97e4aab30              efe788e3cc713726  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:02:59,310 - INFO - Unique values in 'id.resp_p' before labeling: [ 9092.    nan    53.   443.  5353.  1900.   133. 21116.   136.     0.
 21115.    22.   123.    80.   134.   547.   138.   135.    67.]
2025-02-26 20:02:59,311 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:02:59,316 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:59,318 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:02:59,318 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:02:59,320 - INFO - DataFrame shape after NA dropping: (846, 23)
2025-02-26 20:02:59,320 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:02:59,320 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:02:59,320 - INFO - X shape: (846, 21), y shape: (846,)
2025-02-26 20:02:59,321 - INFO - Label distribution in training data: {'DNS': 705, 'HTTPS': 126, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:02:59,322 - INFO - Training model...
2025-02-26 20:02:59,432 - INFO - Predicting on test data...
2025-02-26 20:02:59,445 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 143.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.75,
    "f1-score": 0.8571428571428571,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 0.9583333333333334,
    "recall": 1.0,
    "f1-score": 0.9787234042553191,
    "support": 23.0
  },
  "accuracy": 0.9941176470588236,
  "macro avg": {
    "precision": 0.9861111111111112,
    "recall": 0.9166666666666666,
    "f1-score": 0.945288753799392,
    "support": 170.0
  },
  "weighted avg": {
    "precision": 0.9943627450980391,
    "recall": 0.9941176470588236,
    "f1-score": 0.993760057214375,
    "support": 170.0
  }
}
2025-02-26 20:02:59,451 - INFO - Saved processed data locally to processed_data_20250226_200259.csv
2025-02-26 20:02:59,453 - INFO - JSON data size: 416667 bytes
2025-02-26 20:02:59,453 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:02:59,453 - INFO - Data sent successfully!
2025-02-26 20:02:59,453 - INFO - Data processing and transmission completed successfully
2025-02-26 20:02:59,454 - INFO - Starting data processing
2025-02-26 20:02:59,455 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:02:59,455 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:02:59,456 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:02:59,456 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:02:59,558 - INFO - Broker version identified as 2.5.0
2025-02-26 20:02:59,558 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:02:59,558 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:02:59,558 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:02:59,558 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:02:59,559 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:02:59,559 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:02:59,559 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:02:59,559 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:02:59,750 - INFO - Received 100 messages so far
2025-02-26 20:02:59,750 - INFO - Received 200 messages so far
2025-02-26 20:02:59,750 - INFO - Received 300 messages so far
2025-02-26 20:02:59,750 - INFO - Received 400 messages so far
2025-02-26 20:02:59,750 - INFO - Received 500 messages so far
2025-02-26 20:02:59,751 - INFO - Received 600 messages so far
2025-02-26 20:02:59,751 - INFO - Received 700 messages so far
2025-02-26 20:02:59,751 - INFO - Received 800 messages so far
2025-02-26 20:02:59,751 - INFO - Received 900 messages so far
2025-02-26 20:02:59,751 - INFO - Received 1000 messages so far
2025-02-26 20:02:59,752 - INFO - Received 1100 messages so far
2025-02-26 20:02:59,752 - INFO - Received 1200 messages so far
2025-02-26 20:02:59,752 - INFO - Received 1300 messages so far
2025-02-26 20:02:59,752 - INFO - Received 1400 messages so far
2025-02-26 20:02:59,752 - INFO - Received 1500 messages so far
2025-02-26 20:02:59,753 - INFO - Received 1600 messages so far
2025-02-26 20:02:59,753 - INFO - Received 1700 messages so far
2025-02-26 20:02:59,753 - INFO - Received 1800 messages so far
2025-02-26 20:02:59,753 - INFO - Received 1900 messages so far
2025-02-26 20:02:59,753 - INFO - Received 2000 messages so far
2025-02-26 20:02:59,754 - INFO - Received 2100 messages so far
2025-02-26 20:02:59,754 - INFO - Received 2200 messages so far
2025-02-26 20:02:59,754 - INFO - Received 2300 messages so far
2025-02-26 20:02:59,754 - INFO - Received 2400 messages so far
2025-02-26 20:02:59,754 - INFO - Received 2500 messages so far
2025-02-26 20:02:59,755 - INFO - Received 2600 messages so far
2025-02-26 20:02:59,755 - INFO - Received 2700 messages so far
2025-02-26 20:02:59,755 - INFO - Received 2800 messages so far
2025-02-26 20:02:59,755 - INFO - Received 2900 messages so far
2025-02-26 20:02:59,755 - INFO - Received 3000 messages so far
2025-02-26 20:02:59,756 - INFO - Received 3100 messages so far
2025-02-26 20:02:59,756 - INFO - Received 3200 messages so far
2025-02-26 20:02:59,756 - INFO - Received 3300 messages so far
2025-02-26 20:02:59,756 - INFO - Received 3400 messages so far
2025-02-26 20:02:59,756 - INFO - Received 3500 messages so far
2025-02-26 20:02:59,757 - INFO - Received 3600 messages so far
2025-02-26 20:02:59,757 - INFO - Received 3700 messages so far
2025-02-26 20:02:59,757 - INFO - Received 3800 messages so far
2025-02-26 20:02:59,757 - INFO - Received 3900 messages so far
2025-02-26 20:02:59,757 - INFO - Received 4000 messages so far
2025-02-26 20:02:59,758 - INFO - Received 4100 messages so far
2025-02-26 20:02:59,811 - INFO - Received 4200 messages so far
2025-02-26 20:02:59,812 - INFO - Received 4300 messages so far
2025-02-26 20:02:59,812 - INFO - Received 4400 messages so far
2025-02-26 20:02:59,812 - INFO - Received 4500 messages so far
2025-02-26 20:02:59,812 - INFO - Received 4600 messages so far
2025-02-26 20:02:59,812 - INFO - Received 4700 messages so far
2025-02-26 20:02:59,813 - INFO - Received 4800 messages so far
2025-02-26 20:02:59,813 - INFO - Received 4900 messages so far
2025-02-26 20:02:59,813 - INFO - Received 5000 messages so far
2025-02-26 20:02:59,813 - INFO - Received 5100 messages so far
2025-02-26 20:02:59,813 - INFO - Received 5200 messages so far
2025-02-26 20:02:59,814 - INFO - Received 5300 messages so far
2025-02-26 20:02:59,814 - INFO - Received 5400 messages so far
2025-02-26 20:02:59,814 - INFO - Received 5500 messages so far
2025-02-26 20:02:59,814 - INFO - Received 5600 messages so far
2025-02-26 20:02:59,814 - INFO - Received 5700 messages so far
2025-02-26 20:02:59,815 - INFO - Received 5800 messages so far
2025-02-26 20:02:59,815 - INFO - Received 5900 messages so far
2025-02-26 20:02:59,815 - INFO - Received 6000 messages so far
2025-02-26 20:02:59,815 - INFO - Received 6100 messages so far
2025-02-26 20:02:59,815 - INFO - Received 6200 messages so far
2025-02-26 20:02:59,816 - INFO - Received 6300 messages so far
2025-02-26 20:02:59,816 - INFO - Received 6400 messages so far
2025-02-26 20:02:59,816 - INFO - Received 6500 messages so far
2025-02-26 20:02:59,816 - INFO - Received 6600 messages so far
2025-02-26 20:02:59,816 - INFO - Received 6700 messages so far
2025-02-26 20:02:59,816 - INFO - Received 6800 messages so far
2025-02-26 20:02:59,817 - INFO - Received 6900 messages so far
2025-02-26 20:02:59,817 - INFO - Received 7000 messages so far
2025-02-26 20:02:59,817 - INFO - Received 7100 messages so far
2025-02-26 20:02:59,817 - INFO - Received 7200 messages so far
2025-02-26 20:02:59,817 - INFO - Received 7300 messages so far
2025-02-26 20:02:59,818 - INFO - Received 7400 messages so far
2025-02-26 20:02:59,818 - INFO - Received 7500 messages so far
2025-02-26 20:02:59,818 - INFO - Received 7600 messages so far
2025-02-26 20:02:59,818 - INFO - Received 7700 messages so far
2025-02-26 20:02:59,818 - INFO - Received 7800 messages so far
2025-02-26 20:02:59,819 - INFO - Received 7900 messages so far
2025-02-26 20:02:59,819 - INFO - Received 8000 messages so far
2025-02-26 20:02:59,819 - INFO - Received 8100 messages so far
2025-02-26 20:02:59,819 - INFO - Received 8200 messages so far
2025-02-26 20:02:59,819 - INFO - Received 8300 messages so far
2025-02-26 20:02:59,820 - INFO - Received 8400 messages so far
2025-02-26 20:02:59,820 - INFO - Received 8500 messages so far
2025-02-26 20:02:59,820 - INFO - Received 8600 messages so far
2025-02-26 20:02:59,820 - INFO - Received 8700 messages so far
2025-02-26 20:02:59,874 - INFO - Received 8800 messages so far
2025-02-26 20:02:59,874 - INFO - Received 8900 messages so far
2025-02-26 20:02:59,874 - INFO - Received 9000 messages so far
2025-02-26 20:02:59,874 - INFO - Received 9100 messages so far
2025-02-26 20:02:59,875 - INFO - Received 9200 messages so far
2025-02-26 20:02:59,875 - INFO - Received 9300 messages so far
2025-02-26 20:02:59,875 - INFO - Received 9400 messages so far
2025-02-26 20:02:59,875 - INFO - Received 9500 messages so far
2025-02-26 20:02:59,875 - INFO - Received 9600 messages so far
2025-02-26 20:02:59,876 - INFO - Received 9700 messages so far
2025-02-26 20:02:59,876 - INFO - Received 9800 messages so far
2025-02-26 20:02:59,876 - INFO - Received 9900 messages so far
2025-02-26 20:02:59,876 - INFO - Received 10000 messages so far
2025-02-26 20:02:59,876 - INFO - Total messages consumed: 10000
2025-02-26 20:02:59,961 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:02:59,965 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:59,966 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:02:59,966 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:02:59,966 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:02:59,973 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:02:59,976 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:02:59,977 - INFO - Number of columns: 66
2025-02-26 20:02:59,987 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
1957        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7364        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8315        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7228     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740119e+09      NaN  NaN     NaN  CzizMC1M7V0YriYqUk    50798.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000138     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6045        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:02:59,988 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:00,018 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:00,062 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    5b67465ea3a9f950              20e4136c52007c23  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:00,063 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.   443.    53.    80.   133.  1900.  5353.   136.   547.
   135. 21116.   123.    67.   138.    22.   134. 21115.     0.]
2025-02-26 20:03:00,064 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:00,069 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:00,070 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:00,070 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:00,072 - INFO - DataFrame shape after NA dropping: (845, 23)
2025-02-26 20:03:00,073 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:00,073 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:00,073 - INFO - X shape: (845, 21), y shape: (845,)
2025-02-26 20:03:00,073 - INFO - Label distribution in training data: {'DNS': 712, 'HTTPS': 119, 'HTTP': 13, 'SSH': 1}
2025-02-26 20:03:00,074 - INFO - Training model...
2025-02-26 20:03:00,180 - INFO - Predicting on test data...
2025-02-26 20:03:00,193 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 145.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.3333333333333333,
    "f1-score": 0.5,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.9130434782608695,
    "recall": 1.0,
    "f1-score": 0.9545454545454546,
    "support": 21.0
  },
  "accuracy": 0.9881656804733728,
  "macro avg": {
    "precision": 0.9710144927536232,
    "recall": 0.7777777777777777,
    "f1-score": 0.8181818181818182,
    "support": 169.0
  },
  "weighted avg": {
    "precision": 0.9891947517365577,
    "recall": 0.9881656804733728,
    "f1-score": 0.9854760623991394,
    "support": 169.0
  }
}
2025-02-26 20:03:00,200 - INFO - Saved processed data locally to processed_data_20250226_200300.csv
2025-02-26 20:03:00,202 - INFO - JSON data size: 416547 bytes
2025-02-26 20:03:00,202 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:00,202 - INFO - Data sent successfully!
2025-02-26 20:03:00,202 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:00,203 - INFO - Starting data processing
2025-02-26 20:03:00,203 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:00,204 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:00,204 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:00,204 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:00,306 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:00,306 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:00,306 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:00,306 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:00,306 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:00,307 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:00,308 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:00,308 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:00,308 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:00,460 - INFO - Received 100 messages so far
2025-02-26 20:03:00,460 - INFO - Received 200 messages so far
2025-02-26 20:03:00,461 - INFO - Received 300 messages so far
2025-02-26 20:03:00,461 - INFO - Received 400 messages so far
2025-02-26 20:03:00,461 - INFO - Received 500 messages so far
2025-02-26 20:03:00,461 - INFO - Received 600 messages so far
2025-02-26 20:03:00,461 - INFO - Received 700 messages so far
2025-02-26 20:03:00,462 - INFO - Received 800 messages so far
2025-02-26 20:03:00,462 - INFO - Received 900 messages so far
2025-02-26 20:03:00,462 - INFO - Received 1000 messages so far
2025-02-26 20:03:00,462 - INFO - Received 1100 messages so far
2025-02-26 20:03:00,462 - INFO - Received 1200 messages so far
2025-02-26 20:03:00,463 - INFO - Received 1300 messages so far
2025-02-26 20:03:00,463 - INFO - Received 1400 messages so far
2025-02-26 20:03:00,463 - INFO - Received 1500 messages so far
2025-02-26 20:03:00,463 - INFO - Received 1600 messages so far
2025-02-26 20:03:00,463 - INFO - Received 1700 messages so far
2025-02-26 20:03:00,464 - INFO - Received 1800 messages so far
2025-02-26 20:03:00,464 - INFO - Received 1900 messages so far
2025-02-26 20:03:00,464 - INFO - Received 2000 messages so far
2025-02-26 20:03:00,464 - INFO - Received 2100 messages so far
2025-02-26 20:03:00,464 - INFO - Received 2200 messages so far
2025-02-26 20:03:00,465 - INFO - Received 2300 messages so far
2025-02-26 20:03:00,465 - INFO - Received 2400 messages so far
2025-02-26 20:03:00,465 - INFO - Received 2500 messages so far
2025-02-26 20:03:00,465 - INFO - Received 2600 messages so far
2025-02-26 20:03:00,465 - INFO - Received 2700 messages so far
2025-02-26 20:03:00,466 - INFO - Received 2800 messages so far
2025-02-26 20:03:00,466 - INFO - Received 2900 messages so far
2025-02-26 20:03:00,466 - INFO - Received 3000 messages so far
2025-02-26 20:03:00,466 - INFO - Received 3100 messages so far
2025-02-26 20:03:00,466 - INFO - Received 3200 messages so far
2025-02-26 20:03:00,467 - INFO - Received 3300 messages so far
2025-02-26 20:03:00,467 - INFO - Received 3400 messages so far
2025-02-26 20:03:00,467 - INFO - Received 3500 messages so far
2025-02-26 20:03:00,467 - INFO - Received 3600 messages so far
2025-02-26 20:03:00,467 - INFO - Received 3700 messages so far
2025-02-26 20:03:00,468 - INFO - Received 3800 messages so far
2025-02-26 20:03:00,468 - INFO - Received 3900 messages so far
2025-02-26 20:03:00,468 - INFO - Received 4000 messages so far
2025-02-26 20:03:00,468 - INFO - Received 4100 messages so far
2025-02-26 20:03:00,565 - INFO - Received 4200 messages so far
2025-02-26 20:03:00,566 - INFO - Received 4300 messages so far
2025-02-26 20:03:00,566 - INFO - Received 4400 messages so far
2025-02-26 20:03:00,566 - INFO - Received 4500 messages so far
2025-02-26 20:03:00,566 - INFO - Received 4600 messages so far
2025-02-26 20:03:00,566 - INFO - Received 4700 messages so far
2025-02-26 20:03:00,567 - INFO - Received 4800 messages so far
2025-02-26 20:03:00,567 - INFO - Received 4900 messages so far
2025-02-26 20:03:00,567 - INFO - Received 5000 messages so far
2025-02-26 20:03:00,567 - INFO - Received 5100 messages so far
2025-02-26 20:03:00,567 - INFO - Received 5200 messages so far
2025-02-26 20:03:00,568 - INFO - Received 5300 messages so far
2025-02-26 20:03:00,568 - INFO - Received 5400 messages so far
2025-02-26 20:03:00,568 - INFO - Received 5500 messages so far
2025-02-26 20:03:00,568 - INFO - Received 5600 messages so far
2025-02-26 20:03:00,569 - INFO - Received 5700 messages so far
2025-02-26 20:03:00,569 - INFO - Received 5800 messages so far
2025-02-26 20:03:00,569 - INFO - Received 5900 messages so far
2025-02-26 20:03:00,569 - INFO - Received 6000 messages so far
2025-02-26 20:03:00,569 - INFO - Received 6100 messages so far
2025-02-26 20:03:00,570 - INFO - Received 6200 messages so far
2025-02-26 20:03:00,570 - INFO - Received 6300 messages so far
2025-02-26 20:03:00,570 - INFO - Received 6400 messages so far
2025-02-26 20:03:00,570 - INFO - Received 6500 messages so far
2025-02-26 20:03:00,570 - INFO - Received 6600 messages so far
2025-02-26 20:03:00,570 - INFO - Received 6700 messages so far
2025-02-26 20:03:00,571 - INFO - Received 6800 messages so far
2025-02-26 20:03:00,571 - INFO - Received 6900 messages so far
2025-02-26 20:03:00,571 - INFO - Received 7000 messages so far
2025-02-26 20:03:00,571 - INFO - Received 7100 messages so far
2025-02-26 20:03:00,571 - INFO - Received 7200 messages so far
2025-02-26 20:03:00,572 - INFO - Received 7300 messages so far
2025-02-26 20:03:00,572 - INFO - Received 7400 messages so far
2025-02-26 20:03:00,572 - INFO - Received 7500 messages so far
2025-02-26 20:03:00,572 - INFO - Received 7600 messages so far
2025-02-26 20:03:00,572 - INFO - Received 7700 messages so far
2025-02-26 20:03:00,573 - INFO - Received 7800 messages so far
2025-02-26 20:03:00,573 - INFO - Received 7900 messages so far
2025-02-26 20:03:00,573 - INFO - Received 8000 messages so far
2025-02-26 20:03:00,573 - INFO - Received 8100 messages so far
2025-02-26 20:03:00,573 - INFO - Received 8200 messages so far
2025-02-26 20:03:00,574 - INFO - Received 8300 messages so far
2025-02-26 20:03:00,574 - INFO - Received 8400 messages so far
2025-02-26 20:03:00,574 - INFO - Received 8500 messages so far
2025-02-26 20:03:00,574 - INFO - Received 8600 messages so far
2025-02-26 20:03:00,575 - INFO - Received 8700 messages so far
2025-02-26 20:03:00,629 - INFO - Received 8800 messages so far
2025-02-26 20:03:00,630 - INFO - Received 8900 messages so far
2025-02-26 20:03:00,630 - INFO - Received 9000 messages so far
2025-02-26 20:03:00,630 - INFO - Received 9100 messages so far
2025-02-26 20:03:00,630 - INFO - Received 9200 messages so far
2025-02-26 20:03:00,630 - INFO - Received 9300 messages so far
2025-02-26 20:03:00,631 - INFO - Received 9400 messages so far
2025-02-26 20:03:00,631 - INFO - Received 9500 messages so far
2025-02-26 20:03:00,631 - INFO - Received 9600 messages so far
2025-02-26 20:03:00,631 - INFO - Received 9700 messages so far
2025-02-26 20:03:00,631 - INFO - Received 9800 messages so far
2025-02-26 20:03:00,632 - INFO - Received 9900 messages so far
2025-02-26 20:03:00,632 - INFO - Received 10000 messages so far
2025-02-26 20:03:00,632 - INFO - Total messages consumed: 10000
2025-02-26 20:03:00,713 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:00,717 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:00,717 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:00,717 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:00,717 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:00,725 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:00,728 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:00,728 - INFO - Number of columns: 66
2025-02-26 20:03:00,739 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
46          NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5012        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.010755     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5945        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8532     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  CCnTpK14k3Rz7WG1Dj    40600.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000537     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9827        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:00,739 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:00,770 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:00,812 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    fb5090d671c8a979              fb5090d671c8a979  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:00,813 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.  1900.   443.  5353.   138.   134. 21116.   123.
   133.   136.    80.     0.   547.   135. 21115.    22.    67.]
2025-02-26 20:03:00,814 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:00,819 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:00,820 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:00,820 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:00,822 - INFO - DataFrame shape after NA dropping: (848, 23)
2025-02-26 20:03:00,823 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:00,823 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:00,823 - INFO - X shape: (848, 21), y shape: (848,)
2025-02-26 20:03:00,823 - INFO - Label distribution in training data: {'DNS': 707, 'HTTPS': 126, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:00,825 - INFO - Training model...
2025-02-26 20:03:00,934 - INFO - Predicting on test data...
2025-02-26 20:03:00,947 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 131.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 6.0
  },
  "HTTPS": {
    "precision": 0.9166666666666666,
    "recall": 1.0,
    "f1-score": 0.9565217391304348,
    "support": 33.0
  },
  "accuracy": 0.9823529411764705,
  "macro avg": {
    "precision": 0.9722222222222222,
    "recall": 0.8333333333333334,
    "f1-score": 0.8743961352657005,
    "support": 170.0
  },
  "weighted avg": {
    "precision": 0.9838235294117647,
    "recall": 0.9823529411764705,
    "f1-score": 0.9797953964194374,
    "support": 170.0
  }
}
2025-02-26 20:03:00,953 - INFO - Saved processed data locally to processed_data_20250226_200300.csv
2025-02-26 20:03:00,955 - INFO - JSON data size: 417913 bytes
2025-02-26 20:03:00,955 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:00,955 - INFO - Data sent successfully!
2025-02-26 20:03:00,955 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:00,956 - INFO - Starting data processing
2025-02-26 20:03:00,956 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:00,957 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:00,958 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:00,958 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:01,059 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:01,059 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:01,060 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:01,060 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:01,060 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:01,061 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:01,061 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:01,061 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:01,061 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:01,214 - INFO - Received 100 messages so far
2025-02-26 20:03:01,214 - INFO - Received 200 messages so far
2025-02-26 20:03:01,214 - INFO - Received 300 messages so far
2025-02-26 20:03:01,214 - INFO - Received 400 messages so far
2025-02-26 20:03:01,215 - INFO - Received 500 messages so far
2025-02-26 20:03:01,215 - INFO - Received 600 messages so far
2025-02-26 20:03:01,215 - INFO - Received 700 messages so far
2025-02-26 20:03:01,215 - INFO - Received 800 messages so far
2025-02-26 20:03:01,215 - INFO - Received 900 messages so far
2025-02-26 20:03:01,216 - INFO - Received 1000 messages so far
2025-02-26 20:03:01,216 - INFO - Received 1100 messages so far
2025-02-26 20:03:01,216 - INFO - Received 1200 messages so far
2025-02-26 20:03:01,216 - INFO - Received 1300 messages so far
2025-02-26 20:03:01,216 - INFO - Received 1400 messages so far
2025-02-26 20:03:01,217 - INFO - Received 1500 messages so far
2025-02-26 20:03:01,217 - INFO - Received 1600 messages so far
2025-02-26 20:03:01,217 - INFO - Received 1700 messages so far
2025-02-26 20:03:01,217 - INFO - Received 1800 messages so far
2025-02-26 20:03:01,217 - INFO - Received 1900 messages so far
2025-02-26 20:03:01,218 - INFO - Received 2000 messages so far
2025-02-26 20:03:01,218 - INFO - Received 2100 messages so far
2025-02-26 20:03:01,218 - INFO - Received 2200 messages so far
2025-02-26 20:03:01,218 - INFO - Received 2300 messages so far
2025-02-26 20:03:01,218 - INFO - Received 2400 messages so far
2025-02-26 20:03:01,219 - INFO - Received 2500 messages so far
2025-02-26 20:03:01,219 - INFO - Received 2600 messages so far
2025-02-26 20:03:01,219 - INFO - Received 2700 messages so far
2025-02-26 20:03:01,219 - INFO - Received 2800 messages so far
2025-02-26 20:03:01,219 - INFO - Received 2900 messages so far
2025-02-26 20:03:01,219 - INFO - Received 3000 messages so far
2025-02-26 20:03:01,220 - INFO - Received 3100 messages so far
2025-02-26 20:03:01,220 - INFO - Received 3200 messages so far
2025-02-26 20:03:01,220 - INFO - Received 3300 messages so far
2025-02-26 20:03:01,220 - INFO - Received 3400 messages so far
2025-02-26 20:03:01,220 - INFO - Received 3500 messages so far
2025-02-26 20:03:01,221 - INFO - Received 3600 messages so far
2025-02-26 20:03:01,221 - INFO - Received 3700 messages so far
2025-02-26 20:03:01,221 - INFO - Received 3800 messages so far
2025-02-26 20:03:01,221 - INFO - Received 3900 messages so far
2025-02-26 20:03:01,221 - INFO - Received 4000 messages so far
2025-02-26 20:03:01,222 - INFO - Received 4100 messages so far
2025-02-26 20:03:01,276 - INFO - Received 4200 messages so far
2025-02-26 20:03:01,276 - INFO - Received 4300 messages so far
2025-02-26 20:03:01,276 - INFO - Received 4400 messages so far
2025-02-26 20:03:01,276 - INFO - Received 4500 messages so far
2025-02-26 20:03:01,277 - INFO - Received 4600 messages so far
2025-02-26 20:03:01,277 - INFO - Received 4700 messages so far
2025-02-26 20:03:01,277 - INFO - Received 4800 messages so far
2025-02-26 20:03:01,277 - INFO - Received 4900 messages so far
2025-02-26 20:03:01,277 - INFO - Received 5000 messages so far
2025-02-26 20:03:01,278 - INFO - Received 5100 messages so far
2025-02-26 20:03:01,278 - INFO - Received 5200 messages so far
2025-02-26 20:03:01,278 - INFO - Received 5300 messages so far
2025-02-26 20:03:01,278 - INFO - Received 5400 messages so far
2025-02-26 20:03:01,278 - INFO - Received 5500 messages so far
2025-02-26 20:03:01,279 - INFO - Received 5600 messages so far
2025-02-26 20:03:01,279 - INFO - Received 5700 messages so far
2025-02-26 20:03:01,279 - INFO - Received 5800 messages so far
2025-02-26 20:03:01,279 - INFO - Received 5900 messages so far
2025-02-26 20:03:01,279 - INFO - Received 6000 messages so far
2025-02-26 20:03:01,279 - INFO - Received 6100 messages so far
2025-02-26 20:03:01,280 - INFO - Received 6200 messages so far
2025-02-26 20:03:01,280 - INFO - Received 6300 messages so far
2025-02-26 20:03:01,280 - INFO - Received 6400 messages so far
2025-02-26 20:03:01,280 - INFO - Received 6500 messages so far
2025-02-26 20:03:01,280 - INFO - Received 6600 messages so far
2025-02-26 20:03:01,281 - INFO - Received 6700 messages so far
2025-02-26 20:03:01,281 - INFO - Received 6800 messages so far
2025-02-26 20:03:01,281 - INFO - Received 6900 messages so far
2025-02-26 20:03:01,281 - INFO - Received 7000 messages so far
2025-02-26 20:03:01,281 - INFO - Received 7100 messages so far
2025-02-26 20:03:01,282 - INFO - Received 7200 messages so far
2025-02-26 20:03:01,282 - INFO - Received 7300 messages so far
2025-02-26 20:03:01,282 - INFO - Received 7400 messages so far
2025-02-26 20:03:01,282 - INFO - Received 7500 messages so far
2025-02-26 20:03:01,282 - INFO - Received 7600 messages so far
2025-02-26 20:03:01,283 - INFO - Received 7700 messages so far
2025-02-26 20:03:01,283 - INFO - Received 7800 messages so far
2025-02-26 20:03:01,283 - INFO - Received 7900 messages so far
2025-02-26 20:03:01,283 - INFO - Received 8000 messages so far
2025-02-26 20:03:01,283 - INFO - Received 8100 messages so far
2025-02-26 20:03:01,284 - INFO - Received 8200 messages so far
2025-02-26 20:03:01,284 - INFO - Received 8300 messages so far
2025-02-26 20:03:01,284 - INFO - Received 8400 messages so far
2025-02-26 20:03:01,284 - INFO - Received 8500 messages so far
2025-02-26 20:03:01,284 - INFO - Received 8600 messages so far
2025-02-26 20:03:01,285 - INFO - Received 8700 messages so far
2025-02-26 20:03:01,381 - INFO - Received 8800 messages so far
2025-02-26 20:03:01,382 - INFO - Received 8900 messages so far
2025-02-26 20:03:01,382 - INFO - Received 9000 messages so far
2025-02-26 20:03:01,382 - INFO - Received 9100 messages so far
2025-02-26 20:03:01,382 - INFO - Received 9200 messages so far
2025-02-26 20:03:01,382 - INFO - Received 9300 messages so far
2025-02-26 20:03:01,383 - INFO - Received 9400 messages so far
2025-02-26 20:03:01,383 - INFO - Received 9500 messages so far
2025-02-26 20:03:01,383 - INFO - Received 9600 messages so far
2025-02-26 20:03:01,383 - INFO - Received 9700 messages so far
2025-02-26 20:03:01,383 - INFO - Received 9800 messages so far
2025-02-26 20:03:01,384 - INFO - Received 9900 messages so far
2025-02-26 20:03:01,384 - INFO - Received 10000 messages so far
2025-02-26 20:03:01,384 - INFO - Total messages consumed: 10000
2025-02-26 20:03:01,469 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:01,473 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:01,473 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:01,473 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:01,474 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:01,481 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:01,484 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:01,484 - INFO - Number of columns: 66
2025-02-26 20:03:01,495 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
8303        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7132        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8238        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3269       53.0  192.168.1.3  192.168.1.1   udp        51.0       409.0  1.740119e+09      NaN  NaN     dns  CdIHUO3wJsWZZhIfud    49585.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         SF       True       True           0.0      Dd        1.0           79.0        1.0          437.0      17.0  0.001994     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3001        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.007085     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:01,495 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:01,527 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:01,570 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    b90b0ae34b0b9725              f90b0ae34b0b9725  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:01,570 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443.  5353.  1900.    80.   134.   138.   123.
    22.   133.     0. 21116.   136. 21115.   135.    67.   547.]
2025-02-26 20:03:01,571 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:01,576 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:01,577 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:01,578 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:01,580 - INFO - DataFrame shape after NA dropping: (907, 23)
2025-02-26 20:03:01,580 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:01,580 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:01,580 - INFO - X shape: (907, 21), y shape: (907,)
2025-02-26 20:03:01,580 - INFO - Label distribution in training data: {'DNS': 758, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:01,582 - INFO - Training model...
2025-02-26 20:03:01,696 - INFO - Predicting on test data...
2025-02-26 20:03:01,710 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 158.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 2.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 22.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 182.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 182.0
  }
}
2025-02-26 20:03:01,717 - INFO - Saved processed data locally to processed_data_20250226_200301.csv
2025-02-26 20:03:01,720 - INFO - JSON data size: 446409 bytes
2025-02-26 20:03:01,720 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:01,720 - INFO - Data sent successfully!
2025-02-26 20:03:01,720 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:01,721 - INFO - Starting data processing
2025-02-26 20:03:01,721 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:01,721 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:01,722 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:01,722 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:01,824 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:01,824 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:01,824 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:01,824 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:01,824 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:01,825 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:01,826 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:01,826 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:01,826 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:01,979 - INFO - Received 100 messages so far
2025-02-26 20:03:01,979 - INFO - Received 200 messages so far
2025-02-26 20:03:01,979 - INFO - Received 300 messages so far
2025-02-26 20:03:01,979 - INFO - Received 400 messages so far
2025-02-26 20:03:01,979 - INFO - Received 500 messages so far
2025-02-26 20:03:01,980 - INFO - Received 600 messages so far
2025-02-26 20:03:01,980 - INFO - Received 700 messages so far
2025-02-26 20:03:01,980 - INFO - Received 800 messages so far
2025-02-26 20:03:01,980 - INFO - Received 900 messages so far
2025-02-26 20:03:01,980 - INFO - Received 1000 messages so far
2025-02-26 20:03:01,981 - INFO - Received 1100 messages so far
2025-02-26 20:03:01,981 - INFO - Received 1200 messages so far
2025-02-26 20:03:01,981 - INFO - Received 1300 messages so far
2025-02-26 20:03:01,981 - INFO - Received 1400 messages so far
2025-02-26 20:03:01,981 - INFO - Received 1500 messages so far
2025-02-26 20:03:01,982 - INFO - Received 1600 messages so far
2025-02-26 20:03:01,982 - INFO - Received 1700 messages so far
2025-02-26 20:03:01,982 - INFO - Received 1800 messages so far
2025-02-26 20:03:01,982 - INFO - Received 1900 messages so far
2025-02-26 20:03:01,982 - INFO - Received 2000 messages so far
2025-02-26 20:03:01,983 - INFO - Received 2100 messages so far
2025-02-26 20:03:01,983 - INFO - Received 2200 messages so far
2025-02-26 20:03:01,983 - INFO - Received 2300 messages so far
2025-02-26 20:03:01,983 - INFO - Received 2400 messages so far
2025-02-26 20:03:01,983 - INFO - Received 2500 messages so far
2025-02-26 20:03:01,984 - INFO - Received 2600 messages so far
2025-02-26 20:03:01,984 - INFO - Received 2700 messages so far
2025-02-26 20:03:01,984 - INFO - Received 2800 messages so far
2025-02-26 20:03:01,984 - INFO - Received 2900 messages so far
2025-02-26 20:03:01,984 - INFO - Received 3000 messages so far
2025-02-26 20:03:01,985 - INFO - Received 3100 messages so far
2025-02-26 20:03:01,985 - INFO - Received 3200 messages so far
2025-02-26 20:03:01,985 - INFO - Received 3300 messages so far
2025-02-26 20:03:01,985 - INFO - Received 3400 messages so far
2025-02-26 20:03:01,985 - INFO - Received 3500 messages so far
2025-02-26 20:03:01,986 - INFO - Received 3600 messages so far
2025-02-26 20:03:01,986 - INFO - Received 3700 messages so far
2025-02-26 20:03:01,986 - INFO - Received 3800 messages so far
2025-02-26 20:03:01,986 - INFO - Received 3900 messages so far
2025-02-26 20:03:01,986 - INFO - Received 4000 messages so far
2025-02-26 20:03:01,987 - INFO - Received 4100 messages so far
2025-02-26 20:03:02,041 - INFO - Received 4200 messages so far
2025-02-26 20:03:02,041 - INFO - Received 4300 messages so far
2025-02-26 20:03:02,041 - INFO - Received 4400 messages so far
2025-02-26 20:03:02,042 - INFO - Received 4500 messages so far
2025-02-26 20:03:02,042 - INFO - Received 4600 messages so far
2025-02-26 20:03:02,042 - INFO - Received 4700 messages so far
2025-02-26 20:03:02,042 - INFO - Received 4800 messages so far
2025-02-26 20:03:02,042 - INFO - Received 4900 messages so far
2025-02-26 20:03:02,043 - INFO - Received 5000 messages so far
2025-02-26 20:03:02,043 - INFO - Received 5100 messages so far
2025-02-26 20:03:02,043 - INFO - Received 5200 messages so far
2025-02-26 20:03:02,043 - INFO - Received 5300 messages so far
2025-02-26 20:03:02,043 - INFO - Received 5400 messages so far
2025-02-26 20:03:02,043 - INFO - Received 5500 messages so far
2025-02-26 20:03:02,044 - INFO - Received 5600 messages so far
2025-02-26 20:03:02,044 - INFO - Received 5700 messages so far
2025-02-26 20:03:02,044 - INFO - Received 5800 messages so far
2025-02-26 20:03:02,044 - INFO - Received 5900 messages so far
2025-02-26 20:03:02,044 - INFO - Received 6000 messages so far
2025-02-26 20:03:02,045 - INFO - Received 6100 messages so far
2025-02-26 20:03:02,045 - INFO - Received 6200 messages so far
2025-02-26 20:03:02,045 - INFO - Received 6300 messages so far
2025-02-26 20:03:02,045 - INFO - Received 6400 messages so far
2025-02-26 20:03:02,045 - INFO - Received 6500 messages so far
2025-02-26 20:03:02,046 - INFO - Received 6600 messages so far
2025-02-26 20:03:02,046 - INFO - Received 6700 messages so far
2025-02-26 20:03:02,046 - INFO - Received 6800 messages so far
2025-02-26 20:03:02,046 - INFO - Received 6900 messages so far
2025-02-26 20:03:02,046 - INFO - Received 7000 messages so far
2025-02-26 20:03:02,047 - INFO - Received 7100 messages so far
2025-02-26 20:03:02,047 - INFO - Received 7200 messages so far
2025-02-26 20:03:02,047 - INFO - Received 7300 messages so far
2025-02-26 20:03:02,047 - INFO - Received 7400 messages so far
2025-02-26 20:03:02,047 - INFO - Received 7500 messages so far
2025-02-26 20:03:02,048 - INFO - Received 7600 messages so far
2025-02-26 20:03:02,048 - INFO - Received 7700 messages so far
2025-02-26 20:03:02,048 - INFO - Received 7800 messages so far
2025-02-26 20:03:02,048 - INFO - Received 7900 messages so far
2025-02-26 20:03:02,048 - INFO - Received 8000 messages so far
2025-02-26 20:03:02,049 - INFO - Received 8100 messages so far
2025-02-26 20:03:02,049 - INFO - Received 8200 messages so far
2025-02-26 20:03:02,049 - INFO - Received 8300 messages so far
2025-02-26 20:03:02,049 - INFO - Received 8400 messages so far
2025-02-26 20:03:02,049 - INFO - Received 8500 messages so far
2025-02-26 20:03:02,050 - INFO - Received 8600 messages so far
2025-02-26 20:03:02,050 - INFO - Received 8700 messages so far
2025-02-26 20:03:02,106 - INFO - Received 8800 messages so far
2025-02-26 20:03:02,106 - INFO - Received 8900 messages so far
2025-02-26 20:03:02,106 - INFO - Received 9000 messages so far
2025-02-26 20:03:02,106 - INFO - Received 9100 messages so far
2025-02-26 20:03:02,107 - INFO - Received 9200 messages so far
2025-02-26 20:03:02,107 - INFO - Received 9300 messages so far
2025-02-26 20:03:02,107 - INFO - Received 9400 messages so far
2025-02-26 20:03:02,107 - INFO - Received 9500 messages so far
2025-02-26 20:03:02,107 - INFO - Received 9600 messages so far
2025-02-26 20:03:02,108 - INFO - Received 9700 messages so far
2025-02-26 20:03:02,108 - INFO - Received 9800 messages so far
2025-02-26 20:03:02,108 - INFO - Received 9900 messages so far
2025-02-26 20:03:02,108 - INFO - Received 10000 messages so far
2025-02-26 20:03:02,108 - INFO - Total messages consumed: 10000
2025-02-26 20:03:02,194 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:02,198 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:02,198 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:02,198 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:02,199 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:02,206 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:02,209 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:02,210 - INFO - Number of columns: 66
2025-02-26 20:03:02,221 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt                    query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD     RA    Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
3091        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4959        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9696       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740120e+09      NaN  NaN     NaN   CCZKcbYs2Gh3u6jEg    56690.0  NaN  wac-0003.wac-msedge.net     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  False  0.0     NaN  NaN    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5891        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8611     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  CjNYru1yV30UxeaX4c    35504.0  NaN                      NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000139     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:02,221 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:02,251 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:02,293 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version           client_initial_dcid client_scid                   server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                            19          19                            17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                            19           1                            17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13  e66e05fe576deac0adb1fa816be6              e545068f19ba9a27fe6c1bcaec57  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                             1          19                             1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:02,293 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.    80.   443.  5353.  1900.   123.    22.   133.
   134.     0.   136. 21116.   138.   547.   135. 21115.    67.]
2025-02-26 20:03:02,295 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:02,300 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:02,301 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:02,301 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:02,303 - INFO - DataFrame shape after NA dropping: (801, 23)
2025-02-26 20:03:02,303 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:02,303 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:02,303 - INFO - X shape: (801, 21), y shape: (801,)
2025-02-26 20:03:02,304 - INFO - Label distribution in training data: {'DNS': 669, 'HTTPS': 120, 'HTTP': 12}
2025-02-26 20:03:02,305 - INFO - Training model...
2025-02-26 20:03:02,414 - INFO - Predicting on test data...
2025-02-26 20:03:02,428 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 133.0
  },
  "HTTP": {
    "precision": 0.75,
    "recall": 0.6,
    "f1-score": 0.6666666666666666,
    "support": 5.0
  },
  "HTTPS": {
    "precision": 0.9166666666666666,
    "recall": 0.9565217391304348,
    "f1-score": 0.9361702127659575,
    "support": 23.0
  },
  "accuracy": 0.9813664596273292,
  "macro avg": {
    "precision": 0.8888888888888888,
    "recall": 0.8521739130434783,
    "f1-score": 0.867612293144208,
    "support": 161.0
  },
  "weighted avg": {
    "precision": 0.9803312629399586,
    "recall": 0.9813664596273292,
    "f1-score": 0.9805294920928594,
    "support": 161.0
  }
}
2025-02-26 20:03:02,434 - INFO - Saved processed data locally to processed_data_20250226_200302.csv
2025-02-26 20:03:02,436 - INFO - JSON data size: 393425 bytes
2025-02-26 20:03:02,436 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:02,437 - INFO - Data sent successfully!
2025-02-26 20:03:02,437 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:02,438 - INFO - Starting data processing
2025-02-26 20:03:02,438 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:02,438 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:02,439 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:02,439 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:02,541 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:02,541 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:02,541 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:02,541 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:02,541 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:02,542 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:02,542 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:02,542 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:02,543 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:02,738 - INFO - Received 100 messages so far
2025-02-26 20:03:02,738 - INFO - Received 200 messages so far
2025-02-26 20:03:02,739 - INFO - Received 300 messages so far
2025-02-26 20:03:02,739 - INFO - Received 400 messages so far
2025-02-26 20:03:02,739 - INFO - Received 500 messages so far
2025-02-26 20:03:02,739 - INFO - Received 600 messages so far
2025-02-26 20:03:02,739 - INFO - Received 700 messages so far
2025-02-26 20:03:02,740 - INFO - Received 800 messages so far
2025-02-26 20:03:02,740 - INFO - Received 900 messages so far
2025-02-26 20:03:02,740 - INFO - Received 1000 messages so far
2025-02-26 20:03:02,740 - INFO - Received 1100 messages so far
2025-02-26 20:03:02,740 - INFO - Received 1200 messages so far
2025-02-26 20:03:02,741 - INFO - Received 1300 messages so far
2025-02-26 20:03:02,741 - INFO - Received 1400 messages so far
2025-02-26 20:03:02,741 - INFO - Received 1500 messages so far
2025-02-26 20:03:02,741 - INFO - Received 1600 messages so far
2025-02-26 20:03:02,741 - INFO - Received 1700 messages so far
2025-02-26 20:03:02,742 - INFO - Received 1800 messages so far
2025-02-26 20:03:02,742 - INFO - Received 1900 messages so far
2025-02-26 20:03:02,742 - INFO - Received 2000 messages so far
2025-02-26 20:03:02,742 - INFO - Received 2100 messages so far
2025-02-26 20:03:02,742 - INFO - Received 2200 messages so far
2025-02-26 20:03:02,743 - INFO - Received 2300 messages so far
2025-02-26 20:03:02,743 - INFO - Received 2400 messages so far
2025-02-26 20:03:02,743 - INFO - Received 2500 messages so far
2025-02-26 20:03:02,743 - INFO - Received 2600 messages so far
2025-02-26 20:03:02,743 - INFO - Received 2700 messages so far
2025-02-26 20:03:02,744 - INFO - Received 2800 messages so far
2025-02-26 20:03:02,744 - INFO - Received 2900 messages so far
2025-02-26 20:03:02,744 - INFO - Received 3000 messages so far
2025-02-26 20:03:02,744 - INFO - Received 3100 messages so far
2025-02-26 20:03:02,744 - INFO - Received 3200 messages so far
2025-02-26 20:03:02,745 - INFO - Received 3300 messages so far
2025-02-26 20:03:02,745 - INFO - Received 3400 messages so far
2025-02-26 20:03:02,745 - INFO - Received 3500 messages so far
2025-02-26 20:03:02,745 - INFO - Received 3600 messages so far
2025-02-26 20:03:02,745 - INFO - Received 3700 messages so far
2025-02-26 20:03:02,746 - INFO - Received 3800 messages so far
2025-02-26 20:03:02,746 - INFO - Received 3900 messages so far
2025-02-26 20:03:02,746 - INFO - Received 4000 messages so far
2025-02-26 20:03:02,746 - INFO - Received 4100 messages so far
2025-02-26 20:03:02,798 - INFO - Received 4200 messages so far
2025-02-26 20:03:02,798 - INFO - Received 4300 messages so far
2025-02-26 20:03:02,798 - INFO - Received 4400 messages so far
2025-02-26 20:03:02,798 - INFO - Received 4500 messages so far
2025-02-26 20:03:02,798 - INFO - Received 4600 messages so far
2025-02-26 20:03:02,799 - INFO - Received 4700 messages so far
2025-02-26 20:03:02,799 - INFO - Received 4800 messages so far
2025-02-26 20:03:02,799 - INFO - Received 4900 messages so far
2025-02-26 20:03:02,799 - INFO - Received 5000 messages so far
2025-02-26 20:03:02,799 - INFO - Received 5100 messages so far
2025-02-26 20:03:02,800 - INFO - Received 5200 messages so far
2025-02-26 20:03:02,800 - INFO - Received 5300 messages so far
2025-02-26 20:03:02,800 - INFO - Received 5400 messages so far
2025-02-26 20:03:02,800 - INFO - Received 5500 messages so far
2025-02-26 20:03:02,800 - INFO - Received 5600 messages so far
2025-02-26 20:03:02,801 - INFO - Received 5700 messages so far
2025-02-26 20:03:02,801 - INFO - Received 5800 messages so far
2025-02-26 20:03:02,801 - INFO - Received 5900 messages so far
2025-02-26 20:03:02,801 - INFO - Received 6000 messages so far
2025-02-26 20:03:02,801 - INFO - Received 6100 messages so far
2025-02-26 20:03:02,802 - INFO - Received 6200 messages so far
2025-02-26 20:03:02,802 - INFO - Received 6300 messages so far
2025-02-26 20:03:02,802 - INFO - Received 6400 messages so far
2025-02-26 20:03:02,802 - INFO - Received 6500 messages so far
2025-02-26 20:03:02,802 - INFO - Received 6600 messages so far
2025-02-26 20:03:02,803 - INFO - Received 6700 messages so far
2025-02-26 20:03:02,803 - INFO - Received 6800 messages so far
2025-02-26 20:03:02,803 - INFO - Received 6900 messages so far
2025-02-26 20:03:02,803 - INFO - Received 7000 messages so far
2025-02-26 20:03:02,803 - INFO - Received 7100 messages so far
2025-02-26 20:03:02,803 - INFO - Received 7200 messages so far
2025-02-26 20:03:02,804 - INFO - Received 7300 messages so far
2025-02-26 20:03:02,804 - INFO - Received 7400 messages so far
2025-02-26 20:03:02,804 - INFO - Received 7500 messages so far
2025-02-26 20:03:02,804 - INFO - Received 7600 messages so far
2025-02-26 20:03:02,804 - INFO - Received 7700 messages so far
2025-02-26 20:03:02,805 - INFO - Received 7800 messages so far
2025-02-26 20:03:02,805 - INFO - Received 7900 messages so far
2025-02-26 20:03:02,805 - INFO - Received 8000 messages so far
2025-02-26 20:03:02,805 - INFO - Received 8100 messages so far
2025-02-26 20:03:02,805 - INFO - Received 8200 messages so far
2025-02-26 20:03:02,806 - INFO - Received 8300 messages so far
2025-02-26 20:03:02,806 - INFO - Received 8400 messages so far
2025-02-26 20:03:02,806 - INFO - Received 8500 messages so far
2025-02-26 20:03:02,806 - INFO - Received 8600 messages so far
2025-02-26 20:03:02,807 - INFO - Received 8700 messages so far
2025-02-26 20:03:02,864 - INFO - Received 8800 messages so far
2025-02-26 20:03:02,864 - INFO - Received 8900 messages so far
2025-02-26 20:03:02,864 - INFO - Received 9000 messages so far
2025-02-26 20:03:02,865 - INFO - Received 9100 messages so far
2025-02-26 20:03:02,865 - INFO - Received 9200 messages so far
2025-02-26 20:03:02,865 - INFO - Received 9300 messages so far
2025-02-26 20:03:02,865 - INFO - Received 9400 messages so far
2025-02-26 20:03:02,865 - INFO - Received 9500 messages so far
2025-02-26 20:03:02,866 - INFO - Received 9600 messages so far
2025-02-26 20:03:02,866 - INFO - Received 9700 messages so far
2025-02-26 20:03:02,866 - INFO - Received 9800 messages so far
2025-02-26 20:03:02,866 - INFO - Received 9900 messages so far
2025-02-26 20:03:02,866 - INFO - Received 10000 messages so far
2025-02-26 20:03:02,866 - INFO - Total messages consumed: 10000
2025-02-26 20:03:02,954 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:02,958 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:02,958 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:02,958 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:02,958 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:02,966 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:02,969 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:02,969 - INFO - Number of columns: 66
2025-02-26 20:03:02,980 - INFO - DataFrame head:
      id.resp_p      id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto   duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
1321        NaN            NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN        NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1830     5353.0  192.168.1.238  224.0.0.251   udp       599.0         0.0  1.740118e+09      NaN  NaN     dns  Cnho3V2HhEnYv5oJV3     5353.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN         S0       True      False           0.0       D        6.0          767.0        0.0            0.0      17.0  15.010153     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3793        NaN            NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN        NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4979        NaN            NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN        NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6733        NaN            NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN        NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:02,980 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:03,011 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:03,056 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    7621c9ee35587231              f621c9ee35587231  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:03,057 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  5353.    53.  9092.   443.    80.  1900.   123.   136.    67.
     0. 21115.   133. 21116.   134.    22.   138.   547.   135.]
2025-02-26 20:03:03,058 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:03,063 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:03,064 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:03,064 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:03,066 - INFO - DataFrame shape after NA dropping: (900, 23)
2025-02-26 20:03:03,066 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:03,066 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:03,067 - INFO - X shape: (900, 21), y shape: (900,)
2025-02-26 20:03:03,067 - INFO - Label distribution in training data: {'DNS': 751, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:03,068 - INFO - Training model...
2025-02-26 20:03:03,179 - INFO - Predicting on test data...
2025-02-26 20:03:03,193 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 152.0
  },
  "HTTP": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.8928571428571429,
    "recall": 1.0,
    "f1-score": 0.9433962264150944,
    "support": 25.0
  },
  "accuracy": 0.9833333333333333,
  "macro avg": {
    "precision": 0.6309523809523809,
    "recall": 0.6666666666666666,
    "f1-score": 0.6477987421383647,
    "support": 180.0
  },
  "weighted avg": {
    "precision": 0.9684523809523811,
    "recall": 0.9833333333333333,
    "f1-score": 0.9754716981132076,
    "support": 180.0
  }
}
2025-02-26 20:03:03,200 - INFO - Saved processed data locally to processed_data_20250226_200303.csv
2025-02-26 20:03:03,202 - INFO - JSON data size: 440588 bytes
2025-02-26 20:03:03,202 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:03,202 - INFO - Data sent successfully!
2025-02-26 20:03:03,202 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:03,203 - INFO - Starting data processing
2025-02-26 20:03:03,203 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:03,204 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:03,205 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:03,205 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:03,306 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:03,306 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:03,307 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:03,307 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:03,307 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:03,307 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:03,308 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:03,308 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:03,308 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:03,462 - INFO - Received 100 messages so far
2025-02-26 20:03:03,462 - INFO - Received 200 messages so far
2025-02-26 20:03:03,462 - INFO - Received 300 messages so far
2025-02-26 20:03:03,463 - INFO - Received 400 messages so far
2025-02-26 20:03:03,463 - INFO - Received 500 messages so far
2025-02-26 20:03:03,463 - INFO - Received 600 messages so far
2025-02-26 20:03:03,463 - INFO - Received 700 messages so far
2025-02-26 20:03:03,463 - INFO - Received 800 messages so far
2025-02-26 20:03:03,464 - INFO - Received 900 messages so far
2025-02-26 20:03:03,464 - INFO - Received 1000 messages so far
2025-02-26 20:03:03,464 - INFO - Received 1100 messages so far
2025-02-26 20:03:03,464 - INFO - Received 1200 messages so far
2025-02-26 20:03:03,464 - INFO - Received 1300 messages so far
2025-02-26 20:03:03,465 - INFO - Received 1400 messages so far
2025-02-26 20:03:03,465 - INFO - Received 1500 messages so far
2025-02-26 20:03:03,465 - INFO - Received 1600 messages so far
2025-02-26 20:03:03,465 - INFO - Received 1700 messages so far
2025-02-26 20:03:03,465 - INFO - Received 1800 messages so far
2025-02-26 20:03:03,466 - INFO - Received 1900 messages so far
2025-02-26 20:03:03,466 - INFO - Received 2000 messages so far
2025-02-26 20:03:03,466 - INFO - Received 2100 messages so far
2025-02-26 20:03:03,466 - INFO - Received 2200 messages so far
2025-02-26 20:03:03,466 - INFO - Received 2300 messages so far
2025-02-26 20:03:03,467 - INFO - Received 2400 messages so far
2025-02-26 20:03:03,467 - INFO - Received 2500 messages so far
2025-02-26 20:03:03,467 - INFO - Received 2600 messages so far
2025-02-26 20:03:03,467 - INFO - Received 2700 messages so far
2025-02-26 20:03:03,467 - INFO - Received 2800 messages so far
2025-02-26 20:03:03,468 - INFO - Received 2900 messages so far
2025-02-26 20:03:03,468 - INFO - Received 3000 messages so far
2025-02-26 20:03:03,468 - INFO - Received 3100 messages so far
2025-02-26 20:03:03,468 - INFO - Received 3200 messages so far
2025-02-26 20:03:03,468 - INFO - Received 3300 messages so far
2025-02-26 20:03:03,468 - INFO - Received 3400 messages so far
2025-02-26 20:03:03,469 - INFO - Received 3500 messages so far
2025-02-26 20:03:03,469 - INFO - Received 3600 messages so far
2025-02-26 20:03:03,469 - INFO - Received 3700 messages so far
2025-02-26 20:03:03,469 - INFO - Received 3800 messages so far
2025-02-26 20:03:03,469 - INFO - Received 3900 messages so far
2025-02-26 20:03:03,470 - INFO - Received 4000 messages so far
2025-02-26 20:03:03,470 - INFO - Received 4100 messages so far
2025-02-26 20:03:03,570 - INFO - Received 4200 messages so far
2025-02-26 20:03:03,571 - INFO - Received 4300 messages so far
2025-02-26 20:03:03,571 - INFO - Received 4400 messages so far
2025-02-26 20:03:03,571 - INFO - Received 4500 messages so far
2025-02-26 20:03:03,571 - INFO - Received 4600 messages so far
2025-02-26 20:03:03,571 - INFO - Received 4700 messages so far
2025-02-26 20:03:03,572 - INFO - Received 4800 messages so far
2025-02-26 20:03:03,572 - INFO - Received 4900 messages so far
2025-02-26 20:03:03,572 - INFO - Received 5000 messages so far
2025-02-26 20:03:03,572 - INFO - Received 5100 messages so far
2025-02-26 20:03:03,572 - INFO - Received 5200 messages so far
2025-02-26 20:03:03,573 - INFO - Received 5300 messages so far
2025-02-26 20:03:03,573 - INFO - Received 5400 messages so far
2025-02-26 20:03:03,573 - INFO - Received 5500 messages so far
2025-02-26 20:03:03,573 - INFO - Received 5600 messages so far
2025-02-26 20:03:03,573 - INFO - Received 5700 messages so far
2025-02-26 20:03:03,574 - INFO - Received 5800 messages so far
2025-02-26 20:03:03,574 - INFO - Received 5900 messages so far
2025-02-26 20:03:03,574 - INFO - Received 6000 messages so far
2025-02-26 20:03:03,574 - INFO - Received 6100 messages so far
2025-02-26 20:03:03,574 - INFO - Received 6200 messages so far
2025-02-26 20:03:03,575 - INFO - Received 6300 messages so far
2025-02-26 20:03:03,575 - INFO - Received 6400 messages so far
2025-02-26 20:03:03,575 - INFO - Received 6500 messages so far
2025-02-26 20:03:03,575 - INFO - Received 6600 messages so far
2025-02-26 20:03:03,575 - INFO - Received 6700 messages so far
2025-02-26 20:03:03,576 - INFO - Received 6800 messages so far
2025-02-26 20:03:03,576 - INFO - Received 6900 messages so far
2025-02-26 20:03:03,576 - INFO - Received 7000 messages so far
2025-02-26 20:03:03,576 - INFO - Received 7100 messages so far
2025-02-26 20:03:03,576 - INFO - Received 7200 messages so far
2025-02-26 20:03:03,577 - INFO - Received 7300 messages so far
2025-02-26 20:03:03,577 - INFO - Received 7400 messages so far
2025-02-26 20:03:03,577 - INFO - Received 7500 messages so far
2025-02-26 20:03:03,577 - INFO - Received 7600 messages so far
2025-02-26 20:03:03,577 - INFO - Received 7700 messages so far
2025-02-26 20:03:03,578 - INFO - Received 7800 messages so far
2025-02-26 20:03:03,578 - INFO - Received 7900 messages so far
2025-02-26 20:03:03,578 - INFO - Received 8000 messages so far
2025-02-26 20:03:03,578 - INFO - Received 8100 messages so far
2025-02-26 20:03:03,578 - INFO - Received 8200 messages so far
2025-02-26 20:03:03,579 - INFO - Received 8300 messages so far
2025-02-26 20:03:03,579 - INFO - Received 8400 messages so far
2025-02-26 20:03:03,579 - INFO - Received 8500 messages so far
2025-02-26 20:03:03,579 - INFO - Received 8600 messages so far
2025-02-26 20:03:03,580 - INFO - Received 8700 messages so far
2025-02-26 20:03:03,634 - INFO - Received 8800 messages so far
2025-02-26 20:03:03,634 - INFO - Received 8900 messages so far
2025-02-26 20:03:03,634 - INFO - Received 9000 messages so far
2025-02-26 20:03:03,634 - INFO - Received 9100 messages so far
2025-02-26 20:03:03,634 - INFO - Received 9200 messages so far
2025-02-26 20:03:03,635 - INFO - Received 9300 messages so far
2025-02-26 20:03:03,635 - INFO - Received 9400 messages so far
2025-02-26 20:03:03,635 - INFO - Received 9500 messages so far
2025-02-26 20:03:03,635 - INFO - Received 9600 messages so far
2025-02-26 20:03:03,635 - INFO - Received 9700 messages so far
2025-02-26 20:03:03,636 - INFO - Received 9800 messages so far
2025-02-26 20:03:03,636 - INFO - Received 9900 messages so far
2025-02-26 20:03:03,636 - INFO - Received 10000 messages so far
2025-02-26 20:03:03,636 - INFO - Total messages consumed: 10000
2025-02-26 20:03:03,723 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:03,727 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:03,727 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:03,727 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:03,727 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:03,734 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:03,738 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:03,738 - INFO - Number of columns: 66
2025-02-26 20:03:03,748 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
93          NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
711         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
145         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6726        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8282        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:03,748 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:03,778 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:03,823 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    8af1ef48d3289058              2336755850007c23  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:03,824 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.  5353.   443. 21116.    80.   547.  1900.   123.
   134.   136.   133.    22.   135.   138.    67. 21115.     0.]
2025-02-26 20:03:03,825 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:03,830 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:03,831 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:03,831 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:03,833 - INFO - DataFrame shape after NA dropping: (864, 23)
2025-02-26 20:03:03,834 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:03,834 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:03,834 - INFO - X shape: (864, 21), y shape: (864,)
2025-02-26 20:03:03,834 - INFO - Label distribution in training data: {'DNS': 721, 'HTTPS': 128, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:03,836 - INFO - Training model...
2025-02-26 20:03:03,949 - INFO - Predicting on test data...
2025-02-26 20:03:03,962 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 149.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 2.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 22.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 173.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 173.0
  }
}
2025-02-26 20:03:03,969 - INFO - Saved processed data locally to processed_data_20250226_200303.csv
2025-02-26 20:03:03,972 - INFO - JSON data size: 423392 bytes
2025-02-26 20:03:03,972 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:03,972 - INFO - Data sent successfully!
2025-02-26 20:03:03,972 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:03,973 - INFO - Starting data processing
2025-02-26 20:03:03,973 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:03,974 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:03,974 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:03,975 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:04,076 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:04,076 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:04,076 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:04,077 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:04,077 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:04,077 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:04,078 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:04,078 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:04,078 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:04,232 - INFO - Received 100 messages so far
2025-02-26 20:03:04,232 - INFO - Received 200 messages so far
2025-02-26 20:03:04,232 - INFO - Received 300 messages so far
2025-02-26 20:03:04,232 - INFO - Received 400 messages so far
2025-02-26 20:03:04,232 - INFO - Received 500 messages so far
2025-02-26 20:03:04,233 - INFO - Received 600 messages so far
2025-02-26 20:03:04,233 - INFO - Received 700 messages so far
2025-02-26 20:03:04,233 - INFO - Received 800 messages so far
2025-02-26 20:03:04,233 - INFO - Received 900 messages so far
2025-02-26 20:03:04,233 - INFO - Received 1000 messages so far
2025-02-26 20:03:04,234 - INFO - Received 1100 messages so far
2025-02-26 20:03:04,234 - INFO - Received 1200 messages so far
2025-02-26 20:03:04,234 - INFO - Received 1300 messages so far
2025-02-26 20:03:04,234 - INFO - Received 1400 messages so far
2025-02-26 20:03:04,234 - INFO - Received 1500 messages so far
2025-02-26 20:03:04,235 - INFO - Received 1600 messages so far
2025-02-26 20:03:04,235 - INFO - Received 1700 messages so far
2025-02-26 20:03:04,235 - INFO - Received 1800 messages so far
2025-02-26 20:03:04,235 - INFO - Received 1900 messages so far
2025-02-26 20:03:04,235 - INFO - Received 2000 messages so far
2025-02-26 20:03:04,236 - INFO - Received 2100 messages so far
2025-02-26 20:03:04,236 - INFO - Received 2200 messages so far
2025-02-26 20:03:04,236 - INFO - Received 2300 messages so far
2025-02-26 20:03:04,236 - INFO - Received 2400 messages so far
2025-02-26 20:03:04,236 - INFO - Received 2500 messages so far
2025-02-26 20:03:04,237 - INFO - Received 2600 messages so far
2025-02-26 20:03:04,237 - INFO - Received 2700 messages so far
2025-02-26 20:03:04,237 - INFO - Received 2800 messages so far
2025-02-26 20:03:04,237 - INFO - Received 2900 messages so far
2025-02-26 20:03:04,237 - INFO - Received 3000 messages so far
2025-02-26 20:03:04,238 - INFO - Received 3100 messages so far
2025-02-26 20:03:04,238 - INFO - Received 3200 messages so far
2025-02-26 20:03:04,238 - INFO - Received 3300 messages so far
2025-02-26 20:03:04,238 - INFO - Received 3400 messages so far
2025-02-26 20:03:04,238 - INFO - Received 3500 messages so far
2025-02-26 20:03:04,238 - INFO - Received 3600 messages so far
2025-02-26 20:03:04,239 - INFO - Received 3700 messages so far
2025-02-26 20:03:04,239 - INFO - Received 3800 messages so far
2025-02-26 20:03:04,239 - INFO - Received 3900 messages so far
2025-02-26 20:03:04,239 - INFO - Received 4000 messages so far
2025-02-26 20:03:04,240 - INFO - Received 4100 messages so far
2025-02-26 20:03:04,294 - INFO - Received 4200 messages so far
2025-02-26 20:03:04,294 - INFO - Received 4300 messages so far
2025-02-26 20:03:04,294 - INFO - Received 4400 messages so far
2025-02-26 20:03:04,294 - INFO - Received 4500 messages so far
2025-02-26 20:03:04,295 - INFO - Received 4600 messages so far
2025-02-26 20:03:04,295 - INFO - Received 4700 messages so far
2025-02-26 20:03:04,295 - INFO - Received 4800 messages so far
2025-02-26 20:03:04,295 - INFO - Received 4900 messages so far
2025-02-26 20:03:04,295 - INFO - Received 5000 messages so far
2025-02-26 20:03:04,296 - INFO - Received 5100 messages so far
2025-02-26 20:03:04,296 - INFO - Received 5200 messages so far
2025-02-26 20:03:04,296 - INFO - Received 5300 messages so far
2025-02-26 20:03:04,296 - INFO - Received 5400 messages so far
2025-02-26 20:03:04,296 - INFO - Received 5500 messages so far
2025-02-26 20:03:04,297 - INFO - Received 5600 messages so far
2025-02-26 20:03:04,297 - INFO - Received 5700 messages so far
2025-02-26 20:03:04,297 - INFO - Received 5800 messages so far
2025-02-26 20:03:04,297 - INFO - Received 5900 messages so far
2025-02-26 20:03:04,297 - INFO - Received 6000 messages so far
2025-02-26 20:03:04,297 - INFO - Received 6100 messages so far
2025-02-26 20:03:04,298 - INFO - Received 6200 messages so far
2025-02-26 20:03:04,298 - INFO - Received 6300 messages so far
2025-02-26 20:03:04,298 - INFO - Received 6400 messages so far
2025-02-26 20:03:04,298 - INFO - Received 6500 messages so far
2025-02-26 20:03:04,298 - INFO - Received 6600 messages so far
2025-02-26 20:03:04,299 - INFO - Received 6700 messages so far
2025-02-26 20:03:04,299 - INFO - Received 6800 messages so far
2025-02-26 20:03:04,299 - INFO - Received 6900 messages so far
2025-02-26 20:03:04,299 - INFO - Received 7000 messages so far
2025-02-26 20:03:04,300 - INFO - Received 7100 messages so far
2025-02-26 20:03:04,300 - INFO - Received 7200 messages so far
2025-02-26 20:03:04,300 - INFO - Received 7300 messages so far
2025-02-26 20:03:04,300 - INFO - Received 7400 messages so far
2025-02-26 20:03:04,301 - INFO - Received 7500 messages so far
2025-02-26 20:03:04,301 - INFO - Received 7600 messages so far
2025-02-26 20:03:04,301 - INFO - Received 7700 messages so far
2025-02-26 20:03:04,301 - INFO - Received 7800 messages so far
2025-02-26 20:03:04,301 - INFO - Received 7900 messages so far
2025-02-26 20:03:04,302 - INFO - Received 8000 messages so far
2025-02-26 20:03:04,302 - INFO - Received 8100 messages so far
2025-02-26 20:03:04,302 - INFO - Received 8200 messages so far
2025-02-26 20:03:04,302 - INFO - Received 8300 messages so far
2025-02-26 20:03:04,303 - INFO - Received 8400 messages so far
2025-02-26 20:03:04,303 - INFO - Received 8500 messages so far
2025-02-26 20:03:04,303 - INFO - Received 8600 messages so far
2025-02-26 20:03:04,303 - INFO - Received 8700 messages so far
2025-02-26 20:03:04,360 - INFO - Received 8800 messages so far
2025-02-26 20:03:04,360 - INFO - Received 8900 messages so far
2025-02-26 20:03:04,360 - INFO - Received 9000 messages so far
2025-02-26 20:03:04,360 - INFO - Received 9100 messages so far
2025-02-26 20:03:04,360 - INFO - Received 9200 messages so far
2025-02-26 20:03:04,361 - INFO - Received 9300 messages so far
2025-02-26 20:03:04,361 - INFO - Received 9400 messages so far
2025-02-26 20:03:04,361 - INFO - Received 9500 messages so far
2025-02-26 20:03:04,361 - INFO - Received 9600 messages so far
2025-02-26 20:03:04,361 - INFO - Received 9700 messages so far
2025-02-26 20:03:04,362 - INFO - Received 9800 messages so far
2025-02-26 20:03:04,362 - INFO - Received 9900 messages so far
2025-02-26 20:03:04,362 - INFO - Received 10000 messages so far
2025-02-26 20:03:04,362 - INFO - Total messages consumed: 10000
2025-02-26 20:03:04,451 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:04,455 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:04,455 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:04,455 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:04,455 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:04,463 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:04,466 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:04,466 - INFO - Number of columns: 66
2025-02-26 20:03:04,476 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
1592        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2004        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
103         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6189        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6995        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:04,476 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:04,507 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:04,591 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    7621c9ee35587231              f621c9ee35587231  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:04,592 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  1900.  9092.    53.   443.   123.  5353.    80.   133.   136.
 21115.   138.   134. 21116.   547.     0.    22.    67.   135.]
2025-02-26 20:03:04,593 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:04,598 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:04,599 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:04,600 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:04,602 - INFO - DataFrame shape after NA dropping: (899, 23)
2025-02-26 20:03:04,602 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:04,602 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:04,602 - INFO - X shape: (899, 21), y shape: (899,)
2025-02-26 20:03:04,603 - INFO - Label distribution in training data: {'DNS': 752, 'HTTPS': 132, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:04,604 - INFO - Training model...
2025-02-26 20:03:04,719 - INFO - Predicting on test data...
2025-02-26 20:03:04,734 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 149.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 31.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 180.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 180.0
  }
}
2025-02-26 20:03:04,741 - INFO - Saved processed data locally to processed_data_20250226_200304.csv
2025-02-26 20:03:04,743 - INFO - JSON data size: 442145 bytes
2025-02-26 20:03:04,743 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:04,743 - INFO - Data sent successfully!
2025-02-26 20:03:04,744 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:04,745 - INFO - Starting data processing
2025-02-26 20:03:04,745 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:04,745 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:04,746 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:04,746 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:04,848 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:04,848 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:04,849 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:04,849 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:04,849 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:04,850 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:04,850 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:04,850 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:04,850 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:04,998 - INFO - Received 100 messages so far
2025-02-26 20:03:04,998 - INFO - Received 200 messages so far
2025-02-26 20:03:04,998 - INFO - Received 300 messages so far
2025-02-26 20:03:04,998 - INFO - Received 400 messages so far
2025-02-26 20:03:04,999 - INFO - Received 500 messages so far
2025-02-26 20:03:04,999 - INFO - Received 600 messages so far
2025-02-26 20:03:04,999 - INFO - Received 700 messages so far
2025-02-26 20:03:04,999 - INFO - Received 800 messages so far
2025-02-26 20:03:04,999 - INFO - Received 900 messages so far
2025-02-26 20:03:05,000 - INFO - Received 1000 messages so far
2025-02-26 20:03:05,000 - INFO - Received 1100 messages so far
2025-02-26 20:03:05,000 - INFO - Received 1200 messages so far
2025-02-26 20:03:05,000 - INFO - Received 1300 messages so far
2025-02-26 20:03:05,000 - INFO - Received 1400 messages so far
2025-02-26 20:03:05,001 - INFO - Received 1500 messages so far
2025-02-26 20:03:05,001 - INFO - Received 1600 messages so far
2025-02-26 20:03:05,001 - INFO - Received 1700 messages so far
2025-02-26 20:03:05,001 - INFO - Received 1800 messages so far
2025-02-26 20:03:05,001 - INFO - Received 1900 messages so far
2025-02-26 20:03:05,002 - INFO - Received 2000 messages so far
2025-02-26 20:03:05,002 - INFO - Received 2100 messages so far
2025-02-26 20:03:05,002 - INFO - Received 2200 messages so far
2025-02-26 20:03:05,002 - INFO - Received 2300 messages so far
2025-02-26 20:03:05,002 - INFO - Received 2400 messages so far
2025-02-26 20:03:05,003 - INFO - Received 2500 messages so far
2025-02-26 20:03:05,003 - INFO - Received 2600 messages so far
2025-02-26 20:03:05,003 - INFO - Received 2700 messages so far
2025-02-26 20:03:05,003 - INFO - Received 2800 messages so far
2025-02-26 20:03:05,003 - INFO - Received 2900 messages so far
2025-02-26 20:03:05,004 - INFO - Received 3000 messages so far
2025-02-26 20:03:05,004 - INFO - Received 3100 messages so far
2025-02-26 20:03:05,004 - INFO - Received 3200 messages so far
2025-02-26 20:03:05,004 - INFO - Received 3300 messages so far
2025-02-26 20:03:05,004 - INFO - Received 3400 messages so far
2025-02-26 20:03:05,005 - INFO - Received 3500 messages so far
2025-02-26 20:03:05,005 - INFO - Received 3600 messages so far
2025-02-26 20:03:05,005 - INFO - Received 3700 messages so far
2025-02-26 20:03:05,005 - INFO - Received 3800 messages so far
2025-02-26 20:03:05,005 - INFO - Received 3900 messages so far
2025-02-26 20:03:05,006 - INFO - Received 4000 messages so far
2025-02-26 20:03:05,006 - INFO - Received 4100 messages so far
2025-02-26 20:03:05,060 - INFO - Received 4200 messages so far
2025-02-26 20:03:05,060 - INFO - Received 4300 messages so far
2025-02-26 20:03:05,060 - INFO - Received 4400 messages so far
2025-02-26 20:03:05,060 - INFO - Received 4500 messages so far
2025-02-26 20:03:05,060 - INFO - Received 4600 messages so far
2025-02-26 20:03:05,061 - INFO - Received 4700 messages so far
2025-02-26 20:03:05,061 - INFO - Received 4800 messages so far
2025-02-26 20:03:05,061 - INFO - Received 4900 messages so far
2025-02-26 20:03:05,061 - INFO - Received 5000 messages so far
2025-02-26 20:03:05,061 - INFO - Received 5100 messages so far
2025-02-26 20:03:05,062 - INFO - Received 5200 messages so far
2025-02-26 20:03:05,062 - INFO - Received 5300 messages so far
2025-02-26 20:03:05,062 - INFO - Received 5400 messages so far
2025-02-26 20:03:05,062 - INFO - Received 5500 messages so far
2025-02-26 20:03:05,062 - INFO - Received 5600 messages so far
2025-02-26 20:03:05,063 - INFO - Received 5700 messages so far
2025-02-26 20:03:05,063 - INFO - Received 5800 messages so far
2025-02-26 20:03:05,063 - INFO - Received 5900 messages so far
2025-02-26 20:03:05,063 - INFO - Received 6000 messages so far
2025-02-26 20:03:05,063 - INFO - Received 6100 messages so far
2025-02-26 20:03:05,064 - INFO - Received 6200 messages so far
2025-02-26 20:03:05,064 - INFO - Received 6300 messages so far
2025-02-26 20:03:05,064 - INFO - Received 6400 messages so far
2025-02-26 20:03:05,064 - INFO - Received 6500 messages so far
2025-02-26 20:03:05,064 - INFO - Received 6600 messages so far
2025-02-26 20:03:05,064 - INFO - Received 6700 messages so far
2025-02-26 20:03:05,065 - INFO - Received 6800 messages so far
2025-02-26 20:03:05,065 - INFO - Received 6900 messages so far
2025-02-26 20:03:05,065 - INFO - Received 7000 messages so far
2025-02-26 20:03:05,065 - INFO - Received 7100 messages so far
2025-02-26 20:03:05,065 - INFO - Received 7200 messages so far
2025-02-26 20:03:05,066 - INFO - Received 7300 messages so far
2025-02-26 20:03:05,066 - INFO - Received 7400 messages so far
2025-02-26 20:03:05,066 - INFO - Received 7500 messages so far
2025-02-26 20:03:05,066 - INFO - Received 7600 messages so far
2025-02-26 20:03:05,066 - INFO - Received 7700 messages so far
2025-02-26 20:03:05,067 - INFO - Received 7800 messages so far
2025-02-26 20:03:05,067 - INFO - Received 7900 messages so far
2025-02-26 20:03:05,067 - INFO - Received 8000 messages so far
2025-02-26 20:03:05,067 - INFO - Received 8100 messages so far
2025-02-26 20:03:05,067 - INFO - Received 8200 messages so far
2025-02-26 20:03:05,068 - INFO - Received 8300 messages so far
2025-02-26 20:03:05,068 - INFO - Received 8400 messages so far
2025-02-26 20:03:05,068 - INFO - Received 8500 messages so far
2025-02-26 20:03:05,068 - INFO - Received 8600 messages so far
2025-02-26 20:03:05,068 - INFO - Received 8700 messages so far
2025-02-26 20:03:05,123 - INFO - Received 8800 messages so far
2025-02-26 20:03:05,123 - INFO - Received 8900 messages so far
2025-02-26 20:03:05,123 - INFO - Received 9000 messages so far
2025-02-26 20:03:05,124 - INFO - Received 9100 messages so far
2025-02-26 20:03:05,124 - INFO - Received 9200 messages so far
2025-02-26 20:03:05,124 - INFO - Received 9300 messages so far
2025-02-26 20:03:05,124 - INFO - Received 9400 messages so far
2025-02-26 20:03:05,124 - INFO - Received 9500 messages so far
2025-02-26 20:03:05,125 - INFO - Received 9600 messages so far
2025-02-26 20:03:05,125 - INFO - Received 9700 messages so far
2025-02-26 20:03:05,125 - INFO - Received 9800 messages so far
2025-02-26 20:03:05,125 - INFO - Received 9900 messages so far
2025-02-26 20:03:05,125 - INFO - Received 10000 messages so far
2025-02-26 20:03:05,125 - INFO - Total messages consumed: 10000
2025-02-26 20:03:05,212 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:05,216 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:05,216 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:05,216 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:05,216 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:05,224 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:05,228 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:05,228 - INFO - Number of columns: 66
2025-02-26 20:03:05,238 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
6865        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8190        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.006608     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6322        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6138        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.007082     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
935         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:05,238 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:05,268 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:05,314 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    3d390eb19a6c1898              fd390eb19a6c1898  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:05,314 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.  5353.   443.    53.    80.   133.     0.   123. 21116.
  1900.   136.   138.   134. 21115.    22.   547.   135.    67.]
2025-02-26 20:03:05,315 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:05,320 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:05,322 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:05,322 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:05,324 - INFO - DataFrame shape after NA dropping: (893, 23)
2025-02-26 20:03:05,324 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:05,324 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:05,325 - INFO - X shape: (893, 21), y shape: (893,)
2025-02-26 20:03:05,325 - INFO - Label distribution in training data: {'DNS': 748, 'HTTPS': 131, 'HTTP': 13, 'SSH': 1}
2025-02-26 20:03:05,326 - INFO - Training model...
2025-02-26 20:03:05,440 - INFO - Predicting on test data...
2025-02-26 20:03:05,454 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 142.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.75,
    "f1-score": 0.8571428571428571,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 0.9705882352941176,
    "recall": 1.0,
    "f1-score": 0.9850746268656716,
    "support": 33.0
  },
  "accuracy": 0.994413407821229,
  "macro avg": {
    "precision": 0.9901960784313726,
    "recall": 0.9166666666666666,
    "f1-score": 0.947405828002843,
    "support": 179.0
  },
  "weighted avg": {
    "precision": 0.9945777193558988,
    "recall": 0.994413407821229,
    "f1-score": 0.994056056509154,
    "support": 179.0
  }
}
2025-02-26 20:03:05,461 - INFO - Saved processed data locally to processed_data_20250226_200305.csv
2025-02-26 20:03:05,464 - INFO - JSON data size: 437887 bytes
2025-02-26 20:03:05,464 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:05,464 - INFO - Data sent successfully!
2025-02-26 20:03:05,464 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:05,465 - INFO - Starting data processing
2025-02-26 20:03:05,466 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:05,466 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:05,467 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:05,467 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:05,569 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:05,569 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:05,569 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:05,569 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:05,569 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:05,570 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:05,570 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:05,570 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:05,570 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:05,724 - INFO - Received 100 messages so far
2025-02-26 20:03:05,724 - INFO - Received 200 messages so far
2025-02-26 20:03:05,725 - INFO - Received 300 messages so far
2025-02-26 20:03:05,725 - INFO - Received 400 messages so far
2025-02-26 20:03:05,725 - INFO - Received 500 messages so far
2025-02-26 20:03:05,725 - INFO - Received 600 messages so far
2025-02-26 20:03:05,725 - INFO - Received 700 messages so far
2025-02-26 20:03:05,726 - INFO - Received 800 messages so far
2025-02-26 20:03:05,726 - INFO - Received 900 messages so far
2025-02-26 20:03:05,726 - INFO - Received 1000 messages so far
2025-02-26 20:03:05,726 - INFO - Received 1100 messages so far
2025-02-26 20:03:05,726 - INFO - Received 1200 messages so far
2025-02-26 20:03:05,727 - INFO - Received 1300 messages so far
2025-02-26 20:03:05,727 - INFO - Received 1400 messages so far
2025-02-26 20:03:05,727 - INFO - Received 1500 messages so far
2025-02-26 20:03:05,727 - INFO - Received 1600 messages so far
2025-02-26 20:03:05,727 - INFO - Received 1700 messages so far
2025-02-26 20:03:05,728 - INFO - Received 1800 messages so far
2025-02-26 20:03:05,728 - INFO - Received 1900 messages so far
2025-02-26 20:03:05,728 - INFO - Received 2000 messages so far
2025-02-26 20:03:05,728 - INFO - Received 2100 messages so far
2025-02-26 20:03:05,728 - INFO - Received 2200 messages so far
2025-02-26 20:03:05,729 - INFO - Received 2300 messages so far
2025-02-26 20:03:05,729 - INFO - Received 2400 messages so far
2025-02-26 20:03:05,729 - INFO - Received 2500 messages so far
2025-02-26 20:03:05,729 - INFO - Received 2600 messages so far
2025-02-26 20:03:05,729 - INFO - Received 2700 messages so far
2025-02-26 20:03:05,730 - INFO - Received 2800 messages so far
2025-02-26 20:03:05,730 - INFO - Received 2900 messages so far
2025-02-26 20:03:05,730 - INFO - Received 3000 messages so far
2025-02-26 20:03:05,730 - INFO - Received 3100 messages so far
2025-02-26 20:03:05,730 - INFO - Received 3200 messages so far
2025-02-26 20:03:05,731 - INFO - Received 3300 messages so far
2025-02-26 20:03:05,731 - INFO - Received 3400 messages so far
2025-02-26 20:03:05,731 - INFO - Received 3500 messages so far
2025-02-26 20:03:05,731 - INFO - Received 3600 messages so far
2025-02-26 20:03:05,731 - INFO - Received 3700 messages so far
2025-02-26 20:03:05,732 - INFO - Received 3800 messages so far
2025-02-26 20:03:05,732 - INFO - Received 3900 messages so far
2025-02-26 20:03:05,732 - INFO - Received 4000 messages so far
2025-02-26 20:03:05,732 - INFO - Received 4100 messages so far
2025-02-26 20:03:05,822 - INFO - Received 4200 messages so far
2025-02-26 20:03:05,822 - INFO - Received 4300 messages so far
2025-02-26 20:03:05,823 - INFO - Received 4400 messages so far
2025-02-26 20:03:05,823 - INFO - Received 4500 messages so far
2025-02-26 20:03:05,823 - INFO - Received 4600 messages so far
2025-02-26 20:03:05,824 - INFO - Received 4700 messages so far
2025-02-26 20:03:05,824 - INFO - Received 4800 messages so far
2025-02-26 20:03:05,824 - INFO - Received 4900 messages so far
2025-02-26 20:03:05,825 - INFO - Received 5000 messages so far
2025-02-26 20:03:05,825 - INFO - Received 5100 messages so far
2025-02-26 20:03:05,825 - INFO - Received 5200 messages so far
2025-02-26 20:03:05,826 - INFO - Received 5300 messages so far
2025-02-26 20:03:05,826 - INFO - Received 5400 messages so far
2025-02-26 20:03:05,826 - INFO - Received 5500 messages so far
2025-02-26 20:03:05,826 - INFO - Received 5600 messages so far
2025-02-26 20:03:05,827 - INFO - Received 5700 messages so far
2025-02-26 20:03:05,827 - INFO - Received 5800 messages so far
2025-02-26 20:03:05,827 - INFO - Received 5900 messages so far
2025-02-26 20:03:05,827 - INFO - Received 6000 messages so far
2025-02-26 20:03:05,827 - INFO - Received 6100 messages so far
2025-02-26 20:03:05,828 - INFO - Received 6200 messages so far
2025-02-26 20:03:05,828 - INFO - Received 6300 messages so far
2025-02-26 20:03:05,828 - INFO - Received 6400 messages so far
2025-02-26 20:03:05,828 - INFO - Received 6500 messages so far
2025-02-26 20:03:05,828 - INFO - Received 6600 messages so far
2025-02-26 20:03:05,829 - INFO - Received 6700 messages so far
2025-02-26 20:03:05,829 - INFO - Received 6800 messages so far
2025-02-26 20:03:05,829 - INFO - Received 6900 messages so far
2025-02-26 20:03:05,829 - INFO - Received 7000 messages so far
2025-02-26 20:03:05,829 - INFO - Received 7100 messages so far
2025-02-26 20:03:05,830 - INFO - Received 7200 messages so far
2025-02-26 20:03:05,830 - INFO - Received 7300 messages so far
2025-02-26 20:03:05,830 - INFO - Received 7400 messages so far
2025-02-26 20:03:05,830 - INFO - Received 7500 messages so far
2025-02-26 20:03:05,830 - INFO - Received 7600 messages so far
2025-02-26 20:03:05,831 - INFO - Received 7700 messages so far
2025-02-26 20:03:05,831 - INFO - Received 7800 messages so far
2025-02-26 20:03:05,831 - INFO - Received 7900 messages so far
2025-02-26 20:03:05,831 - INFO - Received 8000 messages so far
2025-02-26 20:03:05,831 - INFO - Received 8100 messages so far
2025-02-26 20:03:05,832 - INFO - Received 8200 messages so far
2025-02-26 20:03:05,832 - INFO - Received 8300 messages so far
2025-02-26 20:03:05,832 - INFO - Received 8400 messages so far
2025-02-26 20:03:05,832 - INFO - Received 8500 messages so far
2025-02-26 20:03:05,832 - INFO - Received 8600 messages so far
2025-02-26 20:03:05,833 - INFO - Received 8700 messages so far
2025-02-26 20:03:05,889 - INFO - Received 8800 messages so far
2025-02-26 20:03:05,889 - INFO - Received 8900 messages so far
2025-02-26 20:03:05,889 - INFO - Received 9000 messages so far
2025-02-26 20:03:05,890 - INFO - Received 9100 messages so far
2025-02-26 20:03:05,890 - INFO - Received 9200 messages so far
2025-02-26 20:03:05,890 - INFO - Received 9300 messages so far
2025-02-26 20:03:05,890 - INFO - Received 9400 messages so far
2025-02-26 20:03:05,890 - INFO - Received 9500 messages so far
2025-02-26 20:03:05,891 - INFO - Received 9600 messages so far
2025-02-26 20:03:05,891 - INFO - Received 9700 messages so far
2025-02-26 20:03:05,891 - INFO - Received 9800 messages so far
2025-02-26 20:03:05,891 - INFO - Received 9900 messages so far
2025-02-26 20:03:05,891 - INFO - Received 10000 messages so far
2025-02-26 20:03:05,891 - INFO - Total messages consumed: 10000
2025-02-26 20:03:05,979 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:05,983 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:05,983 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:05,983 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:05,983 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:05,991 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:05,994 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:05,994 - INFO - Number of columns: 66
2025-02-26 20:03:06,004 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9789        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6287        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3085        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1159        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5806        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:06,004 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:06,034 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:06,079 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version           client_initial_dcid client_scid                   server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                            19          19                            17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                            19           1                            17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13  53d430adb444f9c5ce75c07fa520              f3a21106ed00c9ab0a948d7162de  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                             1          19                             1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:06,079 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   443.   133.    80.  5353.   138.  1900.   123.
   134.     0.   136. 21116. 21115.   547.   135.    67.    22.]
2025-02-26 20:03:06,080 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:06,085 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:06,086 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:06,087 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:06,089 - INFO - DataFrame shape after NA dropping: (901, 23)
2025-02-26 20:03:06,089 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:06,089 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:06,089 - INFO - X shape: (901, 21), y shape: (901,)
2025-02-26 20:03:06,090 - INFO - Label distribution in training data: {'DNS': 753, 'HTTPS': 133, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:06,091 - INFO - Training model...
2025-02-26 20:03:06,204 - INFO - Predicting on test data...
2025-02-26 20:03:06,217 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 155.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 25.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 181.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 181.0
  }
}
2025-02-26 20:03:06,224 - INFO - Saved processed data locally to processed_data_20250226_200306.csv
2025-02-26 20:03:06,227 - INFO - JSON data size: 443853 bytes
2025-02-26 20:03:06,227 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:06,227 - INFO - Data sent successfully!
2025-02-26 20:03:06,227 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:06,228 - INFO - Starting data processing
2025-02-26 20:03:06,228 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:06,229 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:06,229 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:06,230 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:06,331 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:06,331 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:06,332 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:06,332 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:06,332 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:06,332 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:06,333 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:06,333 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:06,333 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:06,486 - INFO - Received 100 messages so far
2025-02-26 20:03:06,486 - INFO - Received 200 messages so far
2025-02-26 20:03:06,487 - INFO - Received 300 messages so far
2025-02-26 20:03:06,487 - INFO - Received 400 messages so far
2025-02-26 20:03:06,487 - INFO - Received 500 messages so far
2025-02-26 20:03:06,487 - INFO - Received 600 messages so far
2025-02-26 20:03:06,487 - INFO - Received 700 messages so far
2025-02-26 20:03:06,488 - INFO - Received 800 messages so far
2025-02-26 20:03:06,488 - INFO - Received 900 messages so far
2025-02-26 20:03:06,488 - INFO - Received 1000 messages so far
2025-02-26 20:03:06,488 - INFO - Received 1100 messages so far
2025-02-26 20:03:06,488 - INFO - Received 1200 messages so far
2025-02-26 20:03:06,489 - INFO - Received 1300 messages so far
2025-02-26 20:03:06,489 - INFO - Received 1400 messages so far
2025-02-26 20:03:06,489 - INFO - Received 1500 messages so far
2025-02-26 20:03:06,489 - INFO - Received 1600 messages so far
2025-02-26 20:03:06,489 - INFO - Received 1700 messages so far
2025-02-26 20:03:06,490 - INFO - Received 1800 messages so far
2025-02-26 20:03:06,490 - INFO - Received 1900 messages so far
2025-02-26 20:03:06,490 - INFO - Received 2000 messages so far
2025-02-26 20:03:06,490 - INFO - Received 2100 messages so far
2025-02-26 20:03:06,490 - INFO - Received 2200 messages so far
2025-02-26 20:03:06,491 - INFO - Received 2300 messages so far
2025-02-26 20:03:06,491 - INFO - Received 2400 messages so far
2025-02-26 20:03:06,491 - INFO - Received 2500 messages so far
2025-02-26 20:03:06,491 - INFO - Received 2600 messages so far
2025-02-26 20:03:06,491 - INFO - Received 2700 messages so far
2025-02-26 20:03:06,492 - INFO - Received 2800 messages so far
2025-02-26 20:03:06,492 - INFO - Received 2900 messages so far
2025-02-26 20:03:06,492 - INFO - Received 3000 messages so far
2025-02-26 20:03:06,492 - INFO - Received 3100 messages so far
2025-02-26 20:03:06,492 - INFO - Received 3200 messages so far
2025-02-26 20:03:06,493 - INFO - Received 3300 messages so far
2025-02-26 20:03:06,493 - INFO - Received 3400 messages so far
2025-02-26 20:03:06,493 - INFO - Received 3500 messages so far
2025-02-26 20:03:06,493 - INFO - Received 3600 messages so far
2025-02-26 20:03:06,493 - INFO - Received 3700 messages so far
2025-02-26 20:03:06,494 - INFO - Received 3800 messages so far
2025-02-26 20:03:06,494 - INFO - Received 3900 messages so far
2025-02-26 20:03:06,494 - INFO - Received 4000 messages so far
2025-02-26 20:03:06,494 - INFO - Received 4100 messages so far
2025-02-26 20:03:06,548 - INFO - Received 4200 messages so far
2025-02-26 20:03:06,548 - INFO - Received 4300 messages so far
2025-02-26 20:03:06,548 - INFO - Received 4400 messages so far
2025-02-26 20:03:06,549 - INFO - Received 4500 messages so far
2025-02-26 20:03:06,549 - INFO - Received 4600 messages so far
2025-02-26 20:03:06,549 - INFO - Received 4700 messages so far
2025-02-26 20:03:06,549 - INFO - Received 4800 messages so far
2025-02-26 20:03:06,549 - INFO - Received 4900 messages so far
2025-02-26 20:03:06,550 - INFO - Received 5000 messages so far
2025-02-26 20:03:06,550 - INFO - Received 5100 messages so far
2025-02-26 20:03:06,550 - INFO - Received 5200 messages so far
2025-02-26 20:03:06,550 - INFO - Received 5300 messages so far
2025-02-26 20:03:06,550 - INFO - Received 5400 messages so far
2025-02-26 20:03:06,551 - INFO - Received 5500 messages so far
2025-02-26 20:03:06,551 - INFO - Received 5600 messages so far
2025-02-26 20:03:06,551 - INFO - Received 5700 messages so far
2025-02-26 20:03:06,551 - INFO - Received 5800 messages so far
2025-02-26 20:03:06,551 - INFO - Received 5900 messages so far
2025-02-26 20:03:06,552 - INFO - Received 6000 messages so far
2025-02-26 20:03:06,552 - INFO - Received 6100 messages so far
2025-02-26 20:03:06,552 - INFO - Received 6200 messages so far
2025-02-26 20:03:06,552 - INFO - Received 6300 messages so far
2025-02-26 20:03:06,552 - INFO - Received 6400 messages so far
2025-02-26 20:03:06,553 - INFO - Received 6500 messages so far
2025-02-26 20:03:06,553 - INFO - Received 6600 messages so far
2025-02-26 20:03:06,553 - INFO - Received 6700 messages so far
2025-02-26 20:03:06,553 - INFO - Received 6800 messages so far
2025-02-26 20:03:06,553 - INFO - Received 6900 messages so far
2025-02-26 20:03:06,554 - INFO - Received 7000 messages so far
2025-02-26 20:03:06,554 - INFO - Received 7100 messages so far
2025-02-26 20:03:06,554 - INFO - Received 7200 messages so far
2025-02-26 20:03:06,554 - INFO - Received 7300 messages so far
2025-02-26 20:03:06,554 - INFO - Received 7400 messages so far
2025-02-26 20:03:06,554 - INFO - Received 7500 messages so far
2025-02-26 20:03:06,555 - INFO - Received 7600 messages so far
2025-02-26 20:03:06,555 - INFO - Received 7700 messages so far
2025-02-26 20:03:06,555 - INFO - Received 7800 messages so far
2025-02-26 20:03:06,555 - INFO - Received 7900 messages so far
2025-02-26 20:03:06,555 - INFO - Received 8000 messages so far
2025-02-26 20:03:06,556 - INFO - Received 8100 messages so far
2025-02-26 20:03:06,556 - INFO - Received 8200 messages so far
2025-02-26 20:03:06,556 - INFO - Received 8300 messages so far
2025-02-26 20:03:06,556 - INFO - Received 8400 messages so far
2025-02-26 20:03:06,556 - INFO - Received 8500 messages so far
2025-02-26 20:03:06,557 - INFO - Received 8600 messages so far
2025-02-26 20:03:06,557 - INFO - Received 8700 messages so far
2025-02-26 20:03:06,655 - INFO - Received 8800 messages so far
2025-02-26 20:03:06,655 - INFO - Received 8900 messages so far
2025-02-26 20:03:06,655 - INFO - Received 9000 messages so far
2025-02-26 20:03:06,655 - INFO - Received 9100 messages so far
2025-02-26 20:03:06,656 - INFO - Received 9200 messages so far
2025-02-26 20:03:06,656 - INFO - Received 9300 messages so far
2025-02-26 20:03:06,656 - INFO - Received 9400 messages so far
2025-02-26 20:03:06,656 - INFO - Received 9500 messages so far
2025-02-26 20:03:06,656 - INFO - Received 9600 messages so far
2025-02-26 20:03:06,657 - INFO - Received 9700 messages so far
2025-02-26 20:03:06,657 - INFO - Received 9800 messages so far
2025-02-26 20:03:06,657 - INFO - Received 9900 messages so far
2025-02-26 20:03:06,657 - INFO - Received 10000 messages so far
2025-02-26 20:03:06,657 - INFO - Total messages consumed: 10000
2025-02-26 20:03:06,745 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:06,749 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:06,749 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:06,749 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:06,750 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:06,757 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:06,760 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:06,760 - INFO - Number of columns: 66
2025-02-26 20:03:06,771 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
5051        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8543     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  CIsnJH3wOajaTxASC8    36286.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000177     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5540        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8549     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740120e+09      NaN  NaN     NaN  CoTWKo36sCKKBufdsa    39204.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000170     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7823        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:06,772 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:06,802 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:06,846 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    376acab97e4aab30              fb03fbdb1202008c  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:06,847 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.    53.   443.   136.  5353.   123.   138.   133.  1900.
 21115.    80.   134.    22.     0. 21116.   135.   547.    67.]
2025-02-26 20:03:06,848 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:06,853 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:06,854 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:06,854 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:06,856 - INFO - DataFrame shape after NA dropping: (884, 23)
2025-02-26 20:03:06,857 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:06,857 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:06,857 - INFO - X shape: (884, 21), y shape: (884,)
2025-02-26 20:03:06,857 - INFO - Label distribution in training data: {'DNS': 743, 'HTTPS': 126, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:06,858 - INFO - Training model...
2025-02-26 20:03:06,970 - INFO - Predicting on test data...
2025-02-26 20:03:06,983 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 151.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.6666666666666666,
    "f1-score": 0.8,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.9583333333333334,
    "recall": 1.0,
    "f1-score": 0.9787234042553191,
    "support": 23.0
  },
  "accuracy": 0.9943502824858758,
  "macro avg": {
    "precision": 0.9861111111111112,
    "recall": 0.8888888888888888,
    "f1-score": 0.926241134751773,
    "support": 177.0
  },
  "weighted avg": {
    "precision": 0.9945856873822975,
    "recall": 0.9943502824858758,
    "f1-score": 0.9938454141122731,
    "support": 177.0
  }
}
2025-02-26 20:03:06,990 - INFO - Saved processed data locally to processed_data_20250226_200306.csv
2025-02-26 20:03:06,992 - INFO - JSON data size: 437244 bytes
2025-02-26 20:03:06,992 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:06,992 - INFO - Data sent successfully!
2025-02-26 20:03:06,992 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:06,993 - INFO - Starting data processing
2025-02-26 20:03:06,993 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:06,994 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:06,995 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:06,995 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:07,096 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:07,097 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:07,097 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:07,097 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:07,098 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:07,098 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:07,099 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:07,099 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:07,099 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:07,253 - INFO - Received 100 messages so far
2025-02-26 20:03:07,253 - INFO - Received 200 messages so far
2025-02-26 20:03:07,253 - INFO - Received 300 messages so far
2025-02-26 20:03:07,253 - INFO - Received 400 messages so far
2025-02-26 20:03:07,253 - INFO - Received 500 messages so far
2025-02-26 20:03:07,254 - INFO - Received 600 messages so far
2025-02-26 20:03:07,254 - INFO - Received 700 messages so far
2025-02-26 20:03:07,254 - INFO - Received 800 messages so far
2025-02-26 20:03:07,254 - INFO - Received 900 messages so far
2025-02-26 20:03:07,254 - INFO - Received 1000 messages so far
2025-02-26 20:03:07,255 - INFO - Received 1100 messages so far
2025-02-26 20:03:07,255 - INFO - Received 1200 messages so far
2025-02-26 20:03:07,255 - INFO - Received 1300 messages so far
2025-02-26 20:03:07,255 - INFO - Received 1400 messages so far
2025-02-26 20:03:07,255 - INFO - Received 1500 messages so far
2025-02-26 20:03:07,256 - INFO - Received 1600 messages so far
2025-02-26 20:03:07,256 - INFO - Received 1700 messages so far
2025-02-26 20:03:07,256 - INFO - Received 1800 messages so far
2025-02-26 20:03:07,256 - INFO - Received 1900 messages so far
2025-02-26 20:03:07,256 - INFO - Received 2000 messages so far
2025-02-26 20:03:07,257 - INFO - Received 2100 messages so far
2025-02-26 20:03:07,257 - INFO - Received 2200 messages so far
2025-02-26 20:03:07,257 - INFO - Received 2300 messages so far
2025-02-26 20:03:07,257 - INFO - Received 2400 messages so far
2025-02-26 20:03:07,257 - INFO - Received 2500 messages so far
2025-02-26 20:03:07,258 - INFO - Received 2600 messages so far
2025-02-26 20:03:07,258 - INFO - Received 2700 messages so far
2025-02-26 20:03:07,258 - INFO - Received 2800 messages so far
2025-02-26 20:03:07,258 - INFO - Received 2900 messages so far
2025-02-26 20:03:07,258 - INFO - Received 3000 messages so far
2025-02-26 20:03:07,259 - INFO - Received 3100 messages so far
2025-02-26 20:03:07,259 - INFO - Received 3200 messages so far
2025-02-26 20:03:07,259 - INFO - Received 3300 messages so far
2025-02-26 20:03:07,259 - INFO - Received 3400 messages so far
2025-02-26 20:03:07,259 - INFO - Received 3500 messages so far
2025-02-26 20:03:07,260 - INFO - Received 3600 messages so far
2025-02-26 20:03:07,260 - INFO - Received 3700 messages so far
2025-02-26 20:03:07,260 - INFO - Received 3800 messages so far
2025-02-26 20:03:07,260 - INFO - Received 3900 messages so far
2025-02-26 20:03:07,260 - INFO - Received 4000 messages so far
2025-02-26 20:03:07,261 - INFO - Received 4100 messages so far
2025-02-26 20:03:07,314 - INFO - Received 4200 messages so far
2025-02-26 20:03:07,314 - INFO - Received 4300 messages so far
2025-02-26 20:03:07,314 - INFO - Received 4400 messages so far
2025-02-26 20:03:07,315 - INFO - Received 4500 messages so far
2025-02-26 20:03:07,315 - INFO - Received 4600 messages so far
2025-02-26 20:03:07,315 - INFO - Received 4700 messages so far
2025-02-26 20:03:07,315 - INFO - Received 4800 messages so far
2025-02-26 20:03:07,315 - INFO - Received 4900 messages so far
2025-02-26 20:03:07,316 - INFO - Received 5000 messages so far
2025-02-26 20:03:07,316 - INFO - Received 5100 messages so far
2025-02-26 20:03:07,316 - INFO - Received 5200 messages so far
2025-02-26 20:03:07,316 - INFO - Received 5300 messages so far
2025-02-26 20:03:07,316 - INFO - Received 5400 messages so far
2025-02-26 20:03:07,317 - INFO - Received 5500 messages so far
2025-02-26 20:03:07,317 - INFO - Received 5600 messages so far
2025-02-26 20:03:07,317 - INFO - Received 5700 messages so far
2025-02-26 20:03:07,317 - INFO - Received 5800 messages so far
2025-02-26 20:03:07,317 - INFO - Received 5900 messages so far
2025-02-26 20:03:07,318 - INFO - Received 6000 messages so far
2025-02-26 20:03:07,318 - INFO - Received 6100 messages so far
2025-02-26 20:03:07,318 - INFO - Received 6200 messages so far
2025-02-26 20:03:07,318 - INFO - Received 6300 messages so far
2025-02-26 20:03:07,318 - INFO - Received 6400 messages so far
2025-02-26 20:03:07,319 - INFO - Received 6500 messages so far
2025-02-26 20:03:07,319 - INFO - Received 6600 messages so far
2025-02-26 20:03:07,319 - INFO - Received 6700 messages so far
2025-02-26 20:03:07,319 - INFO - Received 6800 messages so far
2025-02-26 20:03:07,319 - INFO - Received 6900 messages so far
2025-02-26 20:03:07,320 - INFO - Received 7000 messages so far
2025-02-26 20:03:07,320 - INFO - Received 7100 messages so far
2025-02-26 20:03:07,320 - INFO - Received 7200 messages so far
2025-02-26 20:03:07,320 - INFO - Received 7300 messages so far
2025-02-26 20:03:07,320 - INFO - Received 7400 messages so far
2025-02-26 20:03:07,321 - INFO - Received 7500 messages so far
2025-02-26 20:03:07,321 - INFO - Received 7600 messages so far
2025-02-26 20:03:07,321 - INFO - Received 7700 messages so far
2025-02-26 20:03:07,321 - INFO - Received 7800 messages so far
2025-02-26 20:03:07,321 - INFO - Received 7900 messages so far
2025-02-26 20:03:07,322 - INFO - Received 8000 messages so far
2025-02-26 20:03:07,322 - INFO - Received 8100 messages so far
2025-02-26 20:03:07,322 - INFO - Received 8200 messages so far
2025-02-26 20:03:07,322 - INFO - Received 8300 messages so far
2025-02-26 20:03:07,322 - INFO - Received 8400 messages so far
2025-02-26 20:03:07,323 - INFO - Received 8500 messages so far
2025-02-26 20:03:07,323 - INFO - Received 8600 messages so far
2025-02-26 20:03:07,323 - INFO - Received 8700 messages so far
2025-02-26 20:03:07,380 - INFO - Received 8800 messages so far
2025-02-26 20:03:07,380 - INFO - Received 8900 messages so far
2025-02-26 20:03:07,380 - INFO - Received 9000 messages so far
2025-02-26 20:03:07,381 - INFO - Received 9100 messages so far
2025-02-26 20:03:07,381 - INFO - Received 9200 messages so far
2025-02-26 20:03:07,381 - INFO - Received 9300 messages so far
2025-02-26 20:03:07,381 - INFO - Received 9400 messages so far
2025-02-26 20:03:07,381 - INFO - Received 9500 messages so far
2025-02-26 20:03:07,382 - INFO - Received 9600 messages so far
2025-02-26 20:03:07,382 - INFO - Received 9700 messages so far
2025-02-26 20:03:07,382 - INFO - Received 9800 messages so far
2025-02-26 20:03:07,382 - INFO - Received 9900 messages so far
2025-02-26 20:03:07,382 - INFO - Received 10000 messages so far
2025-02-26 20:03:07,382 - INFO - Total messages consumed: 10000
2025-02-26 20:03:07,470 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:07,474 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:07,474 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:07,474 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:07,474 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:07,481 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:07,485 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:07,485 - INFO - Number of columns: 66
2025-02-26 20:03:07,495 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9167        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4889        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4276        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4261        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8012        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:07,495 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:07,525 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:07,569 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    ca26477d8c98f7b3              ea26477d8c98f7b3  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:07,569 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.   133.    22.   443.   123.  5353.   136.    80.
  1900.   138.   134.    67.     0. 21116.   547. 21115.   135.]
2025-02-26 20:03:07,570 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:07,576 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:07,577 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:07,577 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:07,579 - INFO - DataFrame shape after NA dropping: (859, 23)
2025-02-26 20:03:07,579 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:07,579 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:07,580 - INFO - X shape: (859, 21), y shape: (859,)
2025-02-26 20:03:07,580 - INFO - Label distribution in training data: {'DNS': 718, 'HTTPS': 129, 'HTTP': 12}
2025-02-26 20:03:07,581 - INFO - Training model...
2025-02-26 20:03:07,687 - INFO - Predicting on test data...
2025-02-26 20:03:07,699 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 144.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 1.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 27.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 172.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 172.0
  }
}
2025-02-26 20:03:07,706 - INFO - Saved processed data locally to processed_data_20250226_200307.csv
2025-02-26 20:03:07,708 - INFO - JSON data size: 421436 bytes
2025-02-26 20:03:07,708 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:07,709 - INFO - Data sent successfully!
2025-02-26 20:03:07,709 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:07,710 - INFO - Starting data processing
2025-02-26 20:03:07,710 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:07,710 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:07,711 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:07,711 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:07,812 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:07,812 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:07,813 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:07,813 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:07,813 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:07,813 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:07,814 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:07,815 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:07,815 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:08,009 - INFO - Received 100 messages so far
2025-02-26 20:03:08,009 - INFO - Received 200 messages so far
2025-02-26 20:03:08,009 - INFO - Received 300 messages so far
2025-02-26 20:03:08,009 - INFO - Received 400 messages so far
2025-02-26 20:03:08,009 - INFO - Received 500 messages so far
2025-02-26 20:03:08,010 - INFO - Received 600 messages so far
2025-02-26 20:03:08,010 - INFO - Received 700 messages so far
2025-02-26 20:03:08,010 - INFO - Received 800 messages so far
2025-02-26 20:03:08,010 - INFO - Received 900 messages so far
2025-02-26 20:03:08,010 - INFO - Received 1000 messages so far
2025-02-26 20:03:08,011 - INFO - Received 1100 messages so far
2025-02-26 20:03:08,011 - INFO - Received 1200 messages so far
2025-02-26 20:03:08,011 - INFO - Received 1300 messages so far
2025-02-26 20:03:08,011 - INFO - Received 1400 messages so far
2025-02-26 20:03:08,011 - INFO - Received 1500 messages so far
2025-02-26 20:03:08,012 - INFO - Received 1600 messages so far
2025-02-26 20:03:08,012 - INFO - Received 1700 messages so far
2025-02-26 20:03:08,012 - INFO - Received 1800 messages so far
2025-02-26 20:03:08,012 - INFO - Received 1900 messages so far
2025-02-26 20:03:08,012 - INFO - Received 2000 messages so far
2025-02-26 20:03:08,013 - INFO - Received 2100 messages so far
2025-02-26 20:03:08,013 - INFO - Received 2200 messages so far
2025-02-26 20:03:08,013 - INFO - Received 2300 messages so far
2025-02-26 20:03:08,013 - INFO - Received 2400 messages so far
2025-02-26 20:03:08,013 - INFO - Received 2500 messages so far
2025-02-26 20:03:08,014 - INFO - Received 2600 messages so far
2025-02-26 20:03:08,014 - INFO - Received 2700 messages so far
2025-02-26 20:03:08,014 - INFO - Received 2800 messages so far
2025-02-26 20:03:08,014 - INFO - Received 2900 messages so far
2025-02-26 20:03:08,014 - INFO - Received 3000 messages so far
2025-02-26 20:03:08,015 - INFO - Received 3100 messages so far
2025-02-26 20:03:08,015 - INFO - Received 3200 messages so far
2025-02-26 20:03:08,015 - INFO - Received 3300 messages so far
2025-02-26 20:03:08,015 - INFO - Received 3400 messages so far
2025-02-26 20:03:08,015 - INFO - Received 3500 messages so far
2025-02-26 20:03:08,016 - INFO - Received 3600 messages so far
2025-02-26 20:03:08,016 - INFO - Received 3700 messages so far
2025-02-26 20:03:08,016 - INFO - Received 3800 messages so far
2025-02-26 20:03:08,016 - INFO - Received 3900 messages so far
2025-02-26 20:03:08,016 - INFO - Received 4000 messages so far
2025-02-26 20:03:08,017 - INFO - Received 4100 messages so far
2025-02-26 20:03:08,070 - INFO - Received 4200 messages so far
2025-02-26 20:03:08,070 - INFO - Received 4300 messages so far
2025-02-26 20:03:08,071 - INFO - Received 4400 messages so far
2025-02-26 20:03:08,071 - INFO - Received 4500 messages so far
2025-02-26 20:03:08,071 - INFO - Received 4600 messages so far
2025-02-26 20:03:08,071 - INFO - Received 4700 messages so far
2025-02-26 20:03:08,071 - INFO - Received 4800 messages so far
2025-02-26 20:03:08,071 - INFO - Received 4900 messages so far
2025-02-26 20:03:08,072 - INFO - Received 5000 messages so far
2025-02-26 20:03:08,072 - INFO - Received 5100 messages so far
2025-02-26 20:03:08,072 - INFO - Received 5200 messages so far
2025-02-26 20:03:08,072 - INFO - Received 5300 messages so far
2025-02-26 20:03:08,072 - INFO - Received 5400 messages so far
2025-02-26 20:03:08,073 - INFO - Received 5500 messages so far
2025-02-26 20:03:08,073 - INFO - Received 5600 messages so far
2025-02-26 20:03:08,073 - INFO - Received 5700 messages so far
2025-02-26 20:03:08,073 - INFO - Received 5800 messages so far
2025-02-26 20:03:08,073 - INFO - Received 5900 messages so far
2025-02-26 20:03:08,074 - INFO - Received 6000 messages so far
2025-02-26 20:03:08,074 - INFO - Received 6100 messages so far
2025-02-26 20:03:08,074 - INFO - Received 6200 messages so far
2025-02-26 20:03:08,074 - INFO - Received 6300 messages so far
2025-02-26 20:03:08,074 - INFO - Received 6400 messages so far
2025-02-26 20:03:08,075 - INFO - Received 6500 messages so far
2025-02-26 20:03:08,075 - INFO - Received 6600 messages so far
2025-02-26 20:03:08,075 - INFO - Received 6700 messages so far
2025-02-26 20:03:08,075 - INFO - Received 6800 messages so far
2025-02-26 20:03:08,075 - INFO - Received 6900 messages so far
2025-02-26 20:03:08,076 - INFO - Received 7000 messages so far
2025-02-26 20:03:08,076 - INFO - Received 7100 messages so far
2025-02-26 20:03:08,076 - INFO - Received 7200 messages so far
2025-02-26 20:03:08,076 - INFO - Received 7300 messages so far
2025-02-26 20:03:08,076 - INFO - Received 7400 messages so far
2025-02-26 20:03:08,077 - INFO - Received 7500 messages so far
2025-02-26 20:03:08,077 - INFO - Received 7600 messages so far
2025-02-26 20:03:08,077 - INFO - Received 7700 messages so far
2025-02-26 20:03:08,077 - INFO - Received 7800 messages so far
2025-02-26 20:03:08,077 - INFO - Received 7900 messages so far
2025-02-26 20:03:08,077 - INFO - Received 8000 messages so far
2025-02-26 20:03:08,078 - INFO - Received 8100 messages so far
2025-02-26 20:03:08,078 - INFO - Received 8200 messages so far
2025-02-26 20:03:08,078 - INFO - Received 8300 messages so far
2025-02-26 20:03:08,078 - INFO - Received 8400 messages so far
2025-02-26 20:03:08,078 - INFO - Received 8500 messages so far
2025-02-26 20:03:08,079 - INFO - Received 8600 messages so far
2025-02-26 20:03:08,079 - INFO - Received 8700 messages so far
2025-02-26 20:03:08,134 - INFO - Received 8800 messages so far
2025-02-26 20:03:08,135 - INFO - Received 8900 messages so far
2025-02-26 20:03:08,135 - INFO - Received 9000 messages so far
2025-02-26 20:03:08,135 - INFO - Received 9100 messages so far
2025-02-26 20:03:08,135 - INFO - Received 9200 messages so far
2025-02-26 20:03:08,135 - INFO - Received 9300 messages so far
2025-02-26 20:03:08,136 - INFO - Received 9400 messages so far
2025-02-26 20:03:08,136 - INFO - Received 9500 messages so far
2025-02-26 20:03:08,136 - INFO - Received 9600 messages so far
2025-02-26 20:03:08,136 - INFO - Received 9700 messages so far
2025-02-26 20:03:08,136 - INFO - Received 9800 messages so far
2025-02-26 20:03:08,137 - INFO - Received 9900 messages so far
2025-02-26 20:03:08,137 - INFO - Received 10000 messages so far
2025-02-26 20:03:08,137 - INFO - Total messages consumed: 10000
2025-02-26 20:03:08,224 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:08,227 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:08,228 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:08,228 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:08,228 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:08,235 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:08,238 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:08,239 - INFO - Number of columns: 66
2025-02-26 20:03:08,249 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9108        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8909        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4142        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       0.0     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3928        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5417        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:08,249 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:08,279 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:08,322 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    6b77933b392d05f9              eb77933b392d05f9  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:08,323 - INFO - Unique values in 'id.resp_p' before labeling: [   nan   443.    53.  9092.    80.  5353.  1900.    22.   133.   134.
   138.   123.     0.    67. 21116.   136.   135. 21115.   547.]
2025-02-26 20:03:08,324 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:08,329 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:08,330 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:08,330 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:08,332 - INFO - DataFrame shape after NA dropping: (905, 23)
2025-02-26 20:03:08,332 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:08,332 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:08,333 - INFO - X shape: (905, 21), y shape: (905,)
2025-02-26 20:03:08,333 - INFO - Label distribution in training data: {'DNS': 758, 'HTTPS': 133, 'HTTP': 13, 'SSH': 1}
2025-02-26 20:03:08,334 - INFO - Training model...
2025-02-26 20:03:08,439 - INFO - Predicting on test data...
2025-02-26 20:03:08,451 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 155.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 23.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 181.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 181.0
  }
}
2025-02-26 20:03:08,458 - INFO - Saved processed data locally to processed_data_20250226_200308.csv
2025-02-26 20:03:08,460 - INFO - JSON data size: 443492 bytes
2025-02-26 20:03:08,460 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:08,461 - INFO - Data sent successfully!
2025-02-26 20:03:08,461 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:08,461 - INFO - Starting data processing
2025-02-26 20:03:08,461 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:08,462 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:08,463 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:08,463 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:08,564 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:08,564 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:08,565 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:08,565 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:08,565 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:08,566 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:08,566 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:08,566 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:08,566 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:08,719 - INFO - Received 100 messages so far
2025-02-26 20:03:08,720 - INFO - Received 200 messages so far
2025-02-26 20:03:08,720 - INFO - Received 300 messages so far
2025-02-26 20:03:08,720 - INFO - Received 400 messages so far
2025-02-26 20:03:08,720 - INFO - Received 500 messages so far
2025-02-26 20:03:08,720 - INFO - Received 600 messages so far
2025-02-26 20:03:08,721 - INFO - Received 700 messages so far
2025-02-26 20:03:08,721 - INFO - Received 800 messages so far
2025-02-26 20:03:08,721 - INFO - Received 900 messages so far
2025-02-26 20:03:08,721 - INFO - Received 1000 messages so far
2025-02-26 20:03:08,721 - INFO - Received 1100 messages so far
2025-02-26 20:03:08,722 - INFO - Received 1200 messages so far
2025-02-26 20:03:08,722 - INFO - Received 1300 messages so far
2025-02-26 20:03:08,722 - INFO - Received 1400 messages so far
2025-02-26 20:03:08,722 - INFO - Received 1500 messages so far
2025-02-26 20:03:08,722 - INFO - Received 1600 messages so far
2025-02-26 20:03:08,723 - INFO - Received 1700 messages so far
2025-02-26 20:03:08,723 - INFO - Received 1800 messages so far
2025-02-26 20:03:08,723 - INFO - Received 1900 messages so far
2025-02-26 20:03:08,723 - INFO - Received 2000 messages so far
2025-02-26 20:03:08,723 - INFO - Received 2100 messages so far
2025-02-26 20:03:08,724 - INFO - Received 2200 messages so far
2025-02-26 20:03:08,724 - INFO - Received 2300 messages so far
2025-02-26 20:03:08,724 - INFO - Received 2400 messages so far
2025-02-26 20:03:08,724 - INFO - Received 2500 messages so far
2025-02-26 20:03:08,724 - INFO - Received 2600 messages so far
2025-02-26 20:03:08,725 - INFO - Received 2700 messages so far
2025-02-26 20:03:08,725 - INFO - Received 2800 messages so far
2025-02-26 20:03:08,725 - INFO - Received 2900 messages so far
2025-02-26 20:03:08,725 - INFO - Received 3000 messages so far
2025-02-26 20:03:08,725 - INFO - Received 3100 messages so far
2025-02-26 20:03:08,726 - INFO - Received 3200 messages so far
2025-02-26 20:03:08,726 - INFO - Received 3300 messages so far
2025-02-26 20:03:08,726 - INFO - Received 3400 messages so far
2025-02-26 20:03:08,726 - INFO - Received 3500 messages so far
2025-02-26 20:03:08,726 - INFO - Received 3600 messages so far
2025-02-26 20:03:08,726 - INFO - Received 3700 messages so far
2025-02-26 20:03:08,727 - INFO - Received 3800 messages so far
2025-02-26 20:03:08,727 - INFO - Received 3900 messages so far
2025-02-26 20:03:08,727 - INFO - Received 4000 messages so far
2025-02-26 20:03:08,727 - INFO - Received 4100 messages so far
2025-02-26 20:03:08,819 - INFO - Received 4200 messages so far
2025-02-26 20:03:08,819 - INFO - Received 4300 messages so far
2025-02-26 20:03:08,819 - INFO - Received 4400 messages so far
2025-02-26 20:03:08,820 - INFO - Received 4500 messages so far
2025-02-26 20:03:08,820 - INFO - Received 4600 messages so far
2025-02-26 20:03:08,820 - INFO - Received 4700 messages so far
2025-02-26 20:03:08,820 - INFO - Received 4800 messages so far
2025-02-26 20:03:08,820 - INFO - Received 4900 messages so far
2025-02-26 20:03:08,821 - INFO - Received 5000 messages so far
2025-02-26 20:03:08,821 - INFO - Received 5100 messages so far
2025-02-26 20:03:08,821 - INFO - Received 5200 messages so far
2025-02-26 20:03:08,821 - INFO - Received 5300 messages so far
2025-02-26 20:03:08,821 - INFO - Received 5400 messages so far
2025-02-26 20:03:08,822 - INFO - Received 5500 messages so far
2025-02-26 20:03:08,822 - INFO - Received 5600 messages so far
2025-02-26 20:03:08,822 - INFO - Received 5700 messages so far
2025-02-26 20:03:08,822 - INFO - Received 5800 messages so far
2025-02-26 20:03:08,822 - INFO - Received 5900 messages so far
2025-02-26 20:03:08,823 - INFO - Received 6000 messages so far
2025-02-26 20:03:08,823 - INFO - Received 6100 messages so far
2025-02-26 20:03:08,823 - INFO - Received 6200 messages so far
2025-02-26 20:03:08,823 - INFO - Received 6300 messages so far
2025-02-26 20:03:08,823 - INFO - Received 6400 messages so far
2025-02-26 20:03:08,824 - INFO - Received 6500 messages so far
2025-02-26 20:03:08,824 - INFO - Received 6600 messages so far
2025-02-26 20:03:08,824 - INFO - Received 6700 messages so far
2025-02-26 20:03:08,824 - INFO - Received 6800 messages so far
2025-02-26 20:03:08,824 - INFO - Received 6900 messages so far
2025-02-26 20:03:08,825 - INFO - Received 7000 messages so far
2025-02-26 20:03:08,825 - INFO - Received 7100 messages so far
2025-02-26 20:03:08,825 - INFO - Received 7200 messages so far
2025-02-26 20:03:08,825 - INFO - Received 7300 messages so far
2025-02-26 20:03:08,826 - INFO - Received 7400 messages so far
2025-02-26 20:03:08,826 - INFO - Received 7500 messages so far
2025-02-26 20:03:08,826 - INFO - Received 7600 messages so far
2025-02-26 20:03:08,826 - INFO - Received 7700 messages so far
2025-02-26 20:03:08,826 - INFO - Received 7800 messages so far
2025-02-26 20:03:08,827 - INFO - Received 7900 messages so far
2025-02-26 20:03:08,827 - INFO - Received 8000 messages so far
2025-02-26 20:03:08,827 - INFO - Received 8100 messages so far
2025-02-26 20:03:08,827 - INFO - Received 8200 messages so far
2025-02-26 20:03:08,827 - INFO - Received 8300 messages so far
2025-02-26 20:03:08,828 - INFO - Received 8400 messages so far
2025-02-26 20:03:08,828 - INFO - Received 8500 messages so far
2025-02-26 20:03:08,828 - INFO - Received 8600 messages so far
2025-02-26 20:03:08,828 - INFO - Received 8700 messages so far
2025-02-26 20:03:08,882 - INFO - Received 8800 messages so far
2025-02-26 20:03:08,882 - INFO - Received 8900 messages so far
2025-02-26 20:03:08,883 - INFO - Received 9000 messages so far
2025-02-26 20:03:08,883 - INFO - Received 9100 messages so far
2025-02-26 20:03:08,883 - INFO - Received 9200 messages so far
2025-02-26 20:03:08,883 - INFO - Received 9300 messages so far
2025-02-26 20:03:08,884 - INFO - Received 9400 messages so far
2025-02-26 20:03:08,884 - INFO - Received 9500 messages so far
2025-02-26 20:03:08,884 - INFO - Received 9600 messages so far
2025-02-26 20:03:08,884 - INFO - Received 9700 messages so far
2025-02-26 20:03:08,884 - INFO - Received 9800 messages so far
2025-02-26 20:03:08,884 - INFO - Received 9900 messages so far
2025-02-26 20:03:08,885 - INFO - Received 10000 messages so far
2025-02-26 20:03:08,885 - INFO - Total messages consumed: 10000
2025-02-26 20:03:08,973 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:08,977 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:08,977 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:08,977 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:08,977 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:08,984 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:08,987 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:08,987 - INFO - Number of columns: 66
2025-02-26 20:03:08,997 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
8912        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4384        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9796        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
971         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3489        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:08,997 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:09,027 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:09,072 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    376acab97e4aab30              eb77933b392d05f9  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:09,072 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.   443.    80.   134.   547.    67.  1900.
   133.   123.   138.    22. 21116.   136.   135.     0. 21115.]
2025-02-26 20:03:09,073 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:09,078 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:09,079 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:09,079 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:09,082 - INFO - DataFrame shape after NA dropping: (822, 23)
2025-02-26 20:03:09,082 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:09,082 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:09,082 - INFO - X shape: (822, 21), y shape: (822,)
2025-02-26 20:03:09,082 - INFO - Label distribution in training data: {'DNS': 686, 'HTTPS': 122, 'HTTP': 13, 'SSH': 1}
2025-02-26 20:03:09,083 - INFO - Training model...
2025-02-26 20:03:09,195 - INFO - Predicting on test data...
2025-02-26 20:03:09,208 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 134.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 28.0
  },
  "accuracy": 1.0,
  "macro avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 165.0
  },
  "weighted avg": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 165.0
  }
}
2025-02-26 20:03:09,214 - INFO - Saved processed data locally to processed_data_20250226_200309.csv
2025-02-26 20:03:09,217 - INFO - JSON data size: 403424 bytes
2025-02-26 20:03:09,217 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:09,217 - INFO - Data sent successfully!
2025-02-26 20:03:09,217 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:09,218 - INFO - Starting data processing
2025-02-26 20:03:09,218 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:09,218 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:09,219 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:09,219 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:09,321 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:09,321 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:09,321 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:09,321 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:09,321 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:09,322 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:09,322 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:09,322 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:09,322 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:09,476 - INFO - Received 100 messages so far
2025-02-26 20:03:09,476 - INFO - Received 200 messages so far
2025-02-26 20:03:09,477 - INFO - Received 300 messages so far
2025-02-26 20:03:09,477 - INFO - Received 400 messages so far
2025-02-26 20:03:09,477 - INFO - Received 500 messages so far
2025-02-26 20:03:09,477 - INFO - Received 600 messages so far
2025-02-26 20:03:09,477 - INFO - Received 700 messages so far
2025-02-26 20:03:09,478 - INFO - Received 800 messages so far
2025-02-26 20:03:09,478 - INFO - Received 900 messages so far
2025-02-26 20:03:09,478 - INFO - Received 1000 messages so far
2025-02-26 20:03:09,478 - INFO - Received 1100 messages so far
2025-02-26 20:03:09,478 - INFO - Received 1200 messages so far
2025-02-26 20:03:09,479 - INFO - Received 1300 messages so far
2025-02-26 20:03:09,479 - INFO - Received 1400 messages so far
2025-02-26 20:03:09,479 - INFO - Received 1500 messages so far
2025-02-26 20:03:09,479 - INFO - Received 1600 messages so far
2025-02-26 20:03:09,479 - INFO - Received 1700 messages so far
2025-02-26 20:03:09,480 - INFO - Received 1800 messages so far
2025-02-26 20:03:09,480 - INFO - Received 1900 messages so far
2025-02-26 20:03:09,480 - INFO - Received 2000 messages so far
2025-02-26 20:03:09,480 - INFO - Received 2100 messages so far
2025-02-26 20:03:09,480 - INFO - Received 2200 messages so far
2025-02-26 20:03:09,481 - INFO - Received 2300 messages so far
2025-02-26 20:03:09,481 - INFO - Received 2400 messages so far
2025-02-26 20:03:09,481 - INFO - Received 2500 messages so far
2025-02-26 20:03:09,481 - INFO - Received 2600 messages so far
2025-02-26 20:03:09,481 - INFO - Received 2700 messages so far
2025-02-26 20:03:09,482 - INFO - Received 2800 messages so far
2025-02-26 20:03:09,482 - INFO - Received 2900 messages so far
2025-02-26 20:03:09,482 - INFO - Received 3000 messages so far
2025-02-26 20:03:09,482 - INFO - Received 3100 messages so far
2025-02-26 20:03:09,482 - INFO - Received 3200 messages so far
2025-02-26 20:03:09,482 - INFO - Received 3300 messages so far
2025-02-26 20:03:09,483 - INFO - Received 3400 messages so far
2025-02-26 20:03:09,483 - INFO - Received 3500 messages so far
2025-02-26 20:03:09,483 - INFO - Received 3600 messages so far
2025-02-26 20:03:09,483 - INFO - Received 3700 messages so far
2025-02-26 20:03:09,483 - INFO - Received 3800 messages so far
2025-02-26 20:03:09,484 - INFO - Received 3900 messages so far
2025-02-26 20:03:09,484 - INFO - Received 4000 messages so far
2025-02-26 20:03:09,484 - INFO - Received 4100 messages so far
2025-02-26 20:03:09,538 - INFO - Received 4200 messages so far
2025-02-26 20:03:09,538 - INFO - Received 4300 messages so far
2025-02-26 20:03:09,538 - INFO - Received 4400 messages so far
2025-02-26 20:03:09,539 - INFO - Received 4500 messages so far
2025-02-26 20:03:09,539 - INFO - Received 4600 messages so far
2025-02-26 20:03:09,539 - INFO - Received 4700 messages so far
2025-02-26 20:03:09,539 - INFO - Received 4800 messages so far
2025-02-26 20:03:09,539 - INFO - Received 4900 messages so far
2025-02-26 20:03:09,540 - INFO - Received 5000 messages so far
2025-02-26 20:03:09,540 - INFO - Received 5100 messages so far
2025-02-26 20:03:09,540 - INFO - Received 5200 messages so far
2025-02-26 20:03:09,540 - INFO - Received 5300 messages so far
2025-02-26 20:03:09,540 - INFO - Received 5400 messages so far
2025-02-26 20:03:09,541 - INFO - Received 5500 messages so far
2025-02-26 20:03:09,541 - INFO - Received 5600 messages so far
2025-02-26 20:03:09,541 - INFO - Received 5700 messages so far
2025-02-26 20:03:09,541 - INFO - Received 5800 messages so far
2025-02-26 20:03:09,541 - INFO - Received 5900 messages so far
2025-02-26 20:03:09,542 - INFO - Received 6000 messages so far
2025-02-26 20:03:09,542 - INFO - Received 6100 messages so far
2025-02-26 20:03:09,542 - INFO - Received 6200 messages so far
2025-02-26 20:03:09,542 - INFO - Received 6300 messages so far
2025-02-26 20:03:09,542 - INFO - Received 6400 messages so far
2025-02-26 20:03:09,543 - INFO - Received 6500 messages so far
2025-02-26 20:03:09,543 - INFO - Received 6600 messages so far
2025-02-26 20:03:09,543 - INFO - Received 6700 messages so far
2025-02-26 20:03:09,543 - INFO - Received 6800 messages so far
2025-02-26 20:03:09,543 - INFO - Received 6900 messages so far
2025-02-26 20:03:09,543 - INFO - Received 7000 messages so far
2025-02-26 20:03:09,544 - INFO - Received 7100 messages so far
2025-02-26 20:03:09,544 - INFO - Received 7200 messages so far
2025-02-26 20:03:09,544 - INFO - Received 7300 messages so far
2025-02-26 20:03:09,544 - INFO - Received 7400 messages so far
2025-02-26 20:03:09,544 - INFO - Received 7500 messages so far
2025-02-26 20:03:09,545 - INFO - Received 7600 messages so far
2025-02-26 20:03:09,545 - INFO - Received 7700 messages so far
2025-02-26 20:03:09,545 - INFO - Received 7800 messages so far
2025-02-26 20:03:09,545 - INFO - Received 7900 messages so far
2025-02-26 20:03:09,545 - INFO - Received 8000 messages so far
2025-02-26 20:03:09,546 - INFO - Received 8100 messages so far
2025-02-26 20:03:09,546 - INFO - Received 8200 messages so far
2025-02-26 20:03:09,546 - INFO - Received 8300 messages so far
2025-02-26 20:03:09,546 - INFO - Received 8400 messages so far
2025-02-26 20:03:09,546 - INFO - Received 8500 messages so far
2025-02-26 20:03:09,547 - INFO - Received 8600 messages so far
2025-02-26 20:03:09,547 - INFO - Received 8700 messages so far
2025-02-26 20:03:09,647 - INFO - Received 8800 messages so far
2025-02-26 20:03:09,648 - INFO - Received 8900 messages so far
2025-02-26 20:03:09,648 - INFO - Received 9000 messages so far
2025-02-26 20:03:09,648 - INFO - Received 9100 messages so far
2025-02-26 20:03:09,648 - INFO - Received 9200 messages so far
2025-02-26 20:03:09,648 - INFO - Received 9300 messages so far
2025-02-26 20:03:09,649 - INFO - Received 9400 messages so far
2025-02-26 20:03:09,649 - INFO - Received 9500 messages so far
2025-02-26 20:03:09,649 - INFO - Received 9600 messages so far
2025-02-26 20:03:09,649 - INFO - Received 9700 messages so far
2025-02-26 20:03:09,649 - INFO - Received 9800 messages so far
2025-02-26 20:03:09,650 - INFO - Received 9900 messages so far
2025-02-26 20:03:09,650 - INFO - Received 10000 messages so far
2025-02-26 20:03:09,650 - INFO - Total messages consumed: 10000
2025-02-26 20:03:09,734 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:09,738 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:09,738 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:09,738 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:09,738 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:09,746 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:09,749 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:09,750 - INFO - Number of columns: 66
2025-02-26 20:03:09,760 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt                     query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD     RA    Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
9701        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN                       NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.006566     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9003        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN                       NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
8498       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740120e+09      NaN  NaN     NaN  CArpb62oYhfEsMaK52    42696.0  NaN  mira-ofc.tm-4.office.com     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  False  0.0     NaN  NaN    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4512        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN                       NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
614         NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                 NaN        NaN  NaN                       NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:09,760 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:09,790 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:09,835 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    1edec4bdcc72bfa6              efe788e3cc713726  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:09,836 - INFO - Unique values in 'id.resp_p' before labeling: [   nan    53.  9092.  5353.  1900.   443.    80.    67.   123.   138.
   136.   133.   547. 21115.     0.   134. 21116.   135.    22.]
2025-02-26 20:03:09,837 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:09,842 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:09,843 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:09,843 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:09,846 - INFO - DataFrame shape after NA dropping: (849, 23)
2025-02-26 20:03:09,846 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:09,846 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:09,846 - INFO - X shape: (849, 21), y shape: (849,)
2025-02-26 20:03:09,846 - INFO - Label distribution in training data: {'DNS': 708, 'HTTPS': 128, 'HTTP': 12, 'SSH': 1}
2025-02-26 20:03:09,847 - INFO - Training model...
2025-02-26 20:03:09,957 - INFO - Predicting on test data...
2025-02-26 20:03:09,970 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 135.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 2.0
  },
  "HTTPS": {
    "precision": 0.9696969696969697,
    "recall": 1.0,
    "f1-score": 0.9846153846153847,
    "support": 32.0
  },
  "SSH": {
    "precision": 0.0,
    "recall": 0.0,
    "f1-score": 0.0,
    "support": 1.0
  },
  "accuracy": 0.9941176470588236,
  "macro avg": {
    "precision": 0.7424242424242424,
    "recall": 0.75,
    "f1-score": 0.7461538461538462,
    "support": 170.0
  },
  "weighted avg": {
    "precision": 0.9884135472370766,
    "recall": 0.9941176470588236,
    "f1-score": 0.9912217194570135,
    "support": 170.0
  }
}
2025-02-26 20:03:09,977 - INFO - Saved processed data locally to processed_data_20250226_200309.csv
2025-02-26 20:03:09,979 - INFO - JSON data size: 423715 bytes
2025-02-26 20:03:09,979 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:09,979 - INFO - Data sent successfully!
2025-02-26 20:03:09,979 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:09,980 - INFO - Starting data processing
2025-02-26 20:03:09,980 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:09,981 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:09,981 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:09,982 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:10,083 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:10,083 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:10,083 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:10,084 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:10,084 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:10,084 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:10,085 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:10,085 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:10,085 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:10,239 - INFO - Received 100 messages so far
2025-02-26 20:03:10,239 - INFO - Received 200 messages so far
2025-02-26 20:03:10,239 - INFO - Received 300 messages so far
2025-02-26 20:03:10,240 - INFO - Received 400 messages so far
2025-02-26 20:03:10,240 - INFO - Received 500 messages so far
2025-02-26 20:03:10,240 - INFO - Received 600 messages so far
2025-02-26 20:03:10,240 - INFO - Received 700 messages so far
2025-02-26 20:03:10,240 - INFO - Received 800 messages so far
2025-02-26 20:03:10,241 - INFO - Received 900 messages so far
2025-02-26 20:03:10,241 - INFO - Received 1000 messages so far
2025-02-26 20:03:10,241 - INFO - Received 1100 messages so far
2025-02-26 20:03:10,241 - INFO - Received 1200 messages so far
2025-02-26 20:03:10,241 - INFO - Received 1300 messages so far
2025-02-26 20:03:10,242 - INFO - Received 1400 messages so far
2025-02-26 20:03:10,242 - INFO - Received 1500 messages so far
2025-02-26 20:03:10,242 - INFO - Received 1600 messages so far
2025-02-26 20:03:10,242 - INFO - Received 1700 messages so far
2025-02-26 20:03:10,242 - INFO - Received 1800 messages so far
2025-02-26 20:03:10,243 - INFO - Received 1900 messages so far
2025-02-26 20:03:10,243 - INFO - Received 2000 messages so far
2025-02-26 20:03:10,243 - INFO - Received 2100 messages so far
2025-02-26 20:03:10,243 - INFO - Received 2200 messages so far
2025-02-26 20:03:10,243 - INFO - Received 2300 messages so far
2025-02-26 20:03:10,244 - INFO - Received 2400 messages so far
2025-02-26 20:03:10,244 - INFO - Received 2500 messages so far
2025-02-26 20:03:10,244 - INFO - Received 2600 messages so far
2025-02-26 20:03:10,244 - INFO - Received 2700 messages so far
2025-02-26 20:03:10,244 - INFO - Received 2800 messages so far
2025-02-26 20:03:10,244 - INFO - Received 2900 messages so far
2025-02-26 20:03:10,245 - INFO - Received 3000 messages so far
2025-02-26 20:03:10,245 - INFO - Received 3100 messages so far
2025-02-26 20:03:10,245 - INFO - Received 3200 messages so far
2025-02-26 20:03:10,245 - INFO - Received 3300 messages so far
2025-02-26 20:03:10,245 - INFO - Received 3400 messages so far
2025-02-26 20:03:10,246 - INFO - Received 3500 messages so far
2025-02-26 20:03:10,246 - INFO - Received 3600 messages so far
2025-02-26 20:03:10,246 - INFO - Received 3700 messages so far
2025-02-26 20:03:10,246 - INFO - Received 3800 messages so far
2025-02-26 20:03:10,246 - INFO - Received 3900 messages so far
2025-02-26 20:03:10,247 - INFO - Received 4000 messages so far
2025-02-26 20:03:10,247 - INFO - Received 4100 messages so far
2025-02-26 20:03:10,301 - INFO - Received 4200 messages so far
2025-02-26 20:03:10,301 - INFO - Received 4300 messages so far
2025-02-26 20:03:10,301 - INFO - Received 4400 messages so far
2025-02-26 20:03:10,301 - INFO - Received 4500 messages so far
2025-02-26 20:03:10,302 - INFO - Received 4600 messages so far
2025-02-26 20:03:10,302 - INFO - Received 4700 messages so far
2025-02-26 20:03:10,302 - INFO - Received 4800 messages so far
2025-02-26 20:03:10,302 - INFO - Received 4900 messages so far
2025-02-26 20:03:10,302 - INFO - Received 5000 messages so far
2025-02-26 20:03:10,303 - INFO - Received 5100 messages so far
2025-02-26 20:03:10,303 - INFO - Received 5200 messages so far
2025-02-26 20:03:10,303 - INFO - Received 5300 messages so far
2025-02-26 20:03:10,303 - INFO - Received 5400 messages so far
2025-02-26 20:03:10,303 - INFO - Received 5500 messages so far
2025-02-26 20:03:10,304 - INFO - Received 5600 messages so far
2025-02-26 20:03:10,304 - INFO - Received 5700 messages so far
2025-02-26 20:03:10,304 - INFO - Received 5800 messages so far
2025-02-26 20:03:10,304 - INFO - Received 5900 messages so far
2025-02-26 20:03:10,304 - INFO - Received 6000 messages so far
2025-02-26 20:03:10,304 - INFO - Received 6100 messages so far
2025-02-26 20:03:10,305 - INFO - Received 6200 messages so far
2025-02-26 20:03:10,305 - INFO - Received 6300 messages so far
2025-02-26 20:03:10,305 - INFO - Received 6400 messages so far
2025-02-26 20:03:10,305 - INFO - Received 6500 messages so far
2025-02-26 20:03:10,305 - INFO - Received 6600 messages so far
2025-02-26 20:03:10,306 - INFO - Received 6700 messages so far
2025-02-26 20:03:10,306 - INFO - Received 6800 messages so far
2025-02-26 20:03:10,306 - INFO - Received 6900 messages so far
2025-02-26 20:03:10,306 - INFO - Received 7000 messages so far
2025-02-26 20:03:10,306 - INFO - Received 7100 messages so far
2025-02-26 20:03:10,307 - INFO - Received 7200 messages so far
2025-02-26 20:03:10,307 - INFO - Received 7300 messages so far
2025-02-26 20:03:10,307 - INFO - Received 7400 messages so far
2025-02-26 20:03:10,307 - INFO - Received 7500 messages so far
2025-02-26 20:03:10,307 - INFO - Received 7600 messages so far
2025-02-26 20:03:10,308 - INFO - Received 7700 messages so far
2025-02-26 20:03:10,308 - INFO - Received 7800 messages so far
2025-02-26 20:03:10,308 - INFO - Received 7900 messages so far
2025-02-26 20:03:10,308 - INFO - Received 8000 messages so far
2025-02-26 20:03:10,308 - INFO - Received 8100 messages so far
2025-02-26 20:03:10,309 - INFO - Received 8200 messages so far
2025-02-26 20:03:10,309 - INFO - Received 8300 messages so far
2025-02-26 20:03:10,309 - INFO - Received 8400 messages so far
2025-02-26 20:03:10,309 - INFO - Received 8500 messages so far
2025-02-26 20:03:10,309 - INFO - Received 8600 messages so far
2025-02-26 20:03:10,310 - INFO - Received 8700 messages so far
2025-02-26 20:03:10,363 - INFO - Received 8800 messages so far
2025-02-26 20:03:10,363 - INFO - Received 8900 messages so far
2025-02-26 20:03:10,363 - INFO - Received 9000 messages so far
2025-02-26 20:03:10,364 - INFO - Received 9100 messages so far
2025-02-26 20:03:10,364 - INFO - Received 9200 messages so far
2025-02-26 20:03:10,364 - INFO - Received 9300 messages so far
2025-02-26 20:03:10,364 - INFO - Received 9400 messages so far
2025-02-26 20:03:10,364 - INFO - Received 9500 messages so far
2025-02-26 20:03:10,365 - INFO - Received 9600 messages so far
2025-02-26 20:03:10,365 - INFO - Received 9700 messages so far
2025-02-26 20:03:10,365 - INFO - Received 9800 messages so far
2025-02-26 20:03:10,365 - INFO - Received 9900 messages so far
2025-02-26 20:03:10,365 - INFO - Received 10000 messages so far
2025-02-26 20:03:10,365 - INFO - Total messages consumed: 10000
2025-02-26 20:03:10,447 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:10,451 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:10,451 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:10,451 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:10,451 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:10,459 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:10,462 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:10,462 - INFO - Number of columns: 66
2025-02-26 20:03:10,472 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                uid  id.orig_p  rtt                                          query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD     RA    Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
309        53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740118e+09      NaN  NaN     NaN  CFDXEJhTByPjys6ra    50434.0  NaN  pgtus1-word-telemetry-vip.officeapps.live.com     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  False  0.0     NaN  NaN    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1632        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN                NaN        NaN  NaN                                            NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN   0.02053     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5033       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740119e+09      NaN  NaN     NaN  Cq2eutQXtXCUPTGpe    52405.0  NaN  onedscolprdcus03.centralus.cloudapp.azure.com     1.0  C_INTERNET   65.0      HTTPS    0.0    NOERROR  False  False  True  False  0.0     NaN  NaN    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
3246        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                NaN        NaN  NaN                                            NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
9247        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                NaN        NaN  NaN                                            NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN    NaN  NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:10,472 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:10,500 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:10,543 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    ca26477d8c98f7b3              ea26477d8c98f7b3  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:10,544 - INFO - Unique values in 'id.resp_p' before labeling: [   53.    nan   443.  5353.  9092.  1900.   123.    80.   133. 21116.
   136.    22.   547.    67.   134.   138.     0. 21115.   135.]
2025-02-26 20:03:10,545 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:10,550 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:10,551 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:10,551 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:10,553 - INFO - DataFrame shape after NA dropping: (898, 23)
2025-02-26 20:03:10,553 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:10,553 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:10,554 - INFO - X shape: (898, 21), y shape: (898,)
2025-02-26 20:03:10,554 - INFO - Label distribution in training data: {'DNS': 750, 'HTTPS': 133, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:10,555 - INFO - Training model...
2025-02-26 20:03:10,662 - INFO - Predicting on test data...
2025-02-26 20:03:10,675 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 154.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.75,
    "f1-score": 0.8571428571428571,
    "support": 4.0
  },
  "HTTPS": {
    "precision": 0.9565217391304348,
    "recall": 1.0,
    "f1-score": 0.9777777777777777,
    "support": 22.0
  },
  "accuracy": 0.9944444444444445,
  "macro avg": {
    "precision": 0.9855072463768115,
    "recall": 0.9166666666666666,
    "f1-score": 0.944973544973545,
    "support": 180.0
  },
  "weighted avg": {
    "precision": 0.9946859903381642,
    "recall": 0.9944444444444445,
    "f1-score": 0.9941093474426808,
    "support": 180.0
  }
}
2025-02-26 20:03:10,681 - INFO - Saved processed data locally to processed_data_20250226_200310.csv
2025-02-26 20:03:10,683 - INFO - JSON data size: 441110 bytes
2025-02-26 20:03:10,683 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:10,683 - INFO - Data sent successfully!
2025-02-26 20:03:10,683 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:10,684 - INFO - Starting data processing
2025-02-26 20:03:10,684 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:10,685 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:10,685 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:10,686 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:10,787 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:10,787 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:10,787 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:10,788 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:10,788 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:10,789 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:10,789 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:10,789 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:10,789 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:10,987 - INFO - Received 100 messages so far
2025-02-26 20:03:10,987 - INFO - Received 200 messages so far
2025-02-26 20:03:10,987 - INFO - Received 300 messages so far
2025-02-26 20:03:10,987 - INFO - Received 400 messages so far
2025-02-26 20:03:10,988 - INFO - Received 500 messages so far
2025-02-26 20:03:10,988 - INFO - Received 600 messages so far
2025-02-26 20:03:10,988 - INFO - Received 700 messages so far
2025-02-26 20:03:10,988 - INFO - Received 800 messages so far
2025-02-26 20:03:10,988 - INFO - Received 900 messages so far
2025-02-26 20:03:10,989 - INFO - Received 1000 messages so far
2025-02-26 20:03:10,989 - INFO - Received 1100 messages so far
2025-02-26 20:03:10,989 - INFO - Received 1200 messages so far
2025-02-26 20:03:10,989 - INFO - Received 1300 messages so far
2025-02-26 20:03:10,989 - INFO - Received 1400 messages so far
2025-02-26 20:03:10,990 - INFO - Received 1500 messages so far
2025-02-26 20:03:10,990 - INFO - Received 1600 messages so far
2025-02-26 20:03:10,990 - INFO - Received 1700 messages so far
2025-02-26 20:03:10,990 - INFO - Received 1800 messages so far
2025-02-26 20:03:10,990 - INFO - Received 1900 messages so far
2025-02-26 20:03:10,991 - INFO - Received 2000 messages so far
2025-02-26 20:03:10,991 - INFO - Received 2100 messages so far
2025-02-26 20:03:10,991 - INFO - Received 2200 messages so far
2025-02-26 20:03:10,991 - INFO - Received 2300 messages so far
2025-02-26 20:03:10,991 - INFO - Received 2400 messages so far
2025-02-26 20:03:10,992 - INFO - Received 2500 messages so far
2025-02-26 20:03:10,992 - INFO - Received 2600 messages so far
2025-02-26 20:03:10,992 - INFO - Received 2700 messages so far
2025-02-26 20:03:10,992 - INFO - Received 2800 messages so far
2025-02-26 20:03:10,992 - INFO - Received 2900 messages so far
2025-02-26 20:03:10,993 - INFO - Received 3000 messages so far
2025-02-26 20:03:10,993 - INFO - Received 3100 messages so far
2025-02-26 20:03:10,993 - INFO - Received 3200 messages so far
2025-02-26 20:03:10,993 - INFO - Received 3300 messages so far
2025-02-26 20:03:10,993 - INFO - Received 3400 messages so far
2025-02-26 20:03:10,994 - INFO - Received 3500 messages so far
2025-02-26 20:03:10,994 - INFO - Received 3600 messages so far
2025-02-26 20:03:10,994 - INFO - Received 3700 messages so far
2025-02-26 20:03:10,994 - INFO - Received 3800 messages so far
2025-02-26 20:03:10,994 - INFO - Received 3900 messages so far
2025-02-26 20:03:10,995 - INFO - Received 4000 messages so far
2025-02-26 20:03:10,995 - INFO - Received 4100 messages so far
2025-02-26 20:03:11,048 - INFO - Received 4200 messages so far
2025-02-26 20:03:11,049 - INFO - Received 4300 messages so far
2025-02-26 20:03:11,049 - INFO - Received 4400 messages so far
2025-02-26 20:03:11,049 - INFO - Received 4500 messages so far
2025-02-26 20:03:11,049 - INFO - Received 4600 messages so far
2025-02-26 20:03:11,049 - INFO - Received 4700 messages so far
2025-02-26 20:03:11,050 - INFO - Received 4800 messages so far
2025-02-26 20:03:11,050 - INFO - Received 4900 messages so far
2025-02-26 20:03:11,050 - INFO - Received 5000 messages so far
2025-02-26 20:03:11,050 - INFO - Received 5100 messages so far
2025-02-26 20:03:11,050 - INFO - Received 5200 messages so far
2025-02-26 20:03:11,051 - INFO - Received 5300 messages so far
2025-02-26 20:03:11,051 - INFO - Received 5400 messages so far
2025-02-26 20:03:11,051 - INFO - Received 5500 messages so far
2025-02-26 20:03:11,051 - INFO - Received 5600 messages so far
2025-02-26 20:03:11,051 - INFO - Received 5700 messages so far
2025-02-26 20:03:11,052 - INFO - Received 5800 messages so far
2025-02-26 20:03:11,052 - INFO - Received 5900 messages so far
2025-02-26 20:03:11,052 - INFO - Received 6000 messages so far
2025-02-26 20:03:11,052 - INFO - Received 6100 messages so far
2025-02-26 20:03:11,052 - INFO - Received 6200 messages so far
2025-02-26 20:03:11,053 - INFO - Received 6300 messages so far
2025-02-26 20:03:11,053 - INFO - Received 6400 messages so far
2025-02-26 20:03:11,053 - INFO - Received 6500 messages so far
2025-02-26 20:03:11,053 - INFO - Received 6600 messages so far
2025-02-26 20:03:11,053 - INFO - Received 6700 messages so far
2025-02-26 20:03:11,054 - INFO - Received 6800 messages so far
2025-02-26 20:03:11,054 - INFO - Received 6900 messages so far
2025-02-26 20:03:11,054 - INFO - Received 7000 messages so far
2025-02-26 20:03:11,054 - INFO - Received 7100 messages so far
2025-02-26 20:03:11,054 - INFO - Received 7200 messages so far
2025-02-26 20:03:11,055 - INFO - Received 7300 messages so far
2025-02-26 20:03:11,055 - INFO - Received 7400 messages so far
2025-02-26 20:03:11,055 - INFO - Received 7500 messages so far
2025-02-26 20:03:11,055 - INFO - Received 7600 messages so far
2025-02-26 20:03:11,055 - INFO - Received 7700 messages so far
2025-02-26 20:03:11,056 - INFO - Received 7800 messages so far
2025-02-26 20:03:11,056 - INFO - Received 7900 messages so far
2025-02-26 20:03:11,056 - INFO - Received 8000 messages so far
2025-02-26 20:03:11,056 - INFO - Received 8100 messages so far
2025-02-26 20:03:11,056 - INFO - Received 8200 messages so far
2025-02-26 20:03:11,057 - INFO - Received 8300 messages so far
2025-02-26 20:03:11,057 - INFO - Received 8400 messages so far
2025-02-26 20:03:11,057 - INFO - Received 8500 messages so far
2025-02-26 20:03:11,057 - INFO - Received 8600 messages so far
2025-02-26 20:03:11,058 - INFO - Received 8700 messages so far
2025-02-26 20:03:11,111 - INFO - Received 8800 messages so far
2025-02-26 20:03:11,112 - INFO - Received 8900 messages so far
2025-02-26 20:03:11,112 - INFO - Received 9000 messages so far
2025-02-26 20:03:11,112 - INFO - Received 9100 messages so far
2025-02-26 20:03:11,112 - INFO - Received 9200 messages so far
2025-02-26 20:03:11,112 - INFO - Received 9300 messages so far
2025-02-26 20:03:11,113 - INFO - Received 9400 messages so far
2025-02-26 20:03:11,113 - INFO - Received 9500 messages so far
2025-02-26 20:03:11,113 - INFO - Received 9600 messages so far
2025-02-26 20:03:11,113 - INFO - Received 9700 messages so far
2025-02-26 20:03:11,113 - INFO - Received 9800 messages so far
2025-02-26 20:03:11,114 - INFO - Received 9900 messages so far
2025-02-26 20:03:11,114 - INFO - Received 10000 messages so far
2025-02-26 20:03:11,114 - INFO - Total messages consumed: 10000
2025-02-26 20:03:11,201 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:11,205 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:11,205 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:11,205 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:11,205 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:11,212 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:11,215 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:11,215 - INFO - Number of columns: 66
2025-02-26 20:03:11,225 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
8011        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
4875        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6885        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
1150        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6050        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:11,225 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:11,256 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:11,300 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    6b77933b392d05f9              eb77933b392d05f9  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:11,301 - INFO - Unique values in 'id.resp_p' before labeling: [   nan   123.  9092.    53.  5353.  1900.   443. 21116.    80.   133.
   136.   138.   134. 21115.   135.    67.     0.    22.   547.]
2025-02-26 20:03:11,302 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:11,307 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:11,308 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:11,308 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:11,311 - INFO - DataFrame shape after NA dropping: (845, 23)
2025-02-26 20:03:11,311 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:11,311 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:11,311 - INFO - X shape: (845, 21), y shape: (845,)
2025-02-26 20:03:11,311 - INFO - Label distribution in training data: {'DNS': 703, 'HTTPS': 129, 'HTTP': 12, 'SSH': 1}
2025-02-26 20:03:11,312 - INFO - Training model...
2025-02-26 20:03:11,426 - INFO - Predicting on test data...
2025-02-26 20:03:11,440 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 135.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.6666666666666666,
    "f1-score": 0.8,
    "support": 3.0
  },
  "HTTPS": {
    "precision": 0.96875,
    "recall": 1.0,
    "f1-score": 0.9841269841269841,
    "support": 31.0
  },
  "accuracy": 0.9940828402366864,
  "macro avg": {
    "precision": 0.9895833333333334,
    "recall": 0.8888888888888888,
    "f1-score": 0.928042328042328,
    "support": 169.0
  },
  "weighted avg": {
    "precision": 0.9942677514792899,
    "recall": 0.9940828402366864,
    "f1-score": 0.9935380858457782,
    "support": 169.0
  }
}
2025-02-26 20:03:11,447 - INFO - Saved processed data locally to processed_data_20250226_200311.csv
2025-02-26 20:03:11,449 - INFO - JSON data size: 418738 bytes
2025-02-26 20:03:11,449 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:11,449 - INFO - Data sent successfully!
2025-02-26 20:03:11,449 - INFO - Data processing and transmission completed successfully
2025-02-26 20:03:11,451 - INFO - Starting data processing
2025-02-26 20:03:11,451 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-26 20:03:11,451 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-26 20:03:11,452 - INFO - Probing node bootstrap-0 broker version
2025-02-26 20:03:11,452 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-26 20:03:11,553 - INFO - Broker version identified as 2.5.0
2025-02-26 20:03:11,553 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-26 20:03:11,554 - WARNING - group_id is None: disabling auto-commit.
2025-02-26 20:03:11,554 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-26 20:03:11,554 - INFO - Connected to Kafka. Waiting for messages...
2025-02-26 20:03:11,555 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-26 20:03:11,555 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-26 20:03:11,555 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-26 20:03:11,555 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-26 20:03:11,710 - INFO - Received 100 messages so far
2025-02-26 20:03:11,711 - INFO - Received 200 messages so far
2025-02-26 20:03:11,711 - INFO - Received 300 messages so far
2025-02-26 20:03:11,711 - INFO - Received 400 messages so far
2025-02-26 20:03:11,711 - INFO - Received 500 messages so far
2025-02-26 20:03:11,711 - INFO - Received 600 messages so far
2025-02-26 20:03:11,712 - INFO - Received 700 messages so far
2025-02-26 20:03:11,712 - INFO - Received 800 messages so far
2025-02-26 20:03:11,712 - INFO - Received 900 messages so far
2025-02-26 20:03:11,712 - INFO - Received 1000 messages so far
2025-02-26 20:03:11,712 - INFO - Received 1100 messages so far
2025-02-26 20:03:11,713 - INFO - Received 1200 messages so far
2025-02-26 20:03:11,713 - INFO - Received 1300 messages so far
2025-02-26 20:03:11,713 - INFO - Received 1400 messages so far
2025-02-26 20:03:11,713 - INFO - Received 1500 messages so far
2025-02-26 20:03:11,713 - INFO - Received 1600 messages so far
2025-02-26 20:03:11,714 - INFO - Received 1700 messages so far
2025-02-26 20:03:11,714 - INFO - Received 1800 messages so far
2025-02-26 20:03:11,714 - INFO - Received 1900 messages so far
2025-02-26 20:03:11,714 - INFO - Received 2000 messages so far
2025-02-26 20:03:11,714 - INFO - Received 2100 messages so far
2025-02-26 20:03:11,715 - INFO - Received 2200 messages so far
2025-02-26 20:03:11,715 - INFO - Received 2300 messages so far
2025-02-26 20:03:11,715 - INFO - Received 2400 messages so far
2025-02-26 20:03:11,715 - INFO - Received 2500 messages so far
2025-02-26 20:03:11,715 - INFO - Received 2600 messages so far
2025-02-26 20:03:11,716 - INFO - Received 2700 messages so far
2025-02-26 20:03:11,716 - INFO - Received 2800 messages so far
2025-02-26 20:03:11,716 - INFO - Received 2900 messages so far
2025-02-26 20:03:11,716 - INFO - Received 3000 messages so far
2025-02-26 20:03:11,716 - INFO - Received 3100 messages so far
2025-02-26 20:03:11,717 - INFO - Received 3200 messages so far
2025-02-26 20:03:11,717 - INFO - Received 3300 messages so far
2025-02-26 20:03:11,717 - INFO - Received 3400 messages so far
2025-02-26 20:03:11,717 - INFO - Received 3500 messages so far
2025-02-26 20:03:11,717 - INFO - Received 3600 messages so far
2025-02-26 20:03:11,718 - INFO - Received 3700 messages so far
2025-02-26 20:03:11,718 - INFO - Received 3800 messages so far
2025-02-26 20:03:11,718 - INFO - Received 3900 messages so far
2025-02-26 20:03:11,718 - INFO - Received 4000 messages so far
2025-02-26 20:03:11,719 - INFO - Received 4100 messages so far
2025-02-26 20:03:11,773 - INFO - Received 4200 messages so far
2025-02-26 20:03:11,773 - INFO - Received 4300 messages so far
2025-02-26 20:03:11,773 - INFO - Received 4400 messages so far
2025-02-26 20:03:11,774 - INFO - Received 4500 messages so far
2025-02-26 20:03:11,774 - INFO - Received 4600 messages so far
2025-02-26 20:03:11,774 - INFO - Received 4700 messages so far
2025-02-26 20:03:11,774 - INFO - Received 4800 messages so far
2025-02-26 20:03:11,774 - INFO - Received 4900 messages so far
2025-02-26 20:03:11,775 - INFO - Received 5000 messages so far
2025-02-26 20:03:11,775 - INFO - Received 5100 messages so far
2025-02-26 20:03:11,775 - INFO - Received 5200 messages so far
2025-02-26 20:03:11,775 - INFO - Received 5300 messages so far
2025-02-26 20:03:11,775 - INFO - Received 5400 messages so far
2025-02-26 20:03:11,776 - INFO - Received 5500 messages so far
2025-02-26 20:03:11,776 - INFO - Received 5600 messages so far
2025-02-26 20:03:11,776 - INFO - Received 5700 messages so far
2025-02-26 20:03:11,776 - INFO - Received 5800 messages so far
2025-02-26 20:03:11,776 - INFO - Received 5900 messages so far
2025-02-26 20:03:11,777 - INFO - Received 6000 messages so far
2025-02-26 20:03:11,777 - INFO - Received 6100 messages so far
2025-02-26 20:03:11,777 - INFO - Received 6200 messages so far
2025-02-26 20:03:11,777 - INFO - Received 6300 messages so far
2025-02-26 20:03:11,777 - INFO - Received 6400 messages so far
2025-02-26 20:03:11,778 - INFO - Received 6500 messages so far
2025-02-26 20:03:11,778 - INFO - Received 6600 messages so far
2025-02-26 20:03:11,778 - INFO - Received 6700 messages so far
2025-02-26 20:03:11,778 - INFO - Received 6800 messages so far
2025-02-26 20:03:11,778 - INFO - Received 6900 messages so far
2025-02-26 20:03:11,778 - INFO - Received 7000 messages so far
2025-02-26 20:03:11,779 - INFO - Received 7100 messages so far
2025-02-26 20:03:11,779 - INFO - Received 7200 messages so far
2025-02-26 20:03:11,779 - INFO - Received 7300 messages so far
2025-02-26 20:03:11,779 - INFO - Received 7400 messages so far
2025-02-26 20:03:11,779 - INFO - Received 7500 messages so far
2025-02-26 20:03:11,780 - INFO - Received 7600 messages so far
2025-02-26 20:03:11,780 - INFO - Received 7700 messages so far
2025-02-26 20:03:11,780 - INFO - Received 7800 messages so far
2025-02-26 20:03:11,780 - INFO - Received 7900 messages so far
2025-02-26 20:03:11,780 - INFO - Received 8000 messages so far
2025-02-26 20:03:11,781 - INFO - Received 8100 messages so far
2025-02-26 20:03:11,781 - INFO - Received 8200 messages so far
2025-02-26 20:03:11,781 - INFO - Received 8300 messages so far
2025-02-26 20:03:11,781 - INFO - Received 8400 messages so far
2025-02-26 20:03:11,781 - INFO - Received 8500 messages so far
2025-02-26 20:03:11,782 - INFO - Received 8600 messages so far
2025-02-26 20:03:11,782 - INFO - Received 8700 messages so far
2025-02-26 20:03:11,880 - INFO - Received 8800 messages so far
2025-02-26 20:03:11,880 - INFO - Received 8900 messages so far
2025-02-26 20:03:11,881 - INFO - Received 9000 messages so far
2025-02-26 20:03:11,881 - INFO - Received 9100 messages so far
2025-02-26 20:03:11,881 - INFO - Received 9200 messages so far
2025-02-26 20:03:11,881 - INFO - Received 9300 messages so far
2025-02-26 20:03:11,882 - INFO - Received 9400 messages so far
2025-02-26 20:03:11,882 - INFO - Received 9500 messages so far
2025-02-26 20:03:11,882 - INFO - Received 9600 messages so far
2025-02-26 20:03:11,882 - INFO - Received 9700 messages so far
2025-02-26 20:03:11,882 - INFO - Received 9800 messages so far
2025-02-26 20:03:11,883 - INFO - Received 9900 messages so far
2025-02-26 20:03:11,883 - INFO - Received 10000 messages so far
2025-02-26 20:03:11,883 - INFO - Total messages consumed: 10000
2025-02-26 20:03:11,974 - INFO - Messages converted to DataFrame successfully!
2025-02-26 20:03:11,978 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:11,978 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-26 20:03:11,978 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-26 20:03:11,978 - INFO - Dropping 96 columns out of 126 specified
2025-02-26 20:03:11,986 - INFO - DataFrame shape after cleaning: (10000, 66)
2025-02-26 20:03:11,989 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkt_lag', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate']
2025-02-26 20:03:11,989 - INFO - Number of columns: 66
2025-02-26 20:03:12,000 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkt_lag host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate
4657        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2154     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740118e+09      NaN  NaN     NaN  CXLWdj1PqBOwcBe7D4    51236.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000161     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
5756        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
6856        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
7743        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09      NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN
2025-02-26 20:03:12,000 - INFO - DataFrame shape: (10000, 66)
2025-02-26 20:03:12,030 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts   pkt_lag     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03  7.000000   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  0.002835  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  0.004274  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04
min        0.000000  0.000000e+00       0.000000  1.740118e+09  0.000000     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  0.000867  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  0.001849  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  0.001973  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  0.012315  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09
2025-02-26 20:03:12,075 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers            TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus
count          1606         1606  1513                              10     439               1605                      433         426        426        409    433    433   433   433                                                                                                                                  254             254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5      7   7           7    7                   4             4                                         4                                         4                                       4          4
unique           18           69     4                               4       8               1118                       66           1          6          2      2      1     2     2                                                                                                                                  117             213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1      1   1           1    1                   4             1                                         2                                         2                                       2          1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CP9ROzzRvmMkxXEu7  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [120.0, 120.0]    False        REJ       True       True      Sr  TLSv13    2fe788e3cc713726              efe788e3cc713726  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good
freq           1520          762   863                               7     382                  7                       74         426        248        408    416    433   392   238                                                                                                                                   34               6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5      7   7           7    7                   1             4                                         3                                         3                                       3          4
2025-02-26 20:03:12,075 - INFO - Unique values in 'id.resp_p' before labeling: [   nan  9092.   443.    53.  1900.   123.    80.  5353.   133.     0.
   134.   135.    67. 21116.   136.   138.    22. 21115.   547.]
2025-02-26 20:03:12,076 - INFO - Data types in 'id.resp_p': [<class 'float'>]
2025-02-26 20:03:12,081 - INFO - Label distribution: {'DNS': 761, 'HTTPS': 134, 'HTTP': 14, 'SSH': 1}
2025-02-26 20:03:12,083 - INFO - DataFrame shape after label filtering: (910, 67)
2025-02-26 20:03:12,083 - INFO - Dropping 44 columns out of 87 specified in second drop
2025-02-26 20:03:12,085 - INFO - DataFrame shape after NA dropping: (825, 23)
2025-02-26 20:03:12,085 - INFO - Using categorical features: ['id.orig_h', 'id.resp_h', 'proto', 'history', 'uid', 'conn_state']
2025-02-26 20:03:12,085 - INFO - Using numerical features: ['id.orig_p', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'missed_bytes', 'local_resp', 'local_orig', 'resp_bytes', 'orig_bytes', 'duration', 'id.resp_p']
2025-02-26 20:03:12,085 - INFO - X shape: (825, 21), y shape: (825,)
2025-02-26 20:03:12,086 - INFO - Label distribution in training data: {'DNS': 684, 'HTTPS': 127, 'HTTP': 13, 'SSH': 1}
2025-02-26 20:03:12,087 - INFO - Training model...
2025-02-26 20:03:12,201 - INFO - Predicting on test data...
2025-02-26 20:03:12,214 - INFO - Classification report:
{
  "DNS": {
    "precision": 1.0,
    "recall": 1.0,
    "f1-score": 1.0,
    "support": 136.0
  },
  "HTTP": {
    "precision": 1.0,
    "recall": 0.5,
    "f1-score": 0.6666666666666666,
    "support": 2.0
  },
  "HTTPS": {
    "precision": 0.9642857142857143,
    "recall": 1.0,
    "f1-score": 0.9818181818181818,
    "support": 27.0
  },
  "accuracy": 0.9939393939393939,
  "macro avg": {
    "precision": 0.9880952380952381,
    "recall": 0.8333333333333334,
    "f1-score": 0.8828282828282829,
    "support": 165.0
  },
  "weighted avg": {
    "precision": 0.9941558441558441,
    "recall": 0.9939393939393939,
    "f1-score": 0.9929843893480257,
    "support": 165.0
  }
}
2025-02-26 20:03:12,221 - INFO - Saved processed data locally to processed_data_20250226_200312.csv
2025-02-26 20:03:12,223 - INFO - JSON data size: 405153 bytes
2025-02-26 20:03:12,223 - INFO - Attempting to send data to 192.168.1.3:9000
2025-02-26 20:03:12,223 - ERROR - Connection refused to 192.168.1.3:9000. Is the receiving server running?
2025-02-26 20:03:12,223 - WARNING - Data processing completed but transmission failed
2025-02-26 20:03:12,224 - INFO - Waiting 30 seconds before retrying...
2025-02-26 20:03:15,598 - INFO - Process interrupted by user.
