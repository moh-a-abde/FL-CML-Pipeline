2025-02-27 23:04:35,862 - INFO - Starting livepreprocessing_socket.py
2025-02-27 23:04:35,862 - INFO - Starting data processing
2025-02-27 23:04:35,862 - INFO - This run will save data to: received/network_traffic_20250227_230435.csv
2025-02-27 23:04:35,862 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-27 23:04:35,864 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-27 23:04:35,864 - INFO - Probing node bootstrap-0 broker version
2025-02-27 23:04:35,864 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-27 23:04:35,966 - INFO - Broker version identified as 2.5.0
2025-02-27 23:04:35,966 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-27 23:04:35,966 - WARNING - group_id is None: disabling auto-commit.
2025-02-27 23:04:35,967 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-27 23:04:35,967 - INFO - Connected to Kafka. Waiting for messages...
2025-02-27 23:04:35,967 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-27 23:04:35,968 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-27 23:04:35,968 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-27 23:04:35,968 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-27 23:04:36,128 - INFO - Received 100 messages so far
2025-02-27 23:04:36,128 - INFO - Received 200 messages so far
2025-02-27 23:04:36,129 - INFO - Received 300 messages so far
2025-02-27 23:04:36,129 - INFO - Received 400 messages so far
2025-02-27 23:04:36,129 - INFO - Received 500 messages so far
2025-02-27 23:04:36,130 - INFO - Received 600 messages so far
2025-02-27 23:04:36,130 - INFO - Received 700 messages so far
2025-02-27 23:04:36,130 - INFO - Received 800 messages so far
2025-02-27 23:04:36,130 - INFO - Received 900 messages so far
2025-02-27 23:04:36,131 - INFO - Received 1000 messages so far
2025-02-27 23:04:36,131 - INFO - Received 1100 messages so far
2025-02-27 23:04:36,131 - INFO - Received 1200 messages so far
2025-02-27 23:04:36,131 - INFO - Received 1300 messages so far
2025-02-27 23:04:36,131 - INFO - Received 1400 messages so far
2025-02-27 23:04:36,132 - INFO - Received 1500 messages so far
2025-02-27 23:04:36,132 - INFO - Received 1600 messages so far
2025-02-27 23:04:36,132 - INFO - Received 1700 messages so far
2025-02-27 23:04:36,132 - INFO - Received 1800 messages so far
2025-02-27 23:04:36,132 - INFO - Received 1900 messages so far
2025-02-27 23:04:36,132 - INFO - Received 2000 messages so far
2025-02-27 23:04:36,133 - INFO - Received 2100 messages so far
2025-02-27 23:04:36,133 - INFO - Received 2200 messages so far
2025-02-27 23:04:36,133 - INFO - Received 2300 messages so far
2025-02-27 23:04:36,133 - INFO - Received 2400 messages so far
2025-02-27 23:04:36,133 - INFO - Received 2500 messages so far
2025-02-27 23:04:36,134 - INFO - Received 2600 messages so far
2025-02-27 23:04:36,134 - INFO - Received 2700 messages so far
2025-02-27 23:04:36,134 - INFO - Received 2800 messages so far
2025-02-27 23:04:36,134 - INFO - Received 2900 messages so far
2025-02-27 23:04:36,135 - INFO - Received 3000 messages so far
2025-02-27 23:04:36,135 - INFO - Received 3100 messages so far
2025-02-27 23:04:36,135 - INFO - Received 3200 messages so far
2025-02-27 23:04:36,135 - INFO - Received 3300 messages so far
2025-02-27 23:04:36,135 - INFO - Received 3400 messages so far
2025-02-27 23:04:36,136 - INFO - Received 3500 messages so far
2025-02-27 23:04:36,136 - INFO - Received 3600 messages so far
2025-02-27 23:04:36,136 - INFO - Received 3700 messages so far
2025-02-27 23:04:36,136 - INFO - Received 3800 messages so far
2025-02-27 23:04:36,136 - INFO - Received 3900 messages so far
2025-02-27 23:04:36,137 - INFO - Received 4000 messages so far
2025-02-27 23:04:36,137 - INFO - Received 4100 messages so far
2025-02-27 23:04:36,199 - INFO - Received 4200 messages so far
2025-02-27 23:04:36,199 - INFO - Received 4300 messages so far
2025-02-27 23:04:36,199 - INFO - Received 4400 messages so far
2025-02-27 23:04:36,199 - INFO - Received 4500 messages so far
2025-02-27 23:04:36,199 - INFO - Received 4600 messages so far
2025-02-27 23:04:36,200 - INFO - Received 4700 messages so far
2025-02-27 23:04:36,200 - INFO - Received 4800 messages so far
2025-02-27 23:04:36,201 - INFO - Received 4900 messages so far
2025-02-27 23:04:36,201 - INFO - Received 5000 messages so far
2025-02-27 23:04:36,201 - INFO - Received 5100 messages so far
2025-02-27 23:04:36,201 - INFO - Received 5200 messages so far
2025-02-27 23:04:36,201 - INFO - Received 5300 messages so far
2025-02-27 23:04:36,202 - INFO - Received 5400 messages so far
2025-02-27 23:04:36,202 - INFO - Received 5500 messages so far
2025-02-27 23:04:36,202 - INFO - Received 5600 messages so far
2025-02-27 23:04:36,202 - INFO - Received 5700 messages so far
2025-02-27 23:04:36,202 - INFO - Received 5800 messages so far
2025-02-27 23:04:36,203 - INFO - Received 5900 messages so far
2025-02-27 23:04:36,203 - INFO - Received 6000 messages so far
2025-02-27 23:04:36,203 - INFO - Received 6100 messages so far
2025-02-27 23:04:36,203 - INFO - Received 6200 messages so far
2025-02-27 23:04:36,203 - INFO - Received 6300 messages so far
2025-02-27 23:04:36,204 - INFO - Received 6400 messages so far
2025-02-27 23:04:36,204 - INFO - Received 6500 messages so far
2025-02-27 23:04:36,204 - INFO - Received 6600 messages so far
2025-02-27 23:04:36,204 - INFO - Received 6700 messages so far
2025-02-27 23:04:36,205 - INFO - Received 6800 messages so far
2025-02-27 23:04:36,205 - INFO - Received 6900 messages so far
2025-02-27 23:04:36,205 - INFO - Received 7000 messages so far
2025-02-27 23:04:36,205 - INFO - Received 7100 messages so far
2025-02-27 23:04:36,205 - INFO - Received 7200 messages so far
2025-02-27 23:04:36,206 - INFO - Received 7300 messages so far
2025-02-27 23:04:36,206 - INFO - Received 7400 messages so far
2025-02-27 23:04:36,206 - INFO - Received 7500 messages so far
2025-02-27 23:04:36,206 - INFO - Received 7600 messages so far
2025-02-27 23:04:36,207 - INFO - Received 7700 messages so far
2025-02-27 23:04:36,207 - INFO - Received 7800 messages so far
2025-02-27 23:04:36,207 - INFO - Received 7900 messages so far
2025-02-27 23:04:36,207 - INFO - Received 8000 messages so far
2025-02-27 23:04:36,207 - INFO - Received 8100 messages so far
2025-02-27 23:04:36,208 - INFO - Received 8200 messages so far
2025-02-27 23:04:36,208 - INFO - Received 8300 messages so far
2025-02-27 23:04:36,208 - INFO - Received 8400 messages so far
2025-02-27 23:04:36,208 - INFO - Received 8500 messages so far
2025-02-27 23:04:36,208 - INFO - Received 8600 messages so far
2025-02-27 23:04:36,209 - INFO - Received 8700 messages so far
2025-02-27 23:04:36,273 - INFO - Received 8800 messages so far
2025-02-27 23:04:36,273 - INFO - Received 8900 messages so far
2025-02-27 23:04:36,273 - INFO - Received 9000 messages so far
2025-02-27 23:04:36,274 - INFO - Received 9100 messages so far
2025-02-27 23:04:36,274 - INFO - Received 9200 messages so far
2025-02-27 23:04:36,274 - INFO - Received 9300 messages so far
2025-02-27 23:04:36,275 - INFO - Received 9400 messages so far
2025-02-27 23:04:36,275 - INFO - Received 9500 messages so far
2025-02-27 23:04:36,275 - INFO - Received 9600 messages so far
2025-02-27 23:04:36,275 - INFO - Received 9700 messages so far
2025-02-27 23:04:36,275 - INFO - Received 9800 messages so far
2025-02-27 23:04:36,276 - INFO - Received 9900 messages so far
2025-02-27 23:04:36,276 - INFO - Received 10000 messages so far
2025-02-27 23:04:36,276 - INFO - Total messages consumed: 10000
2025-02-27 23:04:36,370 - INFO - Messages converted to DataFrame successfully!
2025-02-27 23:04:36,374 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-27 23:04:36,374 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-27 23:04:36,374 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-27 23:04:36,374 - INFO - Dropping 71 columns out of 97 specified
2025-02-27 23:04:36,389 - INFO - DataFrame shape after cleaning: (10000, 91)
2025-02-27 23:04:36,389 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'ts_delta', 'acks', 'percent_lost', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'validation_status', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'extracted_cutoff']
2025-02-27 23:04:36,389 - INFO - Number of columns: 91
2025-02-27 23:04:36,405 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkts_proc  bytes_recv  pkts_dropped  pkts_link  pkt_lag  active_tcp_conns  active_udp_conns  active_icmp_conns  tcp_conns  udp_conns  icmp_conns  dns_requests  active_dns_requests  reassem_tcp_size  reassem_file_size  reassem_frag_size host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration  ts_delta  acks  percent_lost version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol validation_status  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus    thisUpdate    nextUpdate is_orig  seen_bytes  missing_bytes  overflow_bytes timedout extracted_cutoff
6162        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN                 NaN           NaN                                       NaN                                       NaN                                     NaN        NaN           NaN           NaN     NaN         NaN            NaN             NaN      NaN              NaN
5052        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN                 NaN           NaN                                       NaN                                       NaN                                     NaN        NaN           NaN           NaN     NaN         NaN            NaN             NaN      NaN              NaN
5151        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN                 NaN           NaN                                       NaN                                       NaN                                     NaN        NaN           NaN           NaN     NaN         NaN            NaN             NaN      NaN              NaN
7822        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  F003Tx4savkm8oAsl4          sha1  B34FFCEAC1CA8DBE13FD8B8738B023F3D896F3AC  FE09714055051044D8A48175B89E1AE94A0688C8  3301BB26198E9AAB912007A549000001BB2619       good  1.739676e+09  1.740368e+09     NaN         NaN            NaN             NaN      NaN              NaN
8377        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN                 NaN           NaN                                       NaN                                       NaN                                     NaN        NaN           NaN           NaN     NaN         NaN            NaN             NaN      NaN              NaN
2025-02-27 23:04:36,405 - INFO - DataFrame shape: (10000, 91)
2025-02-27 23:04:36,463 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts     pkts_proc    bytes_recv  pkts_dropped     pkts_link   pkt_lag  active_tcp_conns  active_udp_conns  active_icmp_conns   tcp_conns   udp_conns  icmp_conns  dns_requests  active_dns_requests  reassem_tcp_size  reassem_file_size  reassem_frag_size     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration    ts_delta         acks  percent_lost  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate  seen_bytes  missing_bytes  overflow_bytes
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03      7.000000  7.000000e+00           7.0      7.000000  7.000000          7.000000          7.000000           7.000000    7.000000    7.000000    7.000000           7.0                  7.0          7.000000                7.0                7.0   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000    3.000000     3.000000      3.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00         4.0            4.0             4.0
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  48173.000000  3.291629e+07           0.0  48172.142857  0.002835          9.714286          5.428571           0.428571   80.857143   54.285714    2.142857           0.0                  0.0        141.000000                0.0                0.0  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712  620.026357   885.666667      2.491723          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09      1858.0            0.0             0.0
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  24894.946743  1.861603e+07           0.0  24894.248475  0.004274          5.250850          2.992053           0.534522   89.657550   32.612443    3.132016           0.0                  0.0        320.150485                0.0                0.0  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772  484.994635   964.336214      4.315791          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04         0.0            0.0             0.0
min        0.000000  0.000000e+00       0.000000  1.740118e+09      1.000000  6.000000e+01           0.0      0.000000  0.000000          1.000000          0.000000           0.000000    1.000000    0.000000    0.000000           0.0                  0.0          0.000000                0.0                0.0     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000   60.002792     0.000000      0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09      1858.0            0.0             0.0
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  40765.000000  2.579216e+07           0.0  40765.500000  0.000867          9.000000          5.000000           0.000000   16.500000   47.500000    0.500000           0.0                  0.0          0.000000                0.0                0.0  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527  480.002466   372.000000      0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09      1858.0            0.0             0.0
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  55994.000000  3.660305e+07           0.0  55992.000000  0.001849          9.000000          5.000000           0.000000   55.000000   50.000000    1.000000           0.0                  0.0          0.000000                0.0                0.0  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381  900.002140   744.000000      0.000000          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09      1858.0            0.0             0.0
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  63324.000000  4.479299e+07           0.0  63322.000000  0.001973         10.500000          6.500000           1.000000  128.500000   63.500000    2.000000           0.0                  0.0         61.500000                0.0                0.0  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678  900.038139  1328.500000      3.737585          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09      1858.0            0.0             0.0
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  73038.000000  5.264059e+07           0.0  73038.000000  0.012315         19.000000         10.000000           1.000000  220.000000  108.000000    9.000000           0.0                  0.0        864.000000                0.0                0.0  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649  900.074139  1913.000000      7.475170          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09      1858.0            0.0             0.0
2025-02-27 23:04:36,514 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol validation_status method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus is_orig timedout extracted_cutoff
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5                 5      7   7           7    7                   4             4                                         4                                         4                                       4          4       4        4                4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1                 1      1   1           1    1                   4             1                                         2                                         2                                       2          1       1        1                1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    2fe788e3cc713726              efe788e3cc713726  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2                ok    GET   /  No Content   []  F003Tx4savkm8oAsl4          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good   False    False            False
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5                 5      7   7           7    7                   1             4                                         3                                         3                                       3          4       4        4                4
2025-02-27 23:04:36,515 - INFO - Dropping 36 columns out of 73 specified in second drop
2025-02-27 23:04:36,533 - INFO - DataFrame shape after NA dropping: (5843, 55)
2025-02-27 23:04:36,533 - INFO - Total processed data shape: (5843, 55)
2025-02-27 23:04:36,642 - INFO - Saved all processed data to received/network_traffic_20250227_230435.csv
2025-02-27 23:04:36,680 - INFO - JSON data size: 6872654 bytes
2025-02-27 23:04:36,681 - INFO - Preparing to send 6.55 MB of data to 192.168.1.3:9000
2025-02-27 23:04:36,681 - INFO - Socket send buffer size set to: 0.41 MB
2025-02-27 23:04:36,681 - INFO - Socket timeout set to 30 seconds
2025-02-27 23:04:36,681 - INFO - Connected successfully, starting data transmission
2025-02-27 23:04:36,689 - INFO - Data transmission completed. Total sent: 6.55MB
2025-02-27 23:04:36,689 - INFO - Data processing and transmission completed successfully
2025-02-27 23:04:36,693 - INFO - Data processing completed successfully. Exiting.
2025-02-27 23:09:18,182 - INFO - Starting livepreprocessing_socket.py
2025-02-27 23:09:18,182 - INFO - Starting data processing
2025-02-27 23:09:18,182 - INFO - This run will save data to: received/network_traffic_20250227_230918.csv
2025-02-27 23:09:18,182 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-27 23:09:18,184 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-27 23:09:18,184 - INFO - Probing node bootstrap-0 broker version
2025-02-27 23:09:18,184 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-27 23:09:18,286 - INFO - Broker version identified as 2.5.0
2025-02-27 23:09:18,286 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-27 23:09:18,286 - WARNING - group_id is None: disabling auto-commit.
2025-02-27 23:09:18,286 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-27 23:09:18,286 - INFO - Connected to Kafka. Waiting for messages...
2025-02-27 23:09:18,287 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-27 23:09:18,287 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-27 23:09:18,287 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-27 23:09:18,288 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-27 23:09:18,445 - INFO - Received 100 messages so far
2025-02-27 23:09:18,446 - INFO - Received 200 messages so far
2025-02-27 23:09:18,446 - INFO - Received 300 messages so far
2025-02-27 23:09:18,446 - INFO - Received 400 messages so far
2025-02-27 23:09:18,446 - INFO - Received 500 messages so far
2025-02-27 23:09:18,447 - INFO - Received 600 messages so far
2025-02-27 23:09:18,447 - INFO - Received 700 messages so far
2025-02-27 23:09:18,447 - INFO - Received 800 messages so far
2025-02-27 23:09:18,448 - INFO - Received 900 messages so far
2025-02-27 23:09:18,448 - INFO - Received 1000 messages so far
2025-02-27 23:09:18,448 - INFO - Received 1100 messages so far
2025-02-27 23:09:18,448 - INFO - Received 1200 messages so far
2025-02-27 23:09:18,448 - INFO - Received 1300 messages so far
2025-02-27 23:09:18,449 - INFO - Received 1400 messages so far
2025-02-27 23:09:18,449 - INFO - Received 1500 messages so far
2025-02-27 23:09:18,449 - INFO - Received 1600 messages so far
2025-02-27 23:09:18,449 - INFO - Received 1700 messages so far
2025-02-27 23:09:18,449 - INFO - Received 1800 messages so far
2025-02-27 23:09:18,450 - INFO - Received 1900 messages so far
2025-02-27 23:09:18,450 - INFO - Received 2000 messages so far
2025-02-27 23:09:18,450 - INFO - Received 2100 messages so far
2025-02-27 23:09:18,450 - INFO - Received 2200 messages so far
2025-02-27 23:09:18,450 - INFO - Received 2300 messages so far
2025-02-27 23:09:18,451 - INFO - Received 2400 messages so far
2025-02-27 23:09:18,451 - INFO - Received 2500 messages so far
2025-02-27 23:09:18,451 - INFO - Received 2600 messages so far
2025-02-27 23:09:18,451 - INFO - Received 2700 messages so far
2025-02-27 23:09:18,451 - INFO - Received 2800 messages so far
2025-02-27 23:09:18,452 - INFO - Received 2900 messages so far
2025-02-27 23:09:18,452 - INFO - Received 3000 messages so far
2025-02-27 23:09:18,452 - INFO - Received 3100 messages so far
2025-02-27 23:09:18,452 - INFO - Received 3200 messages so far
2025-02-27 23:09:18,452 - INFO - Received 3300 messages so far
2025-02-27 23:09:18,453 - INFO - Received 3400 messages so far
2025-02-27 23:09:18,453 - INFO - Received 3500 messages so far
2025-02-27 23:09:18,453 - INFO - Received 3600 messages so far
2025-02-27 23:09:18,453 - INFO - Received 3700 messages so far
2025-02-27 23:09:18,454 - INFO - Received 3800 messages so far
2025-02-27 23:09:18,454 - INFO - Received 3900 messages so far
2025-02-27 23:09:18,454 - INFO - Received 4000 messages so far
2025-02-27 23:09:18,454 - INFO - Received 4100 messages so far
2025-02-27 23:09:18,513 - INFO - Received 4200 messages so far
2025-02-27 23:09:18,513 - INFO - Received 4300 messages so far
2025-02-27 23:09:18,514 - INFO - Received 4400 messages so far
2025-02-27 23:09:18,514 - INFO - Received 4500 messages so far
2025-02-27 23:09:18,514 - INFO - Received 4600 messages so far
2025-02-27 23:09:18,515 - INFO - Received 4700 messages so far
2025-02-27 23:09:18,515 - INFO - Received 4800 messages so far
2025-02-27 23:09:18,515 - INFO - Received 4900 messages so far
2025-02-27 23:09:18,515 - INFO - Received 5000 messages so far
2025-02-27 23:09:18,515 - INFO - Received 5100 messages so far
2025-02-27 23:09:18,516 - INFO - Received 5200 messages so far
2025-02-27 23:09:18,516 - INFO - Received 5300 messages so far
2025-02-27 23:09:18,516 - INFO - Received 5400 messages so far
2025-02-27 23:09:18,516 - INFO - Received 5500 messages so far
2025-02-27 23:09:18,516 - INFO - Received 5600 messages so far
2025-02-27 23:09:18,517 - INFO - Received 5700 messages so far
2025-02-27 23:09:18,517 - INFO - Received 5800 messages so far
2025-02-27 23:09:18,517 - INFO - Received 5900 messages so far
2025-02-27 23:09:18,517 - INFO - Received 6000 messages so far
2025-02-27 23:09:18,517 - INFO - Received 6100 messages so far
2025-02-27 23:09:18,518 - INFO - Received 6200 messages so far
2025-02-27 23:09:18,518 - INFO - Received 6300 messages so far
2025-02-27 23:09:18,518 - INFO - Received 6400 messages so far
2025-02-27 23:09:18,518 - INFO - Received 6500 messages so far
2025-02-27 23:09:18,518 - INFO - Received 6600 messages so far
2025-02-27 23:09:18,519 - INFO - Received 6700 messages so far
2025-02-27 23:09:18,519 - INFO - Received 6800 messages so far
2025-02-27 23:09:18,519 - INFO - Received 6900 messages so far
2025-02-27 23:09:18,519 - INFO - Received 7000 messages so far
2025-02-27 23:09:18,519 - INFO - Received 7100 messages so far
2025-02-27 23:09:18,520 - INFO - Received 7200 messages so far
2025-02-27 23:09:18,520 - INFO - Received 7300 messages so far
2025-02-27 23:09:18,520 - INFO - Received 7400 messages so far
2025-02-27 23:09:18,520 - INFO - Received 7500 messages so far
2025-02-27 23:09:18,520 - INFO - Received 7600 messages so far
2025-02-27 23:09:18,521 - INFO - Received 7700 messages so far
2025-02-27 23:09:18,521 - INFO - Received 7800 messages so far
2025-02-27 23:09:18,521 - INFO - Received 7900 messages so far
2025-02-27 23:09:18,521 - INFO - Received 8000 messages so far
2025-02-27 23:09:18,521 - INFO - Received 8100 messages so far
2025-02-27 23:09:18,522 - INFO - Received 8200 messages so far
2025-02-27 23:09:18,522 - INFO - Received 8300 messages so far
2025-02-27 23:09:18,522 - INFO - Received 8400 messages so far
2025-02-27 23:09:18,522 - INFO - Received 8500 messages so far
2025-02-27 23:09:18,522 - INFO - Received 8600 messages so far
2025-02-27 23:09:18,523 - INFO - Received 8700 messages so far
2025-02-27 23:09:18,584 - INFO - Received 8800 messages so far
2025-02-27 23:09:18,585 - INFO - Received 8900 messages so far
2025-02-27 23:09:18,585 - INFO - Received 9000 messages so far
2025-02-27 23:09:18,585 - INFO - Received 9100 messages so far
2025-02-27 23:09:18,585 - INFO - Received 9200 messages so far
2025-02-27 23:09:18,586 - INFO - Received 9300 messages so far
2025-02-27 23:09:18,586 - INFO - Received 9400 messages so far
2025-02-27 23:09:18,586 - INFO - Received 9500 messages so far
2025-02-27 23:09:18,586 - INFO - Received 9600 messages so far
2025-02-27 23:09:18,586 - INFO - Received 9700 messages so far
2025-02-27 23:09:18,587 - INFO - Received 9800 messages so far
2025-02-27 23:09:18,587 - INFO - Received 9900 messages so far
2025-02-27 23:09:18,587 - INFO - Received 10000 messages so far
2025-02-27 23:09:18,587 - INFO - Total messages consumed: 10000
2025-02-27 23:09:18,677 - INFO - Messages converted to DataFrame successfully!
2025-02-27 23:09:18,680 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-27 23:09:18,680 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-27 23:09:18,680 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-27 23:09:18,681 - INFO - Dropping 71 columns out of 97 specified
2025-02-27 23:09:18,694 - INFO - DataFrame shape after cleaning: (10000, 91)
2025-02-27 23:09:18,694 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'ts_delta', 'acks', 'percent_lost', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'validation_status', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'extracted_cutoff']
2025-02-27 23:09:18,694 - INFO - Number of columns: 91
2025-02-27 23:09:18,709 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkts_proc  bytes_recv  pkts_dropped  pkts_link  pkt_lag  active_tcp_conns  active_udp_conns  active_icmp_conns  tcp_conns  udp_conns  icmp_conns  dns_requests  active_dns_requests  reassem_tcp_size  reassem_file_size  reassem_frag_size host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration  ts_delta  acks  percent_lost version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol validation_status  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate is_orig  seen_bytes  missing_bytes  overflow_bytes timedout extracted_cutoff
5407        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
5829        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.013497       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
3163        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
4010        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
4615        NaN       NaN       NaN   NaN         NaN         NaN  1.740119e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
2025-02-27 23:09:18,709 - INFO - DataFrame shape: (10000, 91)
2025-02-27 23:09:18,765 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts     pkts_proc    bytes_recv  pkts_dropped     pkts_link   pkt_lag  active_tcp_conns  active_udp_conns  active_icmp_conns   tcp_conns   udp_conns  icmp_conns  dns_requests  active_dns_requests  reassem_tcp_size  reassem_file_size  reassem_frag_size     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration    ts_delta         acks  percent_lost  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate  seen_bytes  missing_bytes  overflow_bytes
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03      7.000000  7.000000e+00           7.0      7.000000  7.000000          7.000000          7.000000           7.000000    7.000000    7.000000    7.000000           7.0                  7.0          7.000000                7.0                7.0   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000    3.000000     3.000000      3.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00         4.0            4.0             4.0
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  48173.000000  3.291629e+07           0.0  48172.142857  0.002835          9.714286          5.428571           0.428571   80.857143   54.285714    2.142857           0.0                  0.0        141.000000                0.0                0.0  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712  620.026357   885.666667      2.491723          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09      1858.0            0.0             0.0
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  24894.946743  1.861603e+07           0.0  24894.248475  0.004274          5.250850          2.992053           0.534522   89.657550   32.612443    3.132016           0.0                  0.0        320.150485                0.0                0.0  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772  484.994635   964.336214      4.315791          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04         0.0            0.0             0.0
min        0.000000  0.000000e+00       0.000000  1.740118e+09      1.000000  6.000000e+01           0.0      0.000000  0.000000          1.000000          0.000000           0.000000    1.000000    0.000000    0.000000           0.0                  0.0          0.000000                0.0                0.0     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000   60.002792     0.000000      0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09      1858.0            0.0             0.0
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  40765.000000  2.579216e+07           0.0  40765.500000  0.000867          9.000000          5.000000           0.000000   16.500000   47.500000    0.500000           0.0                  0.0          0.000000                0.0                0.0  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527  480.002466   372.000000      0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09      1858.0            0.0             0.0
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  55994.000000  3.660305e+07           0.0  55992.000000  0.001849          9.000000          5.000000           0.000000   55.000000   50.000000    1.000000           0.0                  0.0          0.000000                0.0                0.0  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381  900.002140   744.000000      0.000000          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09      1858.0            0.0             0.0
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  63324.000000  4.479299e+07           0.0  63322.000000  0.001973         10.500000          6.500000           1.000000  128.500000   63.500000    2.000000           0.0                  0.0         61.500000                0.0                0.0  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678  900.038139  1328.500000      3.737585          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09      1858.0            0.0             0.0
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  73038.000000  5.264059e+07           0.0  73038.000000  0.012315         19.000000         10.000000           1.000000  220.000000  108.000000    9.000000           0.0                  0.0        864.000000                0.0                0.0  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649  900.074139  1913.000000      7.475170          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09      1858.0            0.0             0.0
2025-02-27 23:09:18,817 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol validation_status method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus is_orig timedout extracted_cutoff
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5                 5      7   7           7    7                   4             4                                         4                                         4                                       4          4       4        4                4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1                 1      1   1           1    1                   4             1                                         2                                         2                                       2          1       1        1                1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    a0e26dda6c2cf717              e0e26dda6c2cf717  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2                ok    GET   /  No Content   []  F0lnXh4fEMRMxatKR2          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good   False    False            False
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5                 5      7   7           7    7                   1             4                                         3                                         3                                       3          4       4        4                4
2025-02-27 23:09:18,819 - INFO - Dropping 36 columns out of 73 specified in second drop
2025-02-27 23:09:18,835 - INFO - DataFrame shape after NA dropping: (1580, 55)
2025-02-27 23:09:18,835 - INFO - Total processed data shape: (1580, 55)
2025-02-27 23:09:18,865 - INFO - Saved all processed data to received/network_traffic_20250227_230918.csv
2025-02-27 23:09:18,874 - INFO - JSON data size: 1830064 bytes
2025-02-27 23:09:18,874 - INFO - Preparing to send 1.75 MB of data to 192.168.1.3:9000
2025-02-27 23:09:18,874 - INFO - Socket send buffer size set to: 0.41 MB
2025-02-27 23:09:18,874 - INFO - Socket timeout set to 30 seconds
2025-02-27 23:09:18,874 - INFO - Connected successfully, starting data transmission
2025-02-27 23:09:18,876 - INFO - Data transmission completed. Total sent: 1.75MB
2025-02-27 23:09:18,876 - INFO - Data processing and transmission completed successfully
2025-02-27 23:09:18,877 - INFO - Data processing completed successfully. Exiting.
2025-02-27 23:33:00,474 - INFO - Starting livepreprocessing_socket.py
2025-02-27 23:33:00,474 - INFO - Starting data processing
2025-02-27 23:33:00,474 - INFO - This run will save data to: received/network_traffic_20250227_233300.csv
2025-02-27 23:33:00,474 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-27 23:33:00,476 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-27 23:33:00,476 - INFO - Probing node bootstrap-0 broker version
2025-02-27 23:33:00,476 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-27 23:33:00,578 - INFO - Broker version identified as 2.5.0
2025-02-27 23:33:00,578 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-27 23:33:00,578 - WARNING - group_id is None: disabling auto-commit.
2025-02-27 23:33:00,578 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-27 23:33:00,578 - INFO - Connected to Kafka. Waiting for messages...
2025-02-27 23:33:00,579 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-27 23:33:00,579 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-27 23:33:00,579 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-27 23:33:00,580 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-27 23:33:00,738 - INFO - Received 100 messages so far
2025-02-27 23:33:00,739 - INFO - Received 200 messages so far
2025-02-27 23:33:00,739 - INFO - Received 300 messages so far
2025-02-27 23:33:00,739 - INFO - Received 400 messages so far
2025-02-27 23:33:00,739 - INFO - Received 500 messages so far
2025-02-27 23:33:00,740 - INFO - Received 600 messages so far
2025-02-27 23:33:00,740 - INFO - Received 700 messages so far
2025-02-27 23:33:00,740 - INFO - Received 800 messages so far
2025-02-27 23:33:00,740 - INFO - Received 900 messages so far
2025-02-27 23:33:00,741 - INFO - Received 1000 messages so far
2025-02-27 23:33:00,741 - INFO - Received 1100 messages so far
2025-02-27 23:33:00,741 - INFO - Received 1200 messages so far
2025-02-27 23:33:00,741 - INFO - Received 1300 messages so far
2025-02-27 23:33:00,741 - INFO - Received 1400 messages so far
2025-02-27 23:33:00,742 - INFO - Received 1500 messages so far
2025-02-27 23:33:00,742 - INFO - Received 1600 messages so far
2025-02-27 23:33:00,742 - INFO - Received 1700 messages so far
2025-02-27 23:33:00,742 - INFO - Received 1800 messages so far
2025-02-27 23:33:00,742 - INFO - Received 1900 messages so far
2025-02-27 23:33:00,743 - INFO - Received 2000 messages so far
2025-02-27 23:33:00,743 - INFO - Received 2100 messages so far
2025-02-27 23:33:00,743 - INFO - Received 2200 messages so far
2025-02-27 23:33:00,743 - INFO - Received 2300 messages so far
2025-02-27 23:33:00,743 - INFO - Received 2400 messages so far
2025-02-27 23:33:00,744 - INFO - Received 2500 messages so far
2025-02-27 23:33:00,744 - INFO - Received 2600 messages so far
2025-02-27 23:33:00,744 - INFO - Received 2700 messages so far
2025-02-27 23:33:00,744 - INFO - Received 2800 messages so far
2025-02-27 23:33:00,744 - INFO - Received 2900 messages so far
2025-02-27 23:33:00,744 - INFO - Received 3000 messages so far
2025-02-27 23:33:00,745 - INFO - Received 3100 messages so far
2025-02-27 23:33:00,745 - INFO - Received 3200 messages so far
2025-02-27 23:33:00,745 - INFO - Received 3300 messages so far
2025-02-27 23:33:00,745 - INFO - Received 3400 messages so far
2025-02-27 23:33:00,745 - INFO - Received 3500 messages so far
2025-02-27 23:33:00,746 - INFO - Received 3600 messages so far
2025-02-27 23:33:00,746 - INFO - Received 3700 messages so far
2025-02-27 23:33:00,746 - INFO - Received 3800 messages so far
2025-02-27 23:33:00,746 - INFO - Received 3900 messages so far
2025-02-27 23:33:00,746 - INFO - Received 4000 messages so far
2025-02-27 23:33:00,747 - INFO - Received 4100 messages so far
2025-02-27 23:33:00,807 - INFO - Received 4200 messages so far
2025-02-27 23:33:00,807 - INFO - Received 4300 messages so far
2025-02-27 23:33:00,807 - INFO - Received 4400 messages so far
2025-02-27 23:33:00,807 - INFO - Received 4500 messages so far
2025-02-27 23:33:00,808 - INFO - Received 4600 messages so far
2025-02-27 23:33:00,808 - INFO - Received 4700 messages so far
2025-02-27 23:33:00,808 - INFO - Received 4800 messages so far
2025-02-27 23:33:00,809 - INFO - Received 4900 messages so far
2025-02-27 23:33:00,809 - INFO - Received 5000 messages so far
2025-02-27 23:33:00,809 - INFO - Received 5100 messages so far
2025-02-27 23:33:00,809 - INFO - Received 5200 messages so far
2025-02-27 23:33:00,809 - INFO - Received 5300 messages so far
2025-02-27 23:33:00,810 - INFO - Received 5400 messages so far
2025-02-27 23:33:00,810 - INFO - Received 5500 messages so far
2025-02-27 23:33:00,810 - INFO - Received 5600 messages so far
2025-02-27 23:33:00,810 - INFO - Received 5700 messages so far
2025-02-27 23:33:00,810 - INFO - Received 5800 messages so far
2025-02-27 23:33:00,811 - INFO - Received 5900 messages so far
2025-02-27 23:33:00,811 - INFO - Received 6000 messages so far
2025-02-27 23:33:00,811 - INFO - Received 6100 messages so far
2025-02-27 23:33:00,811 - INFO - Received 6200 messages so far
2025-02-27 23:33:00,811 - INFO - Received 6300 messages so far
2025-02-27 23:33:00,812 - INFO - Received 6400 messages so far
2025-02-27 23:33:00,812 - INFO - Received 6500 messages so far
2025-02-27 23:33:00,812 - INFO - Received 6600 messages so far
2025-02-27 23:33:00,812 - INFO - Received 6700 messages so far
2025-02-27 23:33:00,812 - INFO - Received 6800 messages so far
2025-02-27 23:33:00,813 - INFO - Received 6900 messages so far
2025-02-27 23:33:00,813 - INFO - Received 7000 messages so far
2025-02-27 23:33:00,813 - INFO - Received 7100 messages so far
2025-02-27 23:33:00,813 - INFO - Received 7200 messages so far
2025-02-27 23:33:00,813 - INFO - Received 7300 messages so far
2025-02-27 23:33:00,814 - INFO - Received 7400 messages so far
2025-02-27 23:33:00,814 - INFO - Received 7500 messages so far
2025-02-27 23:33:00,814 - INFO - Received 7600 messages so far
2025-02-27 23:33:00,814 - INFO - Received 7700 messages so far
2025-02-27 23:33:00,814 - INFO - Received 7800 messages so far
2025-02-27 23:33:00,815 - INFO - Received 7900 messages so far
2025-02-27 23:33:00,815 - INFO - Received 8000 messages so far
2025-02-27 23:33:00,815 - INFO - Received 8100 messages so far
2025-02-27 23:33:00,815 - INFO - Received 8200 messages so far
2025-02-27 23:33:00,815 - INFO - Received 8300 messages so far
2025-02-27 23:33:00,816 - INFO - Received 8400 messages so far
2025-02-27 23:33:00,816 - INFO - Received 8500 messages so far
2025-02-27 23:33:00,816 - INFO - Received 8600 messages so far
2025-02-27 23:33:00,816 - INFO - Received 8700 messages so far
2025-02-27 23:33:00,879 - INFO - Received 8800 messages so far
2025-02-27 23:33:00,879 - INFO - Received 8900 messages so far
2025-02-27 23:33:00,879 - INFO - Received 9000 messages so far
2025-02-27 23:33:00,880 - INFO - Received 9100 messages so far
2025-02-27 23:33:00,880 - INFO - Received 9200 messages so far
2025-02-27 23:33:00,880 - INFO - Received 9300 messages so far
2025-02-27 23:33:00,881 - INFO - Received 9400 messages so far
2025-02-27 23:33:00,881 - INFO - Received 9500 messages so far
2025-02-27 23:33:00,881 - INFO - Received 9600 messages so far
2025-02-27 23:33:00,881 - INFO - Received 9700 messages so far
2025-02-27 23:33:00,881 - INFO - Received 9800 messages so far
2025-02-27 23:33:00,882 - INFO - Received 9900 messages so far
2025-02-27 23:33:00,882 - INFO - Received 10000 messages so far
2025-02-27 23:33:00,882 - INFO - Total messages consumed: 10000
2025-02-27 23:33:00,975 - INFO - Messages converted to DataFrame successfully!
2025-02-27 23:33:00,979 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-27 23:33:00,979 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-27 23:33:00,979 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-27 23:33:00,979 - INFO - Dropping 71 columns out of 97 specified
2025-02-27 23:33:00,992 - INFO - DataFrame shape after cleaning: (10000, 91)
2025-02-27 23:33:00,993 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'ts_delta', 'acks', 'percent_lost', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'validation_status', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'extracted_cutoff']
2025-02-27 23:33:00,993 - INFO - Number of columns: 91
2025-02-27 23:33:01,009 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkts_proc  bytes_recv  pkts_dropped  pkts_link  pkt_lag  active_tcp_conns  active_udp_conns  active_icmp_conns  tcp_conns  udp_conns  icmp_conns  dns_requests  active_dns_requests  reassem_tcp_size  reassem_file_size  reassem_frag_size host service                 uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration  ts_delta  acks  percent_lost version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol validation_status  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate is_orig  seen_bytes  missing_bytes  overflow_bytes timedout extracted_cutoff
2160     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740118e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  CvSfla1wmtSzOu3Xxh    51302.0  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000153       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
7835        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.020511       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
6283        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
1041        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
9800        NaN          NaN          NaN   NaN         NaN         NaN  1.740120e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN                 NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
2025-02-27 23:33:01,009 - INFO - DataFrame shape: (10000, 91)
2025-02-27 23:33:01,064 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts     pkts_proc    bytes_recv  pkts_dropped     pkts_link   pkt_lag  active_tcp_conns  active_udp_conns  active_icmp_conns   tcp_conns   udp_conns  icmp_conns  dns_requests  active_dns_requests  reassem_tcp_size  reassem_file_size  reassem_frag_size     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration    ts_delta         acks  percent_lost  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate  seen_bytes  missing_bytes  overflow_bytes
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03      7.000000  7.000000e+00           7.0      7.000000  7.000000          7.000000          7.000000           7.000000    7.000000    7.000000    7.000000           7.0                  7.0          7.000000                7.0                7.0   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000    3.000000     3.000000      3.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00         4.0            4.0             4.0
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  48173.000000  3.291629e+07           0.0  48172.142857  0.002835          9.714286          5.428571           0.428571   80.857143   54.285714    2.142857           0.0                  0.0        141.000000                0.0                0.0  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712  620.026357   885.666667      2.491723          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09      1858.0            0.0             0.0
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  24894.946743  1.861603e+07           0.0  24894.248475  0.004274          5.250850          2.992053           0.534522   89.657550   32.612443    3.132016           0.0                  0.0        320.150485                0.0                0.0  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772  484.994635   964.336214      4.315791          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04         0.0            0.0             0.0
min        0.000000  0.000000e+00       0.000000  1.740118e+09      1.000000  6.000000e+01           0.0      0.000000  0.000000          1.000000          0.000000           0.000000    1.000000    0.000000    0.000000           0.0                  0.0          0.000000                0.0                0.0     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000   60.002792     0.000000      0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09      1858.0            0.0             0.0
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  40765.000000  2.579216e+07           0.0  40765.500000  0.000867          9.000000          5.000000           0.000000   16.500000   47.500000    0.500000           0.0                  0.0          0.000000                0.0                0.0  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527  480.002466   372.000000      0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09      1858.0            0.0             0.0
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  55994.000000  3.660305e+07           0.0  55992.000000  0.001849          9.000000          5.000000           0.000000   55.000000   50.000000    1.000000           0.0                  0.0          0.000000                0.0                0.0  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381  900.002140   744.000000      0.000000          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09      1858.0            0.0             0.0
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  63324.000000  4.479299e+07           0.0  63322.000000  0.001973         10.500000          6.500000           1.000000  128.500000   63.500000    2.000000           0.0                  0.0         61.500000                0.0                0.0  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678  900.038139  1328.500000      3.737585          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09      1858.0            0.0             0.0
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  73038.000000  5.264059e+07           0.0  73038.000000  0.012315         19.000000         10.000000           1.000000  220.000000  108.000000    9.000000           0.0                  0.0        864.000000                0.0                0.0  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649  900.074139  1913.000000      7.475170          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09      1858.0            0.0             0.0
2025-02-27 23:33:01,114 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol validation_status method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus is_orig timedout extracted_cutoff
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5                 5      7   7           7    7                   4             4                                         4                                         4                                       4          4       4        4                4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1                 1      1   1           1    1                   4             1                                         2                                         2                                       2          1       1        1                1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    56c8fcf4a1052fc6              f6c8fcf4a1052fc6  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2                ok    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good   False    False            False
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5                 5      7   7           7    7                   1             4                                         3                                         3                                       3          4       4        4                4
2025-02-27 23:33:01,115 - INFO - Dropping 36 columns out of 73 specified in second drop
2025-02-27 23:33:01,132 - INFO - DataFrame shape after NA dropping: (6029, 55)
2025-02-27 23:33:01,132 - INFO - Total processed data shape: (6029, 55)
2025-02-27 23:33:01,240 - INFO - Saved all processed data to received/network_traffic_20250227_233300.csv
2025-02-27 23:33:01,277 - INFO - JSON data size: 7086029 bytes
2025-02-27 23:33:01,277 - INFO - Preparing to send 6.76 MB of data to 192.168.1.3:9000
2025-02-27 23:33:01,277 - INFO - Socket send buffer size set to: 0.41 MB
2025-02-27 23:33:01,277 - INFO - Socket timeout set to 30 seconds
2025-02-27 23:33:01,278 - INFO - Connected successfully, starting data transmission
2025-02-27 23:33:01,281 - INFO - Data transmission completed. Total sent: 6.76MB
2025-02-27 23:33:01,281 - INFO - Data processing and transmission completed successfully
2025-02-27 23:33:01,284 - INFO - Data processing completed successfully. Exiting.
2025-02-27 23:48:02,624 - INFO - Starting livepreprocessing_socket.py
2025-02-27 23:48:02,624 - INFO - Starting data processing
2025-02-27 23:48:02,625 - INFO - This run will save data to: received/network_traffic_20250227_234802.csv
2025-02-27 23:48:02,625 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-27 23:48:02,626 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-27 23:48:02,626 - INFO - Probing node bootstrap-0 broker version
2025-02-27 23:48:02,626 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-27 23:48:02,728 - INFO - Broker version identified as 2.5.0
2025-02-27 23:48:02,728 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-27 23:48:02,729 - WARNING - group_id is None: disabling auto-commit.
2025-02-27 23:48:02,729 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-27 23:48:02,729 - INFO - Connected to Kafka. Waiting for messages...
2025-02-27 23:48:02,730 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-27 23:48:02,730 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-27 23:48:02,730 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-27 23:48:02,731 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-27 23:48:02,888 - INFO - Received 100 messages so far
2025-02-27 23:48:02,888 - INFO - Received 200 messages so far
2025-02-27 23:48:02,889 - INFO - Received 300 messages so far
2025-02-27 23:48:02,889 - INFO - Received 400 messages so far
2025-02-27 23:48:02,889 - INFO - Received 500 messages so far
2025-02-27 23:48:02,890 - INFO - Received 600 messages so far
2025-02-27 23:48:02,890 - INFO - Received 700 messages so far
2025-02-27 23:48:02,890 - INFO - Received 800 messages so far
2025-02-27 23:48:02,890 - INFO - Received 900 messages so far
2025-02-27 23:48:02,890 - INFO - Received 1000 messages so far
2025-02-27 23:48:02,891 - INFO - Received 1100 messages so far
2025-02-27 23:48:02,891 - INFO - Received 1200 messages so far
2025-02-27 23:48:02,891 - INFO - Received 1300 messages so far
2025-02-27 23:48:02,891 - INFO - Received 1400 messages so far
2025-02-27 23:48:02,891 - INFO - Received 1500 messages so far
2025-02-27 23:48:02,892 - INFO - Received 1600 messages so far
2025-02-27 23:48:02,892 - INFO - Received 1700 messages so far
2025-02-27 23:48:02,892 - INFO - Received 1800 messages so far
2025-02-27 23:48:02,892 - INFO - Received 1900 messages so far
2025-02-27 23:48:02,892 - INFO - Received 2000 messages so far
2025-02-27 23:48:02,893 - INFO - Received 2100 messages so far
2025-02-27 23:48:02,893 - INFO - Received 2200 messages so far
2025-02-27 23:48:02,893 - INFO - Received 2300 messages so far
2025-02-27 23:48:02,893 - INFO - Received 2400 messages so far
2025-02-27 23:48:02,893 - INFO - Received 2500 messages so far
2025-02-27 23:48:02,894 - INFO - Received 2600 messages so far
2025-02-27 23:48:02,894 - INFO - Received 2700 messages so far
2025-02-27 23:48:02,894 - INFO - Received 2800 messages so far
2025-02-27 23:48:02,894 - INFO - Received 2900 messages so far
2025-02-27 23:48:02,894 - INFO - Received 3000 messages so far
2025-02-27 23:48:02,895 - INFO - Received 3100 messages so far
2025-02-27 23:48:02,895 - INFO - Received 3200 messages so far
2025-02-27 23:48:02,895 - INFO - Received 3300 messages so far
2025-02-27 23:48:02,895 - INFO - Received 3400 messages so far
2025-02-27 23:48:02,895 - INFO - Received 3500 messages so far
2025-02-27 23:48:02,896 - INFO - Received 3600 messages so far
2025-02-27 23:48:02,896 - INFO - Received 3700 messages so far
2025-02-27 23:48:02,896 - INFO - Received 3800 messages so far
2025-02-27 23:48:02,896 - INFO - Received 3900 messages so far
2025-02-27 23:48:02,896 - INFO - Received 4000 messages so far
2025-02-27 23:48:02,897 - INFO - Received 4100 messages so far
2025-02-27 23:48:02,955 - INFO - Received 4200 messages so far
2025-02-27 23:48:02,955 - INFO - Received 4300 messages so far
2025-02-27 23:48:02,955 - INFO - Received 4400 messages so far
2025-02-27 23:48:02,956 - INFO - Received 4500 messages so far
2025-02-27 23:48:02,956 - INFO - Received 4600 messages so far
2025-02-27 23:48:02,956 - INFO - Received 4700 messages so far
2025-02-27 23:48:02,957 - INFO - Received 4800 messages so far
2025-02-27 23:48:02,957 - INFO - Received 4900 messages so far
2025-02-27 23:48:02,957 - INFO - Received 5000 messages so far
2025-02-27 23:48:02,957 - INFO - Received 5100 messages so far
2025-02-27 23:48:02,957 - INFO - Received 5200 messages so far
2025-02-27 23:48:02,958 - INFO - Received 5300 messages so far
2025-02-27 23:48:02,958 - INFO - Received 5400 messages so far
2025-02-27 23:48:02,958 - INFO - Received 5500 messages so far
2025-02-27 23:48:02,958 - INFO - Received 5600 messages so far
2025-02-27 23:48:02,958 - INFO - Received 5700 messages so far
2025-02-27 23:48:02,959 - INFO - Received 5800 messages so far
2025-02-27 23:48:02,959 - INFO - Received 5900 messages so far
2025-02-27 23:48:02,959 - INFO - Received 6000 messages so far
2025-02-27 23:48:02,959 - INFO - Received 6100 messages so far
2025-02-27 23:48:02,959 - INFO - Received 6200 messages so far
2025-02-27 23:48:02,960 - INFO - Received 6300 messages so far
2025-02-27 23:48:02,960 - INFO - Received 6400 messages so far
2025-02-27 23:48:02,960 - INFO - Received 6500 messages so far
2025-02-27 23:48:02,960 - INFO - Received 6600 messages so far
2025-02-27 23:48:02,960 - INFO - Received 6700 messages so far
2025-02-27 23:48:02,961 - INFO - Received 6800 messages so far
2025-02-27 23:48:02,961 - INFO - Received 6900 messages so far
2025-02-27 23:48:02,961 - INFO - Received 7000 messages so far
2025-02-27 23:48:02,961 - INFO - Received 7100 messages so far
2025-02-27 23:48:02,961 - INFO - Received 7200 messages so far
2025-02-27 23:48:02,962 - INFO - Received 7300 messages so far
2025-02-27 23:48:02,962 - INFO - Received 7400 messages so far
2025-02-27 23:48:02,962 - INFO - Received 7500 messages so far
2025-02-27 23:48:02,962 - INFO - Received 7600 messages so far
2025-02-27 23:48:02,962 - INFO - Received 7700 messages so far
2025-02-27 23:48:02,963 - INFO - Received 7800 messages so far
2025-02-27 23:48:02,963 - INFO - Received 7900 messages so far
2025-02-27 23:48:02,963 - INFO - Received 8000 messages so far
2025-02-27 23:48:02,963 - INFO - Received 8100 messages so far
2025-02-27 23:48:02,963 - INFO - Received 8200 messages so far
2025-02-27 23:48:02,964 - INFO - Received 8300 messages so far
2025-02-27 23:48:02,964 - INFO - Received 8400 messages so far
2025-02-27 23:48:02,964 - INFO - Received 8500 messages so far
2025-02-27 23:48:02,964 - INFO - Received 8600 messages so far
2025-02-27 23:48:02,965 - INFO - Received 8700 messages so far
2025-02-27 23:48:03,027 - INFO - Received 8800 messages so far
2025-02-27 23:48:03,027 - INFO - Received 8900 messages so far
2025-02-27 23:48:03,027 - INFO - Received 9000 messages so far
2025-02-27 23:48:03,027 - INFO - Received 9100 messages so far
2025-02-27 23:48:03,028 - INFO - Received 9200 messages so far
2025-02-27 23:48:03,028 - INFO - Received 9300 messages so far
2025-02-27 23:48:03,028 - INFO - Received 9400 messages so far
2025-02-27 23:48:03,028 - INFO - Received 9500 messages so far
2025-02-27 23:48:03,029 - INFO - Received 9600 messages so far
2025-02-27 23:48:03,029 - INFO - Received 9700 messages so far
2025-02-27 23:48:03,029 - INFO - Received 9800 messages so far
2025-02-27 23:48:03,029 - INFO - Received 9900 messages so far
2025-02-27 23:48:03,029 - INFO - Received 10000 messages so far
2025-02-27 23:48:03,030 - INFO - Total messages consumed: 10000
2025-02-27 23:48:03,120 - INFO - Messages converted to DataFrame successfully!
2025-02-27 23:48:03,123 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-27 23:48:03,123 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-27 23:48:03,123 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-27 23:48:03,123 - INFO - Dropping 71 columns out of 97 specified
2025-02-27 23:48:03,137 - INFO - DataFrame shape after cleaning: (10000, 91)
2025-02-27 23:48:03,137 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'ts_delta', 'acks', 'percent_lost', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'validation_status', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'extracted_cutoff']
2025-02-27 23:48:03,137 - INFO - Number of columns: 91
2025-02-27 23:48:03,154 - INFO - DataFrame head:
      id.resp_p    id.orig_h    id.resp_h proto  orig_bytes  resp_bytes            ts  pkts_proc  bytes_recv  pkts_dropped  pkts_link  pkt_lag  active_tcp_conns  active_udp_conns  active_icmp_conns  tcp_conns  udp_conns  icmp_conns  dns_requests  active_dns_requests  reassem_tcp_size  reassem_file_size  reassem_frag_size host service                 uid  id.orig_p       rtt                      query  qclass qclass_name  qtype qtype_name  rcode rcode_name     AA     TC    RD    RA    Z                                                                                                                                                                                                                answers                                                                           TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration  ts_delta  acks  percent_lost version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol validation_status  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate is_orig  seen_bytes  missing_bytes  overflow_bytes timedout extracted_cutoff
9659       53.0  192.168.1.3  192.168.1.1   udp         NaN         NaN  1.740120e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  C2zOKc4BbDvFQRSc7l    33213.0  0.003386  login.microsoftonline.com     1.0  C_INTERNET    1.0          A    0.0    NOERROR  False  False  True  True  0.0  [login.mso.msidentity.com, ak.privatelink.msidentity.com, www.tm.ak.prd.aadg.trafficmanager.net, 40.126.24.148, 20.190.152.20, 40.126.24.82, 40.126.24.84, 20.190.152.19, 40.126.24.81, 40.126.24.147, 20.190.152.21]  [10197.0, 66.0, 67.0, 123.0, 123.0, 123.0, 123.0, 123.0, 123.0, 123.0, 123.0]    False        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
3958        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN                 NaN        NaN       NaN                        NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                    NaN                                                                            NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
7258     9092.0  192.168.1.3  192.168.1.4   tcp         0.0         0.0  1.740119e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  Cka2kt23NkIHWecu77    51058.0       NaN                        NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                    NaN                                                                            NaN      NaN        REJ       True       True           0.0      Sr        1.0           60.0        1.0           40.0       6.0  0.000161       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
2238        NaN          NaN          NaN   NaN         NaN         NaN  1.740118e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN                 NaN        NaN       NaN                        NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                    NaN                                                                            NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
6806        NaN          NaN          NaN   NaN         NaN         NaN  1.740119e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN                 NaN        NaN       NaN                        NaN     NaN         NaN    NaN        NaN    NaN        NaN    NaN    NaN   NaN   NaN  NaN                                                                                                                                                                                                                    NaN                                                                            NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
2025-02-27 23:48:03,154 - INFO - DataFrame shape: (10000, 91)
2025-02-27 23:48:03,210 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts     pkts_proc    bytes_recv  pkts_dropped     pkts_link   pkt_lag  active_tcp_conns  active_udp_conns  active_icmp_conns   tcp_conns   udp_conns  icmp_conns  dns_requests  active_dns_requests  reassem_tcp_size  reassem_file_size  reassem_frag_size     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration    ts_delta         acks  percent_lost  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate  seen_bytes  missing_bytes  overflow_bytes
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03      7.000000  7.000000e+00           7.0      7.000000  7.000000          7.000000          7.000000           7.000000    7.000000    7.000000    7.000000           7.0                  7.0          7.000000                7.0                7.0   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000    3.000000     3.000000      3.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00         4.0            4.0             4.0
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  48173.000000  3.291629e+07           0.0  48172.142857  0.002835          9.714286          5.428571           0.428571   80.857143   54.285714    2.142857           0.0                  0.0        141.000000                0.0                0.0  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712  620.026357   885.666667      2.491723          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09      1858.0            0.0             0.0
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  24894.946743  1.861603e+07           0.0  24894.248475  0.004274          5.250850          2.992053           0.534522   89.657550   32.612443    3.132016           0.0                  0.0        320.150485                0.0                0.0  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772  484.994635   964.336214      4.315791          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04         0.0            0.0             0.0
min        0.000000  0.000000e+00       0.000000  1.740118e+09      1.000000  6.000000e+01           0.0      0.000000  0.000000          1.000000          0.000000           0.000000    1.000000    0.000000    0.000000           0.0                  0.0          0.000000                0.0                0.0     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000   60.002792     0.000000      0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09      1858.0            0.0             0.0
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  40765.000000  2.579216e+07           0.0  40765.500000  0.000867          9.000000          5.000000           0.000000   16.500000   47.500000    0.500000           0.0                  0.0          0.000000                0.0                0.0  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527  480.002466   372.000000      0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09      1858.0            0.0             0.0
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  55994.000000  3.660305e+07           0.0  55992.000000  0.001849          9.000000          5.000000           0.000000   55.000000   50.000000    1.000000           0.0                  0.0          0.000000                0.0                0.0  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381  900.002140   744.000000      0.000000          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09      1858.0            0.0             0.0
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  63324.000000  4.479299e+07           0.0  63322.000000  0.001973         10.500000          6.500000           1.000000  128.500000   63.500000    2.000000           0.0                  0.0         61.500000                0.0                0.0  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678  900.038139  1328.500000      3.737585          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09      1858.0            0.0             0.0
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  73038.000000  5.264059e+07           0.0  73038.000000  0.012315         19.000000         10.000000           1.000000  220.000000  108.000000    9.000000           0.0                  0.0        864.000000                0.0                0.0  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649  900.074139  1913.000000      7.475170          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09      1858.0            0.0             0.0
2025-02-27 23:48:03,259 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol validation_status method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus is_orig timedout extracted_cutoff
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5                 5      7   7           7    7                   4             4                                         4                                         4                                       4          4       4        4                4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1                 1      1   1           1    1                   4             1                                         2                                         2                                       2          1       1        1                1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    fb5090d671c8a979              fb5090d671c8a979  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2                ok    GET   /  No Content   []  FHO0IR29JmFhZFoUuc          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good   False    False            False
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5                 5      7   7           7    7                   1             4                                         3                                         3                                       3          4       4        4                4
2025-02-27 23:48:03,260 - INFO - Dropping 36 columns out of 73 specified in second drop
2025-02-27 23:48:03,278 - INFO - DataFrame shape after NA dropping: (7214, 55)
2025-02-27 23:48:03,278 - INFO - Total processed data shape: (7214, 55)
2025-02-27 23:48:03,404 - INFO - Saved all processed data to received/network_traffic_20250227_234802.csv
2025-02-27 23:48:03,450 - INFO - JSON data size: 8490793 bytes
2025-02-27 23:48:03,450 - INFO - Preparing to send 8.10 MB of data to 192.168.1.3:9000
2025-02-27 23:48:03,450 - INFO - Socket send buffer size set to: 0.41 MB
2025-02-27 23:48:03,450 - INFO - Socket timeout set to 30 seconds
2025-02-27 23:48:03,450 - INFO - Connected successfully, starting data transmission
2025-02-27 23:48:03,457 - INFO - Data transmission completed. Total sent: 8.10MB
2025-02-27 23:48:03,457 - INFO - Data processing and transmission completed successfully
2025-02-27 23:48:03,459 - INFO - Data processing completed successfully. Exiting.
2025-02-27 23:55:22,700 - INFO - Starting livepreprocessing_socket.py
2025-02-27 23:55:22,700 - INFO - Starting data processing
2025-02-27 23:55:22,700 - INFO - This run will save data to: received/network_traffic_20250227_235522.csv
2025-02-27 23:55:22,700 - INFO - Attempting to connect to Kafka topic 'zeek' on ['192.168.1.3:9092']
2025-02-27 23:55:22,701 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: connecting to 192.168.1.3:9092 [('192.168.1.3', 9092) IPv4]
2025-02-27 23:55:22,702 - INFO - Probing node bootstrap-0 broker version
2025-02-27 23:55:22,702 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connecting> [IPv4 ('192.168.1.3', 9092)]>: Connection complete.
2025-02-27 23:55:22,803 - INFO - Broker version identified as 2.5.0
2025-02-27 23:55:22,804 - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-02-27 23:55:22,804 - WARNING - group_id is None: disabling auto-commit.
2025-02-27 23:55:22,804 - INFO - Updating subscribed topics to: ('zeek',)
2025-02-27 23:55:22,804 - INFO - Connected to Kafka. Waiting for messages...
2025-02-27 23:55:22,805 - INFO - Updated partition assignment: [TopicPartition(topic='zeek', partition=0)]
2025-02-27 23:55:22,805 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: connecting to Atlas:9092 [('127.0.1.1', 9092) IPv4]
2025-02-27 23:55:22,805 - INFO - <BrokerConnection node_id=0 host=Atlas:9092 <connecting> [IPv4 ('127.0.1.1', 9092)]>: Connection complete.
2025-02-27 23:55:22,805 - INFO - <BrokerConnection node_id=bootstrap-0 host=192.168.1.3:9092 <connected> [IPv4 ('192.168.1.3', 9092)]>: Closing connection. 
2025-02-27 23:55:22,962 - INFO - Received 100 messages so far
2025-02-27 23:55:22,963 - INFO - Received 200 messages so far
2025-02-27 23:55:22,963 - INFO - Received 300 messages so far
2025-02-27 23:55:22,963 - INFO - Received 400 messages so far
2025-02-27 23:55:22,963 - INFO - Received 500 messages so far
2025-02-27 23:55:22,964 - INFO - Received 600 messages so far
2025-02-27 23:55:22,964 - INFO - Received 700 messages so far
2025-02-27 23:55:22,964 - INFO - Received 800 messages so far
2025-02-27 23:55:22,964 - INFO - Received 900 messages so far
2025-02-27 23:55:22,965 - INFO - Received 1000 messages so far
2025-02-27 23:55:22,965 - INFO - Received 1100 messages so far
2025-02-27 23:55:22,965 - INFO - Received 1200 messages so far
2025-02-27 23:55:22,965 - INFO - Received 1300 messages so far
2025-02-27 23:55:22,965 - INFO - Received 1400 messages so far
2025-02-27 23:55:22,966 - INFO - Received 1500 messages so far
2025-02-27 23:55:22,966 - INFO - Received 1600 messages so far
2025-02-27 23:55:22,966 - INFO - Received 1700 messages so far
2025-02-27 23:55:22,966 - INFO - Received 1800 messages so far
2025-02-27 23:55:22,966 - INFO - Received 1900 messages so far
2025-02-27 23:55:22,967 - INFO - Received 2000 messages so far
2025-02-27 23:55:22,967 - INFO - Received 2100 messages so far
2025-02-27 23:55:22,967 - INFO - Received 2200 messages so far
2025-02-27 23:55:22,967 - INFO - Received 2300 messages so far
2025-02-27 23:55:22,967 - INFO - Received 2400 messages so far
2025-02-27 23:55:22,968 - INFO - Received 2500 messages so far
2025-02-27 23:55:22,968 - INFO - Received 2600 messages so far
2025-02-27 23:55:22,968 - INFO - Received 2700 messages so far
2025-02-27 23:55:22,968 - INFO - Received 2800 messages so far
2025-02-27 23:55:22,968 - INFO - Received 2900 messages so far
2025-02-27 23:55:22,969 - INFO - Received 3000 messages so far
2025-02-27 23:55:22,969 - INFO - Received 3100 messages so far
2025-02-27 23:55:22,969 - INFO - Received 3200 messages so far
2025-02-27 23:55:22,969 - INFO - Received 3300 messages so far
2025-02-27 23:55:22,969 - INFO - Received 3400 messages so far
2025-02-27 23:55:22,970 - INFO - Received 3500 messages so far
2025-02-27 23:55:22,970 - INFO - Received 3600 messages so far
2025-02-27 23:55:22,970 - INFO - Received 3700 messages so far
2025-02-27 23:55:22,970 - INFO - Received 3800 messages so far
2025-02-27 23:55:22,970 - INFO - Received 3900 messages so far
2025-02-27 23:55:22,971 - INFO - Received 4000 messages so far
2025-02-27 23:55:22,971 - INFO - Received 4100 messages so far
2025-02-27 23:55:23,030 - INFO - Received 4200 messages so far
2025-02-27 23:55:23,031 - INFO - Received 4300 messages so far
2025-02-27 23:55:23,031 - INFO - Received 4400 messages so far
2025-02-27 23:55:23,031 - INFO - Received 4500 messages so far
2025-02-27 23:55:23,031 - INFO - Received 4600 messages so far
2025-02-27 23:55:23,032 - INFO - Received 4700 messages so far
2025-02-27 23:55:23,032 - INFO - Received 4800 messages so far
2025-02-27 23:55:23,032 - INFO - Received 4900 messages so far
2025-02-27 23:55:23,032 - INFO - Received 5000 messages so far
2025-02-27 23:55:23,033 - INFO - Received 5100 messages so far
2025-02-27 23:55:23,033 - INFO - Received 5200 messages so far
2025-02-27 23:55:23,033 - INFO - Received 5300 messages so far
2025-02-27 23:55:23,033 - INFO - Received 5400 messages so far
2025-02-27 23:55:23,033 - INFO - Received 5500 messages so far
2025-02-27 23:55:23,034 - INFO - Received 5600 messages so far
2025-02-27 23:55:23,034 - INFO - Received 5700 messages so far
2025-02-27 23:55:23,034 - INFO - Received 5800 messages so far
2025-02-27 23:55:23,034 - INFO - Received 5900 messages so far
2025-02-27 23:55:23,034 - INFO - Received 6000 messages so far
2025-02-27 23:55:23,035 - INFO - Received 6100 messages so far
2025-02-27 23:55:23,035 - INFO - Received 6200 messages so far
2025-02-27 23:55:23,035 - INFO - Received 6300 messages so far
2025-02-27 23:55:23,035 - INFO - Received 6400 messages so far
2025-02-27 23:55:23,035 - INFO - Received 6500 messages so far
2025-02-27 23:55:23,036 - INFO - Received 6600 messages so far
2025-02-27 23:55:23,036 - INFO - Received 6700 messages so far
2025-02-27 23:55:23,036 - INFO - Received 6800 messages so far
2025-02-27 23:55:23,036 - INFO - Received 6900 messages so far
2025-02-27 23:55:23,036 - INFO - Received 7000 messages so far
2025-02-27 23:55:23,037 - INFO - Received 7100 messages so far
2025-02-27 23:55:23,037 - INFO - Received 7200 messages so far
2025-02-27 23:55:23,037 - INFO - Received 7300 messages so far
2025-02-27 23:55:23,037 - INFO - Received 7400 messages so far
2025-02-27 23:55:23,037 - INFO - Received 7500 messages so far
2025-02-27 23:55:23,038 - INFO - Received 7600 messages so far
2025-02-27 23:55:23,038 - INFO - Received 7700 messages so far
2025-02-27 23:55:23,038 - INFO - Received 7800 messages so far
2025-02-27 23:55:23,038 - INFO - Received 7900 messages so far
2025-02-27 23:55:23,038 - INFO - Received 8000 messages so far
2025-02-27 23:55:23,039 - INFO - Received 8100 messages so far
2025-02-27 23:55:23,039 - INFO - Received 8200 messages so far
2025-02-27 23:55:23,039 - INFO - Received 8300 messages so far
2025-02-27 23:55:23,039 - INFO - Received 8400 messages so far
2025-02-27 23:55:23,039 - INFO - Received 8500 messages so far
2025-02-27 23:55:23,040 - INFO - Received 8600 messages so far
2025-02-27 23:55:23,040 - INFO - Received 8700 messages so far
2025-02-27 23:55:23,102 - INFO - Received 8800 messages so far
2025-02-27 23:55:23,103 - INFO - Received 8900 messages so far
2025-02-27 23:55:23,103 - INFO - Received 9000 messages so far
2025-02-27 23:55:23,103 - INFO - Received 9100 messages so far
2025-02-27 23:55:23,103 - INFO - Received 9200 messages so far
2025-02-27 23:55:23,104 - INFO - Received 9300 messages so far
2025-02-27 23:55:23,104 - INFO - Received 9400 messages so far
2025-02-27 23:55:23,104 - INFO - Received 9500 messages so far
2025-02-27 23:55:23,104 - INFO - Received 9600 messages so far
2025-02-27 23:55:23,104 - INFO - Received 9700 messages so far
2025-02-27 23:55:23,105 - INFO - Received 9800 messages so far
2025-02-27 23:55:23,105 - INFO - Received 9900 messages so far
2025-02-27 23:55:23,105 - INFO - Received 10000 messages so far
2025-02-27 23:55:23,105 - INFO - Total messages consumed: 10000
2025-02-27 23:55:23,193 - INFO - Messages converted to DataFrame successfully!
2025-02-27 23:55:23,196 - INFO - Initial DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-27 23:55:23,196 - INFO - Initial DataFrame shape: (10000, 162)
2025-02-27 23:55:23,196 - INFO - Initial columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'peer', 'mem', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'events_proc', 'events_queued', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'timers', 'active_timers', 'files', 'active_files', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'reassem_unknown_size', 'host', 'port_num', 'port_proto', 'service', 'uid', 'id.orig_p', 'trans_id', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'uids', 'mac', 'host_name', 'requested_addr', 'msg_types', 'note', 'msg', 'actions', 'email_dest', 'suppress_for', 'ts_delta', 'gaps', 'acks', 'percent_lost', 'metric_type', 'name', 'labels', 'label_values', 'value', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'cert_chain_fps', 'client_cert_chain_fps', 'subject', 'issuer', 'sni_matches_cert', 'validation_status', 'fingerprint', 'certificate.version', 'certificate.serial', 'certificate.subject', 'certificate.issuer', 'certificate.not_valid_before', 'certificate.not_valid_after', 'certificate.key_alg', 'certificate.sig_alg', 'certificate.key_type', 'certificate.key_length', 'certificate.exponent', 'san.dns', 'basic_constraints.ca', 'host_cert', 'client_cert', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'client_addr', 'notice', 'source', 'mode', 'stratum', 'poll', 'precision', 'root_delay', 'root_disp', 'ref_id', 'ref_time', 'org_time', 'rec_time', 'xmt_time', 'num_exts', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'fuid', 'depth', 'analyzers', 'mime_type', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'md5', 'sha1', 'extracted', 'extracted_cutoff']
2025-02-27 23:55:23,197 - INFO - Dropping 71 columns out of 97 specified
2025-02-27 23:55:23,210 - INFO - DataFrame shape after cleaning: (10000, 91)
2025-02-27 23:55:23,210 - INFO - DataFrame columns: ['id.resp_p', 'id.orig_h', 'id.resp_h', 'proto', 'orig_bytes', 'resp_bytes', 'ts', 'pkts_proc', 'bytes_recv', 'pkts_dropped', 'pkts_link', 'pkt_lag', 'active_tcp_conns', 'active_udp_conns', 'active_icmp_conns', 'tcp_conns', 'udp_conns', 'icmp_conns', 'dns_requests', 'active_dns_requests', 'reassem_tcp_size', 'reassem_file_size', 'reassem_frag_size', 'host', 'service', 'uid', 'id.orig_p', 'rtt', 'query', 'qclass', 'qclass_name', 'qtype', 'qtype_name', 'rcode', 'rcode_name', 'AA', 'TC', 'RD', 'RA', 'Z', 'answers', 'TTLs', 'rejected', 'conn_state', 'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'ip_proto', 'duration', 'ts_delta', 'acks', 'percent_lost', 'version', 'client_initial_dcid', 'client_scid', 'server_scid', 'cipher', 'curve', 'server_name', 'resumed', 'established', 'ssl_history', 'next_protocol', 'validation_status', 'trans_depth', 'method', 'uri', 'request_body_len', 'response_body_len', 'status_code', 'status_msg', 'tags', 'id', 'hashAlgorithm', 'issuerNameHash', 'issuerKeyHash', 'serialNumber', 'certStatus', 'thisUpdate', 'nextUpdate', 'is_orig', 'seen_bytes', 'missing_bytes', 'overflow_bytes', 'timedout', 'extracted_cutoff']
2025-02-27 23:55:23,210 - INFO - Number of columns: 91
2025-02-27 23:55:23,225 - INFO - DataFrame head:
      id.resp_p id.orig_h id.resp_h proto  orig_bytes  resp_bytes            ts  pkts_proc  bytes_recv  pkts_dropped  pkts_link  pkt_lag  active_tcp_conns  active_udp_conns  active_icmp_conns  tcp_conns  udp_conns  icmp_conns  dns_requests  active_dns_requests  reassem_tcp_size  reassem_file_size  reassem_frag_size host service  uid  id.orig_p  rtt query  qclass qclass_name  qtype qtype_name  rcode rcode_name   AA   TC   RD   RA   Z answers TTLs rejected conn_state local_orig local_resp  missed_bytes history  orig_pkts  orig_ip_bytes  resp_pkts  resp_ip_bytes  ip_proto  duration  ts_delta  acks  percent_lost version client_initial_dcid client_scid server_scid cipher curve server_name resumed established ssl_history next_protocol validation_status  trans_depth method  uri  request_body_len  response_body_len  status_code status_msg tags   id hashAlgorithm issuerNameHash issuerKeyHash serialNumber certStatus  thisUpdate  nextUpdate is_orig  seen_bytes  missing_bytes  overflow_bytes timedout extracted_cutoff
47          NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
1817        NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.004742       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
8096        NaN       NaN       NaN   NaN         NaN         NaN  1.740120e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
323         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN       NaN       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
773         NaN       NaN       NaN   NaN         NaN         NaN  1.740118e+09        NaN         NaN           NaN        NaN      NaN               NaN               NaN                NaN        NaN        NaN         NaN           NaN                  NaN               NaN                NaN                NaN  NaN     NaN  NaN        NaN  NaN   NaN     NaN         NaN    NaN        NaN    NaN        NaN  NaN  NaN  NaN  NaN NaN     NaN  NaN      NaN        NaN        NaN        NaN           NaN     NaN        NaN            NaN        NaN            NaN       NaN  0.008161       NaN   NaN           NaN     NaN                 NaN         NaN         NaN    NaN   NaN         NaN     NaN         NaN         NaN           NaN               NaN          NaN    NaN  NaN               NaN                NaN          NaN        NaN  NaN  NaN           NaN            NaN           NaN          NaN        NaN         NaN         NaN     NaN         NaN            NaN             NaN      NaN              NaN
2025-02-27 23:55:23,225 - INFO - DataFrame shape: (10000, 91)
2025-02-27 23:55:23,280 - INFO - DataFrame numeric summary:
          id.resp_p    orig_bytes     resp_bytes            ts     pkts_proc    bytes_recv  pkts_dropped     pkts_link   pkt_lag  active_tcp_conns  active_udp_conns  active_icmp_conns   tcp_conns   udp_conns  icmp_conns  dns_requests  active_dns_requests  reassem_tcp_size  reassem_file_size  reassem_frag_size     id.orig_p         rtt  qclass       qtype       rcode      Z   missed_bytes    orig_pkts  orig_ip_bytes    resp_pkts  resp_ip_bytes     ip_proto     duration    ts_delta         acks  percent_lost  trans_depth  request_body_len  response_body_len  status_code    thisUpdate    nextUpdate  seen_bytes  missing_bytes  overflow_bytes
count   1606.000000  1.048000e+03    1048.000000  9.999000e+03      7.000000  7.000000e+00           7.0      7.000000  7.000000          7.000000          7.000000           7.000000    7.000000    7.000000    7.000000           7.0                  7.0          7.000000                7.0                7.0   1605.000000  243.000000   426.0  426.000000  409.000000  433.0    1079.000000  1079.000000   1.079000e+03  1079.000000    1079.000000  1079.000000  2022.000000    3.000000     3.000000      3.000000          7.0               7.0                7.0          7.0  4.000000e+00  4.000000e+00         4.0            4.0             4.0
mean    3633.608966  2.719185e+03    1388.354008  1.740119e+09  48173.000000  3.291629e+07           0.0  48172.142857  0.002835          9.714286          5.428571           0.428571   80.857143   54.285714    2.142857           0.0                  0.0        141.000000                0.0                0.0  46064.636137    0.007470     1.0   43.377934    0.007335    0.0     275.277108     3.065802   2.782652e+03     3.405931    1494.846154    11.202966     3.474712  620.026357   885.666667      2.491723          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09      1858.0            0.0             0.0
std     4365.460666  6.037924e+04   27411.985622  5.961216e+02  24894.946743  1.861603e+07           0.0  24894.248475  0.004274          5.250850          2.992053           0.534522   89.657550   32.612443    3.132016           0.0                  0.0        320.150485                0.0                0.0  12565.455755    0.018644     0.0   39.157545    0.148340    0.0    9042.339733    20.577883   6.043692e+04    30.110991   27527.392373     7.988196    28.756772  484.994635   964.336214      4.315791          0.0               0.0                0.0          0.0  5.819691e+04  5.819691e+04         0.0            0.0             0.0
min        0.000000  0.000000e+00       0.000000  1.740118e+09      1.000000  6.000000e+01           0.0      0.000000  0.000000          1.000000          0.000000           0.000000    1.000000    0.000000    0.000000           0.0                  0.0          0.000000                0.0                0.0     68.000000    0.000281     1.0    1.000000    0.000000    0.0       0.000000     0.000000   0.000000e+00     0.000000       0.000000     6.000000     0.000000   60.002792     0.000000      0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09      1858.0            0.0             0.0
25%       53.000000  0.000000e+00       0.000000  1.740118e+09  40765.000000  2.579216e+07           0.0  40765.500000  0.000867          9.000000          5.000000           0.000000   16.500000   47.500000    0.500000           0.0                  0.0          0.000000                0.0                0.0  40295.000000    0.001778     1.0    1.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.000527  480.002466   372.000000      0.000000          1.0               0.0                0.0        204.0  1.739575e+09  1.740267e+09      1858.0            0.0             0.0
50%      136.000000  0.000000e+00       0.000000  1.740119e+09  55994.000000  3.660305e+07           0.0  55992.000000  0.001849          9.000000          5.000000           0.000000   55.000000   50.000000    1.000000           0.0                  0.0          0.000000                0.0                0.0  50503.000000    0.002234     1.0   65.000000    0.000000    0.0       0.000000     1.000000   6.000000e+01     1.000000      40.000000     6.000000     0.005381  900.002140   744.000000      0.000000          1.0               0.0                0.0        204.0  1.739625e+09  1.740318e+09      1858.0            0.0             0.0
75%     9092.000000  6.100000e+01     198.000000  1.740119e+09  63324.000000  4.479299e+07           0.0  63322.000000  0.001973         10.500000          6.500000           1.000000  128.500000   63.500000    2.000000           0.0                  0.0         61.500000                0.0                0.0  54430.000000    0.002860     1.0   65.000000    0.000000    0.0       0.000000     1.000000   9.000000e+01     1.000000     226.000000    17.000000     0.007678  900.038139  1328.500000      3.737585          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09      1858.0            0.0             0.0
max    21116.000000  1.932996e+06  874506.000000  1.740120e+09  73038.000000  5.264059e+07           0.0  73038.000000  0.012315         19.000000         10.000000           1.000000  220.000000  108.000000    9.000000           0.0                  0.0        864.000000                0.0                0.0  60995.000000    0.119818     1.0  255.000000    3.000000    0.0  297024.000000   565.000000   1.962384e+06   873.000000  888638.000000    58.000000   448.102649  900.074139  1913.000000      7.475170          1.0               0.0                0.0        204.0  1.739676e+09  1.740368e+09      1858.0            0.0             0.0
2025-02-27 23:55:23,329 - INFO - DataFrame non-numeric summary:
          id.orig_h    id.resp_h proto                            host service                 uid                    query qclass_name qtype_name rcode_name     AA     TC    RD    RA                                                                                                                              answers                                                                      TTLs rejected conn_state local_orig local_resp history version client_initial_dcid client_scid       server_scid                  cipher      curve                       server_name resumed established ssl_history next_protocol validation_status method uri  status_msg tags                  id hashAlgorithm                            issuerNameHash                             issuerKeyHash                            serialNumber certStatus is_orig timedout extracted_cutoff
count          1606         1606  1513                              10     439                1605                      433         426        426        409    433    433   433   433                                                                                                                                  254                                                                       254      433       1079       1083       1079    1081      86                  19          19                17                      54         54                                39      56          56          56             5                 5      7   7           7    7                   4             4                                         4                                         4                                       4          4       4        4                4
unique           18           69     4                               4       8                1118                       66           1          6          2      2      1     2     2                                                                                                                                  117                                                                       213        1          7          2          2      28       5                  19           1                17                       4          4                                17       2           2           6             1                 1      1   1           1    1                   4             1                                         2                                         2                                       2          1       1        1                1
top     192.168.1.3  192.168.1.1   udp  connectivity-check.ubuntu.com.     dns  CQW5gD448OyN1FH5bg  wac-0003.wac-msedge.net  C_INTERNET      HTTPS    NOERROR  False  False  True  True  [usc-word-edit-geo.wac.trafficmanager.net, usc-word-edit.wac.trafficmanager.net.wac-0003.wac-dc-msedge.net.wac-0003.wac-msedge.net]  [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]    False        REJ       True       True      Sr  TLSv13    b90b0ae34b0b9725              f90b0ae34b0b9725  TLS_AES_256_GCM_SHA384  secp384r1  mobile.events.data.microsoft.com   False        True      CjiICs            h2                ok    GET   /  No Content   []  FvpGpu22EX4OAIsXwi          sha1  E475019DC323E226741D6C40390795F90596462E  3B70D153E976259D60A8CA660FC69BAE6F54166A  3300E0D2F69F3A2BFEE266BDA4000000E0D2F6       good   False    False            False
freq           1520          762   863                               7     382                   7                       74         426        248        408    416    433   392   238                                                                                                                                   34                                                                         6      433        585       1079        962     585      49                   1          19                 1                      30         27                                 6      48          39          23             5                 5      7   7           7    7                   1             4                                         3                                         3                                       3          4       4        4                4
2025-02-27 23:55:23,330 - INFO - Dropping 36 columns out of 73 specified in second drop
2025-02-27 23:55:23,346 - INFO - DataFrame shape after NA dropping: (2452, 55)
2025-02-27 23:55:23,347 - INFO - Total processed data shape: (2452, 55)
2025-02-27 23:55:23,395 - INFO - Saved all processed data to received/network_traffic_20250227_235522.csv
2025-02-27 23:55:23,409 - INFO - JSON data size: 2899941 bytes
2025-02-27 23:55:23,409 - INFO - Preparing to send 2.77 MB of data to 192.168.1.3:9000
2025-02-27 23:55:23,409 - INFO - Socket send buffer size set to: 0.41 MB
2025-02-27 23:55:23,409 - INFO - Socket timeout set to 30 seconds
2025-02-27 23:55:23,409 - INFO - Connected successfully, starting data transmission
2025-02-27 23:55:23,411 - INFO - Data transmission completed. Total sent: 2.77MB
2025-02-27 23:55:23,411 - INFO - Data processing and transmission completed successfully
2025-02-27 23:55:23,413 - INFO - Data processing completed successfully. Exiting.
